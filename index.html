<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CyberSec Command - Cybersecurity Platform</title>
    <script type="text/javascript" src="https://gc.kis.v2.scr.kaspersky-labs.com/FD126C42-EBFA-4E12-B309-BB3FDD723AC1/main.js?attr=nLELk0PHAMy_rjw9jlZKTzFTtBb3yGeTOIRvUE8_Pi33hTESkRPThGDVfE6mlq0y_VQcW2VrmC6xjQbP-DhGCX8BjQTKHeLIuaAf_TNzFy9wPaI8hec06ND-vR6lNNPZMKkgtZ8ThOM9rx2FUDBK7Lhl1h-2gUNslMUZodzi9MD9ZD7fzC5i5UiYgiNm7gFQ6IBg7WlLa4A3s-P7-e3Oshwph9Je6zkDmUIkCFuX-jqH1SKW5rJ3f7UXTtXdV2d9TDJ-MZgP7n4s5Fpc0rSVJ7MtjVyGYR0VxKvys3DPc0mOd8rcDdXQsSF8hx48-4ENn4QfMa0cxFKYGVl6CHc4KBo6PUMSP9GXXBD95RrXJCL0r_E84pH2Y0QVafiYLBnnVoOk3HfVeim7gfvM8bMAqqAyyGQKR3YyB8rQImXZ6Lpx0kavwFE5cuMYeZAyqxBJWas7DQBI2Oh2yFK4mioFu1SisgjeaI3t7RuiuoUFc9d7vDoZC44ru-4-uybxT7No3SvjwOlFFH7LR3NSScYwsdPGBR45KnneqPvBUk45lZZxGR1xwcMczbZQKGYrLTWM0VoTWm6Z_XTT_IOB5-KD8zTf98xxQbgwj2mFuVRY3Eq1KCPEyHfdVCHonO82lx_kdkLUu1EiwDdEKwEQYyiI5f5VSMDc52G6Hhn-jB1KHc6NmMH2Mc2P43sZ-diLP1URL_sYvL9NBGbREmm0zPP0VoI49oj4LfcXsIKEArXt66H2zZ_KkvfPRTHx9RPYmotWjhic9yGZ8T79ajtYqblT2bqO1s9TaonWL55YxfBw3sHm87Yu9bSmgoo6qmE5itKMv6meHmapMGE_Ca1nkeEsYDIosdAafv_69jHBfODJIRceA7toNnSCslViWRS5-n1SxCRDhQ815tWTKdv3hA3MhJKePVC6_FAB9osieAB-5pZYvDTCnP5_wMlV2FTpkj5jxlaxo-9kP-1pB6PkELcw9z2_Bo7DEDOOM_cih8WGF7Jph3mh5bjfGf0lqbXRKDKbi_bixovFLi3iyF1nBDgR38T-Sxuyc6zv8RjsgX5XZ-g_V2UlIIJeu5lfpmsvqnSNUE0Y5HbYuQERhJeF2guwpknJC8aS9YBmzeI53Wo9ZfIMramduo5gkYm5E1CD2AQTAOb5HR5cBz1obNXdhJk4nEqh8AlylE0I2aqBLJ4vEjchM99o3u5peKtXrWMkC8om_eszzwuL_p4YTkG8q0eJKR13UP_O0PvRIsLEzdRTG__wcMKXBEdReb-6ER2c6RiDGZwe_rSvx6PmYOOv-8dZ1eJemMTz0aUroMmiXFKtG3WZghVYdT5uWkuoeo3fyIMzRu0ld1cYeWF_STrI35M4f7VzO-XnSfSPERqmdaiD9wed11R7AjzfyijZn1263ewyUsvKwM3bD44CEQj2B1i2HqKWxV4B1paSfMuPvHa13M1qqFEu-OAM20biOi_PqPeFTNU5gd6QQ4K4bZZgVp13uUeaCnByiwhanVmQXkNiAkog3OIGLa3Qn43RzVRMXklyBvZMyevW9Jq98T3dfqWw8dcquOuatEV91DJAhzwlwa9X5qoTvdGUzghb7xx1cvb-UE2VNFOqXX0GAz2Poa9pRa58jmtltxSb1imf2J-KgW_bOx5b9plkC7Tfx0zxsqEk8yWLuxcT-sarNSoIkQ3Ew_p2CaiW3yhtkRO8lBOIwr0bBP5K-o_ZKpVYfFbFuGO7T_BiGZr6-_t8W5lvXPBcFw6d6CYvSQbrTAqJ9jmI1tdZu4o0_keYlfJ7S-AYrCMCUZ2R-AZrhoe8eoMPlG6kF1OEXX65qYpzdGwPvCpf97NwSiR533J0zbnAa3eZO4fcqJtyx9Tk5Q-c8bUPpPAJ8DnCKQb3nCe5_s61o58LVo7YlGyaALWGqpznxJweZ03sI1Lc7fTU79O0-JfvBqNw_kzT_xQvtMFoZvn4LN4uzHLOx3EG5VbkTeKxNVexXegr5LbRNsRbfYFhuxh3VOupnGXvQBpyssMRznWDX6UxrbEOnxs6pn7soPM8pC10_piNtQPGbNYJe_Mis8jAVFzhs4ixDIxvrYlo5j0KbtvSwQ-EfGBssZjJimrhA7h2U4Iaow2Qieo0PORJ0PocXJ9Ft8LPcHvrSp93xgXIAZXn70DRqXlHk-SVVe9XXvxehRdPUwbOPWifRKykyQVJt5ADP0x-PS6zvNQqt2g4ReAcKLKkcH6vpszWjApHCMFaqAcQzkA51uwFid-ykTGa6Lbc5Q5xN6kGxlfDntXEpab8TN3o_7KEdCFyEVS1sMPNAUnsxD7FGvrr6e3WF_6ACH9YAA" charset="UTF-8"></script><link rel="stylesheet" crossorigin="anonymous" href="https://gc.kis.v2.scr.kaspersky-labs.com/E3E8934C-235A-4B0E-825A-35A08381A191/abn/main.css?attr=aHR0cHM6Ly9wcGwtYWktY29kZS1pbnRlcnByZXRlci1maWxlcy5zMy5hbWF6b25hd3MuY29tL3dlYi9kaXJlY3QtZmlsZXMvNTUwZGYzNWY0YmM1NWUyZGIwN2M5NmY0YTViMTE4ODYvNzljN2ZkMjktNmYxOS00MWJkLWIxZGMtNGQzZmZjZjZmYTVhLzliNTQzNDBjLmh0bWw_cmVzcG9uc2UtY29udGVudC1kaXNwb3NpdGlvbj1hdHRhY2htZW50JTNiJTIwZmlsZW5hbWUlM2RjeWJlcnNlYy1jb21tYW5kLmh0bWwlM2IlMjBmaWxlbmFtZSUyYSUzZFVURi04JTI3JTI3Y3liZXJzZWMtY29tbWFuZC5odG1sJkFXU0FjY2Vzc0tleUlkPUFTSUEyRjNFTUVZRVFNUDQ0NUdCJlNpZ25hdHVyZT04YnVOeWwxbDJ4TiUyZmNsd1FYa2VMZHhYZjFBWSUzZCZ4LWFtei1zZWN1cml0eS10b2tlbj1JUW9KYjNKcFoybHVYMlZqRUI4YUNYVnpMV1ZoYzNRdE1TSkhNRVVDSUZNNzBheWxiMXFxV2x0Zk00RUVaTUlRVlQ5cUhHZyUyYjBRTjlFYnAweWx1ekFpRUF3Vm9vSjZIekhOayUyZjU1TVUyTjclMmZFVWc0WjNSeEMzSUdFamo0bFYlMmZobkJNcSUyZkFRSTZQJTJmJTJmJTJmJTJmJTJmJTJmJTJmJTJmJTJmJTJmQVJBQkdndzJPVGszTlRNek1EazNNRFVpREx5aU41UEFFeVJIczZsNDRTclFCSHBKU2NBWGlsM0wlMmZtOFhoOVolMmZTMVBYakZuSCUyZmFNcWtkWThyT011YU9RQnc3azFWOER6JTJia21XdHI3bzhienZRcEl3aWR0a2hRVVk5SVNMZmx1UmRLTjRnZlltakV1S29FY09WOGFyd3FBT3ZtTDN4ZjFkejJCcXJFYU1oamVGdiUyZlJoVVdPSzZKNmdZdFhIM1F5UmhGNm5IZ3Z1bEFuUFI0NWJkYWo3RnRGZUpBWEpMRGd0c0tuNTFCRkY2UGNkeTFvRSUyYnI0T3JHb2VlSzlJYk5wYXFHJTJiMjdwQzZPYlQlMmJ5V1djZ0EwcU9UT25ubjFpelRNZzdMakZVemUyaDBBRUdLR3UlMmJKR2VlNENaWUN1cDE2a2dZQUtWeG9SRDJwTnhTSGgwZUhrTjlITVlEcjlJd2JaMjFiVE5yQnU4WXJwaGh4JTJmT2l1QzBLVEhjTWxzV3Q0OGhZbWEwRVR5NEJ0U0JyWDNaV1BEVkg1ejNrME5sVnpmUDBHVFVZZ1ZIbjc2VjB0Z2VJTVVSWUlROVNrTFhNSUdQRncyRmF5TCUyYjZzQkdNb1dtcE5OOWI0JTJicW1aaE9KdElJYmFzOWElMmZwSzd0VSUyZnk3NHIlMmZraXZWQ1FRd0R5WElKZXZCOU1kY1czakdNTUppcEp2WW40bEpVQUhMUHdMeG81TXgzQTRjdSUyZlZQSDZobVlIUTFuYyUyZnlNVU1mUkRxcUpSejJ6VkwlMmJjeFRuZWtScHJ2enRMa3lwb080RyUyZlRvRTFTa2ppYyUyYjZhMVVpUWJRJTJmJTJiQzJLJTJiRVBhSmtaSFNzUW1kQU0lMmZxQ3ZzRWp3JTJid3cwbEdWUXlFUVkzNERmcEZjdW1oVCUyZnV1bFFtSnVLRDVmSDR1VjZoJTJiVlJkNmsxNEpmMDJ4dkIlMmJyV2hzcnE4MCUyZnBwU1NoSWtZSWlmNklVMkIzU0hkQ2tra0tMOFVmb3AyTGRqN2tJSSUyYlpRQjNXa3ZkJTJmOHhNa0hYQiUyYkRhN1pIUW1haVlSekdSZSUyZk5KR1RjdDI4UkcyWEIxbHd0NFUycHE0eFlvWnI4eERJJTJieWZsVGE0enhKaTRhbU5zd2slMmJ5aHlnWTZtQUVIdFk5RlA0Y3ZKaVN5Ym9DanVmTHhvY2RXb0pQNUt6dTJLaFBaSEZkM3glMmJ6aWJ5dkY5dWVkaTE0bEg2NG1FZE1CJTJmTXNybUJSYzRWT3Z2UEFNTG1NNTlBeHFBdGh0bkZqdkJQM29xY0JNbjBsSUdQenlJcm5PMDVSTlFMWGZ0VVlndVQ4ZGUlMmYyWjluME02MG5tazZFamVuRzVzUE5FOTRwU2xKd3dLaHM0cWVSQWxRJTJmRlJKYkZYRlRNemtvcWFiWXhkUTNUbEg0Tjh3JTNkJTNkJkV4cGlyZXM9MTc2NjM1NzI4OA"/><style>
        :root {
            --color-navy: #0f1419;
            --color-teal: #00d4ff;
            --color-teal-dark: #00a8cc;
            --color-text: #e0e0e0;
            --color-text-secondary: #a0a0a0;
            --color-bg: #1a1f26;
            --color-surface: #242d38;
            --color-error: #ff5454;
            --color-success: #27ae60;
            --color-warning: #ffa500;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, var(--color-bg) 0%, #0d1117 100%);
            color: var(--color-text);
            line-height: 1.6;
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        header {
            text-align: center;
            margin-bottom: 40px;
            padding: 20px 0;
            border-bottom: 2px solid var(--color-teal);
        }

        h1 {
            font-size: 2.5em;
            color: var(--color-teal);
            margin-bottom: 10px;
            text-shadow: 0 0 10px rgba(0, 212, 255, 0.3);
        }

        .subtitle {
            color: var(--color-text-secondary);
            font-size: 1.1em;
        }

        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        .tab-btn {
            padding: 12px 20px;
            background: var(--color-surface);
            color: var(--color-text);
            border: 2px solid var(--color-teal);
            border-radius: 8px;
            cursor: pointer;
            font-size: 1em;
            transition: all 0.3s ease;
        }

        .tab-btn.active {
            background: var(--color-teal);
            color: var(--color-navy);
            font-weight: bold;
        }

        .tab-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 0 15px rgba(0, 212, 255, 0.5);
        }

        .tabs-content {
            display: none;
        }

        .tabs-content.active {
            display: block;
        }

        .tool-section {
            background: var(--color-surface);
            border: 2px solid var(--color-teal);
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: 0 0 20px rgba(0, 212, 255, 0.1);
        }

        .tool-title {
            font-size: 1.5em;
            color: var(--color-teal);
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .form-group {
            margin-bottom: 15px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            color: var(--color-text);
            font-weight: 500;
        }

        input, textarea, select {
            width: 100%;
            padding: 12px;
            background: var(--color-bg);
            color: var(--color-text);
            border: 1px solid var(--color-teal);
            border-radius: 6px;
            font-size: 1em;
            font-family: inherit;
        }

        input:focus, textarea:focus, select:focus {
            outline: none;
            box-shadow: 0 0 10px rgba(0, 212, 255, 0.5);
            border-color: var(--color-teal);
        }

        .btn {
            padding: 12px 30px;
            background: linear-gradient(135deg, var(--color-teal) 0%, var(--color-teal-dark) 100%);
            color: var(--color-navy);
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 1em;
            font-weight: bold;
            transition: all 0.3s ease;
            width: 100%;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 0 20px rgba(0, 212, 255, 0.6);
        }

        .btn:active {
            transform: translateY(0);
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .results {
            background: rgba(0, 0, 0, 0.3);
            border-left: 4px solid var(--color-teal);
            padding: 20px;
            margin-top: 20px;
            border-radius: 6px;
            max-height: 500px;
            overflow-y: auto;
        }

        .results.error {
            border-left-color: var(--color-error);
            color: var(--color-error);
        }

        .results.success {
            border-left-color: var(--color-success);
        }

        .result-item {
            margin-bottom: 12px;
            padding-bottom: 12px;
            border-bottom: 1px solid rgba(0, 212, 255, 0.2);
            word-break: break-word;
        }

        .result-item:last-child {
            border-bottom: none;
            margin-bottom: 0;
            padding-bottom: 0;
        }

        .result-label {
            color: var(--color-teal);
            font-weight: bold;
            margin-right: 8px;
        }

        .badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.9em;
            font-weight: bold;
        }

        .badge.safe {
            background: rgba(39, 174, 96, 0.2);
            color: var(--color-success);
        }

        .badge.malicious {
            background: rgba(255, 84, 89, 0.2);
            color: var(--color-error);
        }

        .badge.suspicious {
            background: rgba(255, 165, 0, 0.2);
            color: var(--color-warning);
        }

        .hidden {
            display: none;
        }

        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(0, 212, 255, 0.3);
            border-top-color: var(--color-teal);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .settings-btn {
            float: right;
            padding: 8px 16px;
            background: var(--color-surface);
            color: var(--color-teal);
            border: 1px solid var(--color-teal);
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.9em;
        }

        .settings-btn:hover {
            background: var(--color-teal);
            color: var(--color-navy);
        }

        .grid-resource {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }

        .resource-card {
            background: rgba(0, 212, 255, 0.1);
            padding: 15px;
            border-radius: 8px;
            border-left: 4px solid var(--color-teal);
        }

        .resource-card h3 {
            color: var(--color-teal);
            margin-bottom: 8px;
        }

        @media (max-width: 768px) {
            h1 { font-size: 1.8em; }
            .tabs { flex-direction: column; }
            .tab-btn { width: 100%; }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <button class="settings-btn" onclick="openSettings()">‚öôÔ∏è Settings</button>
            <h1>üõ°Ô∏è CyberSec Command</h1>
            <p class="subtitle">Enterprise-grade Cybersecurity Intelligence & Analysis Platform</p>
        </header>

        <div class="tabs">
            <button class="tab-btn active" onclick="switchTab(event, 'security')">üîí Security Tools</button>
            <button class="tab-btn" onclick="switchTab(event, 'threat')">‚ö†Ô∏è Threat Intel</button>
            <button class="tab-btn" onclick="switchTab(event, 'learning')">üìö Learning Hub</button>
        </div>

        <!-- Security Tools Tab -->
        <div id="security" class="tabs-content active">
            <div class="tool-section">
                <div class="tool-title">üåê IP Reputation Checker</div>
                <div class="form-group">
                    <label for="ip-input">Enter IP Address</label>
                    <input type="text" id="ip-input" placeholder="e.g., 8.8.8.8" />
                </div>
                <button class="btn" onclick="checkIP()">Check IP</button>
                <div id="ip-results" class="hidden results"></div>
            </div>

            <div class="tool-section">
                <div class="tool-title">üìß Email Breach Checker (HIBP)</div>
                <div class="form-group">
                    <label for="email-input">Enter Email Address</label>
                    <input type="text" id="email-input" placeholder="e.g., user@example.com" />
                </div>
                <button class="btn" onclick="checkEmail()">Check Email</button>
                <div id="email-results" class="hidden results"></div>
            </div>

            <div class="tool-section">
                <div class="tool-title">üîó URL Security Scanner</div>
                <div class="form-group">
                    <label for="url-input">Enter URL</label>
                    <input type="text" id="url-input" placeholder="e.g., https://example.com" />
                </div>
                <button class="btn" onclick="scanURL()">Scan URL</button>
                <div id="url-results" class="hidden results"></div>
            </div>
        </div>

        <!-- Threat Intel Tab -->
        <div id="threat" class="tabs-content">
            <div class="tool-section">
                <div class="tool-title">üîç ThreatMiner Search</div>
                <div class="form-group">
                    <label for="threat-query">Search Query</label>
                    <input type="text" id="threat-query" placeholder="File hash, domain, IP, or email" />
                </div>
                <div class="form-group">
                    <label for="threat-type">Search Type</label>
                    <select id="threat-type">
                        <option value="domain">Domain</option>
                        <option value="ip">IP Address</option>
                        <option value="hash">File Hash</option>
                        <option value="email">Email</option>
                    </select>
                </div>
                <button class="btn" onclick="searchThreatMiner()">Search</button>
                <div id="threat-results" class="hidden results"></div>
            </div>

            <div class="tool-section">
                <div class="tool-title">‚ö†Ô∏è URLhaus Malware Check</div>
                <div class="form-group">
                    <label for="urlhaus-input">Enter URL</label>
                    <input type="text" id="urlhaus-input" placeholder="https://example.com" />
                </div>
                <button class="btn" onclick="checkURLhaus()">Check in URLhaus</button>
                <div id="urlhaus-results" class="hidden results"></div>
            </div>
        </div>

        <!-- Learning Hub Tab -->
        <div id="learning" class="tabs-content">
            <div class="tool-section">
                <div class="tool-title">üìö Learning Hub & Resources</div>
                <p style="margin-bottom: 20px;">Access cybersecurity resources and educational materials:</p>
                <div class="grid-resource">
                    <div class="resource-card">
                        <h3>üîê NIST Framework</h3>
                        <p>National Institute of Standards and Technology cybersecurity guidance</p>
                    </div>
                    <div class="resource-card">
                        <h3>üìã ISO 27001/27002</h3>
                        <p>Information security management standards</p>
                    </div>
                    <div class="resource-card">
                        <h3>üõ°Ô∏è 3 Lines of Defense</h3>
                        <p>GRC framework for organizational risk management</p>
                    </div>
                    <div class="resource-card">
                        <h3>üîç CVE Database</h3>
                        <p>Common Vulnerabilities and Exposures (coming with NVD key)</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Settings Modal -->
    <div id="settingsModal" class="hidden" style="position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.7); display: none; justify-content: center; align-items: center; z-index: 1000;">
        <div style="background: var(--color-surface); padding: 30px; border-radius: 12px; border: 2px solid var(--color-teal); max-width: 500px; width: 90%;">
            <h2 style="color: var(--color-teal); margin-bottom: 20px;">API Key Settings</h2>
            
            <div class="form-group">
                <label for="abuseipdb-key">AbuseIPDB API Key</label>
                <input type="password" id="abuseipdb-key" placeholder="Your AbuseIPDB key" />
            </div>

            <div class="form-group">
                <label for="virustotal-key">VirusTotal API Key</label>
                <input type="password" id="virustotal-key" placeholder="Your VirusTotal key" />
            </div>

            <div class="form-group">
                <label for="nvd-key">NVD API Key (Optional)</label>
                <input type="password" id="nvd-key" placeholder="Your NVD key (when received)" />
            </div>

            <button class="btn" onclick="saveSettings()">Save Keys</button>
            <button class="btn" style="background: var(--color-surface); border: 2px solid var(--color-teal); color: var(--color-teal); margin-top: 10px;" onclick="closeSettings()">Close</button>

            <p style="margin-top: 15px; color: var(--color-text-secondary); font-size: 0.9em;">
                üí° Keys are stored in your browser (localStorage) and never sent to servers. They're only used for API calls.
            </p>
        </div>
    </div>

    <script>
        // Load keys from localStorage
        function loadKeys() {
            document.getElementById('abuseipdb-key').value = localStorage.getItem('abuseipdb-key') || '';
            document.getElementById('virustotal-key').value = localStorage.getItem('virustotal-key') || '';
            document.getElementById('nvd-key').value = localStorage.getItem('nvd-key') || '';
        }

        function saveSettings() {
            localStorage.setItem('abuseipdb-key', document.getElementById('abuseipdb-key').value);
            localStorage.setItem('virustotal-key', document.getElementById('virustotal-key').value);
            localStorage.setItem('nvd-key', document.getElementById('nvd-key').value);
            alert('‚úÖ API keys saved to your browser!');
            closeSettings();
        }

        function openSettings() {
            loadKeys();
            document.getElementById('settingsModal').style.display = 'flex';
            document.getElementById('settingsModal').classList.remove('hidden');
        }

        function closeSettings() {
            document.getElementById('settingsModal').style.display = 'none';
            document.getElementById('settingsModal').classList.add('hidden');
        }

        function getAPIKey(keyName) {
            return localStorage.getItem(keyName) || '';
        }

        function switchTab(event, tabName) {
            document.querySelectorAll('.tabs-content').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
            document.getElementById(tabName).classList.add('active');
            event.target.classList.add('active');
        }

        async function checkIP() {
            const ip = document.getElementById('ip-input').value.trim();
            const resultsDiv = document.getElementById('ip-results');

            if (!ip) {
                showResults(resultsDiv, 'Please enter an IP address', 'error');
                return;
            }

            showLoading(resultsDiv);

            try {
                const apiKey = getAPIKey('abuseipdb-key');
                if (!apiKey) {
                    showResults(resultsDiv, '‚öôÔ∏è API Key not configured. Please add it in Settings.', 'error');
                    return;
                }

                const response = await fetch('https://api.abuseipdb.com/api/v2/check?ipAddress=' + ip + '&maxAgeInDays=90', {
                    method: 'GET',
                    headers: {
                        'Accept': 'application/json',
                        'Key': apiKey
                    }
                });

                if (!response.ok) throw new Error('API Error: ' + response.status);
                const data = await response.json();

                let html = '';
                if (data.data) {
                    html = 'IP: ' + data.data.ipAddress + '<br><br>';
                    html += 'Abuse Score: ' + data.data.abuseConfidenceScore + '% ';
                    html += '<span class="badge ' + (data.data.abuseConfidenceScore > 50 ? 'malicious' : 'safe') + '">' + (data.data.abuseConfidenceScore > 50 ? 'High Risk' : 'Low Risk') + '</span><br>';
                    html += 'Reports: ' + data.data.totalReports + '<br>';
                    html += 'ISP: ' + (data.data.isp || 'N/A') + '<br>';
                    html += 'Domain: ' + (data.data.domain || 'N/A');
                }

                showResults(resultsDiv, html, 'success');
            } catch (error) {
                showResults(resultsDiv, 'Error: ' + error.message, 'error');
            }
        }

        async function checkEmail() {
            const email = document.getElementById('email-input').value.trim();
            const resultsDiv = document.getElementById('email-results');

            if (!email) {
                showResults(resultsDiv, 'Please enter an email address', 'error');
                return;
            }

            showLoading(resultsDiv);

            try {
                const response = await fetch('https://haveibeenpwned.com/api/v3/breachedaccount/' + encodeURIComponent(email) + '?truncateResponse=false', {
                    headers: { 'User-Agent': 'CyberSecCommand' }
                });

                if (response.status === 404) {
                    showResults(resultsDiv, '‚úÖ Good news! Email not found in any breaches.', 'success');
                    return;
                }

                if (!response.ok) throw new Error('API Error');

                const breaches = await response.json();
                let html = '‚ö†Ô∏è Found in ' + breaches.length + ' breach(es):<br><br>';
                
                breaches.forEach((breach, idx) => {
                    html += (idx + 1) + '. ' + breach.Name + '<br>';
                    html += '   Date: ' + breach.BreachDate + '<br>';
                    html += '   Records: ' + breach.PwnCount + '<br><br>';
                });

                showResults(resultsDiv, html, 'error');
            } catch (error) {
                showResults(resultsDiv, 'Error: ' + error.message, 'error');
            }
        }

        async function scanURL() {
            const url = document.getElementById('url-input').value.trim();
            const resultsDiv = document.getElementById('url-results');

            if (!url) {
                showResults(resultsDiv, 'Please enter a URL', 'error');
                return;
            }

            showLoading(resultsDiv);

            try {
                const apiKey = getAPIKey('virustotal-key');
                if (!apiKey) {
                    showResults(resultsDiv, '‚öôÔ∏è VirusTotal API Key not configured. Please add it in Settings.', 'error');
                    return;
                }

                const formData = new URLSearchParams();
                formData.append('url', url);

                const response = await fetch('https://www.virustotal.com/api/v3/urls', {
                    method: 'POST',
                    headers: { 'x-apikey': apiKey },
                    body: formData
                });

                if (!response.ok) throw new Error('API Error');
                const data = await response.json();

                let html = 'URL: ' + url + '<br><br>';
                if (data.data?.attributes?.last_analysis_stats) {
                    const stats = data.data.attributes.last_analysis_stats;
                    html += 'Malicious: ' + (stats.malicious || 0) + ' ';
                    html += '<span class="badge ' + (stats.malicious > 0 ? 'malicious' : 'safe') + '">' + (stats.malicious > 0 ? 'DETECTED' : 'SAFE') + '</span><br>';
                    html += 'Suspicious: ' + (stats.suspicious || 0) + '<br>';
                    html += 'Harmless: ' + (stats.harmless || 0) + '<br>';
                    html += 'Undetected: ' + (stats.undetected || 0);
                }

                showResults(resultsDiv, html, 'success');
            } catch (error) {
                showResults(resultsDiv, 'Error: ' + error.message, 'error');
            }
        }

        async function searchThreatMiner() {
            const query = document.getElementById('threat-query').value.trim();
            const type = document.getElementById('threat-type').value;
            const resultsDiv = document.getElementById('threat-results');

            if (!query) {
                showResults(resultsDiv, 'Please enter a search query', 'error');
                return;
            }

            showLoading(resultsDiv);

            try {
                const typeMap = { 'domain': 1, 'ip': 2, 'hash': 3, 'email': 4 };
                const response = await fetch('https://www.threatminer.org/api/v2/general.php?q=' + encodeURIComponent(query) + '&rt=' + typeMap[type]);

                if (!response.ok) throw new Error('API Error');
                const data = await response.json();

                let html = 'Query: ' + query + '<br>Type: ' + type + '<br><br>';
                
                if (data.results && data.results.length > 0) {
                    html += 'Results (' + data.results.length + '):<br>';
                    data.results.slice(0, 20).forEach((result, idx) => {
                        html += (idx + 1) + '. ' + (typeof result === 'string' ? result : JSON.stringify(result)) + '<br>';
                    });
                } else {
                    html += 'No results found';
                }

                showResults(resultsDiv, html, 'success');
            } catch (error) {
                showResults(resultsDiv, 'Error: ' + error.message, 'error');
            }
        }

        async function checkURLhaus() {
            const url = document.getElementById('urlhaus-input').value.trim();
            const resultsDiv = document.getElementById('urlhaus-results');

            if (!url) {
                showResults(resultsDiv, 'Please enter a URL', 'error');
                return;
            }

            showLoading(resultsDiv);

            try {
                const formData = new URLSearchParams();
                formData.append('url', url);

                const response = await fetch('https://urlhaus-api.abuse.ch/v1/url/', {
                    method: 'POST',
                    body: formData
                });

                if (!response.ok) throw new Error('API Error');
                const data = await response.json();

                let html = 'URL: ' + url + '<br><br>';

                if (data.query_status === 'no_results') {
                    html += 'Status: URL not found in database ';
                    html += '<span class="badge safe">SAFE</span>';
                } else if (data.query_status === 'ok' && data.results) {
                    const result = data.results[0];
                    html += 'Status: ' + result.status + ' ';
                    html += '<span class="badge malicious">MALWARE</span><br>';
                    html += 'Threat: ' + result.threat + '<br>';
                    html += 'Date Added: ' + result.date_added;
                } else {
                    html += 'URL check completed';
                }

                showResults(resultsDiv, html, data.query_status === 'no_results' ? 'success' : 'error');
            } catch (error) {
                showResults(resultsDiv, 'Error: ' + error.message, 'error');
            }
        }

        function showLoading(element) {
            element.classList.remove('hidden');
            element.innerHTML = '<div style="text-align: center;"><div class="loading"></div> Fetching data...</div>';
        }

        function showResults(element, content, type) {
            element.classList.remove('hidden', 'error', 'success');
            element.classList.add(type);
            element.innerHTML = content;
        }
    </script>
</body>
</html>