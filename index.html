<!DOCTYPE html>
<!-- saved from url=(0152)https://ppl-ai-code-interpreter-files.s3.amazonaws.com/web/direct-files/17362b1d5262ec5592104dc35d093716/b271443b-3728-4131-bf72-8b03928a3174/index.html -->
<html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CyberSec Command - All-in-One Cybersecurity Platform</title>
    <link rel="stylesheet" crossorigin="anonymous" href="./index_files/main.css"><script type="text/javascript" src="https://gc.kis.v2.scr.kaspersky-labs.com/FD126C42-EBFA-4E12-B309-BB3FDD723AC1/main.js?attr=iDRG17hodNswHDBjJ_isv2RY0BPjV33tgQMuB5oQ768iT2t04UTgOJ7B1MB2vbtmVYVmQk1CBZkllO66exGDGzZoI5T507NImv3_eDBKQtYol9Ez7zvAnOO_xXAAbgI2xzezy9jczI92VQcb3YM9NqTUHZuqqRp7gPMTJHXmMEMlt2GGXQ6MAuFsO5A0cogauD0wz96uCjEYuK3M--_vXAnS5gD3kuHMEWV-ZRhZJyPY4QQNUOgtLQIxftgBCHHYO5xyGrDGZEzpLUj0LL-IONQZ7H7StiaJAVjRO_gLpbBf5XxxvodliLjZcBAN3Tq99fAikTLPHZ6jnK6jBWGT-CoUjfA1stkTxK42Ntw85Nzpv116W_K5Rv7nN-UeGoJrOm6_Quza-NyT7Je29CnyohOfZ9ve11G-JK7K_RgyOIEEuVHsxEdjqR4fTHPr_v2gieOvfhZAXiGKFtsR_sfQNKaMFE0T2OT8PNu8KlU9gXb4wA9KucTsOmtVoMVrXn65cIaBMJsUbvFFc-z6BIhkjS-sPSPcb6QkmV2obMBHHMHSjRU0XbPVTm4NruKxyaLpQq_lcOsxTSxI6STkLZ-_h6hMvOwSw5ahTAtbUfv-X-JuSirCXL-ednyYOS095nbGSl9zUVCjo1BXfwAa6xCbYu8C1ZvcMJd8LP8EX9fJgHXdHUA-ztCRfvpdhj173o9Rms8CjrOIdDtHI4qY8ZrBsU62kZovyR4VDpn39IjbT7R23s02ytNvjXq5pyoOUC4nv3FYXZHGG_IaB7e07nULMiwdpXNXbeOBZp5UpsxXf-d0bV2Q7xBfgDRQlUAb2w5IY0XFCYxaXg_ygaIHA9i-5ZLHJ_6gVrNdTavGR67Th_xgRf5T7T13BGZ-s_hXnvA1iXRl8456gkxq3181_z-UWTUuhh44TUNy5ajIzQBzHpFb7A18tqWwna67nqKKCQ0kJpcSsO9hnHF_wiTBI9-dvOxbrqQq0f65_RxAmf207ttRecWFm8R5KDrlEJSo5Cdc-FT_XjmGYwqNpHMw6VUma7H6q7adtZ_n7AW9vZGAsBfh3tPkgthhn85hyHkPVKd2cC9v1dv66aCQwy8bmBIKoh1Ya-4cGvvT3v-C7_3NjnkRaBwa6djgEmiUEIOsElRLHHQdvVkJ52F1DU4RLBOzvP1gFbDOYTf0uOS75VeKYbSm9wnwlGhFcJfNwF8A1HXoRj0CzgXZ4Xxj8dsOzSjOLmKEuVNF8V6TZeg6m2G3fp-yHI09V8-5zCRbglXNSmJxuvItNJxruX2xTLP-LKUvKXnLL4-AjWJKT27TEspANDPXXldvoEI5WGCU_-LFc9HFySSZDOJ2-DRa_yUPx7FNubR1ApJSRmk7AJlB9h7lHay2GLdPFbed4uZO6i8GxjM6erfPCRpUdmGxDmr9FbCwQcWQujAZUnUSPVR_TXCxiC-wwwlDzoV9mA6Khg5eBblvOCrYWKezV8-gTxBZ1cMbkeM5qzUw09-CpkQ9y72sXS-cK2ydwlQAMGB7bsezU0UeRPNDO4z8oWkMdnxO0zl-kiNUcyZ9bB6BC_yiHmKYVDtdbgEREmKF3NxG1PgQJl6LcsEAFey4k5Vt-ElDVaTH7sbYdk4uKs9m8qrtRcwHE1FoqoWqop3HQQms_mb2i_AcY5Vt4CnY4kPXsCTzehyO6YyO5Q16yx31gR43GUuerUD9L7dbtawHU3cZc94m5zGqXSy1W8aOUzivWpOQV0SNZ3WLJ_gHMbKhkqiKDM4qMV-J6fwnMXVprKaitYy8l4TOzULGTbBySx0d7H9pVRMqzzLslQzwg6rOji0PkPTJEmebdGtnjZ8OYcgM9sOW91Hpe4A6Ki47_BwQshO_Bo57D_B7dIOi7lGfUC2PSkAHWbkdZ43E6uV8s8JTjQxQCnePxpw7rFMFd3D0Q5bBjXopgZT6nXMfKaV255KkNJM64aWe7YkwAfj87GSztrx8KmjIXgdxr5pMXagVjg6zMuaXRrnfwqBRyqeAVGlxtJi29wiccSwOfGt66wkScBmc2TBrwd6B5p_q7lTCCD0d2vwel9_eAGrFChqKJd61EU6bNPUbKPe6Vo4pWPoBxuJeni9SSAwB_yvjlO1qai6Kdm8PPteQ_0k8vqXjEvJdMSScEFFf8wDQdNXtr-IDbPEIOiLrmdGQcNXshHjbRbGDbgeERwlF13zIls75-6yPSzAlolefXR5SpUvwr75pfPfAgTVHyuGfCuapifrj8EDh4kbc7wYlKiwLBwkkT7kvGk_6gYDSajeajm6UKbbSA8WkQ5qa" charset="UTF-8"></script><link rel="stylesheet" crossorigin="anonymous" href="https://gc.kis.v2.scr.kaspersky-labs.com/E3E8934C-235A-4B0E-825A-35A08381A191/abn/main.css?attr=aHR0cHM6Ly9wcGwtYWktY29kZS1pbnRlcnByZXRlci1maWxlcy5zMy5hbWF6b25hd3MuY29tL3dlYi9kaXJlY3QtZmlsZXMvMjBmODFlOTViZTY2OWU0ZTI0YzhjZGU1NzBmNWYwYjkvZGEwMjFhMzctNjkyMS00MzFlLWI4NjgtOTNhMzBmN2FhNzQ1L2I1MTY1OTQ3Lmh0bWw_cmVzcG9uc2UtY29udGVudC1kaXNwb3NpdGlvbj1hdHRhY2htZW50JTNiJTIwZmlsZW5hbWUlM2RpbmRleF91cGRhdGVkLmh0bWwlM2IlMjBmaWxlbmFtZSUyYSUzZFVURi04JTI3JTI3aW5kZXhfdXBkYXRlZC5odG1sJkFXU0FjY2Vzc0tleUlkPUFTSUEyRjNFTUVZRTQ1SDZKSEtQJlNpZ25hdHVyZT1SSUtramd6NHV5aGhzdXpPeXRaOW5YTzYzbTQlM2QmeC1hbXotc2VjdXJpdHktdG9rZW49SVFvSmIzSnBaMmx1WDJWakVDSWFDWFZ6TFdWaGMzUXRNU0pJTUVZQ0lRREZ0aEs1bkxacmJ0ck5KenVPSzI2enJDWUJVMWhFc0xLS1hTZnRHdzIxVVFJaEFPSFA4JTJiS1l1MThNUEdDdUE3WThjNFdqak8wTzZQYW9DczA2WURZUFBmWjVLdndFQ09yJTJmJTJmJTJmJTJmJTJmJTJmJTJmJTJmJTJmJTJmd0VRQVJvTU5qazVOelV6TXpBNU56QTFJZ3lKdnpUckpHdEpyMFRhR3ljcTBBUkpMaXp4WUw0dXN5QkZNR2ZkTlN6T3dYZ2J5T2xBY09ob2QwJTJmd1hkb3FkRnBRVTRzdDVpM1NGTkhINVY3YiUyZklUS005aDFBcWVZOGV3amxSY0FkQ1RNbCUyZmF5OTIlMmZ0ejZWVnVhcTBrVkYlMmZoTEJwYU9vV1BvdG5oZ3RHbHE1a1AxVXpPJTJmU1N3eEZ0SEY2dWhwcFVvT0t0TDhuVkJkMDB2YmJlU1QlMmJRTnBxdUszUHAzV0xwMDczSTlFWEw3Y1JQQVNZdkxSYSUyZk0lMmIlMmZEVFdBSDdDZzhQNmM2WkZwdEJCbSUyZktxUlV1Rk55JTJmNTN6UDlLc3ZqSk81a1NhWHowcXNjaWlrUWJ0cCUyZjg4VGtJVWc4b0dKVEllRlM5Szg5WnQwcWtwb1FETDJiWDFrTW5TTThhczR2YSUyYkhjY092VFdlMHpRNyUyZmYlMmZJM0dCdEhjUlI4JTJiWnpqclhUOWtVUDAwV1RaJTJmJTJmbWhtRFVycE1Ma1N6NEFIMVIwRlB4a05zakMzMGYlMmJLWGklMmZ4eFNnNzVpVUhrOGJaanlQeFp0NmRzd1JtaEluR0RGcFo2djJBS2JKMnpsWUlLbjFLTTBXcENqbSUyZm0waWwlMmY0dm5HQXIlMmY1OGloeEVScVRPcmR2RUNGWkhZYndCUWRJdnBYT2c0SXcxcjZvQlVaV25JNDZBVW04TUgzdFhBanBGaVBiViUyYmwyNEx3SEZ0a2ZJM1lJaFRxVVBTUDVxRkRwR1h3Sk5jUllqY3dNTGdYUFZ2eWwlMmJQcSUyZkM4Wjg0OHp0RHU0N2licEdNdWNTc21UJTJicFBqMCUyZmczVmRyV2QxNVhZZG5mWk9pOXphbVBVc3Z2M3dqbSUyZmwwYlhPQXNzbnBkaFFSVTFBUmF3JTJiUUFPWFZrNFZyZzlsWVZQdFExS2g0aG83Q0QlMmJhNGZMNEtycTJVVW1KYzJJVkQwNER2UTFubW9vTDYxSkdpZWVqaW1tRWtrOW1Qc3piJTJmSEt0RTVpOU5ieTBsUWJMUWxNd3ZtSGtKVXVITWE4NXR2Tjg4MlBPbllYcm96dyUyYlVIWGpIS2pzcnBQR0ZyckpKaTklMmZNTkN6b3NvR09wY0J1b3VsTzcyN1hKWWZjUXlmMERCaWt1VEdybDQlMmZpa2VnSVRQVDFBYXU2YlJUWklIVlVVVW8lMmJGcGpXb2dpU0NNZVozRWZhJTJmMmNUVjVDZGw0WGFOSjN1OWNCZER1d0RCMU80aHhRNWhnclRzem9LeHl5TW96eUNOJTJmbURuTnk1M1dmc1pWa0xTY0xpV3A3MjRJJTJiSENDaXlzcjJnQ0FEMkRXWlJNRmZKenk3bTV1TFA4cWl6UWclMmZKYkxwc2hKTjdSMDU5VkQzclRMMzl3JTNkJTNkJkV4cGlyZXM9MTc2NjM2NzQxMA"/><style>
        :root {
  /* Primitive Color Tokens */
  --color-white: rgba(255, 255, 255, 1);
  --color-black: rgba(0, 0, 0, 1);
  --color-cream-50: rgba(252, 252, 249, 1);
  --color-cream-100: rgba(255, 255, 253, 1);
  --color-gray-200: rgba(245, 245, 245, 1);
  --color-gray-300: rgba(167, 169, 169, 1);
  --color-gray-400: rgba(119, 124, 124, 1);
  --color-slate-500: rgba(98, 108, 113, 1);
  --color-brown-600: rgba(94, 82, 64, 1);
  --color-charcoal-700: rgba(31, 33, 33, 1);
  --color-charcoal-800: rgba(38, 40, 40, 1);
  --color-slate-900: rgba(19, 52, 59, 1);
  --color-teal-300: rgba(50, 184, 198, 1);
  --color-teal-400: rgba(45, 166, 178, 1);
  --color-teal-500: rgba(33, 128, 141, 1);
  --color-teal-600: rgba(29, 116, 128, 1);
  --color-teal-700: rgba(26, 104, 115, 1);
  --color-teal-800: rgba(41, 150, 161, 1);
  --color-red-400: rgba(255, 84, 89, 1);
  --color-red-500: rgba(192, 21, 47, 1);
  --color-orange-400: rgba(230, 129, 97, 1);
  --color-orange-500: rgba(168, 75, 47, 1);

  /* Custom Premium Colors */
  --color-navy: #07090f;
  --color-teal-accent: #22d3ee;
  --color-teal-accent-dark: #8b5cf6;
  --color-gold: #ffb020;
  --color-blue-badge: #4a90e2;
  --color-purple-badge: #9b59b6;
  --color-green-badge: #27ae60;
  --color-orange-badge: #e67e22;
  --color-pink-badge: #e91e63;
  --color-cyan-badge: #ff4444;

  /* Typography */
  --font-family-base: "FKGroteskNeue", "Geist", "Inter", -apple-system,
    BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
  --font-family-mono: "Berkeley Mono", ui-monospace, SFMono-Regular, Menlo,
    Monaco, Consolas, monospace;
  --font-size-xs: 11px;
  --font-size-sm: 12px;
  --font-size-base: 14px;
  --font-size-md: 14px;
  --font-size-lg: 16px;
  --font-size-xl: 18px;
  --font-size-2xl: 20px;
  --font-size-3xl: 24px;
  --font-size-4xl: 30px;
  --font-weight-normal: 400;
  --font-weight-medium: 500;
  --font-weight-semibold: 550;
  --font-weight-bold: 600;
  --line-height-tight: 1.2;
  --line-height-normal: 1.5;
  --letter-spacing-tight: -0.01em;

  /* Spacing */
  --space-0: 0;
  --space-1: 1px;
  --space-2: 2px;
  --space-4: 4px;
  --space-6: 6px;
  --space-8: 8px;
  --space-10: 10px;
  --space-12: 12px;
  --space-16: 16px;
  --space-20: 20px;
  --space-24: 24px;
  --space-32: 32px;

  /* Border Radius */
  --radius-sm: 6px;
  --radius-base: 8px;
  --radius-md: 10px;
  --radius-lg: 12px;
  --radius-xl: 16px;
  --radius-full: 9999px;

  /* Shadows */
  --shadow-xs: 0 1px 2px rgba(0, 0, 0, 0.02);
  --shadow-sm: 0 1px 3px rgba(0, 0, 0, 0.04), 0 1px 2px rgba(0, 0, 0, 0.02);
  --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.04),
    0 2px 4px -1px rgba(0, 0, 0, 0.02);
  --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.04),
    0 4px 6px -2px rgba(0, 0, 0, 0.02);
  --shadow-premium: 0 18px 50px rgba(0,0,0,.55);
  --shadow-glow: 0 0 0 3px rgba(34,211,238,.12), 0 18px 60px rgba(139,92,246,.12);

  /* Animation */
  --duration-fast: 150ms;
  --duration-normal: 250ms;
  --duration-slow: 400ms;
  --ease-standard: cubic-bezier(0.16, 1, 0.3, 1);
}

@font-face {
  font-family: 'FKGroteskNeue';
  src: url('https://r2cdn.perplexity.ai/fonts/FKGroteskNeue.woff2')
    format('woff2');
}

* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

body{
    font-family: var(--font-family-base);
    min-height: 100vh;
    color: var(--color-white);
    overflow-x: hidden;
    -webkit-font-smoothing: antialiased;

    background:
      radial-gradient(900px 500px at 18% -10%, rgba(139,92,246,.18), transparent 60%),
      radial-gradient(900px 500px at 82% 0%, rgba(34,211,238,.14), transparent 55%),
      radial-gradient(700px 450px at 50% 110%, rgba(255,45,85,.08), transparent 55%),
      linear-gradient(180deg, #0a0f1c 0%, #07090f 65%, #06070b 100%);
}

.app-container {
    min-height: 100vh;
    display: flex;
    flex-direction: column;
}

/* Header */
.header {
    background: rgba(15, 20, 25, 0.9);
    backdrop-filter: blur(20px);
    padding: var(--space-20) var(--space-16);
    text-align: center;
    border-bottom: 1px solid rgba(34,211,238,.18);
    position: sticky;
    top: 0;
    z-index: 100;
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
}

.header h1 {
    font-size: var(--font-size-3xl);
    font-weight: var(--font-weight-bold);
    background: linear-gradient(135deg, var(--color-teal-accent-dark) 0%, var(--color-teal-accent) 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    letter-spacing: var(--letter-spacing-tight);
    margin-bottom: var(--space-4);
}

.header p {
    font-size: var(--font-size-sm);
    color: rgba(255, 255, 255, 0.7);
    font-weight: var(--font-weight-normal);
}

/* Navigation Tabs */
.nav-tabs {
    display: flex;
    background: rgba(15, 20, 25, 0.8);
    backdrop-filter: blur(20px);
    padding: var(--space-8);
    gap: var(--space-8);
    overflow-x: auto;
    border-bottom: 1px solid rgba(34,211,238,0.1);
    position: sticky;
    top: 88px;
    z-index: 99;
    scrollbar-width: none;
}

.nav-tabs::-webkit-scrollbar {
    display: none;
}

.tab-btn{
    flex: 1;
    min-width: 120px;
    padding: var(--space-12) var(--space-16);
    background: rgba(255,255,255,.04);
    border: 1px solid rgba(255,255,255,.10);
    border-radius: var(--radius-lg);
    color: var(--color-white);
    font-size: var(--font-size-sm);
    font-weight: var(--font-weight-medium);
    cursor: pointer;
    transition: all var(--duration-normal) var(--ease-standard);
    display: flex;
    align-items: center;
    justify-content: center;
    gap: var(--space-8);
}

.clipboard-nav-btn {
    flex: 1;
    min-width: 120px;
    padding: var(--space-12) var(--space-16);
    background: rgba(255,255,255,.04);
    border: 1px solid rgba(255,255,255,.10);
    border-radius: var(--radius-lg);
    color: var(--color-white);
    font-size: var(--font-size-sm);
    font-weight: var(--font-weight-medium);
    cursor: pointer;
    transition: all var(--duration-normal) var(--ease-standard);
    display: flex;
    align-items: center;
    justify-content: center;
    gap: var(--space-8);
}

.clipboard-nav-btn:hover {
    background: rgba(255,255,255,0.1);
    border-color: rgba(255,255,255,0.2);
    transform: translateY(-1px);
}

.tab-btn:hover{
    background: rgba(34,211,238,.10);
    border-color: rgba(34,211,238,.25);
    transform: translateY(-1px);
    box-shadow: 0 10px 26px rgba(34,211,238,.10);
}

.tab-btn.active{
    background: linear-gradient(135deg, rgba(139,92,246,.22) 0%, rgba(34,211,238,.12) 100%);
    border-color: rgba(34,211,238,.28);
    box-shadow: var(--shadow-glow);
    transform: translateY(-1px);
}

/* Main Content - MOBILE OPTIMIZED */
.app-shell {
    flex: 1;
    width: 100%;
    max-width: 1200px;
    margin: 0 auto;
}

.main-content {
    flex: 1;
    padding: 12px;
    width: 100%;
    max-width: none;
    margin: 0;
}

@media (min-width: 768px) {
    .main-content {
        padding: 24px;
    }
}

@media (min-width: 1200px) {
    .app-shell {
        max-width: 1380px;
    }

    .main-content {
        padding: 24px;
    }

    .app-shell.has-clipboard {
        max-width: 1560px;
        padding: 0 24px;
        display: grid;
        grid-template-columns: minmax(0, 1fr) 360px;
        gap: 18px;
        align-items: start;
    }

    .app-shell.has-clipboard .main-content {
        padding: 24px 0;
    }
}

@media (min-width: 1600px) {
    .app-shell {
        max-width: 1560px;
    }
}

.tab-content,
.main-panel {
    display: none;
    animation: fadeIn var(--duration-slow) var(--ease-standard);
}

.tab-content.active,
.main-panel.active {
    display: block;
}

@keyframes fadeIn {
    from {
        opacity: 0;
        transform: translateY(20px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

/* Premium Card */
.premium-card{
    position: relative;
    overflow: hidden;
    background:
      linear-gradient(180deg, rgba(255,255,255,.07), rgba(255,255,255,0) 40%),
      radial-gradient(800px 260px at 30% 0%, rgba(255,255,255,.08), transparent 60%),
      rgba(255,255,255,.03);
    backdrop-filter: blur(18px);
    border: 1px solid rgba(255,255,255,.10);
    border-radius: var(--radius-xl);
    padding: var(--space-24);
    margin-bottom: var(--space-20);
    box-shadow: var(--shadow-premium);
    transition: all var(--duration-normal) var(--ease-standard);
}

.premium-card::before{
    content:"";
    position:absolute;
    inset:-2px;
    background: radial-gradient(520px 180px at 20% 0%, rgba(34,211,238,.12), transparent 55%);
    opacity:.55;
    pointer-events:none;
}

.premium-card:hover{
    transform: translateY(-2px);
    border-color: rgba(34,211,238,.22);
    box-shadow: 0 22px 60px rgba(0,0,0,.60);
}

/* News Grid - MOBILE OPTIMIZED */
.news-grid {
    display: grid;
    grid-template-columns: 1fr;
    gap: 12px;
    margin-bottom: var(--space-24);
}

@media (min-width: 768px) {
    .news-grid {
        grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
        gap: var(--space-20);
    }
}

.news-card {
    background: rgba(255, 255, 255, 0.08);
    backdrop-filter: blur(20px);
    border: 1px solid rgba(255, 255, 255, 0.1);
    border-radius: var(--radius-lg);
    padding: var(--space-20);
    transition: all var(--duration-normal) var(--ease-standard);
    cursor: pointer;
    position: relative;
    overflow: hidden;
}

.news-card::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    width: 4px;
    height: 100%;
    background: linear-gradient(180deg, var(--color-teal-accent) 0%, var(--color-gold) 100%);
    opacity: 0;
    transition: opacity var(--duration-normal) var(--ease-standard);
}

.news-card:hover::before {
    opacity: 1;
}

.news-card:hover {
    transform: translateY(-6px);
    box-shadow: var(--shadow-premium), var(--shadow-glow);
    border-color: rgba(34,211,238,0.4);
}

.news-badge {
    display: inline-block;
    padding: var(--space-4) var(--space-12);
    border-radius: var(--radius-full);
    font-size: var(--font-size-xs);
    font-weight: var(--font-weight-semibold);
    margin-bottom: var(--space-12);
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.badge-blue { background: rgba(74, 144, 226, 0.2); color: #6bb6ff; border: 1px solid rgba(74, 144, 226, 0.4); }
.badge-purple { background: rgba(155, 89, 182, 0.2); color: #c39bd3; border: 1px solid rgba(155, 89, 182, 0.4); }
.badge-green { background: rgba(39, 174, 96, 0.2); color: #5dde8c; border: 1px solid rgba(39, 174, 96, 0.4); }
.badge-orange { background: rgba(230, 126, 34, 0.2); color: #f39c12; border: 1px solid rgba(230, 126, 34, 0.4); }
.badge-pink { background: rgba(233, 30, 99, 0.2); color: #ff6b9d; border: 1px solid rgba(233, 30, 99, 0.4); }
.badge-cyan { background: rgba(255, 68, 68, 0.1); color: #ff4444; border: 1px solid rgba(255, 68, 68, 0.4); }

.news-card h3 {
    font-size: var(--font-size-lg);
    font-weight: var(--font-weight-semibold);
    margin-bottom: var(--space-8);
    line-height: var(--line-height-tight);
    color: var(--color-white);
}

.news-card p {
    font-size: var(--font-size-sm);
    color: rgba(255, 255, 255, 0.7);
    line-height: 1.6;
    margin-bottom: var(--space-12);
}

.news-meta {
    display: flex;
    justify-content: space-between;
    align-items: center;
    font-size: var(--font-size-xs);
    color: rgba(255, 255, 255, 0.5);
    margin-top: var(--space-16);
    padding-top: var(--space-12);
    border-top: 1px solid rgba(255, 255, 255, 0.1);
}

.news-card--intel {
    display: flex;
    flex-direction: column;
    gap: var(--space-8);
}

.news-card.is-new {
    border-color: rgba(255, 176, 32, 0.5);
    box-shadow: 0 0 0 1px rgba(255, 176, 32, 0.25), var(--shadow-md);
}

.news-alert-pill {
    display: inline-flex;
    align-items: center;
    gap: var(--space-4);
    font-size: var(--font-size-xs);
    text-transform: uppercase;
    letter-spacing: 0.6px;
    padding: 4px 10px;
    border-radius: var(--radius-full);
    background: rgba(255, 176, 32, 0.15);
    color: #ffb020;
    border: 1px solid rgba(255, 176, 32, 0.4);
}

.news-severity {
    display: inline-flex;
    align-items: center;
    padding: 4px 10px;
    border-radius: var(--radius-full);
    font-size: var(--font-size-xs);
    font-weight: 600;
    letter-spacing: 0.4px;
}

.news-severity.critical { background: rgba(255, 0, 64, 0.18); color: #ff4d7d; border: 1px solid rgba(255, 0, 64, 0.45); }
.news-severity.high { background: rgba(255, 107, 0, 0.18); color: #ff9a57; border: 1px solid rgba(255, 107, 0, 0.45); }
.news-severity.medium { background: rgba(255, 215, 0, 0.18); color: #ffd86b; border: 1px solid rgba(255, 215, 0, 0.45); }
.news-severity.low { background: rgba(34, 211, 238, 0.15); color: #6fe8ff; border: 1px solid rgba(34, 211, 238, 0.4); }

.news-meta-row {
    display: flex;
    flex-wrap: wrap;
    gap: var(--space-8);
    align-items: center;
    font-size: var(--font-size-xs);
    color: rgba(255, 255, 255, 0.6);
}

.news-source-pill {
    padding: 4px 10px;
    border-radius: var(--radius-full);
    font-size: var(--font-size-xs);
    background: rgba(34, 211, 238, 0.12);
    border: 1px solid rgba(34, 211, 238, 0.3);
    color: rgba(255, 255, 255, 0.9);
}

.news-actions {
    display: flex;
    flex-wrap: wrap;
    gap: var(--space-8);
    margin-top: var(--space-8);
}

.news-cve-chips {
    display: flex;
    flex-wrap: wrap;
    gap: var(--space-6);
}

.news-cve-chips .extra-cve-chips {
    display: none;
    gap: var(--space-6);
    flex-wrap: wrap;
}

.news-cve-chips.expanded .extra-cve-chips {
    display: flex;
}

.news-cve-chip {
    border: 1px solid rgba(139, 92, 246, 0.35);
    background: rgba(139, 92, 246, 0.12);
    color: #c4b5fd;
    border-radius: var(--radius-full);
    padding: 4px 10px;
    font-size: var(--font-size-xs);
    cursor: pointer;
}

.news-cve-chip:hover {
    border-color: rgba(139, 92, 246, 0.7);
    color: var(--color-white);
}

/* Document Analyzer Enhancements */
.doc-accordion {
    border: 1px solid rgba(34,211,238,0.16);
    border-radius: var(--radius-md);
    background: rgba(10, 15, 20, 0.55);
    overflow: hidden;
    margin-top: 16px;
}

.doc-accordion:first-of-type {
    margin-top: 0;
}

.doc-accordion-toggle {
    width: 100%;
    background: rgba(34,211,238,0.08);
    border: none;
    color: var(--color-white);
    padding: 14px 16px;
    font-size: var(--font-size-lg);
    font-weight: var(--font-weight-semibold);
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 12px;
    cursor: pointer;
}

.doc-accordion-toggle:hover {
    background: rgba(34,211,238,0.16);
}

.doc-accordion-toggle span:last-child {
    font-size: 16px;
    transition: transform var(--duration-fast) var(--ease-standard);
}

.doc-accordion-toggle[aria-expanded="false"] span:last-child {
    transform: rotate(-90deg);
}

.doc-accordion-body {
    padding: 16px;
    border-top: 1px solid rgba(255,255,255,0.08);
}

.doc-accordion-body.is-collapsed {
    display: none;
}

.artifact-toolbar {
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 12px;
    flex-wrap: wrap;
    margin-bottom: 12px;
}

.artifact-groups {
    display: flex;
    flex-direction: column;
    gap: 14px;
}

.artifact-group-title {
    font-size: 12px;
    text-transform: uppercase;
    letter-spacing: 0.08em;
    color: rgba(255,255,255,0.6);
    margin-bottom: 8px;
}

.artifact-chips {
    display: flex;
    flex-wrap: wrap;
    gap: 8px;
}

.artifact-chip {
    padding: 6px 10px;
    border-radius: 999px;
    border: 1px solid rgba(34,211,238,0.35);
    background: rgba(34,211,238,0.1);
    color: #8be9ff;
    font-size: 12px;
    cursor: pointer;
    transition: all var(--duration-fast) var(--ease-standard);
}

.artifact-chip:hover {
    background: rgba(139,92,246,0.18);
    border-color: rgba(139,92,246,0.4);
    transform: translateY(-1px);
}

.artifact-chip span {
    opacity: 0.7;
    margin-left: 6px;
    font-size: 11px;
}

.artifact-empty {
    font-size: 13px;
    color: rgba(255,255,255,0.6);
}

#document-export-buttons {
    flex-wrap: wrap;
}

.news-cluster {
    margin-top: var(--space-8);
    padding: var(--space-10);
    border-radius: var(--radius-md);
    background: rgba(255, 255, 255, 0.04);
    border: 1px dashed rgba(255, 255, 255, 0.15);
}

.news-cluster summary {
    cursor: pointer;
    font-size: var(--font-size-xs);
    color: rgba(255, 255, 255, 0.7);
}

.news-cluster-list {
    margin-top: var(--space-8);
    display: grid;
    gap: var(--space-6);
    font-size: var(--font-size-xs);
}

.news-cluster-item a {
    color: #6fe8ff;
    text-decoration: none;
}

.news-brief {
    padding: var(--space-20);
}

.news-brief-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    flex-wrap: wrap;
    gap: var(--space-12);
    margin-bottom: var(--space-16);
}

.news-brief-grid {
    display: grid;
    gap: var(--space-16);
}

@media (min-width: 900px) {
    .news-brief-grid {
        grid-template-columns: repeat(3, 1fr);
    }
}

.news-brief-section {
    background: rgba(255, 255, 255, 0.04);
    border-radius: var(--radius-md);
    padding: var(--space-16);
    border: 1px solid rgba(255, 255, 255, 0.08);
}

.news-brief-section h4 {
    font-size: var(--font-size-sm);
    margin-bottom: var(--space-8);
    color: rgba(255, 255, 255, 0.8);
    text-transform: uppercase;
    letter-spacing: 0.6px;
}

.news-brief-item {
    display: flex;
    justify-content: space-between;
    gap: var(--space-8);
    margin-bottom: var(--space-10);
    font-size: var(--font-size-sm);
}

.news-brief-item:last-child {
    margin-bottom: 0;
}

.news-brief-item a {
    color: var(--color-white);
    text-decoration: none;
}

.news-brief-meta {
    font-size: var(--font-size-xs);
    color: rgba(255, 255, 255, 0.6);
}

.news-controls {
    display: flex;
    flex-direction: column;
    gap: var(--space-12);
}

.news-category-tabs {
    display: flex;
    flex-wrap: wrap;
    gap: var(--space-8);
}

.news-category-btn {
    background: rgba(255, 255, 255, 0.08);
    border: 1px solid rgba(255, 255, 255, 0.15);
    border-radius: var(--radius-full);
    padding: 6px 14px;
    font-size: var(--font-size-xs);
    color: rgba(255, 255, 255, 0.8);
    cursor: pointer;
    transition: all var(--duration-fast) var(--ease-standard);
}

.news-category-btn.active,
.news-category-btn:hover {
    border-color: rgba(34, 211, 238, 0.6);
    color: var(--color-white);
    box-shadow: 0 0 0 2px rgba(34, 211, 238, 0.15);
}

.news-filter-row {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
    gap: var(--space-12);
    align-items: center;
}

.news-search-input {
    padding: 10px 12px;
    border-radius: var(--radius-md);
    background: rgba(255, 255, 255, 0.08);
    border: 1px solid rgba(255, 255, 255, 0.18);
    color: var(--color-white);
}

.news-feed-meta {
    font-size: var(--font-size-xs);
    color: rgba(255, 255, 255, 0.6);
    margin-bottom: var(--space-8);
}

.news-empty {
    text-align: center;
    padding: 40px;
    color: rgba(255, 255, 255, 0.6);
}

/* Form Elements */
.form-group {
    margin-bottom: var(--space-24);
    position: relative;
}

.form-label {
    display: block;
    font-size: var(--font-size-sm);
    font-weight: var(--font-weight-medium);
    margin-bottom: var(--space-8);
    color: rgba(255, 255, 255, 0.9);
}

.form-input,
.form-textarea,
.form-select {
    width: 100%;
    padding: var(--space-16);
    background: rgba(255, 255, 255, 0.08);
    border: 1px solid rgba(255, 255, 255, 0.2);
    border-radius: var(--radius-md);
    color: var(--color-white);
    font-size: var(--font-size-base);
    font-family: var(--font-family-base);
    transition: all var(--duration-normal) var(--ease-standard);
}

.form-input::placeholder,
.form-textarea::placeholder {
    color: rgba(255, 255, 255, 0.4);
}

.form-input:focus,
.form-textarea:focus,
.form-select:focus {
    outline: none;
    border-color: var(--color-teal-accent);
    background: rgba(255, 255, 255, 0.12);
    box-shadow: 0 0 0 3px rgba(34,211,238,0.1);
}

.form-textarea {
    min-height: 120px;
    resize: vertical;
}

.form-select {
    cursor: pointer;
    appearance: none;
    background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='%2300d4ff' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='6 9 12 15 18 9'%3E%3C/polyline%3E%3C/svg%3E");
    background-repeat: no-repeat;
    background-position: right 12px center;
    background-size: 16px;
    padding-right: 40px;
}

.form-select option {
    background: #0f1419;
    color: var(--color-white);
}

/* Buttons */
.btn {
    padding: var(--space-16) var(--space-32);
    border: none;
    border-radius: var(--radius-md);
    font-size: var(--font-size-base);
    font-weight: var(--font-weight-semibold);
    cursor: pointer;
    transition: all var(--duration-normal) var(--ease-standard);
    display: inline-flex;
    align-items: center;
    justify-content: center;
    gap: var(--space-8);
    position: relative;
    overflow: hidden;
}

.btn-primary{
    background: linear-gradient(135deg, rgba(139,92,246,.35) 0%, rgba(34,211,238,.22) 100%);
    color: rgba(255,255,255,.95);
    border: 1px solid rgba(34,211,238,.25);
    box-shadow: 0 14px 36px rgba(34,211,238,.12);
}

.btn-primary:hover{
    transform: translateY(-1px);
    box-shadow: 0 18px 46px rgba(34,211,238,.16);
}

.btn-primary:active {
    transform: translateY(0);
}

.btn-secondary {
    background: rgba(255, 255, 255, 0.1);
    color: var(--color-white);
    border: 1px solid rgba(255, 255, 255, 0.2);
}

.btn-secondary:hover {
    background: rgba(255, 255, 255, 0.15);
    border-color: var(--color-teal-accent);
    transform: translateY(-2px);
}

.btn-full {
    width: 100%;
}

/* Loading Spinner */
.spinner {
    display: inline-block;
    width: 16px;
    height: 16px;
    border: 2px solid rgba(255, 255, 255, 0.3);
    border-top-color: var(--color-white);
    border-radius: 50%;
    animation: spin 0.6s linear infinite;
}

@keyframes spin {
    to { transform: rotate(360deg); }
}

.btn.loading {
    pointer-events: none;
    opacity: 0.7;
}

/* Results Card */
.results-card {
    background: rgba(255, 255, 255, 0.08);
    backdrop-filter: blur(20px);
    border-left: 4px solid var(--color-teal-accent);
    border-radius: var(--radius-lg);
    padding: var(--space-24);
    margin-top: var(--space-24);
    animation: slideUp var(--duration-slow) var(--ease-standard);
}

@keyframes slideUp {
    from {
        opacity: 0;
        transform: translateY(30px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

.results-card h3 {
    font-size: var(--font-size-xl);
    margin-bottom: var(--space-16);
    color: var(--color-teal-accent);
}

.results-card p {
    line-height: 1.8;
    color: rgba(255, 255, 255, 0.85);
    margin-bottom: var(--space-12);
}

/* Tips Sidebar */
.tips-container {
    background: rgba(255, 165, 0, 0.1);
    border: 1px solid rgba(255, 165, 0, 0.3);
    border-radius: var(--radius-lg);
    padding: var(--space-20);
    margin-top: var(--space-24);
}

.tips-container h4 {
    color: var(--color-gold);
    font-size: var(--font-size-base);
    margin-bottom: var(--space-16);
    display: flex;
    align-items: center;
    gap: var(--space-8);
}

.tips-list {
    list-style: none;
}

.tips-list li {
    padding: var(--space-8) 0;
    font-size: var(--font-size-sm);
    color: rgba(255, 255, 255, 0.8);
    display: flex;
    align-items: center;
    gap: var(--space-8);
}

.tips-list li::before {
    content: 'âœ¦';
    color: var(--color-gold);
    font-size: var(--font-size-base);
}

/* File Upload */
.file-upload-area {
    border: 2px dashed rgba(34,211,238,0.4);
    border-radius: var(--radius-lg);
    padding: var(--space-32);
    text-align: center;
    cursor: pointer;
    transition: all var(--duration-normal) var(--ease-standard);
    background: rgba(34,211,238,0.05);
}

.file-upload-area:hover {
    border-color: var(--color-teal-accent);
    background: rgba(34,211,238,0.1);
    transform: translateY(-2px);
}

.file-upload-area.drag-over {
    border-color: var(--color-gold);
    background: rgba(255, 165, 0, 0.1);
}

.file-icon {
    font-size: 48px;
    margin-bottom: var(--space-16);
}

.file-info {
    background: rgba(34,211,238,0.15);
    border: 1px solid rgba(34,211,238,0.3);
    border-radius: var(--radius-md);
    padding: var(--space-16);
    margin-top: var(--space-16);
    display: flex;
    align-items: center;
    gap: var(--space-12);
}

/* Quiz Questions */
.quiz-question {
    background: rgba(255, 255, 255, 0.08);
    border-radius: var(--radius-lg);
    padding: var(--space-20);
    margin-bottom: var(--space-16);
}

.quiz-question h4 {
    color: var(--color-teal-accent);
    margin-bottom: var(--space-16);
    font-size: var(--font-size-base);
}

.quiz-options {
    display: flex;
    flex-direction: column;
    gap: var(--space-8);
}

.quiz-option {
    background: rgba(255, 255, 255, 0.05);
    border: 1px solid rgba(255, 255, 255, 0.15);
    border-radius: var(--radius-md);
    padding: var(--space-12) var(--space-16);
    cursor: pointer;
    transition: all var(--duration-fast) var(--ease-standard);
    font-size: var(--font-size-sm);
}

.quiz-option:hover {
    background: rgba(34,211,238,0.15);
    border-color: var(--color-teal-accent);
    transform: translateX(4px);
}

/* Video Info Card */
.video-info {
    background: rgba(255, 255, 255, 0.08);
    border-radius: var(--radius-lg);
    padding: var(--space-20);
    margin: var(--space-24) 0;
    display: flex;
    align-items: center;
    gap: var(--space-16);
}

.video-thumbnail {
    width: 120px;
    height: 90px;
    background: linear-gradient(135deg, rgba(34,211,238,0.2) 0%, rgba(255, 165, 0, 0.2) 100%);
    border-radius: var(--radius-md);
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 32px;
    flex-shrink: 0;
}

.video-details h4 {
    font-size: var(--font-size-base);
    margin-bottom: var(--space-8);
    color: var(--color-white);
}

.video-meta {
    font-size: var(--font-size-xs);
    color: rgba(255, 255, 255, 0.6);
    display: flex;
    gap: var(--space-16);
}

/* Dashboard Styles */
.risk-gauge {
    position: relative;
}

.risk-circle {
    transition: stroke-dashoffset 1s ease;
}

.stat-item {
    display: flex;
    justify-content: space-between;
    padding: var(--space-12) 0;
    border-bottom: 1px solid rgba(255, 255, 255, 0.1);
}

.stat-item:last-child {
    border-bottom: none;
}

.stat-label {
    font-size: var(--font-size-sm);
    color: rgba(255, 255, 255, 0.7);
}

.stat-value {
    font-size: var(--font-size-xl);
    font-weight: var(--font-weight-bold);
    color: var(--color-teal-accent);
}

.threats-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: var(--space-16);
    margin-bottom: var(--space-24);
}

.threat-card {
    background: rgba(255, 255, 255, 0.05);
    backdrop-filter: blur(20px);
    border: 1px solid rgba(255, 255, 255, 0.1);
    border-radius: var(--radius-lg);
    padding: var(--space-20);
    text-align: center;
    transition: all var(--duration-normal) var(--ease-standard);
}

.threat-card:hover {
    transform: translateY(-4px);
    box-shadow: var(--shadow-premium);
}

.dashboard-module {
    margin-bottom: 30px;
}

.module-header {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    gap: var(--space-12);
    flex-wrap: wrap;
    margin-bottom: var(--space-12);
}

.module-header h2 {
    font-size: 22px;
    font-weight: 600;
    color: #fff;
}

.module-meta {
    font-size: 12px;
    color: rgba(255, 255, 255, 0.65);
}

.module-controls {
    display: flex;
    gap: var(--space-8);
    flex-wrap: wrap;
    align-items: center;
    margin-bottom: var(--space-12);
}

.module-controls .form-select,
.module-controls .form-input {
    min-width: 160px;
}

.module-list {
    display: grid;
    grid-template-columns: 1fr;
    gap: var(--space-12);
}

.module-item {
    background: rgba(255, 255, 255, 0.04);
    border: 1px solid rgba(255, 255, 255, 0.08);
    border-radius: var(--radius-lg);
    padding: var(--space-16);
    box-shadow: var(--shadow-sm);
}

.module-item-header {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    gap: var(--space-12);
    margin-bottom: var(--space-10);
}

.module-badges {
    display: flex;
    flex-wrap: wrap;
    gap: var(--space-6);
    align-items: center;
}

.module-summary {
    font-size: 13px;
    color: rgba(255, 255, 255, 0.75);
    line-height: 1.6;
    margin-bottom: var(--space-10);
}

.module-title {
    font-size: 16px;
    font-weight: 600;
    margin-top: 6px;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    max-width: 100%;
}

.summary-text {
    display: inline;
}

.summary-toggle {
    background: none;
    border: none;
    color: #22d3ee;
    font-size: 12px;
    font-weight: 600;
    margin-left: 6px;
    cursor: pointer;
    padding: 0;
}

.summary-toggle:hover {
    text-decoration: underline;
}

.module-actions {
    display: flex;
    flex-wrap: wrap;
    gap: var(--space-8);
    align-items: center;
}

.module-actions a {
    text-decoration: none;
}

.module-degraded {
    display: none;
    margin-bottom: var(--space-10);
    padding: 8px 12px;
    border-radius: var(--radius-base);
    background: rgba(255, 153, 51, 0.15);
    border: 1px solid rgba(255, 153, 51, 0.4);
    color: rgba(255, 255, 255, 0.9);
    font-size: 12px;
}

.status-pill {
    padding: 3px 8px;
    border-radius: var(--radius-full);
    font-size: 11px;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.03em;
}

.status-pill.incident {
    background: rgba(255, 68, 68, 0.15);
    color: #ff6b6b;
    border: 1px solid rgba(255, 68, 68, 0.4);
}

.status-pill.maintenance {
    background: rgba(255, 176, 32, 0.15);
    color: #ffb020;
    border: 1px solid rgba(255, 176, 32, 0.4);
}

.status-pill.resolved {
    background: rgba(39, 174, 96, 0.15);
    color: #5dde8c;
    border: 1px solid rgba(39, 174, 96, 0.4);
}

.intel-summary-chips {
    display: flex;
    flex-wrap: wrap;
    gap: var(--space-8);
    margin-bottom: var(--space-12);
}

.intel-summary-chip {
    padding: 6px 10px;
    border-radius: var(--radius-full);
    font-size: 12px;
    background: rgba(34, 211, 238, 0.12);
    border: 1px solid rgba(34, 211, 238, 0.35);
    color: #8fe8f5;
}

.health-card {
    background: rgba(15, 20, 25, 0.75);
    border: 1px solid rgba(255, 255, 255, 0.1);
    border-radius: var(--radius-lg);
    padding: var(--space-16);
    box-shadow: var(--shadow-sm);
}

.health-row {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 8px 0;
    border-bottom: 1px solid rgba(255, 255, 255, 0.08);
    font-size: 13px;
}

.health-row:last-child {
    border-bottom: none;
}

.health-badge {
    padding: 3px 8px;
    border-radius: var(--radius-full);
    font-size: 11px;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.03em;
}

.health-badge.ok {
    background: rgba(39, 174, 96, 0.2);
    color: #5dde8c;
    border: 1px solid rgba(39, 174, 96, 0.4);
}

.health-badge.degraded {
    background: rgba(255, 176, 32, 0.2);
    color: #ffb020;
    border: 1px solid rgba(255, 176, 32, 0.4);
}

.threat-icon {
    font-size: 32px;
    margin-bottom: var(--space-8);
}

.threat-value {
    font-size: 28px;
    font-weight: var(--font-weight-bold);
    margin-bottom: var(--space-4);
    color: var(--color-white);
}

.threat-label {
    font-size: var(--font-size-sm);
    color: rgba(255, 255, 255, 0.7);
    margin-bottom: var(--space-8);
}

.threat-trend {
    font-size: var(--font-size-xs);
    font-weight: var(--font-weight-semibold);
}

/* Timeline */
.timeline {
    position: relative;
}

.timeline-item {
    display: flex;
    gap: var(--space-16);
    margin-bottom: var(--space-24);
    position: relative;
}

.timeline-item:not(:last-child)::after {
    content: '';
    position: absolute;
    left: 7px;
    top: 24px;
    width: 2px;
    height: calc(100% + 8px);
    background: rgba(255, 255, 255, 0.1);
}

.timeline-dot {
    width: 16px;
    height: 16px;
    border-radius: 50%;
    flex-shrink: 0;
    margin-top: 4px;
    box-shadow: 0 0 12px currentColor;
}

.timeline-content {
    flex: 1;
}

.timeline-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: var(--space-8);
    flex-wrap: wrap;
    gap: var(--space-8);
}

.timeline-meta {
    font-size: var(--font-size-xs);
    color: rgba(255, 255, 255, 0.6);
    margin-bottom: var(--space-6);
}

.timeline-desc {
    font-size: var(--font-size-sm);
    color: rgba(255, 255, 255, 0.8);
    line-height: 1.6;
}

.status-badge {
    display: inline-block;
    padding: var(--space-4) var(--space-10);
    border-radius: var(--radius-full);
    font-size: var(--font-size-xs);
    font-weight: var(--font-weight-semibold);
    border: 1px solid;
}

.status-active {
    background: rgba(255, 0, 64, 0.15);
    border-color: rgba(255, 0, 64, 0.3);
    color: #ff0040;
}

.trending-tags {
    display: flex;
    flex-wrap: wrap;
    gap: var(--space-12);
}

.trending-tag {
    padding: var(--space-10) var(--space-16);
    background: rgba(34,211,238,0.1);
    border: 1px solid rgba(34,211,238,0.3);
    border-radius: var(--radius-full);
    font-size: var(--font-size-sm);
    font-weight: var(--font-weight-medium);
    color: var(--color-teal-accent);
    transition: all var(--duration-normal) var(--ease-standard);
    cursor: pointer;
}

.trending-tag:hover {
    background: rgba(34,211,238,0.2);
    transform: translateY(-2px);
}

/* Filter Bar */
.filter-bar {
    display: flex;
    gap: var(--space-12);
    margin-bottom: var(--space-24);
    flex-wrap: wrap;
}

/* CVE Grid */
.cve-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
    gap: var(--space-16);
}

@media (min-width: 1400px) {
    .cve-grid {
        grid-template-columns: repeat(3, minmax(280px, 1fr));
    }
}

@media (min-width: 1600px) {
    .cve-grid {
        grid-template-columns: repeat(4, minmax(260px, 1fr));
    }
}

.cve-card {
    background: rgba(255, 255, 255, 0.05);
    border: 1px solid rgba(255, 255, 255, 0.1);
    border-left: 4px solid;
    border-radius: var(--radius-lg);
    padding: var(--space-16);
    transition: all var(--duration-normal) var(--ease-standard);
}

.cve-card:hover {
    transform: translateY(-4px);
    box-shadow: var(--shadow-premium);
    background: rgba(255, 255, 255, 0.08);
}

/* EPSS Enhancements */
.nvd-layout {
    display: grid;
    grid-template-columns: 1fr;
    gap: var(--space-20);
}

@media (min-width: 1200px) {
    .nvd-layout {
        grid-template-columns: minmax(0, 1fr) 280px;
        align-items: start;
    }
}

.wide-layout {
    display: grid;
    grid-template-columns: 1fr;
    grid-template-areas: "side" "main";
    gap: 18px;
}

.wide-layout .main-col {
    grid-area: main;
}

.wide-layout .side-col {
    grid-area: side;
}

@media (min-width: 1200px) {
    .wide-layout {
        grid-template-columns: minmax(0, 1fr) 340px;
        grid-template-areas: "main side";
        align-items: start;
    }

    .wide-layout .side-col {
        position: sticky;
        top: 92px;
        max-height: calc(100vh - 120px);
        overflow: auto;
    }
}

.epss-insights-card {
    background: rgba(255, 255, 255, 0.05);
    border: 1px solid rgba(255, 255, 255, 0.12);
    border-radius: var(--radius-lg);
    padding: var(--space-16);
    box-shadow: var(--shadow-soft);
}

.epss-kpis {
    display: grid;
    grid-template-columns: repeat(2, minmax(0, 1fr));
    gap: var(--space-12);
    margin-bottom: var(--space-16);
}

.epss-kpi {
    background: rgba(34, 211, 238, 0.08);
    border: 1px solid rgba(34, 211, 238, 0.2);
    border-radius: var(--radius-md);
    padding: var(--space-10);
    text-align: center;
}

.epss-kpi h4 {
    font-size: var(--font-size-xs);
    color: rgba(255, 255, 255, 0.6);
    margin-bottom: var(--space-4);
}

.epss-kpi span {
    font-size: var(--font-size-lg);
    font-weight: var(--font-weight-semibold);
    color: var(--color-teal-accent);
}

.mini-histogram {
    display: flex;
    align-items: flex-end;
    gap: 4px;
    height: 60px;
    margin-top: var(--space-8);
}

.mini-hist-bar {
    flex: 1;
    background: linear-gradient(180deg, rgba(139, 92, 246, 0.5), rgba(34, 211, 238, 0.4));
    border-radius: 4px 4px 0 0;
    min-height: 6px;
}

.epss-row {
    display: flex;
    align-items: center;
    gap: var(--space-8);
    margin-top: var(--space-12);
    font-size: var(--font-size-xs);
    color: rgba(255, 255, 255, 0.7);
}

.epss-meter {
    flex: 1;
    height: 6px;
    background: rgba(255, 255, 255, 0.08);
    border-radius: var(--radius-full);
    overflow: hidden;
}

.epss-meter-fill {
    height: 100%;
    background: linear-gradient(90deg, rgba(34, 211, 238, 0.6), rgba(139, 92, 246, 0.6));
    border-radius: var(--radius-full);
    width: 0%;
}

.epss-muted {
    color: rgba(255, 255, 255, 0.45);
}

@media (min-width: 1200px) {
    body.clipboard-open .nvd-grid {
        grid-template-columns: repeat(3, minmax(0, 1fr));
    }
}

@media (min-width: 1600px) {
    body.clipboard-collapsed .nvd-grid {
        grid-template-columns: repeat(4, minmax(0, 1fr));
    }

    body.clipboard-open .nvd-grid {
        grid-template-columns: repeat(3, minmax(0, 1fr));
    }
}

.fix-first-card {
    background: rgba(255, 255, 255, 0.05);
    border: 1px solid rgba(255, 255, 255, 0.12);
    border-radius: var(--radius-lg);
    padding: var(--space-16);
    margin-bottom: var(--space-20);
    box-shadow: var(--shadow-soft);
}

.fix-first-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: var(--space-12);
    margin-bottom: var(--space-12);
}

.fix-first-title {
    font-size: 14px;
    font-weight: 600;
    color: #fff;
}

.fix-first-mode {
    min-width: 160px;
    font-size: 12px;
    padding: 8px 12px;
}

.fix-first-list {
    display: flex;
    flex-direction: column;
    gap: 10px;
}

.fix-first-item {
    display: flex;
    align-items: flex-start;
    gap: 10px;
    padding: 10px 12px;
    border-radius: var(--radius-md);
    border: 1px solid rgba(255,255,255,0.08);
    background: rgba(10, 14, 20, 0.6);
    cursor: pointer;
    transition: all var(--duration-normal) var(--ease-standard);
}

.fix-first-item:hover {
    border-color: rgba(34,211,238,0.35);
    box-shadow: 0 10px 30px rgba(34,211,238,0.08);
    transform: translateY(-1px);
}

.fix-first-rank {
    width: 24px;
    height: 24px;
    border-radius: 999px;
    background: rgba(34,211,238,0.18);
    border: 1px solid rgba(34,211,238,0.4);
    color: #e8faff;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 12px;
    font-weight: 600;
    flex-shrink: 0;
}

.fix-first-content {
    flex: 1;
    min-width: 0;
}

.fix-first-id {
    font-size: 12px;
    font-weight: 600;
    color: #22d3ee;
}

.fix-first-title-text {
    font-size: 12px;
    color: rgba(255,255,255,0.85);
    margin-top: 2px;
    line-height: 1.3;
}

.fix-first-meta {
    display: flex;
    flex-wrap: wrap;
    gap: 6px;
    margin-top: 6px;
}

.fix-first-badge {
    padding: 2px 8px;
    border-radius: 999px;
    font-size: 10px;
    font-weight: 600;
    border: 1px solid rgba(255,255,255,0.2);
    color: rgba(255,255,255,0.85);
    background: rgba(255,255,255,0.08);
}

.fix-first-badge.kev {
    border-color: rgba(255,0,64,0.5);
    color: #ff7a9c;
    background: rgba(255,0,64,0.12);
}

.fix-first-actions {
    display: flex;
    align-items: flex-start;
    gap: 6px;
}

.cvss-badge {
    padding: var(--space-6) var(--space-12);
    border-radius: var(--radius-sm);
    font-size: var(--font-size-base);
    font-weight: var(--font-weight-bold);
    color: var(--color-navy);
}

.info-tag {
    display: inline-block;
    padding: var(--space-4) var(--space-8);
    background: rgba(255, 255, 255, 0.1);
    border-radius: var(--radius-sm);
    font-size: var(--font-size-xs);
    color: rgba(255, 255, 255, 0.8);
}

/* Data Table */
.breach-table {
    overflow-x: auto;
}

.data-table {
    width: 100%;
    border-collapse: collapse;
}

.data-table th,
.data-table td {
    padding: var(--space-12) var(--space-16);
    text-align: left;
    border-bottom: 1px solid rgba(255, 255, 255, 0.1);
}

.data-table th {
    font-size: var(--font-size-xs);
    font-weight: var(--font-weight-semibold);
    text-transform: uppercase;
    color: rgba(255, 255, 255, 0.6);
    letter-spacing: 0.5px;
}

.data-table td {
    font-size: var(--font-size-sm);
    color: rgba(255, 255, 255, 0.9);
}

.data-table tbody tr {
    transition: background var(--duration-fast) var(--ease-standard);
}

.data-table tbody tr:hover {
    background: rgba(34,211,238,0.05);
}

/* Malware Grid */
.malware-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
    gap: var(--space-16);
}

@media (min-width: 1400px) {
    #mitre-threat-actors-grid {
        grid-template-columns: repeat(3, minmax(0, 1fr));
    }
}

.malware-card {
    background: rgba(255, 255, 255, 0.05);
    border: 1px solid rgba(255, 255, 255, 0.1);
    border-radius: var(--radius-lg);
    padding: var(--space-16);
    transition: all var(--duration-normal) var(--ease-standard);
}

.malware-card:hover {
    transform: translateY(-4px);
    box-shadow: var(--shadow-premium);
    border-color: rgba(255, 0, 64, 0.3);
}

.actor-card {
    cursor: pointer;
}

.actor-card:focus-visible {
    outline: 2px solid rgba(34, 211, 238, 0.8);
    outline-offset: 2px;
}

.details-card {
    background: rgba(14, 18, 28, 0.92);
    border: 1px solid rgba(139, 92, 246, 0.25);
    border-radius: var(--radius-lg);
    padding: var(--space-16);
    box-shadow: var(--shadow-glow);
}

.details-card h3 {
    font-size: var(--font-size-lg);
    margin-bottom: var(--space-12);
    color: var(--color-teal-accent);
}

.detail-meta {
    font-size: var(--font-size-sm);
    color: rgba(255, 255, 255, 0.7);
    margin-bottom: var(--space-12);
}

.detail-description {
    font-size: var(--font-size-sm);
    color: rgba(255, 255, 255, 0.85);
    line-height: 1.6;
    margin-bottom: var(--space-10);
    display: -webkit-box;
    -webkit-line-clamp: 6;
    -webkit-box-orient: vertical;
    overflow: hidden;
}

.detail-description.expanded {
    -webkit-line-clamp: initial;
}

.detail-toggle {
    background: none;
    border: none;
    color: var(--color-teal-accent);
    font-size: var(--font-size-xs);
    cursor: pointer;
    margin-bottom: var(--space-12);
}

.detail-search input {
    width: 100%;
    padding: var(--space-8) var(--space-12);
    background: rgba(255, 255, 255, 0.08);
    border: 1px solid rgba(255, 255, 255, 0.15);
    border-radius: var(--radius-md);
    color: var(--color-white);
}

.detail-search input:focus-visible {
    outline: 2px solid rgba(34, 211, 238, 0.8);
    outline-offset: 2px;
}

.tech-list {
    display: flex;
    flex-direction: column;
    gap: var(--space-8);
    margin-top: var(--space-12);
}

.tech-item {
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: var(--space-8);
    padding: var(--space-8) var(--space-10);
    background: rgba(34, 211, 238, 0.08);
    border: 1px solid rgba(34, 211, 238, 0.18);
    border-radius: var(--radius-md);
}

.tech-item a {
    color: var(--color-white);
    text-decoration: none;
    font-size: var(--font-size-sm);
}

.tech-item a:hover {
    color: var(--color-teal-accent);
}

.tech-chip {
    padding: 2px 8px;
    border-radius: var(--radius-full);
    background: rgba(139, 92, 246, 0.2);
    border: 1px solid rgba(139, 92, 246, 0.4);
    color: rgba(255, 255, 255, 0.85);
    font-size: var(--font-size-xs);
}

.tactic-bars {
    margin-top: var(--space-12);
    display: flex;
    flex-direction: column;
    gap: var(--space-8);
}

.tactic-row {
    display: grid;
    grid-template-columns: 110px 1fr 30px;
    gap: var(--space-8);
    align-items: center;
    font-size: var(--font-size-xs);
    color: rgba(255, 255, 255, 0.7);
}

.tactic-row .bar {
    height: 8px;
    background: linear-gradient(90deg, rgba(139, 92, 246, 0.6), rgba(34, 211, 238, 0.6));
    border-radius: var(--radius-full);
}

.modal-backdrop {
    position: fixed;
    inset: 0;
    display: none;
    align-items: center;
    justify-content: center;
    padding: 16px;
    background: rgba(5, 8, 16, 0.75);
    z-index: 200;
}

.modal-backdrop.active {
    display: flex;
}

.modal {
    width: 100%;
    max-width: 640px;
    max-height: 85vh;
    overflow: auto;
    background: rgba(14, 18, 28, 0.96);
    border: 1px solid rgba(139, 92, 246, 0.35);
    border-radius: var(--radius-lg);
    padding: var(--space-16);
    box-shadow: var(--shadow-premium);
}

.modal-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: var(--space-12);
    margin-bottom: var(--space-12);
}

.modal-close {
    background: rgba(255, 255, 255, 0.08);
    border: 1px solid rgba(255, 255, 255, 0.2);
    color: var(--color-white);
    border-radius: var(--radius-md);
    padding: 6px 10px;
    cursor: pointer;
}

.modal-close:focus-visible {
    outline: 2px solid rgba(34, 211, 238, 0.8);
    outline-offset: 2px;
}

/* Tools Grid */
.tools-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
    gap: var(--space-20);
}

.tool-card {
    min-height: 280px;
}

.tool-result {
    margin-top: var(--space-16);
    padding: var(--space-16);
    background: rgba(255, 255, 255, 0.05);
    border-left: 4px solid var(--color-teal-accent);
    border-radius: var(--radius-lg);
    animation: slideUp var(--duration-slow) var(--ease-standard);
}

.strength-meter {
    width: 100%;
    height: 8px;
    background: rgba(255, 255, 255, 0.1);
    border-radius: var(--radius-full);
    overflow: hidden;
    margin-bottom: var(--space-12);
}

.strength-bar {
    height: 100%;
    width: 0;
    transition: all var(--duration-slow) var(--ease-standard);
    border-radius: var(--radius-full);
}

.strength-label {
    font-size: var(--font-size-base);
    font-weight: var(--font-weight-semibold);
    margin-bottom: var(--space-8);
}

.strength-details {
    font-size: var(--font-size-sm);
    color: rgba(255, 255, 255, 0.7);
    line-height: 1.6;
}

/* Settings */
.settings-section {
    padding: var(--space-24) 0;
    border-bottom: 1px solid rgba(255, 255, 255, 0.1);
}

.settings-section:last-child {
    border-bottom: none;
}

/* Responsive - ENHANCED MOBILE */
@media (max-width: 768px) {
    body {
        font-size: 15px;
    }
    
    .header {
        padding: 16px 12px;
    }
    
    .header h1 {
        font-size: 22px;
    }
    
    .header p {
        font-size: 13px;
    }
    
    .nav-tabs {
        gap: 6px;
        padding: 6px;
    }
    
    .tab-btn {
        min-width: 100px;
        padding: 10px 12px;
        font-size: 12px;
        min-height: 44px;
    }
    
    .premium-card {
        padding: 16px;
        margin-bottom: 16px;
    }
    
    .news-card {
        padding: 16px;
        max-width: 100%;
    }
    
    .video-info {
        flex-direction: column;
        text-align: center;
    }
    
    .threats-grid {
        grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
        gap: 12px;
    }
    
    .tools-grid {
        grid-template-columns: 1fr;
    }
    
    .filter-bar {
        flex-direction: column;
    }
    
    .cve-grid,
    .malware-grid {
        grid-template-columns: 1fr;
    }
    
    .btn {
        min-height: 44px;
        padding: 12px 24px;
        font-size: 15px;
    }
    
    .form-input,
    .form-textarea,
    .form-select {
        font-size: 15px;
        padding: 14px;
        min-height: 44px;
    }
}

/* Hidden class */
.hidden {
    display: none !important;
}

/* Learning Hub Sub-tabs - MOBILE OPTIMIZED */
.learning-hub-subtabs {
    display: flex;
    gap: 8px;
    padding: 12px;
    background: rgba(15, 20, 25, 0.6);
    border-radius: var(--radius-lg);
    margin-bottom: 20px;
    overflow-x: auto;
    scrollbar-width: thin;
    scroll-snap-type: x mandatory;
    -webkit-overflow-scrolling: touch;
}

.learning-hub-subtabs::-webkit-scrollbar {
    height: 4px;
}

.learning-hub-subtabs::-webkit-scrollbar-track {
    background: rgba(255, 255, 255, 0.05);
    border-radius: 2px;
}

.learning-hub-subtabs::-webkit-scrollbar-thumb {
    background: rgba(34,211,238,0.4);
    border-radius: 2px;
}

.learning-subtab-btn {
    flex-shrink: 0;
    padding: 8px 12px;
    background: rgba(255, 255, 255, 0.08);
    border: 1px solid rgba(255, 255, 255, 0.15);
    border-radius: var(--radius-base);
    color: rgba(255, 255, 255, 0.7);
    font-size: 12px;
    font-weight: var(--font-weight-medium);
    cursor: pointer;
    transition: all 0.2s var(--ease-standard);
    white-space: nowrap;
    scroll-snap-align: start;
    min-height: 44px;
    display: flex;
    align-items: center;
    justify-content: center;
}

.learning-subtab-btn:hover {
    background: rgba(34,211,238,0.15);
    border-color: rgba(34,211,238,0.4);
}

.learning-subtab-btn.active {
    background: linear-gradient(135deg, var(--color-teal-accent) 0%, var(--color-teal-accent-dark) 100%);
    border-color: var(--color-teal-accent);
    color: var(--color-navy);
    font-weight: var(--font-weight-semibold);
    box-shadow: 0 0 12px rgba(34,211,238,0.4);
}

.learning-subtab {
    display: none;
    animation: fadeIn 0.3s var(--ease-standard);
}

.learning-subtab.active {
    display: block;
}

/* News Card Link Styling */
.news-link {
    display: inline-flex;
    align-items: center;
    gap: 6px;
    margin-top: 12px;
    padding: 8px 16px;
    background: rgba(34,211,238,0.15);
    border: 1px solid rgba(34,211,238,0.3);
    border-radius: var(--radius-base);
    color: var(--color-teal-accent);
    font-size: 13px;
    font-weight: var(--font-weight-semibold);
    text-decoration: none;
    transition: all 0.2s var(--ease-standard);
}

.news-link:hover {
    background: rgba(34,211,238,0.25);
    border-color: var(--color-teal-accent);
    transform: translateX(4px);
    box-shadow: 0 4px 12px rgba(34,211,238,0.3);
}

.library-save-btn,
.library-action-btn {
    padding: 6px 12px;
    border-radius: var(--radius-base);
    border: 1px solid rgba(34,211,238,0.35);
    background: rgba(34,211,238,0.12);
    color: var(--color-teal-accent);
    font-size: 12px;
    font-weight: var(--font-weight-semibold);
    cursor: pointer;
    transition: all 0.2s var(--ease-standard);
}

.library-save-btn:hover,
.library-action-btn:hover {
    background: rgba(34,211,238,0.2);
    border-color: rgba(34,211,238,0.6);
    transform: translateY(-1px);
    box-shadow: 0 6px 16px rgba(34,211,238,0.15);
}

.library-toolbar {
    display: flex;
    flex-wrap: wrap;
    gap: 12px;
    margin-bottom: 12px;
}

.library-toolbar .form-input {
    flex: 1;
    min-width: 220px;
}

.library-controls {
    display: flex;
    gap: 10px;
    flex-wrap: wrap;
    align-items: center;
}

.library-tag-filters {
    display: flex;
    flex-wrap: wrap;
    gap: 8px;
    margin-bottom: 16px;
}

.library-chip {
    border-radius: 999px;
    padding: 6px 12px;
    font-size: 12px;
    border: 1px solid rgba(255,255,255,0.15);
    background: rgba(255,255,255,0.08);
    color: rgba(255,255,255,0.7);
    cursor: pointer;
    transition: all 0.2s var(--ease-standard);
}

.library-chip.active {
    background: rgba(34,211,238,0.25);
    color: var(--color-teal-accent);
    border-color: rgba(34,211,238,0.5);
}

.library-items {
    display: grid;
    gap: 12px;
}

.library-item {
    background: rgba(18, 24, 32, 0.9);
    border: 1px solid rgba(255,255,255,0.08);
    border-radius: var(--radius-lg);
    padding: 14px;
    display: grid;
    grid-template-columns: auto 1fr;
    gap: 12px;
    align-items: start;
}

.library-item-title {
    font-size: 15px;
    font-weight: 600;
    color: #fff;
    margin-bottom: 6px;
}

.library-item-summary {
    font-size: 13px;
    color: rgba(255,255,255,0.7);
    margin-bottom: 8px;
}

.library-item-meta {
    font-size: 12px;
    color: rgba(255,255,255,0.6);
    margin-bottom: 8px;
}

.library-item-actions {
    display: flex;
    flex-wrap: wrap;
    gap: 8px;
}

.library-tags {
    display: flex;
    flex-wrap: wrap;
    gap: 6px;
    margin-top: 8px;
}

.library-tag {
    padding: 2px 8px;
    border-radius: 999px;
    background: rgba(255,255,255,0.08);
    color: rgba(255,255,255,0.7);
    font-size: 11px;
}

.library-empty {
    text-align: center;
    padding: 28px 12px;
    color: rgba(255,255,255,0.65);
    border: 1px dashed rgba(255,255,255,0.2);
    border-radius: var(--radius-lg);
    margin-top: 12px;
}

.library-select input {
    width: 18px;
    height: 18px;
}

.databank-search-wrapper {
    position: relative;
}

.databank-search-results {
    position: absolute;
    top: calc(100% + 8px);
    left: 0;
    right: 0;
    background: rgba(12, 16, 24, 0.98);
    border: 1px solid rgba(34, 211, 238, 0.2);
    border-radius: var(--radius-lg);
    box-shadow: var(--shadow-glow);
    max-height: 320px;
    overflow-y: auto;
    display: none;
    z-index: 50;
}

.databank-search-results.active {
    display: block;
}

.databank-search-result {
    display: flex;
    align-items: flex-start;
    gap: 12px;
    padding: 12px 14px;
    border-bottom: 1px solid rgba(255,255,255,0.06);
    cursor: pointer;
    transition: background 0.2s var(--ease-standard);
}

.databank-search-result:last-child {
    border-bottom: none;
}

.databank-search-result:hover {
    background: rgba(34, 211, 238, 0.08);
}

.databank-result-icon {
    min-width: 34px;
    height: 34px;
    border-radius: 10px;
    background: rgba(34, 211, 238, 0.16);
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 16px;
}

.databank-result-title {
    font-size: 14px;
    font-weight: 600;
    color: #fff;
    margin-bottom: 4px;
}

.databank-result-snippet {
    font-size: 12px;
    color: rgba(255,255,255,0.65);
}

.databank-result-type {
    font-size: 11px;
    color: rgba(255,255,255,0.55);
    text-transform: uppercase;
    letter-spacing: 0.08em;
}

.databank-mini-rows {
    display: grid;
    gap: 14px;
    margin-bottom: 18px;
}

.databank-mini-row {
    background: rgba(12, 16, 24, 0.8);
    border: 1px solid rgba(255,255,255,0.08);
    border-radius: var(--radius-lg);
    padding: 12px;
}

.databank-mini-header {
    font-size: 12px;
    text-transform: uppercase;
    letter-spacing: 0.08em;
    color: rgba(255,255,255,0.6);
    margin-bottom: 10px;
}

.databank-mini-list {
    display: flex;
    flex-wrap: wrap;
    gap: 8px;
}

.databank-mini-empty {
    font-size: 12px;
    color: rgba(255,255,255,0.5);
}

.databank-mini-chip {
    display: inline-flex;
    align-items: center;
    gap: 8px;
    padding: 6px 10px;
    border-radius: 999px;
    border: 1px solid rgba(34,211,238,0.3);
    background: rgba(34,211,238,0.12);
    color: #fff;
    font-size: 12px;
    cursor: pointer;
    transition: all 0.2s var(--ease-standard);
}

.databank-mini-chip:hover {
    transform: translateY(-1px);
    box-shadow: var(--shadow-sm);
}

.databank-chip-type {
    font-size: 11px;
    color: rgba(255,255,255,0.7);
}

.databank-fav-btn {
    border: 1px solid rgba(255,255,255,0.2);
    background: rgba(255,255,255,0.06);
    color: rgba(255,255,255,0.6);
    border-radius: 999px;
    padding: 4px 8px;
    font-size: 12px;
    cursor: pointer;
    transition: all 0.2s var(--ease-standard);
}

.databank-fav-btn.is-active {
    color: #ffb020;
    border-color: rgba(255,176,32,0.6);
    background: rgba(255,176,32,0.15);
}

.databank-card-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    gap: 12px;
}

.databank-detail-actions {
    display: flex;
    flex-wrap: wrap;
    gap: 10px;
    margin-top: 16px;
}

.databank-detail-grid {
    display: grid;
    gap: 16px;
}

.databank-detail-section {
    background: rgba(12, 16, 24, 0.7);
    border: 1px solid rgba(255,255,255,0.08);
    border-radius: var(--radius-lg);
    padding: 14px;
}

.databank-detail-section h4 {
    font-size: 13px;
    text-transform: uppercase;
    letter-spacing: 0.08em;
    color: rgba(255,255,255,0.7);
    margin-bottom: 8px;
}

.databank-detail-section ul {
    padding-left: 16px;
    margin: 0;
    color: rgba(255,255,255,0.75);
    font-size: 13px;
}

.databank-detail-section li {
    margin-bottom: 6px;
}

.databank-guide-header {
    display: flex;
    justify-content: space-between;
    gap: 12px;
    flex-wrap: wrap;
    align-items: center;
}

.databank-guide-actions {
    display: flex;
    align-items: center;
    gap: 8px;
}

.databank-guide-toggle,
.databank-detail-btn {
    border: 1px solid rgba(34,211,238,0.3);
    background: rgba(34,211,238,0.1);
    color: #22d3ee;
    border-radius: 999px;
    padding: 4px 10px;
    font-size: 11px;
    cursor: pointer;
}

.databank-guide-body {
    margin-top: 12px;
    padding-top: 10px;
    border-top: 1px solid rgba(255,255,255,0.1);
    display: none;
}

.databank-guide-body.active {
    display: block;
}

.databank-guide-step {
    margin-bottom: 10px;
    font-size: 13px;
    color: rgba(255,255,255,0.75);
}

.databank-guide-step strong {
    color: #fff;
}

.databank-highlight {
    outline: 2px solid rgba(34,211,238,0.8);
    box-shadow: 0 0 22px rgba(34,211,238,0.3);
    transition: outline 0.2s var(--ease-standard);
}

.risk-builder-card {
    border: 1px solid rgba(255, 176, 32, 0.35);
    box-shadow: 0 0 14px rgba(255, 176, 32, 0.2);
}

.risk-builder-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    gap: 12px;
    flex-wrap: wrap;
    margin-bottom: 14px;
}

.risk-interactive-badge {
    display: inline-flex;
    align-items: center;
    gap: 6px;
    padding: 4px 10px;
    border-radius: 999px;
    font-size: 11px;
    font-weight: 600;
    color: #0f1419;
    background: rgba(34, 211, 238, 0.9);
}

.risk-builder-toggle {
    display: flex;
    gap: 8px;
    flex-wrap: wrap;
}

.risk-toggle-btn {
    border: 1px solid rgba(255,255,255,0.2);
    background: rgba(255,255,255,0.06);
    color: rgba(255,255,255,0.7);
    border-radius: 999px;
    padding: 6px 12px;
    font-size: 12px;
    cursor: pointer;
    transition: all 0.2s var(--ease-standard);
}

.risk-toggle-btn.active {
    background: rgba(255,176,32,0.2);
    border-color: rgba(255,176,32,0.5);
    color: #ffb020;
}

.risk-builder-labels {
    display: grid;
    gap: 12px;
    grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
    margin-bottom: 16px;
}

.risk-label-group {
    background: rgba(12, 16, 24, 0.7);
    border: 1px solid rgba(255,255,255,0.08);
    border-radius: var(--radius-lg);
    padding: 12px;
}

.risk-label-group h4 {
    font-size: 12px;
    text-transform: uppercase;
    letter-spacing: 0.08em;
    color: rgba(255,255,255,0.6);
    margin-bottom: 8px;
}

.risk-label-inputs {
    display: grid;
    gap: 8px;
}

.risk-label-inputs input {
    width: 100%;
    padding: 6px 10px;
    border-radius: 8px;
    border: 1px solid rgba(255,255,255,0.2);
    background: rgba(0,0,0,0.2);
    color: #fff;
    font-size: 12px;
}

.risk-matrix-grid {
    width: 100%;
    border-collapse: collapse;
    text-align: center;
    font-size: 12px;
}

.risk-matrix-grid th,
.risk-matrix-grid td {
    border: 1px solid rgba(255,255,255,0.08);
    padding: 8px;
}

.risk-matrix-grid th {
    background: rgba(34,211,238,0.12);
    color: #22d3ee;
    font-weight: 600;
}

.risk-matrix-grid td {
    position: relative;
    color: #0f1419;
    font-weight: 600;
    border-radius: 6px;
}

.risk-cell-label {
    font-size: 12px;
    margin-bottom: 6px;
    color: #0f1419;
}

.risk-cell-select {
    width: 100%;
    border-radius: 6px;
    border: none;
    padding: 4px 6px;
    font-size: 11px;
    background: rgba(255,255,255,0.85);
    color: #0f1419;
}

.risk-register-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    gap: 12px;
    flex-wrap: wrap;
    margin-bottom: 12px;
}

.risk-register-actions {
    display: flex;
    gap: 8px;
    flex-wrap: wrap;
}

.risk-register-filters {
    display: grid;
    gap: 8px;
    grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
    margin-bottom: 12px;
}

.risk-rating-badge {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    padding: 4px 10px;
    border-radius: 999px;
    font-size: 11px;
    font-weight: 600;
    color: #0f1419;
}

.risk-row-actions {
    display: flex;
    gap: 6px;
    flex-wrap: wrap;
}

.risk-modal-grid {
    display: grid;
    gap: 12px;
    grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
}

.risk-rating-preview {
    display: flex;
    align-items: center;
    gap: 8px;
    font-size: 13px;
    color: rgba(255,255,255,0.7);
}

.risk-register-table tbody tr {
    cursor: pointer;
    transition: background 0.2s var(--ease-standard);
}

.risk-register-table tbody tr:hover {
    background: rgba(34, 211, 238, 0.08);
}

.risk-controls-section {
    margin-top: 16px;
    padding: 14px;
    border-radius: var(--radius-lg);
    background: rgba(12, 16, 24, 0.7);
    border: 1px solid rgba(34, 211, 238, 0.2);
}

.risk-controls-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    gap: 12px;
    flex-wrap: wrap;
    margin-bottom: 12px;
}

.risk-controls-actions {
    display: flex;
    gap: 8px;
    flex-wrap: wrap;
}

.risk-controls-search {
    display: grid;
    gap: 8px;
    margin-bottom: 10px;
}

.risk-controls-suggestions,
.risk-controls-auto {
    display: grid;
    gap: 8px;
}

.risk-control-suggestion {
    display: flex;
    justify-content: space-between;
    align-items: center;
    gap: 10px;
    padding: 8px 10px;
    border-radius: 10px;
    background: rgba(15, 23, 42, 0.7);
    border: 1px solid rgba(255, 255, 255, 0.08);
    font-size: 12px;
}

.mapped-controls-list {
    display: grid;
    gap: 12px;
    margin-top: 12px;
}

.mapped-control-row {
    border-radius: 12px;
    background: rgba(8, 12, 20, 0.7);
    border: 1px solid rgba(255, 255, 255, 0.08);
    padding: 12px;
    display: grid;
    gap: 10px;
}

.mapped-control-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    gap: 10px;
    flex-wrap: wrap;
}

.mapped-control-badge {
    display: inline-flex;
    align-items: center;
    gap: 6px;
    padding: 4px 10px;
    border-radius: 999px;
    background: rgba(255, 176, 32, 0.2);
    color: #ffb020;
    font-size: 11px;
    font-weight: 600;
}

.mapped-control-meta {
    display: flex;
    align-items: center;
    gap: 10px;
    flex-wrap: wrap;
    font-size: 13px;
}

.mapped-control-type {
    font-size: 11px;
    color: rgba(255, 255, 255, 0.6);
}

.mapped-control-remove {
    border: none;
    background: rgba(255, 0, 64, 0.15);
    color: #ff0040;
    padding: 4px 8px;
    border-radius: 8px;
    cursor: pointer;
}

.mapped-control-fields {
    display: grid;
    gap: 10px;
    grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
}

.mapped-control-fields textarea {
    min-height: 70px;
}

.risk-controls-count {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    min-width: 28px;
    padding: 4px 8px;
    border-radius: 999px;
    font-size: 11px;
    font-weight: 600;
    color: #0f1419;
    background: rgba(34, 211, 238, 0.9);
}

.risk-treatment-modal .modal-body {
    display: grid;
    gap: 16px;
}

.risk-treatment-summary {
    display: grid;
    gap: 8px;
    padding: 12px;
    border-radius: 12px;
    background: rgba(15, 23, 42, 0.7);
    border: 1px solid rgba(255, 255, 255, 0.08);
}

.risk-treatment-controls {
    display: grid;
    gap: 10px;
}

.risk-treatment-evidence {
    display: grid;
    gap: 12px;
}

.risk-treatment-actions {
    display: flex;
    gap: 8px;
    flex-wrap: wrap;
}

.risk-treatment-notes textarea {
    min-height: 90px;
}

.risk-control-block {
    display: grid;
    gap: 10px;
    padding: 12px;
    border-radius: 12px;
    background: rgba(12, 16, 24, 0.7);
    border: 1px solid rgba(255,255,255,0.08);
}

.evidence-accordion {
    background: rgba(10, 14, 22, 0.9);
    border: 1px solid rgba(34,211,238,0.2);
    border-radius: 12px;
    padding: 12px;
}

.evidence-accordion summary {
    cursor: pointer;
    font-weight: 600;
    color: #22d3ee;
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 10px;
}

.evidence-accordion[open] summary {
    margin-bottom: 12px;
}

.evidence-summary-pill {
    background: rgba(255, 255, 255, 0.08);
    border-radius: 999px;
    padding: 4px 8px;
    font-size: 11px;
    color: rgba(255,255,255,0.75);
}

.evidence-items {
    display: grid;
    gap: 12px;
}

.evidence-item {
    border: 1px solid rgba(255,255,255,0.08);
    border-radius: 10px;
    padding: 10px;
    background: rgba(8, 12, 20, 0.8);
    display: grid;
    gap: 8px;
}

.evidence-item-header {
    display: flex;
    gap: 8px;
    align-items: center;
    flex-wrap: wrap;
}

.evidence-item-header .form-input {
    flex: 1;
}

.evidence-item-grid {
    display: grid;
    gap: 8px;
    grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
}

.evidence-status-badge {
    padding: 4px 8px;
    border-radius: 999px;
    font-size: 11px;
    font-weight: 600;
}

.evidence-status-missing {
    background: rgba(255,84,89,0.18);
    color: #ff5459;
}

.evidence-status-stale {
    background: rgba(255,176,32,0.18);
    color: #ffb020;
}

.evidence-status-ok {
    background: rgba(0,255,136,0.18);
    color: #00ff88;
}

.evidence-item-actions {
    display: flex;
    gap: 8px;
    flex-wrap: wrap;
}

.evidence-remove-btn {
    background: rgba(255, 0, 64, 0.15);
    color: #ff0040;
    border: 1px solid rgba(255, 0, 64, 0.3);
}

.posture-toolbar {
    display: flex;
    gap: 12px;
    align-items: center;
    flex-wrap: wrap;
    justify-content: space-between;
}

.posture-kpi-grid {
    display: grid;
    gap: 12px;
    grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
    margin-top: 16px;
}

.posture-kpi-card {
    padding: 14px;
    border-radius: 12px;
    background: rgba(12, 16, 24, 0.85);
    border: 1px solid rgba(255,255,255,0.08);
    display: grid;
    gap: 8px;
}

.posture-kpi-value {
    font-size: 22px;
    font-weight: 600;
    color: #22d3ee;
}

.posture-kpi-label {
    font-size: 12px;
    color: rgba(255,255,255,0.6);
    text-transform: uppercase;
    letter-spacing: 0.04em;
}

.posture-bars {
    display: grid;
    gap: 10px;
    margin-top: 16px;
}

.posture-bar {
    display: grid;
    gap: 6px;
}

.posture-bar-track {
    height: 10px;
    border-radius: 999px;
    background: rgba(255,255,255,0.08);
    overflow: hidden;
}

.posture-bar-fill {
    height: 100%;
    border-radius: 999px;
    background: linear-gradient(90deg, rgba(34,211,238,0.8), rgba(139,92,246,0.9));
}

.posture-bar-label {
    font-size: 12px;
    color: rgba(255,255,255,0.7);
    display: flex;
    justify-content: space-between;
}

.posture-due-grid {
    display: grid;
    gap: 10px;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    margin-top: 16px;
}

.posture-due-card {
    padding: 12px;
    border-radius: 10px;
    border: 1px solid rgba(255,255,255,0.08);
    background: rgba(10, 14, 22, 0.7);
    display: grid;
    gap: 6px;
}

.posture-due-value {
    font-size: 18px;
    font-weight: 600;
    color: #ffb020;
}

.posture-hero {
    display: flex;
    flex-direction: column;
    gap: 12px;
}

.posture-hero-title {
    display: flex;
    justify-content: space-between;
    gap: 16px;
    flex-wrap: wrap;
    align-items: center;
}

.posture-hero-actions {
    display: flex;
    gap: 10px;
    flex-wrap: wrap;
    align-items: center;
}

.posture-dashboard {
    display: grid;
    gap: 18px;
}

.posture-dashboard-grid {
    display: grid;
    gap: 16px;
    grid-template-columns: minmax(0, 1.6fr) minmax(0, 1fr);
}

.posture-card {
    padding: 14px;
    border-radius: 12px;
    background: rgba(12, 16, 24, 0.85);
    border: 1px solid rgba(255,255,255,0.08);
    display: grid;
    gap: 12px;
}

.posture-card-title {
    display: flex;
    justify-content: space-between;
    align-items: center;
    gap: 8px;
    font-size: 14px;
    font-weight: 600;
    color: #fff;
}

.posture-card-title button {
    font-size: 12px;
}

.posture-list {
    display: grid;
    gap: 10px;
}

.posture-list-item {
    display: flex;
    gap: 12px;
    padding: 10px;
    border-radius: 10px;
    background: rgba(8, 12, 20, 0.85);
    border: 1px solid rgba(255,255,255,0.08);
    align-items: center;
    justify-content: space-between;
}

.posture-list-content {
    display: grid;
    gap: 6px;
    flex: 1;
}

.posture-list-meta {
    display: flex;
    flex-wrap: wrap;
    gap: 6px;
    font-size: 11px;
    color: rgba(255,255,255,0.7);
}

.posture-list-actions {
    display: flex;
    gap: 6px;
    align-items: center;
    flex-wrap: wrap;
}

.posture-pill {
    padding: 2px 8px;
    border-radius: 999px;
    border: 1px solid rgba(255,255,255,0.18);
    background: rgba(255,255,255,0.08);
    font-size: 11px;
    color: rgba(255,255,255,0.8);
}

.posture-empty {
    font-size: 12px;
    color: rgba(255,255,255,0.6);
    padding: 8px 0;
}

@media (max-width: 980px) {
    .posture-dashboard-grid {
        grid-template-columns: 1fr;
    }
}

.checklist-summary {
    display: grid;
    gap: 10px;
}

.checklist-card {
    background: rgba(12, 16, 24, 0.8);
    border: 1px solid rgba(255,255,255,0.08);
    border-radius: var(--radius-lg);
    padding: 12px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    gap: 12px;
    flex-wrap: wrap;
}

.checklist-actions {
    display: flex;
    gap: 8px;
    flex-wrap: wrap;
}

.checklist-items {
    display: grid;
    gap: 10px;
    margin-top: 12px;
}

.checklist-item {
    display: flex;
    align-items: center;
    gap: 10px;
    padding: 8px 10px;
    border-radius: 8px;
    background: rgba(12, 16, 24, 0.7);
    border: 1px solid rgba(255,255,255,0.08);
}

.checklist-item input[type="checkbox"] {
    width: 16px;
    height: 16px;
}

.checklist-item.done {
    opacity: 0.6;
    text-decoration: line-through;
}
/* Smooth scrolling */
html {
    scroll-behavior: smooth;
}
    </style>
    <!-- External Libraries for PDF and Word Export -->
    <script src="./index_files/jspdf.umd.min.js.download"></script>
    <script src="./index_files/html2canvas.min.js.download"></script>
    <script src="./index_files/index.js.download"></script>
<style type="text/css" class="abn_style" nonce="undefined">#AC_ad,#AD_160,#AD_300,#AD_468x60,#AD_G,#AD_L,#AD_ROW,#AD_Top,#AD_text,#ADbox,#Ad-3-Slider,#Ad-4-Slider,#Ad-Container,#Ad-Content,#Ad-Top,#AdBanner,#AdBar,#AdBigBox,#AdBillboard,#AdBlockDialog,#AdBottomLeader,#AdBottomRight,#AdBox2,#AdColumn,#AdContainerTop,#AdContent,#AdDisclaimer,#AdHeader,#AdMiddle,#AdPopUp,#AdRectangleBanner,#AdSense1,#AdSense2,#AdSense3,#AdServer,#AdSkyscraper,#AdSlot_megabanner,#AdSpaceLeaderboard,#AdTop,#AdTopLeader,#AdWidgetContainer,#AdWrapperSuperCA,#AdZone1,#AdZone2,#Ad_BelowContent,#Ad_Block,#Ad_TopLeaderboard,#Adbanner,#Adlabel,#AdsBannerTop,#AdsBillboard,#AdsBottomContainer,#AdsContent,#AdsDiv,#AdsFrame,#AdsPubperform,#AdsRight,#AdsSky,#AdsTopContainer,#AdsWrap,#Ads_BA_BS,#Ads_BA_BUT,#Ads_BA_BUT2,#Ads_BA_BUT_box,#Ads_BA_CAD,#Ads_BA_CAD2,#Ads_BA_FLB,#Ads_BA_SKY,#Ads_BA_VID,#Ads_TFM_BS,#Ads_google_bottom_wide,#Adsense300x250,#AdsenseBottom,#AdsenseTop,#Adsterra,#Adv10,#Adv11,#Adv8,#Adv9,#AdvContainer,#AdvFooter,#AdvHeader,#Adv_Footer,#AdvertMid1,#AdvertMid2,#AdvertMpu,#AdvertPanel,#AdvertText,#AdvertiseFrame,#Advertisement1,#Advertisement2,#AdvertisementDiv,#AdvertisementLeaderboard,#Advertisements,#AdvertisingDiv_0,#Advertorial,#Advertorials,#AnchorAd,#ArticleContentAd,#Banner728x90,#BannerAd,#BannerAds,#BannerAdvert,#BannerAdvertisement,#BigBoxAd,#BigboxAdUnit,#BodyAd,#BodyTopAds,#Body_Ad8_divAdd,#BotAd,#BottomAdContainer,#BottomRightAdWrapper,#ButtonAd,#ContentAd,#Content_CA_AD_0_BC,#Content_CA_AD_1_BC,#DFP_top_leaderboard,#FooterAd,#FooterAdBlock,#FooterAdContainer,#FreeStarVideoAdContainer,#GoogleAd,#GoogleAd1,#GoogleAd2,#GoogleAd3,#GoogleAdRight,#GoogleAdTop,#GoogleAdsense,#HP1-ad,#HP2-ad,#HeadAd,#HeaderAD,#HeaderAd,#HeaderAdBlock,#HeaderAdsBlock,#HeaderTopBanner,#HeaderTopBannerADV,#HeroAd,#HomeAd1,#IFrameAd,#IFrameAd1,#IK-ad-area,#IK-ad-block,#IM_AD,#LayoutBottomAdBox,#LayoutHomeAdBoxBottom,#LeftAd,#LeftAd1,#MPUAdSpace,#MPUadvertising,#MainAd,#NR-Ads,#Player_Playoncontent,#Player_Playoncontent_footer,#PromotionAdBox,#RightAd,#RightAdBlock,#RightAdSpace,#RightAdvertisement,#SidebarAd,#SidebarAdContainer,#SitenavAdslot,#SkyAd,#SkyscraperAD,#SponsoredAd,#SponsoredAds,#SponsoredLinks,#SponsorsAds,#StickyBannerAd,#Top-ad,#TopADs,#TopAd,#TopAd0,#TopAdBox,#TopAdContainer,#TopAdPlacement,#TopAdPos,#TopAdTable,#TopAdvert,#TopBannerAd,#TopRightRadvertisement,#VPNAdvert,#WelcomeAd,#aad-header-1,#aad-header-2,#aad-header-3,#ab_adblock,#above-comments-ad,#above-fold-ad,#above-footer-ads,#aboveAd,#aboveNodeAds,#above_button_ad,#aboveplayerad,#abovepostads,#abp-killer,#acm-ad-tag-lawrence_dfp_mobile_arkadium,#ad--article--home-mobile-paramount-wrapper,#ad--article-bottom-wrapper,#ad--article-top,#ad--sidebar,#ad-0,#ad-1,#ad-125x125,#ad-160,#ad-160x600,#ad-2,#ad-2-160x600,#ad-250,#ad-250x300,#ad-3,#ad-3-300x250,#ad-300,#ad-300-250,#ad-300-additional,#ad-300-detail,#ad-300-sidebar,#ad-300X250-2,#ad-300a,#ad-300b,#ad-300x250,#ad-300x250-0,#ad-300x250-2,#ad-300x250-b,#ad-300x250-sidebar,#ad-300x250-wrapper,#ad-300x250_mid,#ad-300x250_mobile,#ad-300x250_top,#ad-300x600_top,#ad-4,#ad-5,#ad-6,#ad-7,#ad-728,#ad-728-90,#ad-728x90,#ad-8,#ad-9,#ad-Content_1,#ad-Content_2,#ad-Rectangle_1,#ad-Rectangle_2,#ad-Superbanner,#ad-a,#ad-ads,#ad-advertorial,#ad-affiliate,#ad-after,#ad-anchor,#ad-around-the-web,#ad-article,#ad-article-in,#ad-aside-1,#ad-background,#ad-ban,#ad-banner-1,#ad-banner-atf,#ad-banner-bottom,#ad-banner-btf,#ad-banner-desktop,#ad-banner-image,#ad-banner-placement,#ad-banner-top,#ad-banner-wrap,#ad-banner_atf-label,#ad-bar,#ad-base,#ad-bb-content,#ad-below-content,#ad-bg,#ad-big,#ad-bigbox,#ad-bigsize,#ad-billboard,#ad-billboard-atf,#ad-billboard-bottom,#ad-billboard01,#ad-blade,#ad-block,#ad-block-125,#ad-block-2,#ad-block-aa,#ad-block-bottom,#ad-block-container,#ad-block__overlay,#ad-block_overlay,#ad-border,#ad-bottom,#ad-bottom-banner,#ad-bottom-bnr,#ad-bottom-fixed,#ad-bottom-right-container,#ad-bottom-wrapper,#ad-box,#ad-box-1,#ad-box-2,#ad-box-bottom,#ad-box-halfpage,#ad-box-leaderboard,#ad-box-left,#ad-box-rectangle,#ad-box-rectangle-2,#ad-box-right,#ad-box1,#ad-box2,#ad-boxes,#ad-break,#ad-bs,#ad-btm,#ad-buttons,#ad-campaign,#ad-case,#ad-center,#ad-chips,#ad-circfooter,#ad-code,#ad-col,#ad-container-banner,#ad-container-fullpage,#ad-container-inner,#ad-container-leaderboard,#ad-container-mpu,#ad-container-outer,#ad-container-overlay,#ad-container-top-placeholder,#ad-container1,#ad-contentad,#ad-desktop-bottom,#ad-desktop-takeover-home,#ad-desktop-takeover-int,#ad-desktop-top,#ad-desktop-wrap,#ad-discover,#ad-display-ad,#ad-display-ad-placeholder,#ad-div-leaderboard,#ad-drawer,#ad-ear,#ad-extra-flat,#ad-featured-right,#ad-fixed-bottom,#ad-flex-top,#ad-flyout,#ad-footer-728x90,#ad-framework-top,#ad-front-btf,#ad-front-footer,#ad-full-width,#ad-fullbanner-btf,#ad-fullbanner-outer,#ad-fullwidth,#ad-googleAdSense,#ad-gutter-left,#ad-gutter-right,#ad-halfpage,#ad-halfpage1,#ad-halfpage2,#ad-head,#ad-header-1,#ad-header-2,#ad-header-3,#ad-header-banner,#ad-header-left,#ad-header-mad,#ad-header-mobile,#ad-header-right,#ad-holder,#ad-horizontal,#ad-horizontal-header,#ad-horizontal-top,#ad-incontent,#ad-index,#ad-inline-block,#ad-label2,#ad-large-banner-top,#ad-large-header,#ad-lb-secondary,#ad-lead,#ad-leadboard1,#ad-leadboard2,#ad-leader,#ad-leader-atf,#ad-leader-container,#ad-leader-wrapper,#ad-leaderboard,#ad-leaderboard-atf,#ad-leaderboard-bottom,#ad-leaderboard-container,#ad-leaderboard-footer,#ad-leaderboard-header,#ad-leaderboard-spot,#ad-leaderboard-top,#ad-leaderboard970x90home,#ad-leaderboard970x90int,#ad-leaderboard_bottom,#ad-leadertop,#ad-lrec,#ad-m-rec-content,#ad-main,#ad-main-bottom,#ad-main-top,#ad-manager,#ad-masthead,#ad-medium,#ad-medium-lower,#ad-medium-rectangle,#ad-medrec,#ad-medrec__first,#ad-mid,#ad-mid-rect,#ad-middle,#ad-midpage,#ad-minibar,#ad-module,#ad-mpu,#ad-mrec,#ad-mrec2,#ad-new,#ad-north,#ad-one,#ad-other,#ad-output,#ad-overlay,#ad-page-1,#ad-pan3l,#ad-panel,#ad-pencil,#ad-performance,#ad-performanceFullbanner1,#ad-performanceRectangle1,#ad-placeholder,#ad-placeholder-horizontal,#ad-placeholder-vertical,#ad-placement,#ad-plate,#ad-player,#ad-popup,#ad-popup-home,#ad-popup-int,#ad-post,#ad-promo,#ad-push,#ad-pushdown,#ad-r,#ad-rec-atf,#ad-rec-btf,#ad-rec-btf-top,#ad-rect,#ad-rectangle,#ad-rectangle1,#ad-rectangle1-outer,#ad-rectangle2,#ad-rectangle3,#ad-results,#ad-right,#ad-right-bar-tall,#ad-right-container,#ad-right-sidebar,#ad-right-top,#ad-right2,#ad-right3,#ad-row,#ad-section,#ad-separator,#ad-shop,#ad-side,#ad-side-text,#ad-sidebar,#ad-sidebar-btf,#ad-sidebar-container,#ad-sidebar-mad,#ad-sidebar-mad-wrapper,#ad-sidebar1,#ad-sidebar2,#ad-site-header,#ad-skin,#ad-skm-below-content,#ad-sky,#ad-skyscraper,#ad-slideshow,#ad-slideshow2,#ad-slot,#ad-slot-1,#ad-slot-2,#ad-slot-3,#ad-slot-4,#ad-slot-5,#ad-slot-502,#ad-slot-lb,#ad-slot-right,#ad-slot-top,#ad-slot1,#ad-slot2,#ad-slot4,#ad-slug-wrapper,#ad-small-banner,#ad-space,#ad-space-big,#ad-splash,#ad-sponsors,#ad-spot,#ad-spot-bottom,#ad-spot-one,#ad-standard,#ad-standard-wrap,#ad-stickers,#ad-sticky-footer-container,#ad-story-right,#ad-story-top,#ad-stripe,#ad-target,#ad-teaser,#ad-text,#ad-three,#ad-top-250,#ad-top-300x250,#ad-top-728,#ad-top-banner,#ad-top-leaderboard,#ad-top-left,#ad-top-lock,#ad-top-low,#ad-top-right,#ad-top-right-container,#ad-top-text-low,#ad-top-wrap,#ad-top-wrapper,#ad-tower,#ad-two,#ad-undefined,#ad-unit-right-bottom-160-600,#ad-unit-right-middle-300-250,#ad-unit-top-banner,#ad-vip-article,#ad-west,#ad-wide-leaderboard,#ad-wrap,#ad-wrap2,#ad-wrapper-728x90,#ad-wrapper-footer-1,#ad-wrapper-main-1,#ad-wrapper-sidebar-1,#ad-wrapper-top-1,#ad1-placeholder,#ad125x125,#ad160,#ad160600,#ad160x600,#ad250,#ad300,#ad300-250,#ad300_250,#ad336,#ad336x280,#ad468,#ad468x60,#ad480x60,#ad6,#ad600,#ad728,#ad72890,#ad728Box,#ad728Header,#ad728Mid,#ad728Top,#ad728Wrapper,#ad728X90,#ad728foot,#ad728h,#ad728top,#ad728x90,#ad728x90_1,#ad90,#ad900,#ad970,#ad970x90_exp,#adATF300x250,#adATF728x90,#adATFLeaderboard,#adAside,#adBTF300x250,#adBadges,#adBanner1,#adBanner336x280,#adBannerBottom,#adBannerHeader,#adBannerSpacer,#adBannerTable,#adBannerTop,#adBar,#adBelt,#adBillboard,#adBlock01,#adBlockAlert,#adBlockAlertWrap,#adBlockBanner,#adBlockContainer,#adBlockContent,#adBlockDetect,#adBlockOverlay,#adBlockerModal,#adBlocks,#adBottom,#adBox,#adBrandDev,#adBrandingStation,#adBreak,#adCarousel,#adChannel,#adChoiceFooter,#adChoices,#adChoicesIcon,#adChoicesLogo,#adCol,#adColumn,#adColumn3,#adComponentWrapper,#adContainer,#adContainer_1,#adContainer_2,#adContainer_3,#adContent,#adContentHolder,#adContext,#adDiv,#adDiv0,#adDiv1,#adDiv300,#adDiv4,#adDiv728,#adDivContainer,#adFiller,#adFlashDiv,#adFooter,#adFot,#adFrame,#adGallery,#adGoogleText,#adHeader,#adHeaderTop,#adHeaderWrapper,#adHeading,#adHeightstory,#adHolder,#adHolder1,#adHolder2,#adHolder3,#adHolder4,#adHolder5,#adHolder6,#adHome,#adHomeTop,#adIframe,#adInPlayer,#adInhouse,#adIsland,#adLB,#adLabel,#adLarge,#adLayer,#adLayerTop,#adLayout,#adLeader,#adLeaderTop,#adLeaderboard,#adLeaderboard-middle,#adLeft,#adLink,#adLink1,#adLounge,#adLrec,#adMOBILETOP,#adMPU,#adMPUHolder,#adMain,#adMarketplace,#adMed,#adMedRect,#adMediumRectangle,#adMeld,#adMessage,#adMid2,#adMpu,#adMpuBottom,#adOuter,#adPartnerLinks,#adPlaceHolder1,#adPlaceHolder2,#adPlacement_1,#adPlacement_2,#adPlacement_3,#adPlacement_4,#adPlacement_7,#adPlacement_8,#adPlacement_9,#adPlacer,#adPopover,#adPopup,#adPosition0,#adPosition14,#adPosition5,#adPosition6,#adPosition7,#adPosition9,#adPush,#adPushdown1,#adReady,#adRight,#adRight1,#adRight2,#adRight3,#adRight4,#adRight5,#adScraper,#adSection,#adSenseBox,#adSenseModule,#adSenseWrapper,#adSet,#adSide,#adSide1-container,#adSideButton,#adSidebar,#adSite,#adSkin,#adSkinBackdrop,#adSkinLeft,#adSkinRight,#adSky,#adSkyPosition,#adSkyscraper,#adSlider,#adSlot-dmpu,#adSlot-dontMissLarge,#adSlot-leader,#adSlot-leaderBottom,#adSlot1,#adSlot2,#adSlot3,#adSlot4,#adSlug,#adSpace,#adSpaceBottom,#adSpaceHeight,#adSpacer,#adSpecial,#adSqb,#adSquare,#adStrip,#adSuperbanner,#adTag,#adText,#adTextLink,#adTile,#adTop,#adTopContent,#adTopLREC,#adTopLarge,#adTopModule,#adTower,#adUnderArticle,#adUnit,#adWideSkyscraper,#adWrap,#adWrapper,#adWrapperSky,#ad_160,#ad_160_600,#ad_160_600_2,#ad_160x160,#ad_160x600,#ad_250,#ad_250x250,#ad_300,#ad_300_250,#ad_300_250_1,#ad_300x250,#ad_336,#ad_468_60,#ad_468x60,#ad_5,#ad_728,#ad_728_90,#ad_728x90,#ad_8,#ad_9,#ad_B1,#ad_Banner,#ad_Bottom,#ad_LargeRec01,#ad_Middle,#ad_Middle1,#ad_Pushdown,#ad_R1,#ad_Right,#ad_Top,#ad_Wrap,#ad__billboard,#ad_ad,#ad_adsense,#ad_after_header_1,#ad_anchor,#ad_area,#ad_article1_1,#ad_article1_2,#ad_article2_1,#ad_article2_2,#ad_article3_1,#ad_article3_2,#ad_banner_1,#ad_banner_468x60,#ad_banner_728x90,#ad_banner_bot,#ad_banner_top,#ad_banners,#ad_bar,#ad_bar_rect,#ad_before_header,#ad_bg,#ad_bg_image,#ad_big,#ad_bigbox,#ad_bigbox_companion,#ad_bigrectangle,#ad_billboard,#ad_block,#ad_block_0,#ad_block_1,#ad_block_2,#ad_block_mpu,#ad_bnr_atf_01,#ad_bnr_atf_02,#ad_bnr_atf_03,#ad_bnr_btf_07,#ad_bnr_btf_08,#ad_body,#ad_bottom,#ad_box,#ad_box_top,#ad_branding,#ad_bsb,#ad_bsb_cont,#ad_btmslot,#ad_button,#ad_buttons,#ad_cell,#ad_center,#ad_choices,#ad_close,#ad_closebtn,#ad_comments,#ad_cont,#ad_cont_superbanner,#ad_container,#ad_container_0,#ad_container_300x250,#ad_container_side,#ad_container_sidebar,#ad_container_top,#ad_content,#ad_content_1,#ad_content_2,#ad_content_3,#ad_content_fullsize,#ad_content_primary,#ad_content_right,#ad_content_top,#ad_content_wrap,#ad_contentslot_1,#ad_contentslot_2,#ad_creative_2,#ad_creative_3,#ad_creative_5,#ad_dfp_rec1,#ad_display_300_250,#ad_display_728_90,#ad_div,#ad_div_bottom,#ad_div_top,#ad_feedback,#ad_foot,#ad_footer,#ad_footer1,#ad_footerAd,#ad_frame,#ad_frame1,#ad_from_bottom,#ad_fullbanner,#ad_gallery,#ad_gallery_bot,#ad_global_300x250,#ad_global_above_footer,#ad_global_below_navbar,#ad_global_header,#ad_global_header1,#ad_global_header2,#ad_h3,#ad_halfpage,#ad_head,#ad_header,#ad_header_1,#ad_header_container,#ad_holder,#ad_home,#ad_home_middle,#ad_horizontal,#ad_houseslot_a,#ad_houseslot_b,#ad_hp,#ad_img,#ad_interthread,#ad_island,#ad_island2,#ad_label,#ad_large,#ad_large_rectangular,#ad_lateral,#ad_layer,#ad_ldb,#ad_lead1,#ad_leader,#ad_leaderBoard,#ad_leaderboard,#ad_leaderboard_top,#ad_left,#ad_left_1,#ad_left_2,#ad_left_3,#ad_left_skyscraper,#ad_left_top,#ad_leftslot,#ad_links,#ad_links_footer,#ad_lnk,#ad_lrec,#ad_lwr_square,#ad_main,#ad_main_leader,#ad_main_top,#ad_marginal,#ad_marker,#ad_mast,#ad_med_rect,#ad_medium,#ad_medium_rectangle,#ad_medium_rectangular,#ad_mediumrectangle,#ad_message,#ad_middle,#ad_middle_bottom,#ad_midstrip,#ad_mobile,#ad_module,#ad_mpu,#ad_mpu2,#ad_mpu300x250,#ad_mrec,#ad_mrec1,#ad_mrec2,#ad_mrec_intext,#ad_mrec_intext2,#ad_new,#ad_news_article,#ad_newsletter,#ad_one,#ad_overlay,#ad_overlayer,#ad_panel,#ad_panorama_top,#ad_pencil,#ad_place,#ad_placeholder,#ad_player,#ad_plugs,#ad_popup_background,#ad_popup_wrapper,#ad_post,#ad_poster,#ad_primary,#ad_publicidad,#ad_rail,#ad_rec_01,#ad_rect,#ad_rect1,#ad_rect2,#ad_rect3,#ad_rect_body,#ad_rect_bottom,#ad_rect_btf_01,#ad_rect_btf_02,#ad_rect_btf_03,#ad_rect_btf_04,#ad_rect_btf_05,#ad_rectangle,#ad_region1,#ad_region2,#ad_region3,#ad_region5,#ad_results {display: none !important; color: #00b3dd !important; background-color: #db1dff !important;}#ad_right,#ad_right_box,#ad_right_top,#ad_rightslot,#ad_rotator-2,#ad_rotator-3,#ad_row,#ad_row_home,#ad_rr_1,#ad_sec,#ad_sec_div,#ad_secondary,#ad_short,#ad_sidebar,#ad_sidebar1,#ad_sidebar2,#ad_sidebar3,#ad_sidebar_1,#ad_sidebar_left_container,#ad_sidebar_news,#ad_sidebar_top,#ad_sidebody,#ad_site_header,#ad_sitebar,#ad_skin,#ad_slot,#ad_slot_bottom,#ad_slot_leaderboard,#ad_small,#ad_space_top,#ad_sponsored,#ad_spot_a,#ad_spot_b,#ad_spotlight,#ad_square,#ad_squares,#ad_ss,#ad_stck,#ad_sticky_wrap,#ad_strip,#ad_superbanner,#ad_table,#ad_takeover,#ad_tall,#ad_tbl,#ad_topBanner,#ad_topScroller,#ad_top_728x90,#ad_top_banner,#ad_top_bar,#ad_top_holder,#ad_topbanner,#ad_topmob,#ad_topnav,#ad_topslot,#ad_two,#ad_txt,#ad_under_game,#ad_unit,#ad_unit1,#ad_unit2,#ad_vertical,#ad_video_abovePlayer,#ad_video_belowPlayer,#ad_video_large,#ad_video_root,#ad_wallpaper,#ad_wide,#ad_wide_box,#ad_wideboard,#ad_widget,#ad_widget_1,#ad_window,#ad_wp,#ad_wp_base,#ad_wrap,#ad_wrapper,#ad_wrapper1,#ad_wrapper2,#ad_xrail_top,#ad_zone,#adaptvcompanion,#adb-actived,#adb-enabled,#adb-enabled3,#adb-warning,#adb_bottom,#adbackground,#adbanner-container,#adbanner1,#adbannerbox,#adbannerdiv,#adbannerleft,#adbannerright,#adbannerwidget,#adbig,#adblade,#adblade_ad,#adblock-alert,#adblock-big,#adblock-box,#adblock-leaderboard,#adblock-modal,#adblock-msg,#adblock-overlay,#adblock-small,#adblock1,#adblock2,#adblock4,#adblockDetect,#adblockOverlay,#adblock_detected,#adblock_message,#adblock_screen,#adblock_tooltip,#adblockbottom,#adblocker_announce,#adblocker_message,#adblocker_modal_overlay,#adblocks-detected,#adbn,#adbnr,#adboard,#adbody,#adbottom,#adbottomleft,#adbottomright,#adbox--hot_news_ad,#adbox--page_bottom_ad,#adbox--page_top_ad,#adbox-inarticle,#adbox-topbanner,#adbox1,#adbox2,#adbox_content,#adbox_right,#adbutton,#adbuttons,#adcell,#adcenter,#adcenter2,#adcenter4,#adchoices-icon,#adchoicesBtn,#adclear,#adclose,#adcolContent,#adcolumn,#adcontainer2,#adcontainer3,#adcontainer5,#adcontainerRight,#adcontainer_ad_content_top,#adcontent1,#adcontent2,#adcontextlinks,#addbottomleft,#addemam-wrapper,#addvert,#adfactor-label,#adfloat,#adfooter,#adfooter_728x90,#adframe:not(frameset),#adframetop,#adfreeDeskSpace,#adhalfpage,#adhead,#adheader,#adhesionAdSlot,#adhesionUnit,#adhide,#adholder,#adholderContainerHeader,#adhome,#adhomepage,#adjacency,#adlabel,#adlabelFooter,#adlabelfooter,#adlabelheader,#adlanding,#adlayer,#adlayerContainer,#adlayerad,#adleaderboard,#adleft,#adlinks,#adlrec,#adm-inline-article-ad-1,#adm-inline-article-ad-2,#admain,#admasthead,#admid,#admobilefoot,#admobilefootinside,#admobilemiddle,#admobiletop,#admobiletopinside,#admod2,#admpubottom,#admpubottom2,#admpufoot,#admpumiddle,#admpumiddle2,#admputop2,#admsg,#adnet,#adnorth,#ados1,#ados2,#ados3,#ados4,#adplace,#adplacement,#adpos-top,#adpos2,#adposition,#adposition1,#adposition10,#adposition1_container,#adposition2,#adposition3,#adposition4,#adpositionbottom,#adrect,#adright,#adright2,#adrightbottom,#adrightrail,#adriver_middle,#adriver_top,#adrotator,#adrow,#adrow1,#adrow3,#ads-1,#ads-125,#ads-200,#ads-250,#ads-300,#ads-300-250,#ads-336x280,#ads-468,#ads-5,#ads-728x90,#ads-728x90-I3,#ads-728x90-I4,#ads-area,#ads-article-left,#ads-banner,#ads-banner-top,#ads-bar,#ads-before-content,#ads-bg,#ads-bg-mobile,#ads-billboard,#ads-block,#ads-blog,#ads-bot,#ads-bottom,#ads-col,#ads-container,#ads-container-2,#ads-container-anchor,#ads-container-single,#ads-container-top,#ads-content,#ads-content-double,#ads-footer,#ads-footer-inner,#ads-footer-wrap,#ads-google,#ads-header-728,#ads-home-468,#ads-horizontal,#ads-inread,#ads-inside-content,#ads-leader,#ads-leaderboard,#ads-leaderboard1,#ads-left-top,#ads-lrec,#ads-main,#ads-middle,#ads-mpu,#ads-outer,#ads-pagetop,#ads-panel,#ads-pop,#ads-position-header-desktop,#ads-right,#ads-right-bottom,#ads-right-skyscraper,#ads-right-top,#ads-slot,#ads-space,#ads-superBanner,#ads-text,#ads-top,#ads-top-728,#ads-top-wrap,#ads-under-rotator,#ads-vertical,#ads-vertical-wrapper,#ads-wrap,#ads1,#ads120,#ads125,#ads1_box,#ads2,#ads2_block,#ads2_box,#ads2_container,#ads3,#ads300,#ads300-250,#ads300x200,#ads300x250,#ads300x250_2,#ads336x280,#ads4,#ads468x60,#ads50,#ads7,#ads728,#ads728bottom,#ads728top,#ads728x90,#ads728x90_2,#ads728x90top,#adsBar,#adsBottom,#adsContent,#adsDisplay,#adsHeader,#adsHeading,#adsLREC,#adsLeft,#adsLinkFooter,#adsMobileFixed,#adsMpu,#adsPanel,#adsRight,#adsRightDiv,#adsSectionLeft,#adsSectionRight,#adsSquare,#adsTG,#adsTN,#adsTop,#adsTopLeft,#adsTopMobileFixed,#adsZone,#adsZone1,#adsZone2,#ads_0_container,#ads_160,#ads_3,#ads_300x250,#ads_4,#ads_728,#ads_728x90,#ads_728x90_top,#ads_banner,#ads_banner1,#ads_banner_header,#ads_belownav,#ads_big,#ads_block,#ads_body_1,#ads_body_2,#ads_body_3,#ads_body_4,#ads_body_5,#ads_body_6,#ads_bottom,#ads_box,#ads_box1,#ads_box2,#ads_box_bottom,#ads_box_right,#ads_box_top,#ads_button,#ads_campaign,#ads_catDiv,#ads_center,#ads_center_banner,#ads_central,#ads_combo2,#ads_container,#ads_content,#ads_desktop_r1,#ads_desktop_r2,#ads_expand,#ads_footer,#ads_fullsize,#ads_h,#ads_h1,#ads_h2,#ads_halfsize,#ads_header,#ads_horiz,#ads_horizontal,#ads_horz,#ads_in_modal,#ads_in_video,#ads_insert_container,#ads_layout_bottom,#ads_lb,#ads_lb_frame,#ads_leaderbottom,#ads_left,#ads_left_top,#ads_line,#ads_medrect,#ads_notice,#ads_overlay,#ads_page_top,#ads_place,#ads_placeholder,#ads_player,#ads_popup,#ads_right,#ads_right_sidebar,#ads_right_top,#ads_slide_div,#ads_space,#ads_space_header,#ads_superbanner1,#ads_superbanner2,#ads_superior,#ads_td,#ads_text,#ads_textlinks,#ads_title,#ads_top2,#ads_top:not(a),#ads_top_banner,#ads_top_container,#ads_top_content,#ads_top_right,#ads_top_sec,#ads_topbanner,#ads_tower_top,#ads_vert,#ads_video,#ads_wide,#ads_wrapper,#adsbot,#adsbottom,#adsbox,#adsbox-left,#adsbox-right,#adscenter,#adscolumn,#adscontainer,#adscontent,#adsdiv,#adsection,#adsense-2,#adsense-468x60,#adsense-area,#adsense-bottom,#adsense-container-bottom,#adsense-header,#adsense-link,#adsense-links,#adsense-middle,#adsense-post,#adsense-right,#adsense-sidebar,#adsense-tag,#adsense-text,#adsense-top,#adsense-wrap,#adsense1,#adsense2,#adsense468,#adsense6,#adsense728,#adsenseArea,#adsenseContainer,#adsenseHeader,#adsenseLeft,#adsenseWrap,#adsense_banner_top,#adsense_block,#adsense_bottom_ad,#adsense_box,#adsense_box2,#adsense_center,#adsense_image,#adsense_inline,#adsense_leaderboard,#adsense_overlay,#adsense_r_side_sticky_container,#adsense_sidebar,#adsense_top,#adsenseheader,#adsensehorizontal,#adsensempu,#adsenseskyscraper,#adsensetext,#adsensetop,#adserv,#adsframe_2,#adside,#adsimage,#adsitem,#adskeeper,#adskinleft,#adskinlink,#adskinright,#adskintop,#adsky,#adskyscraper,#adskyscraper_flex,#adsleft1,#adslider,#adslist,#adslot-below-updated,#adslot-download-abovefiles,#adslot-half-page,#adslot-homepage-middle,#adslot-infobox,#adslot-left-skyscraper,#adslot-side-mrec,#adslot-site-footer,#adslot-site-header,#adslot-sticky-headerbar,#adslot-top-rectangle,#adslot1,#adslot2,#adslot3,#adslot300x250ATF,#adslot300x250BTF,#adslot4,#adslot5,#adslot6,#adslot7,#adslot_1,#adslot_2,#adslot_left,#adslot_rect,#adslot_top,#adsmgid,#adsmiddle,#adsonar,#adspace-1,#adspace-2,#adspace-300x250,#adspace-728,#adspace-728x90,#adspace-bottom,#adspace-leaderboard-top,#adspace-one,#adspace-top,#adspace300x250,#adspaceBox,#adspaceRow,#adspace_header,#adspace_leaderboard,#adspace_top,#adspacer,#adspan,#adsplace1,#adsplace2,#adsplace4,#adsplash,#adspot,#adspot-bottom,#adspot-top,#adsquare,#adsquare2,#adsright,#adsside,#adsspace,#adstext2,#adstrip,#adtab,#adtext,#adtxt,#adunit,#adunit-article-bottom,#adunit_video,#adunitl,#adv-01,#adv-300,#adv-Bottom,#adv-BoxP,#adv-Middle,#adv-Middle1,#adv-Middle2,#adv-Scrollable,#adv-Top,#adv-banner,#adv-banner-r,#adv-box,#adv-companion-iframe,#adv-container,#adv-gpt-box-container1,#adv-gpt-masthead-skin-container1,#adv-halfpage,#adv-header,#adv-leaderblock,#adv-leaderboard,#adv-left,#adv-masthead,#adv-middle,#adv-middle1,#adv-midroll,#adv-native,#adv-preroll,#adv-right,#adv-right1,#adv-scrollable,#adv-sticky-1,#adv-sticky-2,#adv-title,#adv-top-skin,#adv300x250,#adv300x250container,#adv468x90,#adv728,#adv728x90,#adv768x90,#advBoxBottom,#advCarrousel,#advHome,#advHook-Middle1,#advRectangle,#advRectangle1,#advSkin,#advTop,#advWrapper,#adv_300,#adv_728,#adv_728x90,#adv_BoxBottom,#adv_Inread,#adv_IntropageOvl,#adv_LdbMastheadPush,#adv_Reload,#adv_Skin,#adv_bootom,#adv_border,#adv_center,#adv_config,#adv_container,#adv_contents,#adv_footer,#adv_holder,#adv_leaderboard,#adv_mob,#adv_mpu1,#adv_mpu2,#adv_network,#adv_overlay,#adv_overlay_content,#adv_r,#adv_right,#adv_skin,#adv_sky,#adv_textlink,#adv_top,#adv_wallpaper,#adv_wallpaper2,#advads_ad_widget-18,#advads_ad_widget-19,#advads_ad_widget-8,#adver,#adver-top,#adverFrame,#advert-1,#advert-120,#advert-2,#advert-ahead,#advert-article,#advert-article-1,#advert-article-2,#advert-article-3,#advert-banner,#advert-banner-container,#advert-banner-wrap,#advert-banner2,#advert-block,#advert-boomer,#advert-box,#advert-column,#advert-container-top,#advert-display,#advert-fireplace,#advert-footer,#advert-footer-hidden,#advert-header,#advert-island,#advert-leaderboard,#advert-left,#advert-mpu,#advert-posterad,#advert-rectangle,#advert-right,#advert-sky,#advert-skyscaper,#advert-skyscraper,#advert-slider-top,#advert-text,#advert-top,#advert-top-banner,#advert-wrapper,#advert1,#advert2,#advertBanner,#advertBox,#advertBoxRight,#advertBoxSquare,#advertColumn,#advertContainer,#advertDB,#advertOverlay,#advertRight,#advertSection,#advertTop,#advertTopLarge,#advertTopSmall,#advertTower,#advertWrapper,#advert_1,#advert_banner,#advert_belowmenu,#advert_box,#advert_container,#advert_header,#advert_leaderboard,#advert_mid,#advert_mpu,#advert_right1,#advert_sky,#advert_top,#advertblock,#advertborder,#adverticum_r_above,#adverticum_r_above_container,#adverticum_r_side_container,#advertise-block,#advertise-here,#advertise-sidebar,#advertise1,#advertise2,#advertiseBanner,#advertiseLink,#advertise_top,#advertisediv,#advertisement-300x250,#advertisement-bottom,#advertisement-content,#advertisement-large,#advertisement-placement,#advertisement-text,#advertisement1,#advertisement2,#advertisement3,#advertisement728x90,#advertisementArea,#advertisementBox,#advertisementHorizontal,#advertisementRight,#advertisementTop,#advertisement_banner,#advertisement_belowscreenshots,#advertisement_block,#advertisement_box,#advertisement_container,#advertisement_label,#advertisement_notice,#advertisement_title,#advertisementjsalert,#advertisements_bottom,#advertisements_sidebar,#advertisements_top,#advertisementsarticle,#advertiser-container,#advertiserLinks,#advertisetop,#advertising-160x600,#advertising-300x250,#advertising-728x90,#advertising-banner,#advertising-caption,#advertising-container,#advertising-right,#advertising-skyscraper,#advertising-top,#advertisingHrefTop,#advertisingLeftLeft,#advertisingLink,#advertisingRightColumn,#advertisingRightRight,#advertisingTop,#advertisingTopWrapper,#advertising_300,#advertising_320,#advertising_728,#advertising__banner__content,#advertising_column,#advertising_container,#advertising_contentad,#advertising_div,#advertising_header,#advertising_holder,#advertising_leaderboard,#advertising_top_container,#advertising_wrapper,#advertisment-horizontal,#advertisment-text,#advertisment1,#advertisment_content,#advertisment_panel,#advertleft,#advertorial,#advertorial-box,#advertorial-wrap,#advertorial1,#advertorial_links,#adverts,#adverts--footer,#adverts-top-container,#adverts-top-left,#adverts-top-middle,#adverts-top-right,#adverts_base,#adverts_post_content,#adverts_right,#advertscroll,#advertsingle,#advertspace,#advertssection,#adverttop,#advframe,#advr_mobile,#advsingle,#advt,#advt_bottom,#advtbar,#advtcell,#advtext,#advtop,#advtopright,#adwallpaper,#adwidget,#adwidget-5,#adwidget-6,#adwidget1,#adwidget2,#adwrapper,#adxBigAd,#adxBigAd2,#adxLeaderboard,#adxMiddle,#adxMiddleRight,#adxToolSponsor,#adx_ad,#adxtop2,#adzbanner,#adzone,#adzone-middle1,#adzone-middle2,#adzone-right,#adzone-top,#adzone_content,#adzone_wall,#adzonebanner,#adzoneheader,#afc-container,#affiliate_2,#affiliate_ad,#after-dfp-ad-mid1,#after-dfp-ad-mid2,#after-dfp-ad-mid3,#after-dfp-ad-mid4,#after-dfp-ad-top,#after-header-ads,#after-top-menu-ads,#after_ad,#after_bottom_ad,#after_heading_ad,#after_title_ad,#aigirlfriendad,#amazon-ads,#amazon_ad,#analytics_ad,#anchor-ad,#anchorAd,#aniview--player,#aniview-ads,#anti_adblock,#aom-ad-right_side_1,#aom-ad-right_side_2,#aom-ad-top,#apiBackgroundAd,#around-the-web,#article-ad,#article-ad-container,#article-ad-content,#article-ads,#article-advert,#article-aside-top-ad,#article-billboard-ad-1,#article-bottom-ad,#article-box-ad,#article-content-ad,#article-footer-ad,#article-footer-sponsors,#article-island-ad,#article-sidebar-ad,#articleAd,#articleAdReplacement,#articleBoard-ad,#articleBottom-ads,#articleLeftAdColumn,#articleSideAd,#articleTop-ads,#article_ad_1,#article_ad_3,#article_ad_bottom,#article_ad_container,#article_ad_top,#article_ad_w,#article_adholder,#article_ads,#article_advert,#article_banner_ad,#article_body_ad1,#article_box_ad,#articlead300x250r,#articleadblock,#articlefootad,#articletop_ad,#aside-ad-container,#asideAd,#aside_ad,#asideads,#asinglead,#ax-billboard,#ax-billboard-bottom,#ax-billboard-sub,#ax-billboard-top,#backad,#background-ad-cover,#background-adv,#background_ad_left,#background_ad_right,#background_ads,#background_banner_wrapper,#backgroundadvert,#banADbanner,#banner-300x250,#banner-468x60,#banner-728,#banner-728x90,#banner-ad-container,#banner-ad-large,#banner-ads,#banner-advert,#banner-lg-ad,#banner-native-ad,#banner-skyscraper,#banner300x250,#banner468,#banner468x60,#banner728,#banner728x90,#bannerAd,#bannerAdFrame,#bannerAdTop,#bannerAdWrap,#bannerAdWrapper,#bannerAds,#bannerAdsense,#bannerAdvert,#bannerGoogle,#banner_ad_bottom,#banner_ad_footer,#banner_ad_module,#banner_ad_placeholder,#banner_ad_top,#banner_ads,#banner_adsense,#banner_adv,#banner_advertisement,#banner_adverts,#banner_content_ad,#banner_pos1_ddb_0,#banner_pos2_ddb_0,#banner_pos3_ddb_0,#banner_pos4_ddb_0,#banner_sedo,#banner_slot,#banner_spacer {display: none !important; color: #00b3dd !important; background-color: #db1dff !important;}#banner_topad,#banner_videoad,#banner_wrapper_top,#bannerad-bottom,#bannerad-top,#bannerad2,#banneradrow,#bannerads,#banneradspace,#banneradvert3,#banneradvertise,#bannerplayer-wrap,#bannerpop,#baseboard-ad,#baseboard-ad-wrapper,#bbContentAds,#bb_ad_container,#bb_top_ad,#bbadwrap,#before-footer-ad,#below-listings-ad,#below-menu-ad-header,#below-post-ad,#below-title-ad,#belowAd,#belowContactBoxAd,#belowNodeAds,#below_content_ad_container,#belowad,#belowheaderad,#bg-custom-ad,#bgad,#big-box-ad,#bigAd,#bigAd1,#bigAd2,#bigAdDiv,#bigBoxAd,#bigBoxAdCont,#big_ad,#big_ad_label,#big_ads,#bigad,#bigadbox,#bigads,#bigadspace,#bigadspot,#bigboard_ad,#bigsidead,#billboard-ad,#billboard-atf,#billboard_ad,#bingadcontainer2,#blkAds1,#blkAds2,#blkAds3,#blkAds4,#blkAds5,#block-ad-articles,#block-adsense-0,#block-adsense-2,#block-adsense-banner-article-bottom,#block-adsense-banner-channel-bottom,#block-adsenseleaderboard,#block-advertisement,#block-advertorial,#block-articlebelowtextad,#block-articlefrontpagead,#block-articletopadvert,#block-boxes-taboola,#block-dfp-top,#block-frontpageabovepartnersad,#block-frontpagead,#block-frontpagesideadvert1,#block-google-ads,#block-googleads3,#block-googleads3-2,#block-openads-0,#block-openads-1,#block-openads-13,#block-openads-14,#block-openads-2,#block-openads-3,#block-openads-4,#block-openads-5,#block-sponsors,#block-taboolablock,#blockAd,#blockAds,#block_ad,#block_ad2,#block_ad_container,#block_advert,#block_advert1,#block_advert2,#block_advertisement,#blog-ad,#blog-advert,#blogad,#blogad-wrapper,#blogads,#bm-HeaderAd,#bn_ad,#bnr-300x250,#bnr-468x60,#bnr-728x90,#bnrAd,#body-ads,#bodyAd1,#bodyAd2,#bodyAd3,#bodyAd4,#body_ad,#body_centered_ad,#bottom-ad,#bottom-ad-1,#bottom-ad-area,#bottom-ad-banner,#bottom-ad-container,#bottom-ad-leaderboard,#bottom-ad-slot,#bottom-ad-tray,#bottom-ad-wrapper,#bottom-add,#bottom-adhesion,#bottom-adhesion-container,#bottom-ads,#bottom-ads-bar,#bottom-ads-container,#bottom-adspot,#bottom-advertising,#bottom-bnr,#bottom-boxad,#bottom-not-ads,#bottom-side-ad,#bottom-sponsor-add,#bottomAd,#bottomAd300,#bottomAdBlcok,#bottomAdContainer,#bottomAdSection,#bottomAdSense,#bottomAdSenseDiv,#bottomAdWrapper,#bottomAds,#bottomAdvBox,#bottomBannerAd,#bottomContentAd,#bottomDDAd,#bottomLeftAd,#bottomMPU,#bottomRightAd,#bottom_ad,#bottom_ad_728,#bottom_ad_area,#bottom_ad_box,#bottom_ad_region,#bottom_ad_unit,#bottom_ad_wrapper,#bottom_adbox,#bottom_ads,#bottom_adwrapper,#bottom_banner,#bottom_banner_ad,#bottom_fixed_ad_overlay,#bottom_leader_ad,#bottom_player_adv,#bottom_sponsor_ads,#bottom_sponsored_links,#bottom_text_ad,#bottomad,#bottomad300,#bottomad_table,#bottomadbanner,#bottomadbar,#bottomadholder,#bottomads,#bottomadsdiv,#bottomadsense,#bottomadvert,#bottomadwrapper,#bottomcontentads,#bottomleaderboardad,#bottommpuAdvert,#bottommpuSlot,#bottomsponad,#bottomsponsoredresults,#box-ad,#box-ad-section,#box-ad-sidebar,#box-content-ad,#box1ad,#box2ad,#boxAD,#boxAd,#boxAd300,#boxAdContainer,#boxAdvert,#boxLREC,#box_ad,#box_ad_container,#box_ad_middle,#box_ads,#box_advertisement,#box_advertisment,#box_articlead,#box_text_ads,#boxad,#boxads,#bpAd,#br-ad-header,#breadcrumb_ad,#breakbarad,#bsa_add_holder_g,#bt-ad,#bt-ad-header,#btfAdNew,#btm_ad,#btm_ads,#btmad,#btnAdDP,#btnAds,#btnads,#btopads,#button-ads,#button_ad_container,#button_ads,#buy-sell-ads,#buySellAds,#buysellads,#carbon-ads-container-bg,#carbonadcontainer,#carbonads,#carbonads-container,#card-ads-top,#category-ad,#category-sponsor,#cellAd,#center-ad,#center-ad-group,#ch-ad-outer-right,#ch-ads,#channel_ad,#channel_ads,#circ_ad,#circ_ad_holder,#circad_wrapper,#classifiedsads,#clickforad,#clientAds,#closeAdsDiv,#closeable-ad,#cmg-video-player-placeholder,#col-right-ad,#colAd,#columnAd,#commentAdWrapper,#commentTopAd,#comment_ad_zone,#comments-ad-container,#comments-ads,#compAdvertisement,#companion-ad,#companionAd,#companionAdDiv,#companion_Ad,#companionad,#component-taboola-below-article-feed,#component-taboola-below-article-feed-2,#component-taboola-below-homepage-feed,#connatix,#connatix-moveable,#connatix_placeholder_desktop,#container-ad,#container_ad,#content-ad,#content-ad-side,#content-ads,#content-adver,#content-contentad,#content-header-ad,#contentAd,#contentAdSense,#contentAdTwo,#contentAds,#contentBoxad,#content_Ad,#content_ad,#content_ad_1,#content_ad_2,#content_ad_block,#content_ad_container,#content_ad_placeholder,#content_ads,#content_ads_top,#content_adv,#content_bottom_ad,#content_bottom_ads,#content_mpu,#contentad,#contentads,#contextad,#contextual-ads,#contextual-ads-block,#contextualad,#cornerad,#coverads,#criteoAd,#cubeAd,#cube_ad,#cube_ads,#customAd,#customAds,#customad,#ddb_fluid_native_ddb_0,#desktop-ad-top,#desktop-sidebar-ad,#desktop_middle_ad_fixed,#desktop_top_ad_fixed,#detectadblock,#dfp-ad-bottom-wrapper,#dfp-ad-container,#dfp-ad-floating,#dfp-ad-leaderboard,#dfp-ad-leaderboard-wrapper,#dfp-ad-medium_rectangle,#dfp-ad-mediumrect-wrapper,#dfp-ad-mpu1,#dfp-ad-mpu2,#dfp-ad-right1,#dfp-ad-right1-wrapper,#dfp-ad-right2,#dfp-ad-right2-wrapper,#dfp-ad-right3,#dfp-ad-right4-wrapper,#dfp-ad-slot2,#dfp-ad-slot3,#dfp-ad-slot3-wrapper,#dfp-ad-slot4-wrapper,#dfp-ad-slot5,#dfp-ad-slot5-wrapper,#dfp-ad-slot6,#dfp-ad-slot6-wrapper,#dfp-ad-slot7,#dfp-ad-slot7-wrapper,#dfp-ad-top-wrapper,#dfp-article-mpu,#dfp-atf,#dfp-atf-desktop,#dfp-banner,#dfp-banner-popup,#dfp-billboard1,#dfp-billboard2,#dfp-btf,#dfp-btf-desktop,#dfp-footer-desktop,#dfp-header,#dfp-header-container,#dfp-ia01,#dfp-ia02,#dfp-interstitial,#dfp-leaderboard,#dfp-leaderboard-desktop,#dfp-masthead,#dfp-middle,#dfp-middle1,#dfp-mtf,#dfp-mtf-desktop,#dfp-rectangle,#dfp-rectangle1,#dfp-ros-res-header_container,#dfp-tlb,#dfp-top-banner,#dfpAd,#dfp_ad_mpu,#dfp_ads_4,#dfp_ads_5,#dfp_bigbox_2,#dfp_bigbox_recipe_top,#dfp_container,#dfp_leaderboard,#dfpad-0,#dfpslot_tow_2-0,#dfpslot_tow_2-1,#dfrads-widget-3,#dfrads-widget-6,#dfrads-widget-7,#dianomiNewsBlock,#dict-adv,#direct-ad,#disable-ads-container,#display-ads,#displayAd,#displayAdSet,#display_ad,#displayad_carousel,#displayad_rectangle,#div-ad-1x1,#div-ad-bottom,#div-ad-flex,#div-ad-inread,#div-ad-leaderboard,#div-ad-r,#div-ad-r1,#div-ad-top,#div-ad-top_banner,#div-adcenter1,#div-adcenter2,#div-advert,#div-contentad_1,#div-footer-ad,#div-gpt-LDB1,#div-gpt-MPU1,#div-gpt-MPU2,#div-gpt-MPU3,#div-gpt-Skin,#div-gpt-inline-main,#div-gpt-mini-leaderboard1,#div-gpt-mrec,#div-insticator-ad-1,#div-insticator-ad-2,#div-insticator-ad-3,#div-insticator-ad-4,#div-insticator-ad-5,#div-insticator-ad-6,#div-insticator-ad-9,#div-leader-ad,#div-social-ads,#divAd,#divAdDetail,#divAdHere,#divAdHorizontal,#divAdLeft,#divAdMain,#divAdRight,#divAdWrapper,#divAds,#divAdsTop,#divAdv300x250,#divAdvertisement,#divBannerSlider,#divDoubleAd,#divFoldersAd,#divFooterAd,#divFooterAds,#divSponAds,#divSponAds + *,#divSponsoredLinks,#divStoryBigAd1,#divThreadAdBox,#divTopAd,#divTopAds,#divWrapper_Ad,#div_ad_TopRight,#div_ad_float,#div_ad_holder,#div_ad_leaderboard,#div_advt_right,#div_belowAd,#div_bottomad,#div_bottomad_container,#div_googlead,#divadfloat,#dnn_adSky,#dnn_adTop,#dnn_ad_banner,#dnn_ad_island1,#dnn_ad_skyscraper,#dnn_sponsoredLinks,#downloadAd,#download_ad,#download_ads,#dragads,#ds-mpu,#dsStoryAd,#dsk-banner-ad-a,#dsk-banner-ad-b,#dsk-banner-ad-c,#dsk-banner-ad-d,#dsk-box-ad-c,#dsk-box-ad-d,#dsk-box-ad-f,#dsk-box-ad-g,#dv-gpt-ad-bigbox-wrap,#dynamicAdDiv,#em_ad_superbanner,#embedAD,#embedADS,#embed__pre[style^="width: 612px; height: 300px;"],#ero_fade_banner,#event_ads,#events-adv-side1,#events-adv-side2,#events-adv-side3,#events-adv-side4,#events-adv-side5,#events-adv-side6,#exoAd,#external-floater-ad-wrap,#externalAd,#ezmob_footer,#ezmobfooter,#fallbackTerms.fallback-term-holder,#featureAd,#featureAdSpace,#featureAds,#feature_ad,#featuread,#featured-ads,#featuredAds,#first-ads,#first_ad,#firstad,#fixed-ad,#fixedAd,#fixedban,#floatAd,#floatads,#floating-ad-wrapper,#floating-ads,#floating-advert,#floatingAd,#floatingAdContainer,#floatingAds,#floating_ad,#floating_ad_container,#floating_ads_bottom_textcss_container,#floorAdWrapper,#fnAdblockingOverlay,#foot-ad-wrap,#foot-ad2-wrap,#footAd,#footAdArea,#footAds,#footad,#footer-ad,#footer-ad-728,#footer-ad-block,#footer-ad-box,#footer-ad-col,#footer-ad-google,#footer-ad-large,#footer-ad-slot,#footer-ad-unit,#footer-ad-wrapper,#footer-adspace,#footer-adv,#footer-advert,#footer-advert-area,#footer-advertisement,#footer-adverts,#footer-adwrapper,#footer-affl,#footer-banner-ad,#footer-leaderboard-ad,#footer-sponsored,#footer-sponsors,#footerAd,#footerAdBottom,#footerAdBox,#footerAdDiv,#footerAdWrap,#footerAdd,#footerAds,#footerAdsPlacement,#footerAdvert,#footerAdvertisement,#footerAdverts,#footerGoogleAd,#footer_AdArea,#footer_ad_block,#footer_ad_container,#footer_ad_frame,#footer_ad_holder,#footer_adcode,#footer_add,#footer_addvertise,#footer_ads,#footer_ads_holder,#footer_adspace,#footer_adv,#footer_advertising,#footer_leaderboard_ad,#footer_text_ad,#footerad,#footerad728,#footerads,#footeradsbox,#footeradvert,#forum-top-ad-bar,#frameAd,#frmSponsAds,#front-ad-cont,#front-page-ad,#front-page-advert,#frontPageAd,#front_advert,#front_mpu,#ft-ad,#ft-ads,#full_banner_ad,#fwAdBox,#g-outbrain,#gAds,#gStickyAd,#g_ad,#g_adsense,#gad300x250,#gad728x90,#gads300x250,#gadsOverlayUnit,#gads_middle,#gallery-ad,#gallery-ad-container,#gallery-advert,#gallery-below-line-advert,#gallery-sidebar-advert,#gallery_ad,#gallery_ads,#gallery_header_ad,#galleryad1,#gam-ad-ban1,#gam-ad-doubleMpu-1,#gam-ad-mpu-1,#gam-ad-mpu-2,#gam-ad-mpu-3,#gam-ad-mpu-4,#gam-ad-mpuLeaderboard-leaderboard-1,#gam-ad-mpuLeaderboard-leaderboard-2,#gam-ad-mpuLeaderboard-leaderboard-3,#gam-ad-topLeaderboard-1,#game-ad,#gamead,#gameads,#gasense,#geoAd,#gg_ad,#ggl-ad,#glamads,#global-banner-ad,#globalLeftNavAd,#globalTopNavAd,#global_header_ad,#global_header_ad_area,#gnt_atomsnc,#goad1,#goads,#gooadtop,#google-ad,#google-ads-bottom,#google-ads-bottom-container,#google-ads-container,#google-ads-header,#google-adsense,#google-adwords,#google-afc,#google-dfp-bottom,#google-dfp-top,#google-post-ad,#google-post-adbottom,#google-top-ads,#googleAd,#googleAdArea,#googleAdBottom,#googleAdBox,#googleAdTop,#googleAds,#googleAdsense,#googleAdsenseAdverts,#googleSearchAds,#google_ad_1,#google_ad_2,#google_ad_3,#google_ad_container,#google_ad_slot,#google_ads,#google_ads_1,#google_ads_box,#google_ads_frame,#google_ads_frame1_anchor,#google_ads_frame2_anchor,#google_ads_frame3_anchor,#google_ads_frame4_anchor,#google_ads_frame5_anchor,#google_ads_frame6_anchor,#google_adsense,#google_adsense_ad,#googlead,#googlead2,#googleadleft,#googleads,#googleads1,#googleadsense,#googleadstop,#googlebanner,#googlesponsor,#googletextads,#gpt-ad-1,#gpt-ad-banner,#gpt-ad-halfpage,#gpt-ad-outofpage-wp,#gpt-ad-rectangle1,#gpt-ad-rectangle2,#gpt-ad-side-bottom,#gpt-ad-skyscraper,#gpt-dynamic_native_article_4,#gpt-high_impact,#gpt-instory-ad,#gpt-leaderboard-ad,#gpt-mpu,#gpt-poster,#gpt-sticky,#grdAds,#gridAdSidebar,#grid_ad,#half-page-ad,#halfPageAd,#half_page_ad_300x600,#halfpagead,#head-ad,#head-ad-text-wrap,#head-ad-timer,#head-ads,#head-advertisement,#headAd,#headAds,#headAdv,#head_ad,#head_ads,#head_advert,#headad,#headadvert,#header-ad,#header-ad-background,#header-ad-block,#header-ad-bottom,#header-ad-container,#header-ad-holder,#header-ad-label,#header-ad-left,#header-ad-placeholder,#header-ad-right,#header-ad-slot,#header-ad-wrap,#header-ad-wrapper,#header-ad2,#header-ads,#header-ads-container,#header-ads-holder,#header-ads-wrapper,#header-adsense,#header-adserve,#header-adspace,#header-adv,#header-advert,#header-advert-panel,#header-advertisement,#header-advertising,#header-adverts,#header-advrt,#header-banner-728-90,#header-banner-ad,#header-banner-ad-wrapper,#header-block-ads,#header-box-ads,#headerAdBackground,#headerAdContainer,#headerAdSpace,#headerAdUnit,#headerAdWrap,#headerAds,#headerAdsWrapper,#headerAdv,#headerAdvert,#headerTopAd,#header_ad_728,#header_ad_728_90,#header_ad_banner,#header_ad_block,#header_ad_container,#header_ad_leaderboard,#header_ad_units,#header_ad_widget,#header_ad_wrap,#header_adbox,#header_adcode,#header_ads,#header_ads2,#header_adsense,#header_adv,#header_advert,#header_advertisement,#header_advertisement_top,#header_advertising,#header_adverts,#header_bottom_ad,#header_publicidad,#header_right_ad,#header_sponsors,#header_top_ad,#headerad,#headerad_large,#headeradbox,#headeradcontainer,#headerads,#headeradsbox,#headeradsense,#headeradspace,#headeradvertholder,#headeradwrap,#headergooglead,#headersponsors,#headingAd,#headline_ad,#hearst-autos-ad-wrapper,#hgiks-middle,#hgiks-top,#home-ad,#home-ad-block,#home-ad-slot,#home-advert-module,#home-advertise,#home-banner-ad,#home-left-ad,#home-rectangle-ad,#home-side-ad,#home-top-ads,#homeAd,#homeAdLeft,#homeAds,#homeSideAd,#home_ad,#home_ads_vert,#home_advertising_block,#home_bottom_ad,#home_contentad,#home_mpu,#home_sidebar_ad,#home_top_right_ad,#homead,#homeheaderad,#homepage-ad,#homepage-adbar,#homepage-footer-ad,#homepage-header-ad,#homepage-sidebar-ad,#homepage-sidebar-ads,#homepage-sponsored,#homepageAd,#homepageAdsTop,#homepageFooterAd,#homepageGoogleAds,#homepage_ad,#homepage_ad_listing,#homepage_rectangle_ad,#homepage_right_ad,#homepage_right_ad_container,#homepage_top_ad,#homepage_top_ads,#homepageadvert,#hometopads,#horAd,#hor_ad,#horadslot,#horizad,#horizads728,#horizontal-ad,#horizontal-adspace,#horizontal-banner-ad,#horizontalAd,#horizontalAdvertisement,#horizontal_ad,#horizontal_ad2,#horizontal_ad_top,#horizontalad,#horizontalads,#hours_ad,#houseAd,#hovered_sponsored,#hp-header-ad,#hp-right-ad,#hp-store-ad,#hpAdVideo,#idDivAd,#id_SearchAds,#iframe-ad,#iframeAd_2,#iframe_ad_2,#imPopup,#im_papupFixed,#im_popupDiv,#imgad1,#imu_ad_module,#in-article-ad,#in-article-mpu,#in-content-ad,#inArticleAdv,#inarticlead,#incontent-ad-2,#incontent-ad-3,#incontentAd1,#incontentAd2,#incontentAd3,#index-ad,#index-bottom-advert,#indexSquareAd,#index_ad,#indexad,#infoBottomAd,#infoboxadwrapper,#inhousead,#initializeAd,#inline-ad,#inline-ad-label,#inline-advert,#inline-story-ad,#inline-story-ad2,#inlineAd,#inlineAdCont,#inlineAdtop,#inlineAdvertisement,#inlineBottomAd,#inline_ad,#inline_ad_section,#inlinead,#inlineads,#inner-ad,#inner-ad-container,#inner-advert-row,#inner-top-ads,#innerad,#innerpage-ad,#instant_ad,#insticator-container,#instoryad,#int-ad,#int_ad,#interads,#intermediate-ad,#internalAdvert,#internalads,#interstitial-shade,#interstitialAd,#interstitialAdContainer,#interstitialAdUnit,#interstitial_ad,#interstitial_ad_container,#interstitial_ads,#intext_ad,#introAds,#intro_ad_1,#invid_ad,#ipadv,#iq-AdSkin,#iqadcontainer,#iqadoverlay,#iqadtile1,#iqadtile11,#iqadtile14,#iqadtile15,#iqadtile16,#iqadtile2,#iqadtile3,#iqadtile4,#iqadtile41,#iqadtile6,#iqadtile8,#iqadtile9,#iqadtile99,#islandAd,#islandAdPan,#islandAdPane,#islandAdPane2,#island_ad_top,#islandad,#jobs-ad,#js-Sponsored-Container,#js-Taboola-Container-0,#js-ad-billboard,#js-ad-leaderboard,#js-image-ad-mpu,#js-outbrain-ads-module,#js-outbrain-module,#js-outbrain-relateds,#js-page-ad-top,#js-wide-ad,#js_commerceInsetModule,#jwplayer-container-div,#jwplayer_contextual_player_div,#kargo-player,#kt_player > a[target="_blank"],#kt_player > div[style$="display: block;"][style*="inset: 0px;"],#large-ads,#large-bottom-leaderboard-ad,#large-leaderboard-ad,#large-middle-leaderboard-ad,#large-rectange-ad,#large-rectange-ad-2,#large-skyscraper-ad,#largeAd {display: none !important; color: #00b3dd !important; background-color: #db1dff !important;}#largeAds,#large_rec_ad1,#largead,#layer_ad,#layer_ad_content,#layerad,#layeradsense,#layout-header-ad-wrapper,#layout_topad,#lb-ad,#lb-sponsor-left,#lb-sponsor-right,#lbAdBar,#lbAdBarBtm,#lblAds,#lead-ads,#lead_ad,#leadad_1,#leadad_2,#leader-ad,#leader-board-ad,#leaderAd,#leaderAdContainer,#leaderAdContainerOuter,#leaderBoardAd,#leader_ad,#leader_board_ad,#leaderad,#leaderad_section,#leaderadvert,#leaderboard-ad,#leaderboard-advert,#leaderboard-advertisement,#leaderboard-atf,#leaderboard-bottom-ad,#leaderboard.ad,#leaderboardAd,#leaderboardAdTop,#leaderboardAds,#leaderboardAdvert,#leaderboard_728x90,#leaderboard_Ad,#leaderboard_ad,#leaderboard_ads,#leaderboard_bottom_ad,#leaderboard_top_ad,#leaderboardad,#leatherboardad,#left-ad,#left-ad-1,#left-ad-2,#left-ad-col,#left-ad-iframe,#left-ad-skin,#left-bottom-ad,#left-col-ads-1,#left-content-ad,#leftAD,#leftAdAboveSideBar,#leftAdCol,#leftAdContainer,#leftAdMessage,#leftAdSpace,#leftAd_fmt,#leftAd_rdr,#leftAds,#leftAdsSmall,#leftAdvert,#leftBanner-ad,#leftColumnAdContainer,#leftGoogleAds,#leftTopAdWrapper,#left_ad,#left_ads,#left_adsense,#left_adspace,#left_adv,#left_advertisement,#left_bg_ad,#left_block_ads,#left_float_ad,#left_global_adspace,#left_side_ads,#left_sidebar_ads,#left_top_ad,#leftadg,#leftads,#leftcolAd,#leftcolumnad,#leftforumad,#leftrail_dynamic_ad_wrapper,#lg-banner-ad,#ligatus,#ligatus_adv,#ligatusdiv,#lightboxAd,#linkAdSingle,#linkAds,#link_ads,#linkads,#listadholder,#liste_top_ads_wrapper,#listing-ad,#live-ad,#localAds,#localpp,#locked-footer-ad-wrapper,#logoAd,#logoAd2,#logo_ad,#long-ad,#long-ad-space,#long-bottom-ad-wrapper,#longAdSpace,#longAdWrap,#long_advert_header,#long_advertisement,#lower-ad-banner,#lower-ads,#lower-advertising,#lower-home-ads,#lowerAdvertisement,#lowerAdvertisementImg,#lower_ad,#lowerads,#lowerthirdad,#lrec_ad,#lrecad,#m-banner-bannerAd,#main-ad,#main-advert,#mainAd,#mainAd1,#mainAdUnit,#mainAdvert,#mainPageAds,#main_AD,#main_ad,#main_ads,#main_content_ad,#main_rec_ad,#main_top_ad,#mainui-ads,#mapAdsSwiper,#mapAdvert,#marketgid,#marketplaceAds,#marquee-ad,#marquee_ad,#mastAd,#mastAdvert,#mastad,#masterad,#masthead_ad,#masthead_ads_container,#masthead_topad,#med-rect-ad,#med-rectangle-ad,#medRecAd,#medReqAd,#media-ad,#medium-ad,#mediumAd1,#mediumAdContainer,#mediumAdvertisement,#mediumRectangleAd,#medrec_bottom_ad,#medrec_middle_ad,#medrec_top_ad,#medrectad,#medrectangle_banner,#menuad,#menubarad,#message_adblock,#mgb-container > #mgb,#mgid-container,#mgid_iframe,#mid-ad-slot-1,#mid-ad-slot-3,#mid-ad-slot-5,#mid-ads,#mid-table-ad,#midAD,#midRightAds,#midRightTextAds,#mid_ad,#mid_ad_div,#mid_ad_title,#mid_left_ads,#mid_mpu,#mid_roll_ad_holder,#midadspace,#midadvert,#midbarad,#midbnrad,#midcolumn_ad,#middle-ad,#middleAd,#middle_ad,#middle_ads,#middle_mpu,#middlead,#middleads,#middleads2,#midpost_ad,#midrect_ad,#midstrip_ad,#mini-ad,#mm-player-placeholder-large-screen,#mobile-ad-container,#mobile-adhesion,#mobile-ads-ad,#mobile-footer-ad-wrapper,#mobile-swipe-banner,#mobileAdContainer,#mod_ad,#mod_ad_top,#modal-ad,#module-ads-01,#module-ads-02,#moduleTaboolaRightRail,#module_ad,#module_box_ad,#monsterAd,#mpu-ad,#mpu-advert,#mpu-cont,#mpu-content,#mpu-sidebar,#mpu1_parent,#mpu2,#mpu2_container,#mpu2_parent,#mpuAd,#mpuAdvert,#mpuContainer,#mpuDiv,#mpuInContent,#mpuSecondary,#mpuSlot,#mpuWrapper,#mpuWrapperAd,#mpuWrapperAd2,#mpu_ad,#mpu_ad2,#mpu_adv,#mpu_banner,#mpu_box,#mpu_container,#mpu_div,#mpu_holder,#mpu_text_ad,#mpu_top,#mpuad,#mpubox,#mpuholder,#mvp-foot-ad-wrap,#mvp-post-bot-ad,#my-ads,#narrow-ad,#narrow_ad_unit,#native-ads-placeholder,#native_ad2,#native_ads,#nav-ad-container,#navAdBanner,#nav_ad,#nav_ad_728_mid,#navads-container,#navbar_ads,#navigation-ad,#navlinkad,#newAd,#ng-ad,#ng-ad-lbl,#ni-ad-row,#nk_ad_top,#notify_ad,#ntvads,#ob-ad-choices,#openx-text-ad,#openx-widget,#original_taboola,#outbrain,#outbrain-id,#outbrain-section,#outbrain-wrapper,#outbrain1,#outbrainAdWrapper,#outbrainWidget,#outstream_connatix_container,#ovadsense,#overlay-ad-bg,#overlay_ad,#overlayad,#overlayadd,#p-Ad,#p-advert,#p-googlead,#p-googleadsense,#p2HeaderAd,#p2squaread,#page-ad-top,#page-advertising,#page-header-ad,#page-top-ad,#pageAdDiv,#pageAdds,#pageAds,#pageAdsDiv,#pageAdvert,#pageBannerAd,#pageLeftAd,#pageMiddleAdWrapper,#pageRightAd,#page__outside-advertsing,#page_ad_top,#page_top_ad,#pageads_top,#pagebottomAd,#pagination-advert,#panel-ad,#panelAd,#panel_ad1,#panoAdBlock,#partner-ad,#partnerAd,#partnerMedRec,#partner_ads,#pause-ad,#pause-ads,#pauseAd,#pc-div-gpt-ad_728-3,#pencil-ad,#pencil-ad-container,#perm_ad,#permads,#persistentAd,#personalization_ads,#pgAdWrapper,#ph_ad,#pk-status-message,#player-advert,#player-advertising,#player-banner,#player-below-advert,#player-midrollAd,#playerAd,#playerAdsRight,#player_ad,#player_ads,#player_middle_ad,#player_top_ad,#playerad,#pop.div_pop,#pop_ad,#popadwrap,#popback-ad,#popoverAd,#popupAd,#popupBottomAd,#popup_ad_wrapper,#popupadunit,#possible_taboola,#post-ad,#post-ads,#post-bottom-ads,#post-content-ad,#post-page-ad,#post-promo-ad,#postAd,#postNavigationAd,#post_ad,#post_addsense,#post_adsense,#post_adspace,#post_advert,#postads0,#ppcAdverts,#ppvideoadvertisement,#pr_ad,#pr_advertising,#pre-adv,#pre-footer-ad,#preAds_ad_mrec_intext,#preAds_ad_mrec_intext2,#preminumAD,#premiumAdTop,#premium_ad,#premium_ddb_0,#premiumad,#premiumads,#preroll_ads,#primis-container,#primis-holder,#primis_intext,#primis_player,#print_ads,#printads,#privateads,#promo-ad,#promoAds,#promoFloatAd,#promo_ads,#pub468x60,#pub728x90,#pubexchange_below_content,#publicidad,#publicidadeLREC,#pushAd,#pushDownAd,#pushdownAd,#pushdownAdWrapper,#pushdown_ad,#pusher-ad,#pvadscontainer,#quads-ad1_widget,#quads-ad2_widget,#quads-admin-ads-js,#r89-desktop-top-ad,#radio-ad-container,#rail-ad-wrap,#rail-bottom-ad,#railAd,#rail_ad,#rail_ad1,#rail_ad2,#rec_spot_ad_1,#recommendAdBox,#rect-ad,#rectAd,#rect_ad,#rectad,#rectangle-ad,#rectangleAd,#rectangleAdTeaser1,#rectangle_ad,#redirect-ad,#redirect-ad-modal,#reference-ad,#region-node-advert,#reklam_buton,#reklam_center,#reklama,#reklama_big,#reklama_left_body,#reklama_left_up,#reklama_right_up,#related-ads,#related_ad,#related_ads_box,#removeAdsSidebar,#removeadlink,#responsive-ad,#responsive-ad-sidebar-container,#responsive_ad,#responsivead,#resultSponLinks,#resultsAdsBottom,#resultsAdsSB,#resultsAdsTop,#rh-ad,#rh-ad-container,#rh_tower_ad,#rhc_ads,#rhs_ads,#rhs_adverts,#rhsads,#rhsadvert,#richad,#right-ad,#right-ad-block,#right-ad-col,#right-ad-iframe,#right-ad-skin,#right-ad1,#right-ads,#right-ads-rail,#right-advert,#right-bar-ad,#right-box-ad,#right-content-ad,#right-featured-ad,#right-rail-ad-slot-content-top,#right1-ad,#rightAD,#rightAd,#rightAd1,#rightAdBar,#rightAdBlock,#rightAdColumn,#rightAdContainer,#rightAdHolder,#rightAdUnit,#rightAd_rdr,#rightAds,#rightAdsDiv,#rightBlockAd,#rightBottomAd,#rightColAd,#rightColumnAds,#rightRailAds,#rightSideAd,#rightSideAdvert,#right_Ads2,#right_ad,#right_ad_1,#right_ad_2,#right_ad_box,#right_ad_container,#right_ad_top,#right_ad_wrapper,#right_ads_box,#right_adsense,#right_advert,#right_advertisement,#right_advertising,#right_adverts,#right_bg_ad,#right_block_ads,#right_bottom_ad,#right_column_ad,#right_column_ad_container,#right_column_ads,#right_column_adverts,#right_player_ad,#right_side_ad,#right_sidebar_ads,#right_top_ad,#right_top_gad,#rightad1,#rightad2,#rightadBorder,#rightadBorder1,#rightadBorder2,#rightadContainer,#rightadcell,#rightadg,#rightadhome,#rightads,#rightads300x250,#rightadsarea,#rightbar-ad,#rightbar_ad,#rightcol_sponsorad,#rightgoogleads,#rightrail-ad,#rightrail_bottom_ddb_0,#rightrail_pos1_ddb_0,#rightrail_pos2_ddb_0,#rightrail_pos3_ddb_0,#rightrail_top_ddb_0,#rightside-ads,#rightside_ad,#rightskyad,#rm-adslot-bigsizebanner_1,#rm-adslot-contentad_1,#rotating_ad,#rotatingads,#row-ad,#rowAdv,#rtAdvertisement,#scroll-ad,#scroll_ad,#search-ad,#search-ads1,#search-google-ads,#search-sponsor,#search-sponsored-links,#searchAd,#searchAds,#search_ad,#search_ads,#second_ad_div,#secondad,#section-ad,#section-ad-bottom,#section_ad,#section_advertisements,#self-ad,#sellwild-loader,#show-ad,#show-sticky-ad,#showAd,#show_ads,#showads,#showcaseAd,#side-ad-container,#side-ads,#side-ads-box,#side-banner-ad,#side-boxad,#sideABlock,#sideAD,#sideAd,#sideAd1,#sideAd2,#sideAd3,#sideAd4,#sideAdArea,#sideAdLarge,#sideAdSmall,#sideAdSub,#sideAds,#sideBannerAd,#sideBar-ads,#sideBarAd,#sideSponsors,#side_ad,#side_ad_module,#side_ad_wrapper,#side_ads,#side_adverts,#side_longads,#side_skyscraper_ad,#side_sponsors,#sidead,#sidead1,#sideads,#sideads_container,#sideadscol,#sideadvert,#sideadzone,#sidebar-ad-1,#sidebar-ad-2,#sidebar-ad-block,#sidebar-ad-boxes,#sidebar-ad-middle,#sidebar-ad-wrap,#sidebar-ad1,#sidebar-ad2,#sidebar-ad3,#sidebar-ads,#sidebar-ads-content,#sidebar-ads-narrow,#sidebar-ads-wide,#sidebar-ads-wrapper,#sidebar-adspace,#sidebar-adv,#sidebar-advertise-text,#sidebar-advertisement,#sidebar-left-ad,#sidebar-main-ad,#sidebar-sponsors,#sidebar-top-ad,#sidebar-top-ads,#sidebarAd,#sidebarAd1,#sidebarAd2,#sidebarAdSense,#sidebarAdSpace,#sidebarAdUnitWidget,#sidebarAds,#sidebarAdvTop,#sidebarAdvert,#sidebarSponsors,#sidebarTextAds,#sidebarTowerAds,#sidebar_ad,#sidebar_ad_1,#sidebar_ad_2,#sidebar_ad_3,#sidebar_ad_big,#sidebar_ad_container,#sidebar_ad_top,#sidebar_ad_widget,#sidebar_ad_wrapper,#sidebar_adblock,#sidebar_ads,#sidebar_box_add,#sidebar_topad,#sidebarad,#sidebarad0,#sidebaradpane,#sidebarads,#sidebaradsense,#sidebaradverts,#sidebard-ads-wrapper,#sidebargooglead,#sidebargoogleads,#sidebarrectad,#sideline-ad,#sidepad-ad,#single-ad,#single-ad-2,#single-adblade,#single-mpu,#singleAd,#singleAdsContainer,#singlead,#singleads,#site-ad-container,#site-ads,#site-header__ads,#site-leaderboard-ads,#site-sponsor-ad,#site-sponsors,#siteAdHeader,#site_bottom_ad_div,#site_content_ad_div,#site_top_ad,#site_wrap_ad,#sitead,#skin-ad,#skin-ad-left-rail-container,#skin-ad-right-rail-container,#skinTopAd,#skin_adv,#skinad-left,#skinad-right,#sky-ad,#sky-ads,#sky-left,#sky-right,#skyAd,#skyAdContainer,#skyScraperAd,#skyScrapperAd,#skyWrapperAds,#sky_ad,#sky_advert,#skyads,#skyadwrap,#skybox-ad,#skyline_ad,#skyscrapeAd,#skyscraper-ad,#skyscraperAd,#skyscraperAdContainer,#skyscraperAdWrap,#skyscraperAds,#skyscraperWrapperAd,#skyscraper_ad,#skyscraper_advert,#skyscraperadblock,#skyscrapper-ad,#slashboxes > .deals-rail,#slideAd,#slide_ad,#slidead,#slideboxad,#slider-ad,#sliderAdHolder,#slider_ad,#sm-banner-ad,#smallAd,#small_ad,#small_ads,#smallad,#smallads,#smallerAd,#sp-adv-banner-top,#spdFloatAds,#specialAd,#special_ads,#specialadfeatures,#specials_ads,#speed_ads,#speeds_ads,#sponBox,#spon_links,#sponlink,#sponlinks,#sponsAds,#sponsLinks,#spons_links,#sponseredlinks,#sponsor-box-widget,#sponsor-flyout,#sponsor-flyout-wrap,#sponsor-links,#sponsor-partners,#sponsor-sidebar-container,#sponsorAd,#sponsorAd1,#sponsorAd2,#sponsorAdDiv,#sponsorBar,#sponsorBorder,#sponsorContainer0,#sponsorFooter,#sponsorLinkDiv,#sponsorLinks,#sponsorResults,#sponsorSpot,#sponsorTab,#sponsorText,#sponsorTextLink,#sponsor_300x250,#sponsor_ad,#sponsor_ads,#sponsor_bar,#sponsor_bottom,#sponsor_box,#sponsor_deals,#sponsor_div,#sponsor_footer,#sponsor_header,#sponsor_link,#sponsor_no,#sponsor_posts,#sponsor_right,#sponsored-ads,#sponsored-footer,#sponsored-inline,#sponsored-links,#sponsored-links-alt,#sponsored-links-container,#sponsored-listings,#sponsored-message,#sponsored-products,#sponsored-recommendations,#sponsored-resources,#sponsored-search,#sponsored-text-links,#sponsored-widget,#sponsored1,#sponsoredAd,#sponsoredAdvertisement,#sponsoredBottom,#sponsoredBox1,#sponsoredBox2,#sponsoredHoz,#sponsoredLinks,#sponsoredLinksBox,#sponsoredList,#sponsoredResults,#sponsoredResultsWide,#sponsoredTop,#sponsored_ads,#sponsored_container,#sponsored_content,#sponsored_head,#sponsored_label,#sponsored_link_bottom,#sponsored_links,#sponsored_native_ad,#sponsoredad,#sponsoredlinks,#sponsorfeature,#sponsorlink,#sponsors-article,#sponsors-block,#sponsors-home,#sponsorsBox,#sponsorsContainer,#sponsorship-box,#sporsored-results,#spotlight-ads,#spotlightAds,#spotlight_ad,#spotlightad,#sprint_ad,#sqAd,#sq_ads,#square-ad,#square-ad-box,#square-ad-space,#square-ads,#square-sponsors,#squareAd,#squareAdBottom,#squareAdSpace,#squareAdTop,#squareAdWrap,#squareAds,#squareGoogleAd,#square_ad,#squaread,#squareadevertise,#squareadvert,#squared_ad,#staticad,#stationad,#sticky-ad,#sticky-ad-bottom,#sticky-ad-container,#sticky-ad-header,#sticky-add-side-block,#sticky-ads,#sticky-ads-top,#sticky-custom-ads,#sticky-footer-ad,#sticky-footer-ads,#sticky-left-ad,#sticky-rail-ad,#stickyAd,#stickyAdBlock,#stickyBottomAd,#stickySidebarAd,#stickySkyAd,#sticky_sidebar_ads,#stickyad,#stickyleftad,#stickyrightad,#stopAdv,#stop_ad3,#story-ad,#story-bottom-ad,#storyAd,#story_ad,#story_ads,#story_bottom_ddb_0,#story_bottom_ddb_1,#story_top_ddb_0,#storyad2,#stripadv,#subheaderAd,#taboola,#taboola-above-homepage-thumbnails,#taboola-ad,#taboola-adverts,#taboola-below,#taboola-below-article-thumbnails,#taboola-below-article-thumbnails-2,#taboola-below-article-thumbnails-express,#taboola-below-article-thumbnails-mg,#taboola-below-article-thumbnails-new,#taboola-below-article-thumbnails-photo,#taboola-below-article-thumbnails-v2,#taboola-below-disco-board,#taboola-below-forum-thumbnails,#taboola-below-homepage-thumbnails-2,#taboola-below-homepage-thumbnails-3,#taboola-below-main-column,#taboola-belowarticle,#taboola-bottom,#taboola-bottom-main-column,#taboola-div,#taboola-homepage-thumbnails,#taboola-homepage-thumbnails-desktop,#taboola-horizontal-toolbar,#taboola-in-feed-thumbnails,#taboola-mid-article-thumbnails,#taboola-mid-article-thumbnails-ii,#taboola-mid-main-column-thumbnails,#taboola-mobile-article-thumbnails,#taboola-native-right-rail-thumbnails,#taboola-placeholder,#taboola-right-rail,#taboola-right-rail-express,#taboola-right-rail-text-right,#taboola-right-rail-thumbnails,#taboola-right-rail-thumbnails-2nd,#taboola-text-2-columns-mix,#taboola-vid-container,#taboola-widget-wrapper,#taboolaContainerWrapper_0,#taboola_bottom,#taboola_responsive_wrapper,#taboola_side,#taboola_wrapper,#takeover-ad,#takeover_ad,#takeoverad,#td-ad-placeholder,#tdAds,#td_adunit2,#td_sponsorAd,#teaser1[style^="width:autopx;"],#teaser2[style^="width:autopx;"],#teaser3[style="width: 100%;text-align: center;display: scroll;position:fixed;bottom: 0;margin: 0 auto;z-index: 103;"],#teaser3[style^="width:autopx;"],#text-ad,#text-ads,#text-intext-ads,#text-link-ads,#textAd,#textAd1,#textAds,#textAdsTop,#text_ad,#text_ads,#text_advert,#textad,#textad3,#textlink-advertisement,#textsponsor,#tile-ad,#tileAds,#tmInfiniteAd,#toaster_ad,#top-ad,#top-ad-area,#top-ad-banner,#top-ad-container,#top-ad-content,#top-ad-desktop,#top-ad-div,#top-ad-google,#top-ad-iframe,#top-ad-rect,#top-ad-slot,#top-ad-slot-0,#top-ad-slot-1,#top-ad-unit,#top-ad-wrapper,#top-adblock,#top-adds,#top-ads {display: none !important; color: #00b3dd !important; background-color: #db1dff !important;}</style><style type="text/css" class="abn_style" nonce="undefined">#top-ads-1,#top-ads-contain,#top-ads-container,#top-adspot,#top-advert,#top-advertisement,#top-advertisements,#top-advertising-content,#top-banner-ad,#top-banner-ad-browser,#top-buy-sell-ads,#top-dfp,#top-head-ad,#top-leaderboard-ad,#top-left-ad,#top-middle-add,#top-not-ads,#top-right-ad,#top-right-ad-slot,#top-skin-ad,#top-skin-ad-bg,#top-sponsor-ad,#top-story-ad,#topAD,#topAd728x90,#topAdArea,#topAdBanner,#topAdBar,#topAdBox,#topAdContainer,#topAdDiv,#topAdDropdown,#topAdHolder,#topAdShow,#topAdSpace,#topAdSpace_div,#topAdWrapper,#topAdcontainer,#topAds,#topAds1,#topAds2,#topAdsContainer,#topAdsDiv,#topAdsG,#topAdv,#topAdvBox,#topAdvert,#topBanner-ad,#topBannerAd,#topBannerAdContainer,#topBannerAdv,#topImgAd,#topLeaderboardAd,#topMPU,#topMpuContainer,#topSponsorBanner,#topSponsoredLinks,#top_AD,#top_ad,#top_ad-360,#top_ad_area,#top_ad_banner,#top_ad_block,#top_ad_box,#top_ad_container,#top_ad_td,#top_ad_unit,#top_ad_wrapper,#top_ad_zone,#top_add,#top_ads,#top_ads_box,#top_ads_container,#top_ads_region,#top_ads_wrap,#top_adsense_cont,#top_adspace,#top_adv,#top_advert,#top_advert_box,#top_advertise,#top_advertising,#top_banner,#top_banner_ads,#top_container_ad,#top_google_ads,#top_mpu,#top_mpu_ad,#top_rectangle_ad,#top_right_ad,#top_row_ad,#top_span_ad,#top_sponsor_ads,#top_sponsor_text,#topad,#topad-728x90,#topad-block,#topad-wrap,#topad1,#topad728,#topad_holder,#topad_left,#topad_right,#topad_table,#topadbanner,#topadbanner2,#topadbar,#topadblock,#topadcell,#topadcontainer,#topaddwide,#topadleft,#topadone,#topadplaceholder,#topadright,#topads-spacer,#topads-wrapper,#topadsblock,#topadsdiv,#topadsense,#topadspace,#topadvert,#topadwrap,#topadz,#topadzone,#topbanner_ad,#topbanner_sponsor,#topbanneradtitle,#topbar-ad,#topbarAd,#topbarad,#topbarads,#topcustomad,#topheader_ads,#topleaderAd,#topleaderboardad,#topnavad,#toppannonse,#topright-ad,#toprightAdvert,#toprightad,#toprow-ad,#topsidebar-ad,#topsponad,#topsponsorads,#topsponsored,#toptextad,#towerAdContainer,#towerad,#tpl_advertising,#transparentad,#txtAdHeader,#ulBannerSlider,#ultimedia_wrapper,#upper-ads,#upperMpu,#upperRightAds,#upper_adbox,#upper_advertising,#upper_small_ad,#upperad,#velsof_wheel_container,#vert-ads,#vertAd2,#vert_ad,#vert_ad_placeholder,#vertad1,#vertical.ad,#verticalAds,#vertical_ad,#vertical_ads,#verticalads,#vidazoo-player,#video-ad,#video-ad-companion-rectangle,#video-adv,#video-adv-wrapper,#video-advert,#video-embed-ads,#video-in-player-ad,#video-side-adv,#video-sponsor-links,#video-under-player-ad,#videoAd,#videoAdvert,#videoCompanionAd,#videoOverAd,#videoOverAd300,#videoPauseAd,#video_ads_bot_overlay,#video_adv,#video_embed_ads,#video_hor_bot_ads,#video_overlay_ad,#videoad,#videoads,#viewAd1,#visual-ad,#wTopAd,#wallAd,#wall_advert,#wd-sponsored,#weather-ad,#weather_sponsor,#weatherad,#welcome_ad,#wg_ads,#wgtAd,#whitepaper-ad,#wide-ad,#wideAdd,#wide_ad_unit,#wide_ad_unit2,#wide_ad_unit3,#wide_adv,#wide_right_ad,#widget-ads-3,#widget-ads-4,#widget-adv-12,#widget-box-ad-1,#widget-box-ad-2,#widget_Adverts,#widget_ad,#widget_advertisement,#widget_thrive_ad_default-2,#widget_thrive_ad_default-4,#widgetwidget_adserve,#widgetwidget_adserve2,#wl-pencil-ad,#wp-insert-ad-widget-1,#wp-topAds,#wpgtr_stickyads_textcss_container,#wrapAd,#wrapAdRight,#wrapCommentAd,#wrapper-AD_G,#wrapper-AD_L,#wrapper-AD_L2,#wrapper-AD_L3,#wrapper-AD_R,#wrapper-ad,#wrapper-ad970,#wrapper_ad_Top,#wrapper_topad,#wtopad,#yahoo_ads,#yahooads,#yandex_ad,#yandex_ad2,#yatadsky,#yrail_ads,#yreSponsoredLinks,#ysm_ad_iframe,#zMSplacement1,#zMSplacement2,#zMSplacement3,#zMSplacement4,#zMSplacement5,#zMSplacement6,#zdcFloatingBtn,#zeus_top-banner,#zone-adsense,#zsAdvertisingBanner,.-advertsSidebar,.ADBAR,.ADBox,.ADFooter,.ADInfo,.ADLeader,.ADMiddle1,.ADPod,.ADServer,.ADStyle,.ADTop,.ADVBig,.ADVFLEX_250,.ADV_Mobile,.AD_2,.AD_area,.ADbox,.ADmid,.ADwidget,.ATF_wrapper,.Ad--Align,.Ad--empty,.Ad--header,.Ad--loading,.Ad--presenter,.Ad--sidebar,.Ad-Advert_Container,.Ad-Container:not(.adsbygoogle),.Ad-Header,.Ad-Inner,.Ad-adhesive,.Ad-hor-height,.Ad-label,.Ad-leaderboard,.Ad.Leaderboard,.Ad300,.Ad3Tile,.Ad728x90,.AdBar,.AdBody:not(body),.AdBorder,.AdBottomPage,.AdBox,.AdBox160,.AdBox7,.AdBox728,.AdCenter,.AdCommercial,.AdCompactheader,.AdContainer,.AdContainer-Sidebar,.AdHeader,.AdHere,.AdHolder,.AdInline,.AdInsLink,.AdLeft1,.AdLeft2,.AdMedium,.AdMessage,.AdMod,.AdModule,.AdOneColumnContainer,.AdOuterMostContainer,.AdPanel,.AdPlaceHolder,.AdPlaceholder,.AdPlacementContainer,.AdProduct,.AdRight1,.AdRight2,.AdSense,.AdSenseLeft,.AdSlot,.AdSpace,.AdSpeedWP,.AdTagModule,.AdTitle,.AdTop,.AdUnit,.AdWidget_ImageWidget,.Ad_C,.Ad_D,.Ad_Label,.Ad_Right,.Ad_container,.AdblockMessage,.AdblockMessage_msg,.Ads--center,.Ads-768x90,.Ads-background,.Ads-leaderboard,.Ads-slot,.Ads-sticky,.AdsBottom,.AdsBox,.AdsBoxBottom,.AdsBoxSection,.AdsBoxTop,.AdsLayout__top-container,.AdsRectangleWrapper,.AdsSlot,.Ads__wrapper,.Ads_header,.AdsenseBox,.Adsterra,.Adtext,.Adv468,.Advert-label,.Advert300x250,.AdvertContainer,.AdvertWrapper,.AdvertisementAfterHeader,.AdvertisementAfterPost,.AdvertisementAsidePost,.AdvertisementText,.AdvertisementTextTag,.AdvertisementTop,.Advertisment,.AdvertorialTeaser,.AdvtSample,.AdzerkBanner,.AffiliateAds,.AppFooter__BannerAd,.Arpian-ads,.Article-advert,.ArticleAd,.ArticleAdSide,.ArticleAdWrapper,.ArticleFooter-outbrain,.ArticleInlineAd,.ArticleInnerAD,.ArticleOutbrainLocal,.Article__Ad,.BOX_Ad,.BOX_LeadAd,.Banner300x250,.Banner468X60,.BeOpWidget,.BigBoxAd,.BigBoxAdLabel,.Billboard-ad,.Billboard-ad-holder,.Billboard_2-ad-holder,.Billboard_3-ad-holder,.Billboard_4-ad-holder,.Billboard_5-ad-holder,.BlockAd,.BottomAd-container,.BottomAdContainer,.BottomAdsPartial,.BottomAffiliate,.BoxAd,.BoxAdWrap,.BoxRail-ad,.ButtonAd,.CitrusBannerWrapper--enollj,.CommentAd,.ConnatixAd,.ContentAd,.ContentAds,.ContentBottomAd,.ContentTextAd,.ContentTopAd,.DFPad,.DisplayAd,.DisplayAd_Native__XCll3,.DisplayAd_PremiumPlacement__gAXXB,.FirstAd,.FooterAd,.FooterAdContainer,.FooterAds,.Footer_1-ad-holder,.GRVAd,.GRVMpuWrapper,.GRVMultiVideo,.GRVPrimisVideo,.GRVVideo,.Gallery-Content-BottomAd,.GeminiAdItem,.GeminiNativeAd,.GoogleAdv,.GoogleDfpAd,.GoogleDfpAd-Content,.GoogleDfpAd-Float,.GoogleDfpAd-container,.GoogleDfpAd-wrap,.GoogleDfpAd-wrapper,.GoogleDfpAdModule,.GoogleDoubleClick-SponsorText,.GroupAdSense,.HeaderAd,.HeaderAds,.HeaderBannerAd,.HeadingAdSpace,.Hero-Ad,.HomeAds,.InArticleAd,.IndexRightAd,.InsertedAd,.LastAd,.LayoutBottomAds,.LayoutHomeAds,.LayoutHomeAdsAd,.LayoutPromotionAdsNew,.LazyLoadAd,.LeaderAd,.LeaderAdvertisement,.LeaderBoardAd,.LearderAd_Border,.ListicleAdRow,.MIXADVERT_NET,.MPUHolder,.MPUad,.MPUstyled__MPUWrapper-sc-100o0l7-0,.MPUstyled__MPUWrapper-sc-1cdmm4p-0,.MapLayout_BottomAd,.MapLayout_BottomMobiAd,.MarketGid_container,.MbanAd,.MiddleAd,.MiddleAdContainer,.MiddleAdvert,.MiddleRightRadvertisement,.NA_ad,.NR-Ads,.NativeAdContainerRegion,.NavBarAd,.Normal-add,.OAS_wrap,.OUTBRAIN,.OcelotAdModule,.OcelotAdModule-ad,.Outbrain,.PPD_ADS_JS,.Page-ad,.PageTopAd,.PcSideBarAd,.PencilAd,.PostAdvertisementBeforePost,.PostSidebarAd,.Post__ad,.PrimisMidArticleAdUnit_desktop__dq_iB,.PrimisResponsiveStyle,.PrintAd-Slider,.PushdownAd,.RC-AD,.RC-AD-BOX-BOTTOM,.RC-AD-BOX-MIDDLE,.RC-AD-BOX-TOP,.RC-AD-TOP-BANNER,.RectangleAd,.Rectangle_1-ad-holder,.Rectangle_2-ad-holder,.Rectangle_3-ad-holder,.RelatedAds,.ResponsiveAd,.RightAd,.RightAd1,.RightAd2,.RightAdvertisement,.RightGoogleAd,.RightRailAd,.RightRailAds,.RightRailPanelAd_noPanelSmall__7yQ1M,.RightRailTrendingAd_nativeAdWrapper__dxc78,.RightTowerAd,.STR_AdBlock,.SecondaryAd,.SecondaryAdLink,.Section-ad,.SectionSponsor,.SideAd,.SideAdCol,.SideAds,.SideBarstyled__SideBarMpuWrapper-sc-g4r51i-2,.SideWidget__ad,.Sidebar-ad,.Sidebar-ad--300x600,.SidebarAd,.SidebarAdvert,.SidebarRightAdvertisement,.SimpleAd,.SkyAdContainer,.SkyAdContent,.SkyScraperAd,.SovrnAd,.Sponsor-container,.SponsorHeader,.SponsorIsland,.SponsorLink,.SponsoredAdTitle,.SponsoredArticleAd,.SponsoredContent,.SponsoredContentWidget,.SponsoredLinks,.SponsoredLinksModule,.SponsoredLinksPadding,.SponsoredLinksPanel,.SponsoredResults,.Sponsored_link,.SquareAd,.Sticky-AdContainer,.StickyAdRail__Inner,.StoryPage_storyTopAdContainer__6udZ0,.SummaryPage-HeaderAd,.TaboolaMoreToExplore_taboolaContainerWrapper__Ccf_j,.TextAd,.TextAdds,.Textads,.TopAd,.TopAdBox,.TopAdContainer,.TopAdL,.TopAdR,.TopAds,.TopBannerAd,.TopBannerstyled__Wrapper-sc-x2ypns-0,.TopRightRadvertisement,.Top_Ad,.TrackedBannerPromo,.TrackedSidebarPromo,.TrafficAd,.U210-adv-column,.UnderAd,.VerticalAd,.Video-Ad,.VideoAd,.WPBannerizeWidget,.WP_Widget_Ad_manager,.WideAdTile,.WideAdsLeft,.WidgetAdvertiser,.WidthAd,.ZERGNET,.\[\&_\.gdprAdTransparencyCogWheelButton\]\:\!pjra-z-\[5\],._SummaryPageHeaderAdView,._SummaryPageSidebarStickyAdView,._ads,._ads-full,._ap_adrecover_ad,._articleAdvert,._bannerAds,._bottom_ad_wrapper,._fullsquaread,._has-ads,._popIn_recommend_article_ad,._popIn_recommend_article_ad_reserved,._table_ad_div_wide,.a-ad,.a-d-250,.a-d-90,.a-dserver,.a-dserver_text,.a-sponsor,.ab-ad_placement-article,.ablock300,.ablock468,.ablock728,.above-header-advert,.aboveCommentAds,.abovead,.ac-banner-ad,.ac-lre-desktop,.ac-lre-player-ph,.ac-lre-wrapper,.ac_adbox,.acm-ad-tag-unit,.ad--300,.ad--300x250,.ad--468,.ad--468-60,.ad--728x90,.ad--970-750-336-300,.ad--970-90,.ad--article,.ad--article-top,.ad--articlemodule,.ad--b,.ad--banner,.ad--banner2,.ad--banniere_basse,.ad--banniere_haute,.ad--billboard,.ad--bottom,.ad--bottom-label,.ad--bottommpu,.ad--boundries,.ad--button,.ad--c,.ad--center,.ad--centered,.ad--container,.ad--content,.ad--content-ad,.ad--dart,.ad--desktop,.ad--displayed,.ad--droite_basse,.ad--droite_haute,.ad--droite_middle,.ad--e,.ad--fallback,.ad--footer,.ad--fullsize,.ad--google,.ad--halfpage,.ad--header,.ad--homepage-top,.ad--in-article,.ad--in-content,.ad--inArticleBanner,.ad--inline,.ad--inner,.ad--large,.ad--leaderboard,.ad--loading,.ad--medium-rectangle,.ad--medium_rectangle,.ad--medium_rectangle_outstream,.ad--mediumrectangle,.ad--mid,.ad--mid-content,.ad--mobile,.ad--mpu,.ad--native,.ad--nativeFlex,.ad--no-bg,.ad--noscroll,.ad--object,.ad--outstream,.ad--overlayer,.ad--p1,.ad--p2,.ad--p3,.ad--p4,.ad--p6,.ad--p7,.ad--placeholder,.ad--pubperform,.ad--pushdown,.ad--rail,.ad--rectangle,.ad--rectangle1,.ad--rectangle2,.ad--right,.ad--rightRail,.ad--scroll,.ad--section,.ad--sidebar,.ad--sky,.ad--skyscraper,.ad--slider,.ad--slot,.ad--sponsor-content,.ad--square-rectangle,.ad--sticky,.ad--stripe,.ad--stroeer,.ad--subcontainer,.ad--top,.ad--top-desktop,.ad--top-leaderboard,.ad--top-slot,.ad--topmobile,.ad--topmobile2,.ad--topmobile3,.ad--wallpaper,.ad--widget,.ad--wrapper,.ad-1,.ad-120-60,.ad-120x60,.ad-120x600,.ad-120x90,.ad-125x125,.ad-13,.ad-137,.ad-14,.ad-160,.ad-160-160,.ad-160x600,.ad-2,.ad-200,.ad-200x200,.ad-250.gnad,.ad-250x300,.ad-3,.ad-300,.ad-300-2,.ad-300-250-600,.ad-300-600,.ad-300-b,.ad-300-block,.ad-300-dummy,.ad-300-flex,.ad-300-x-250,.ad-300250,.ad-300X250,.ad-300X250-body,.ad-300x,.ad-300x100,.ad-300x200,.ad-300x250,.ad-300x600,.ad-336,.ad-336x280,.ad-336x280B,.ad-350,.ad-4,.ad-468,.ad-468x120,.ad-468x60,.ad-5,.ad-544x250,.ad-55,.ad-560,.ad-6,.ad-600,.ad-600-h,.ad-635x40,.ad-7,.ad-728,.ad-728-90,.ad-728-banner,.ad-728-x-90,.ad-728x90,.ad-728x90-1,.ad-728x90-top,.ad-728x90-top0,.ad-728x90-wrapper,.ad-728x90_forum,.ad-768,.ad-8,.ad-88-60,.ad-88x31,.ad-9,.ad-90,.ad-90x600,.ad-970,.ad-970-250,.ad-970-90,.ad-970250,.ad-970x250,.ad-970x90,.ad-Advert_Placeholder,.ad-E,.ad-LREC,.ad-LREC2,.ad-Leaderboard,.ad-MPU,.ad-MediumRectangle,.ad-PENCIL,.ad-S,.ad-Square,.ad-SuperBanner,.ad-TOPPER,.ad-W,.ad-a,.ad-ab,.ad-abc,.ad-above-header,.ad-accordion,.ad-active,.ad-adSense,.ad-adcode,.ad-adhesion,.ad-adlink-bottom,.ad-adlink-side,.ad-adsense,.ad-adsense-block-250,.ad-advertisement-horizontal,.ad-affiliate,.ad-after-content,.ad-after-header,.ad-align-none,.ad-aligncenter,.ad-alignment,.ad-alsorectangle,.ad-anchor,.ad-aps-wide,.ad-area--pd,.ad-area-small,.ad-article-breaker,.ad-article-inline,.ad-article-teaser,.ad-article-wrapper,.ad-aside-pc-billboard,.ad-atf,.ad-atf-top,.ad-background,.ad-background-center,.ad-background-container,.ad-ban,.ad-banner-2,.ad-banner-250x600,.ad-banner-300,.ad-banner-300x250,.ad-banner-5,.ad-banner-6,.ad-banner-728x90,.ad-banner-bottom-container,.ad-banner-box,.ad-banner-btf,.ad-banner-container,.ad-banner-content,.ad-banner-full-wrapper,.ad-banner-header,.ad-banner-image,.ad-banner-inlisting,.ad-banner-leaderboard,.ad-banner-placeholder,.ad-banner-single,.ad-banner-smaller,.ad-banner-static,.ad-banner-top,.ad-banner-top-wrapper,.ad-banner-wrapper,.ad-banners,.ad-bar,.ad-bar-header,.ad-bb,.ad-before-header,.ad-below,.ad-below-images,.ad-below-player,.ad-belowarticle,.ad-bg,.ad-big,.ad-big-box,.ad-bigbanner,.ad-bigbillboard,.ad-bigbox,.ad-bigbox-double-inread,.ad-bigbox-fixed,.ad-bigsize,.ad-billboard,.ad-bline,.ad-block--300,.ad-block--leader,.ad-block-300,.ad-block-banner-container,.ad-block-big,.ad-block-bottom,.ad-block-btf,.ad-block-container,.ad-block-enabled,.ad-block-header,.ad-block-holder,.ad-block-inside,.ad-block-message,.ad-block-mod,.ad-block-section,.ad-block-square,.ad-block-sticky-ad,.ad-block-wide,.ad-block-wk,.ad-block-wrapper,.ad-block-wrapper-dev,.ad-block__overlay,.ad-block_overlay,.ad-blocked,.ad-blocker-warning,.ad-blocking-advisor-wrapper,.ad-blogads,.ad-bnr,.ad-body,.ad-boombox,.ad-border,.ad-bordered,.ad-borderless,.ad-bot,.ad-bottom-container,.ad-bottom-right-container,.ad-bottom728x90,.ad-bottomLeft,.ad-bottomleader,.ad-bottomline,.ad-box-2,.ad-box-300x250,.ad-box-auto,.ad-box-caption,.ad-box-container,.ad-box-title,.ad-box-up,.ad-box-video,.ad-box-wrapper,.ad-box1,.ad-box2,.ad-box3,.ad-box_h,.ad-boxamp-wrapper,.ad-boxbottom,.ad-boxes,.ad-boxsticky,.ad-boxtop,.ad-brdr-btm,.ad-break,.ad-break-item,.ad-breaker,.ad-breakout,.ad-browse-rectangle,.ad-bt,.ad-btn,.ad-btn-heading,.ad-bug-300w,.ad-burnside,.ad-buttons,.ad-c-label,.ad-cad,.ad-calendar,.ad-call-300x250,.ad-callout,.ad-callout-wrapper,.ad-caption,.ad-card,.ad-card-container,.ad-carousel,.ad-cat,.ad-catfish,.ad-cell,.ad-cen,.ad-cen2,.ad-cen3,.ad-centered,.ad-centering,.ad-chartbeatwidget,.ad-choices,.ad-circ,.ad-close-button,.ad-cls,.ad-cls-fix,.ad-cnt,.ad-code,.ad-codes,.ad-col,.ad-col-02 {display: none !important; color: #00b3dd !important; background-color: #db1dff !important;}.ad-colour,.ad-column,.ad-comment,.ad-companion,.ad-complete,.ad-component,.ad-component-fullbanner2,.ad-component-wrapper,.ad-contain,.ad-contain-300x250,.ad-contain-top,.ad-container--hot-video,.ad-container--inline,.ad-container--leaderboard,.ad-container--masthead,.ad-container--mrec,.ad-container--stripe,.ad-container--top,.ad-container-160x600,.ad-container-300x250,.ad-container-728,.ad-container-728x90,.ad-container-adsense,.ad-container-banner-top,.ad-container-bot,.ad-container-bottom,.ad-container-box,.ad-container-embedded,.ad-container-header,.ad-container-inner,.ad-container-inthread,.ad-container-leaderboard,.ad-container-left,.ad-container-m,.ad-container-medium-rectangle,.ad-container-middle,.ad-container-multiple,.ad-container-pave,.ad-container-property,.ad-container-responsive,.ad-container-right,.ad-container-side,.ad-container-single,.ad-container-tool,.ad-container-top,.ad-container-topad,.ad-container-wrapper,.ad-container1,.ad-container3x,.ad-container__ad-slot,.ad-container__leaderboard,.ad-container__sticky-wrapper,.ad-container_row,.ad-content-area,.ad-content-rectangle,.ad-content-slot,.ad-content-wrapper,.ad-context,.ad-critical,.ad-cta,.ad-curtain,.ad-custom-size,.ad-d,.ad-decoration,.ad-defer,.ad-desktop,.ad-desktop-in-content,.ad-desktop-legacy,.ad-desktop-native-1,.ad-desktop-native-2,.ad-desktop-only,.ad-desktop-right,.ad-detail,.ad-dfp-column,.ad-dfp-row,.ad-disclaimer,.ad-disclaimer-container,.ad-disclaimer-text,.ad-display,.ad-displayed,.ad-diver,.ad-divider,.ad-dog,.ad-dog__cnx-container,.ad-dog__ratio-16x9,.ad-dt,.ad-dx_wrp,.ad-e,.ad-engage,.ad-entity-container,.ad-entry-wrapper,.ad-ex,.ad-exchange,.ad-expand,.ad-external,.ad-fadein,.ad-fadeup,.ad-fallback,.ad-feature-content,.ad-feature-sponsor,.ad-feature-text,.ad-featured-video-caption,.ad-feedback,.ad-fi,.ad-field,.ad-filler,.ad-filmstrip,.ad-first,.ad-fix,.ad-fixed,.ad-flag,.ad-flex,.ad-flex-center,.ad-float,.ad-floating,.ad-floor,.ad-footer,.ad-footer-empty,.ad-footer-leaderboard,.ad-format-300x250,.ad-format-300x600,.ad-forum,.ad-frame,.ad-frame-container,.ad-full,.ad-full-width,.ad-fullbanner,.ad-fullbanner-btf-container,.ad-fullbannernohieght,.ad-fullwidth,.ad-gap-sm,.ad-giga,.ad-google,.ad-google-contextual,.ad-gpt,.ad-gpt-breaker,.ad-gpt-container,.ad-gpt-main,.ad-gpt-vertical,.ad-graphic-large,.ad-gray,.ad-grey,.ad-grid,.ad-grid-125,.ad-grid-container,.ad-group,.ad-halfpage,.ad-halfpage-placeholder,.ad-hdr,.ad-head,.ad-header,.ad-header-below,.ad-header-container,.ad-header-creative,.ad-header-inner-wrap,.ad-header-pencil,.ad-header-placeholder,.ad-header-sidebar,.ad-header-small-square,.ad-heading,.ad-height-250,.ad-height-280,.ad-height-600,.ad-here,.ad-hide-mobile,.ad-hideable,.ad-hint,.ad-hldr-tmc,.ad-ho,.ad-hold,.ad-holder-center,.ad-holder-mob-300,.ad-home-bottom,.ad-home-leaderboard-placeholder,.ad-home-right,.ad-homeleaderboard,.ad-homepage,.ad-homepage-1,.ad-homepage-2,.ad-homepage-one,.ad-hor,.ad-horizontal,.ad-horizontal-large,.ad-horizontal-top,.ad-horizontal-top-wrapper,.ad-hoverable,.ad-hpto,.ad-identifier,.ad-iframe,.ad-iframe-container,.ad-in-content,.ad-in-content-300,.ad-in-post,.ad-in-read,.ad-in-results,.ad-inStory,.ad-incontent,.ad-incontent-wrap,.ad-index-main,.ad-indicator-horiz,.ad-info-wrap,.ad-inline,.ad-inline-article,.ad-inline-block,.ad-inner,.ad-inner-container,.ad-inner-container-background,.ad-innr,.ad-insert,.ad-inserter-widget,.ad-inside,.ad-integrated-display,.ad-internal,.ad-interruptor,.ad-interstitial,.ad-island,.ad-item,.ad-item-related,.ad-lable,.ad-landscape,.ad-large-1,.ad-large-game,.ad-last,.ad-lat,.ad-lat2,.ad-layer,.ad-lazy,.ad-lb,.ad-ldrbrd,.ad-lead,.ad-lead-bottom,.ad-leader,.ad-leader-board,.ad-leader-bottom,.ad-leader-plus-top,.ad-leader-top,.ad-leader-wrap,.ad-leader-wrapper,.ad-leaderboard,.ad-leaderboard-base,.ad-leaderboard-companion,.ad-leaderboard-container,.ad-leaderboard-flex,.ad-leaderboard-footer,.ad-leaderboard-header,.ad-leaderboard-middle,.ad-leaderboard-placeholder,.ad-leaderboard-slot,.ad-leaderboard-splitter,.ad-leaderboard-top,.ad-leaderboard-wrapper,.ad-leaderbody,.ad-leaderheader,.ad-leadtop,.ad-left-1,.ad-left-top,.ad-leftrail,.ad-lib-div,.ad-line,.ad-link,.ad-link-block,.ad-link-label,.ad-link-left,.ad-link-right,.ad-links-text,.ad-list-desktop,.ad-loaded,.ad-loader,.ad-location,.ad-location-container,.ad-lock,.ad-lock-content,.ad-lowerboard,.ad-lrec,.ad-m-banner,.ad-m-mrec,.ad-m-rec,.ad-mad,.ad-main,.ad-manager-ad,.ad-manager-placeholder,.ad-manager-wrapper,.ad-margin,.ad-marketplace,.ad-marketswidget,.ad-marquee,.ad-masthead,.ad-masthead-1,.ad-masthead-left,.ad-mb,.ad-med,.ad-med-rec,.ad-med-rect,.ad-med-rect-tmp,.ad-medium,.ad-medium-container,.ad-medium-content,.ad-medium-rectangle,.ad-medium-rectangle-base,.ad-medium-two,.ad-medium-widget,.ad-medrect,.ad-megaboard,.ad-message,.ad-messaging,.ad-microsites,.ad-midleader,.ad-mobile,.ad-mobile--sticky,.ad-mobile-300x150,.ad-mobile-300x250,.ad-mobile-300x50,.ad-mobile-banner,.ad-mobile-flex-inc,.ad-mobile-flex-pos2,.ad-mobile-incontent-ad-plus,.ad-mobile-mpu-plus-outstream-inc,.ad-mobile-nav-ad-plus,.ad-mod,.ad-mod-section,.ad-mod-section-728-90,.ad-module,.ad-mount,.ad-mpl,.ad-mpu,.ad-mpu-bottom,.ad-mpu-container,.ad-mpu-middle,.ad-mpu-middle2,.ad-mpu-placeholder,.ad-mpu-plus-top,.ad-mpu-top,.ad-mpu__aside,.ad-mpufixed,.ad-mr-article,.ad-mrec,.ad-mrect,.ad-msg,.ad-msn,.ad-native,.ad-native-top-sidebar,.ad-nav-ad,.ad-nav-ad-plus,.ad-new,.ad-new-box,.ad-no-css,.ad-no-mobile,.ad-no-notice,.ad-no-style,.ad-noBorderAndMargin,.ad-noline,.ad-note,.ad-notice-small,.ad-observer,.ad-oms,.ad-on,.ad-on-top,.ad-one,.ad-other,.ad-outer,.ad-outlet,.ad-outline,.ad-output-middle,.ad-output-wrapper,.ad-overlay,.ad-packs,.ad-page-leader,.ad-page-medium,.ad-page-setting,.ad-pagehead,.ad-panel,.ad-panel-wrap,.ad-panel__container,.ad-panel__container--styled,.ad-panel__googlead,.ad-panorama,.ad-parallax,.ad-parent-billboard,.ad-parent-class,.ad-parent-halfpage,.ad-pb,.ad-peg,.ad-pencil-margin,.ad-permalink,.ad-personalise,.ad-place,.ad-place-active,.ad-place-holder,.ad-placeholder--mpu,.ad-placeholder-leaderboard,.ad-placeholder-wrapper,.ad-placeholder-wrapper-dynamic,.ad-placeholder:not(#filter_ads_by_classname):not(#detect_ad_empire):not(#detect):not(.adsbox),.ad-placeholder__inner,.ad-placement-left,.ad-placement-right,.ad-places,.ad-plea,.ad-poc,.ad-poc-admin,.ad-popup-content,.ad-pos,.ad-pos-0,.ad-pos-1,.ad-pos-2,.ad-pos-3,.ad-pos-4,.ad-pos-5,.ad-pos-6,.ad-pos-7,.ad-pos-8,.ad-pos-middle,.ad-pos-top,.ad-position,.ad-position-1,.ad-position-2,.ad-poss,.ad-post,.ad-post-footer,.ad-post-top,.ad-postText,.ad-poster,.ad-posterad-inlisting,.ad-preloader-container,.ad-preparing,.ad-prevent-jump,.ad-primary,.ad-primary-desktop,.ad-primary-sidebar,.ad-priority,.ad-program-list,.ad-program-top,.ad-promo,.ad-pub,.ad-push,.ad-pushdown,.ad-r,.ad-rac-box,.ad-rail,.ad-rail-wrapper,.ad-ratio,.ad-rb-hover,.ad-reader-con-item,.ad-rect,.ad-rect-atf-01,.ad-rect-top-right,.ad-rectangle,.ad-rectangle-1,.ad-rectangle-banner,.ad-rectangle-container,.ad-rectangle-long,.ad-rectangle-long-sky,.ad-rectangle-text,.ad-rectangle-wide,.ad-rectangle-xs,.ad-rectangle2,.ad-rectanglemed,.ad-region,.ad-region-delay-load,.ad-related,.ad-relatedbottom,.ad-render-space,.ad-responsive,.ad-responsive-slot,.ad-responsive-wide,.ad-result,.ad-rev-content,.ad-rh,.ad-right,.ad-right-header,.ad-right1,.ad-right2,.ad-right3,.ad-risingstar-container,.ad-roadblock,.ad-rotation,.ad-rotator,.ad-row,.ad-row-box,.ad-row-horizontal,.ad-row-horizontal-top,.ad-row-viewport,.ad-s,.ad-s-rendered,.ad-sample,.ad-script-processed,.ad-scroll,.ad-scrollpane,.ad-search-grid,.ad-secondary-desktop,.ad-section-body,.ad-section-one,.ad-section-three,.ad-section__skyscraper,.ad-sense,.ad-sense-ad,.ad-sep,.ad-separator,.ad-shifted,.ad-show-label,.ad-showcase,.ad-side,.ad-side-one,.ad-side-top,.ad-side-wrapper,.ad-sidebar-mrec,.ad-sidebar-skyscraper,.ad-siderail,.ad-signup,.ad-single-bottom,.ad-sitewide,.ad-size-300x600,.ad-size-728x90,.ad-size-landscape,.ad-size-leaderboard,.ad-size-medium-rectangle,.ad-size-medium-rectangle-flex,.ad-size-mpu,.ad-skeleton,.ad-skin-link,.ad-sky,.ad-sky-left,.ad-sky-right,.ad-sky-wrap,.ad-skyscr,.ad-skyscraper,.ad-skyscraper1,.ad-skyscraper2,.ad-skyscraper3,.ad-slider,.ad-slot,.ad-slot--container,.ad-slot--inline,.ad-slot--mostpop,.ad-slot--mpu-banner-ad,.ad-slot--rendered,.ad-slot--right,.ad-slot--top,.ad-slot--top-above-nav,.ad-slot--top-banner-ad,.ad-slot--wrapper,.ad-slot-1,.ad-slot-2,.ad-slot-234-60,.ad-slot-300-250,.ad-slot-728-90,.ad-slot-a,.ad-slot-article,.ad-slot-banner,.ad-slot-bigbox,.ad-slot-billboard,.ad-slot-box,.ad-slot-container,.ad-slot-container-1,.ad-slot-desktop,.ad-slot-full-width,.ad-slot-header,.ad-slot-horizontal,.ad-slot-inview,.ad-slot-placeholder,.ad-slot-rail,.ad-slot-replies,.ad-slot-replies-header,.ad-slot-responsive,.ad-slot-sidebar,.ad-slot-sidebar-b,.ad-slot-tall,.ad-slot-top,.ad-slot-top-728,.ad-slot-widget,.ad-slot-wrapper,.ad-slotRg,.ad-slotRgc,.ad-slot__ad--top,.ad-slot__content,.ad-slot__label,.ad-slot__oas,.ad-slots-wrapper,.ad-slug,.ad-small,.ad-small-1,.ad-small-2,.ad-smallBP,.ad-sp,.ad-space,.ad-space-mpu-box,.ad-space-topbanner,.ad-spacing,.ad-span,.ad-speedbump,.ad-splash,.ad-sponsor,.ad-sponsor-large-container,.ad-sponsor-text,.ad-sponsored-feed-top,.ad-sponsored-links,.ad-sponsored-post,.ad-sponsors,.ad-spot,.ad-spotlight,.ad-spteaser,.ad-sq-super,.ad-square,.ad-square-placeholder,.ad-square2-container,.ad-square300,.ad-squares,.ad-stack,.ad-standard,.ad-statement,.ad-static,.ad-sticky,.ad-sticky-banner,.ad-sticky-bottom,.ad-sticky-container,.ad-sticky-slot,.ad-sticky-wrapper,.ad-story-inject,.ad-story-top,.ad-strategic,.ad-strip,.ad-style2,.ad-subnav-container,.ad-subtitle,.ad-summary,.ad-superbanner,.ad-superbanner-node,.ad-t,.ad-t-text,.ad-table,.ad-tabs,.ad-tag,.ad-tag-square,.ad-tag__inner,.ad-tag__wrapper,.ad-takeover,.ad-takeover-homepage,.ad-tall,.ad-tech-widget,.ad-temp,.ad-text-centered,.ad-text-label,.ad-text-link,.ad-text-links,.ad-textads,.ad-textlink,.ad-thanks,.ad-ticker,.ad-tile,.ad-tl1,.ad-top,.ad-top-300x250,.ad-top-728,.ad-top-728x90,.ad-top-banner,.ad-top-billboard,.ad-top-billboard-init,.ad-top-box-right,.ad-top-container,.ad-top-desktop,.ad-top-featured,.ad-top-in,.ad-top-lboard,.ad-top-left,.ad-top-mobile,.ad-top-mpu,.ad-top-padding,.ad-top-rectangle,.ad-top-right-container,.ad-top-side,.ad-top-slot,.ad-top-spacing,.ad-top-wrap-inner,.ad-top-wrapper,.ad-topbanner,.ad-topper,.ad-topright,.ad-tower,.ad-tower-container,.ad-towers,.ad-transition,.ad-trck,.ad-truvid,.ad-two,.ad-twos,.ad-txt,.ad-txt-red,.ad-type,.ad-type-branding,.ad-type-cube,.ad-type-flex-leaderboard,.ad-unit--leaderboard,.ad-unit-2,.ad-unit-300,.ad-unit-300-wrapper,.ad-unit-container,.ad-unit-horisontal,.ad-unit-inline-center,.ad-unit-label,.ad-unit-mpu,.ad-unit-panel,.ad-unit-secondary,.ad-unit-sponsored-bar,.ad-unit-t,.ad-unit-text,.ad-unit-top,.ad-unit-wrapper,.ad-unit__inner,.ad-units-single-header-wrapper,.ad-update,.ad-vert,.ad-vertical,.ad-vertical-container,.ad-vertical-stack-ad,.ad-view-zone,.ad-w-300,.ad-w-728,.ad-w-970,.ad-warning,.ad-warp,.ad-watermark,.ad-wgt,.ad-wide,.ad-wide-bottom,.ad-wide-wrap,.ad-widget-area,.ad-widget-box,.ad-widget-list,.ad-widget-sizes,.ad-widget-wrapper,.ad-widgets,.ad-width-300,.ad-width-728,.ad-wireframe,.ad-wireframe-wrapper,.ad-with-background,.ad-with-header-wrapper,.ad-with-notice,.ad-wp,.ad-wp-720,.ad-wppr,.ad-wppr-container,.ad-wrap-leaderboard,.ad-wrap-transparent,.ad-wrap_wallpaper,.ad-wrapp,.ad-wrapper--ad-unit-wrap,.ad-wrapper--articletop,.ad-wrapper--lg,.ad-wrapper--sidebar,.ad-wrapper-250,.ad-wrapper-bg,.ad-wrapper-desktop,.ad-wrapper-left,.ad-wrapper-mobile,.ad-wrapper-mobile-atf,.ad-wrapper-outer,.ad-wrapper-solid,.ad-wrapper-sticky,.ad-wrapper-top,.ad-wrapper-with-text,.ad-wrapper__ad-slug,.ad-xs-title,.ad-zone-ajax,.ad.addon,.ad.bottomrect,.ad.box,.ad.brandboard,.ad.card,.ad.center,.ad.contentboard,.ad.desktop-970x250,.ad.element,.ad.floater-link,.ad.gallery,.ad.halfpage,.ad.inner,.ad.item,.ad.leaderboard,.ad.maxiboard,.ad.maxisky,.ad.middlerect,.ad.module,.ad.monsterboard,.ad.netboard,.ad.post-area,.ad.promotion,.ad.rectangle,.ad.rectangle_2,.ad.rectangle_3,.ad.rectangle_home_1,.ad.reform-top,.ad.section,.ad.sidebar-module,.ad.size-300x250,.ad.skybridgeleft,.ad.small-mpu,.ad.small-teaser,.ad.super,.ad.wideboard_tablet,.ad02,.ad03,.ad04,.ad08sky,.ad1-float,.ad1-left,.ad1-right,.ad10,.ad100,.ad1000,.ad1001,.ad100x100,.ad120,.ad120_600,.ad120x120,.ad120x240GrayBorder,.ad120x60,.ad120x600,.ad125,.ad125x125,.ad125x125a,.ad125x125b,.ad140,.ad160,.ad160600,.ad160_blk,.ad160_l,.ad160_r,.ad160b,.ad160x160,.ad160x600,.ad160x600GrayBorder,.ad160x600_1,.ad160x600box,.ad170x30,.ad18,.ad180,.ad180x80,.ad185x100,.ad19,.ad1Image,.ad1_bottom,.ad1_latest,.ad1_top,.ad1b,.ad1left,.ad1x1,.ad2-float,.ad200,.ad200x60,.ad220x50,.ad230,.ad233x224,.ad234,.ad234x60,.ad236x62,.ad240,.ad250,.ad250wrap,.ad250x250,.ad250x300,.ad260,.ad260x60,.ad284x134,.ad290,.ad2content_box,.ad300,.ad300-hp-top,.ad3001,.ad300250,.ad300Block,.ad300Wrapper,.ad300X250,.ad300_2,.ad300_250,.ad300_bg,.ad300_ver2,.ad300b,.ad300banner,.ad300px,.ad300shows,.ad300top,.ad300w,.ad300x100,.ad300x120,.ad300x150,.ad300x250,.ad300x250-1,.ad300x250-2,.ad300x250-inline,.ad300x250Module,.ad300x250Right,.ad300x250Top,.ad300x250_box,.ad300x250_container,.ad300x250a,.ad300x250b,.ad300x250box,.ad300x250box2,.ad300x250flex,.ad300x250s,.ad300x250x2,.ad300x40,.ad300x50-right,.ad300x600,.ad300x600cat,.ad300x600post,.ad300x77,.ad300x90,.ad310,.ad315,.ad320x250,.ad320x50,.ad336_b,.ad336x250,.ad336x280,.ad336x362,.ad343x290,.ad350,.ad350r,.ad360,.ad366,.ad3rdParty,.ad400,.ad400right,.ad400x40,.ad450,.ad468,.ad468_60,.ad468box,.ad468innerboxadpic,.ad468x60,.ad468x60Wrap,.ad468x60_main,.ad470x60,.ad530,.ad540x90,.ad590,.ad590x90,.ad5_container,.ad600,.ad612x80,.ad620x70,.ad626X35,.ad640x480,.ad644,.ad650x140,.ad652,.ad70,.ad728,.ad72890,.ad728By90,.ad728_90,.ad728_blk,.ad728_cont,.ad728_wrap,.ad728b,.ad728cont,.ad728h,.ad728top,.ad728x90-1,.ad728x90-2,.ad728x90box,.ad728x90btf,.ad970,.ad970_250,.adAlert,.adArea,.adAreaLC,.adAreaNative,.adAreaTopTitle,.adArticleBanner,.adArticleBody,.adArticleSideTop300x250,.adBan,.adBanner300x250,.adBanner728x90,.adBillboard,.adBkgd,.adBlock,.adBlock728,.adBlockBottom,.adBlockDetectedSign,.adBlockNotification,.adBlockNotificationOverlay,.adBlockSpacer,.adBlockSpot,.adBlockWarning,.adBorder,.adBorders,.adBox,.adBox-small,.adBox1,.adBox2,.adBox5,.adBox6,.adBox728,.adBox728X90,.adBox728X90_header,.adBoxBody {display: none !important; color: #00b3dd !important; background-color: #db1dff !important;}.adBoxBorder,.adBoxContainer,.adBoxContent,.adBoxFooter,.adBoxHeader,.adBoxSidebar,.adBoxSingle,.adBoxTitle,.adBox_1,.adBox_3,.adBtm,.adCall,.adCaptionText,.adCell,.adCenter,.adCenterAd,.adCentertile,.adChoice,.adChoiceLogo,.adChrome,.adClose,.adColumn,.adColumnLeft,.adColumnRight,.adComponent,.adCont,.adContTop,.adContainer1,.adContainerSide,.adContent,.adContentAd,.adContour,.adCopy,.adCreative,.adCreator,.adCube,.adDefRect,.adDetails_ad336,.adDiv,.adDrawer,.adDyn,.adElement,.adExpanded,.adFooterLinks,.adFrame,.adFrameCnt,.adFrameContainer,.adFrames,.adFuel-label,.adFull,.adFullbanner,.adGlobalHeader,.adGoogle,.adGroup,.adHalfPage,.adHead,.adHeader,.adHeaderAdbanner,.adHeaderText,.adHeaderblack,.adHeading,.adHeadline,.adHeadlineSummary,.adHed,.adHeight200,.adHeight270,.adHeight280,.adHeight313,.adHeight600,.adHolder2,.adHolderStory,.adHoldert,.adHome300x250,.adHomeSideTop300x250,.adHorisontal,.adHorisontalNoBorder,.adHorizontalTextAlt,.adHplaceholder,.adHz,.adIDiv,.adIframe,.adIframeCount,.adImgIM,.adInArticle,.adInContent,.adInfo,.adInitRemove,.adInner,.adInnerLeftBottom,.adInsider,.adInteractive,.adIsland,.adItem,.adLabel,.adLabelLine,.adLabels,.adLargeRec,.adLargeRect,.adLat,.adLayer,.adLeader,.adLeaderBoard_container,.adLeaderForum,.adLeaderboard,.adLeaderboardAdContainer,.adLeft,.adLine,.adLinkCnt,.adListB,.adLoader,.adLocal,.adLocation,.adMPU,.adMPUHome,.adMRECHolder,.adMarker,.adMarkerBlock,.adMastheadLeft,.adMastheadRight,.adMed,.adMedRectBox,.adMedRectBoxLeft,.adMediaMiddle,.adMediumRectangle,.adMessage,.adMinHeight280,.adMinHeight313,.adMiniTower,.adMod,.adModule,.adModule--inner,.adModule--outer,.adModule-outer,.adModule300,.adModuleAd,.adMpu,.adMpuHolder,.adMrginBottom,.adNarrow,.adNoBorder,.adNoOutline,.adNone,.adNote,.adNotice,.adNotice90,.adNoticeOut,.adNotification,.adObj,.adOne,.adOuterContainer,.adOverlay,.adPanel,.adPanelContent,.adPanorama,.adPlaceholder,.adPlacement,.adPod,.adPosition,.adPremium,.adRecommend,.adRecommendRight,.adRect,.adRectangle,.adRectangle-pos-large,.adRectangle-pos-medium,.adRectangle-pos-small,.adRectangleBanner,.adRectangleUnit,.adRemove,.adRenderer,.adRendererInfinite,.adResponsive,.adResults,.adRight,.adRightSide,.adRightSky,.adRoller,.adRotator,.adRow,.adRowTopWrapper,.adSKY,.adSection,.adSenceImagePush,.adSense,.adSense-header,.adSepDiv,.adServer,.adSeven,.adSide,.adSideBarMPU,.adSideBarMPUTop,.adSidebarButtons,.adSizer,.adSkin,.adSky,.adSkyscaper,.adSkyscraper,.adSlice,.adSlide,.adSlot,.adSlot-container,.adSlotAdition,.adSlotCnt,.adSlotContainer,.adSlotHeaderContainer,.adSlug,.adSpBelow,.adSpace,.adSpace300x250,.adSpace950x90,.adSpacer,.adSpec,.adSplash,.adSponsor,.adSponsorText,.adSponsorhipInfo,.adSpot,.adSpot-mrec,.adSpot-textBox,.adSpotBlock,.adSpotFullWidth,.adSpotIsland,.adSquare,.adStatementText,.adStyle,.adStyle1,.adSub,.adSubColPod,.adSummary,.adSuperboard,.adSupertower,.adTD,.adTXTnew,.adTab,.adTag,.adTag-top,.adTag-wrap,.adTagThree,.adTagTwo,.adTextDownload,.adTextPmpt,.adTextStreaming,.adTextWrap,.adTicker,.adTile,.adTileWrap,.adTiler,.adTip,.adTitle,.adTitleR,.adTop,.adTopBk,.adTopFloat,.adTopHome,.adTopLB,.adTopLeft,.adTopRight,.adTopWrapper,.adTopboxright,.adTwo,.adTxt,.adType2,.adUnderArticle,.adUnit,.adUnitHorz,.adUnitVert,.adVar,.adVertical,.adVideo,.adVideo2,.adVl,.adVplaceholder,.adWarning,.adWebBoard,.adWideSkyscraper,.adWideSkyscraperRight,.adWidget,.adWidgetBlock,.adWithTab,.adWizard-ad,.adWord,.adWords-bg,.adWrapLg,.adWrapper,.adWrapper1,.adZone,.adZoneRight,.ad_0,.ad_1,.ad_1000_125,.ad_120x60,.ad_120x600,.ad_120x90,.ad_125,.ad_130x90,.ad_150x150,.ad_160,.ad_160_600,.ad_160x600,.ad_188_inner,.ad_1deg5up,.ad_1tdq7q5,.ad_2,.ad_200,.ad_240,.ad_250250,.ad_250x200,.ad_250x250,.ad_290_290,.ad_3,.ad_300,.ad_300250,.ad_300_250,.ad_300_250_1,.ad_300_250_2,.ad_300_250_wrapper,.ad_300_600,.ad_300by250,.ad_300x100,.ad_300x250,.ad_300x250_container,.ad_300x600,.ad_320x250_async,.ad_336,.ad_336x280,.ad_350x250,.ad_4,.ad_468,.ad_468x60,.ad_5,.ad_600,.ad_640,.ad_640x480,.ad_728,.ad_72890,.ad_728Home,.ad_728_90,.ad_728_90_1,.ad_728_90b,.ad_728_top,.ad_728x90,.ad_728x90-1,.ad_728x90-2,.ad_728x90_container,.ad_728x90b,.ad_90,.ad_970x250,.ad_970x250_300x250,.ad_970x250_container,.ad_Bumper,.ad_Flex,.ad_Left,.ad__300x250,.ad__300x600,.ad__970x250,.ad__align,.ad__centered,.ad__container,.ad__content,.ad__full--width,.ad__header,.ad__holder,.ad__image,.ad__in_article,.ad__inline,.ad__label,.ad__leaderboard,.ad__mobi,.ad__mobile-footer,.ad__mpu,.ad__placeholder,.ad__rectangle,.ad__section-border,.ad__sidebar,.ad__space,.ad__sticky,.ad__template,.ad__window,.ad__wrapper,.ad_adv,.ad_after_section,.ad_amazon,.ad_area,.ad_area_two,.ad_back,.ad_background,.ad_background_1,.ad_background_true,.ad_banner2,.ad_banner_2,.ad_banner_250x250,.ad_banner_468,.ad_banner_728,.ad_banner_728x90_inner,.ad_banner_border,.ad_banner_div,.ad_bar,.ad_below_content,.ad_belowfirstpost_frame,.ad_bgskin,.ad_big_banner,.ad_bigbox,.ad_billboard,.ad_blk,.ad_block_1,.ad_block_2,.ad_block_widget,.ad_border,.ad_botbanner,.ad_bottom_728,.ad_bottom_leaderboard,.ad_bottom_left,.ad_bottom_mpu,.ad_bottom_space,.ad_box1,.ad_box2,.ad_box_2,.ad_box_6,.ad_box_9,.ad_box_ad,.ad_box_div,.ad_box_header,.ad_box_spacer,.ad_box_top,.ad_break,.ad_break2_container,.ad_break_container,.ad_btf,.ad_btn-white,.ad_btn1,.ad_btn2,.ad_by,.ad_callout,.ad_center,.ad_center_bottom,.ad_centered,.ad_choice,.ad_choices,.ad_cl,.ad_claim,.ad_click,.ad_cls_fix,.ad_code,.ad_col,.ad_column,.ad_column_box,.ad_common,.ad_con,.ad_cont,.ad_cont_footer,.ad_contain,.ad_container_body,.ad_container_bottom,.ad_content,.ad_content_below,.ad_content_bottom,.ad_content_wide,.ad_content_wrapper,.ad_contents,.ad_crown,.ad_custombanner,.ad_d_big,.ad_db,.ad_default,.ad_description,.ad_desktop,.ad_disclaimer,.ad_div_banner,.ad_div_box,.ad_div_box2,.ad_element,.ad_embed,.ad_feature,.ad_float,.ad_floating_box,.ad_fluid,.ad_footer,.ad_footer_super_banner,.ad_frame_around,.ad_fullwidth,.ad_gam,.ad_google,.ad_gpt,.ad_grein_botn,.ad_grid,.ad_group,.ad_half_page,.ad_halfpage,.ad_hd,.ad_head,.ad_head_rectangle,.ad_header,.ad_header_top,.ad_heading,.ad_headline,.ad_holder,.ad_horizontal,.ad_hover_href,.ad_iframe2,.ad_img,.ad_imgae_150,.ad_in_article,.ad_in_text,.ad_incontent,.ad_index02,.ad_indicator,.ad_inline,.ad_inline_wrapper,.ad_inner,.ad_inset,.ad_island,.ad_label,.ad_large,.ad_lb,.ad_leader,.ad_leader_bottom,.ad_leader_plus_top,.ad_leaderboard,.ad_leaderboard_atf,.ad_leaderboard_master,.ad_leaderboard_top,.ad_leaderboard_wrap,.ad_left_cell,.ad_left_column,.ad_lft,.ad_line2,.ad_link,.ad_links,.ad_lnks,.ad_loc,.ad_long,.ad_lrec,.ad_lrgsky,.ad_lt,.ad_maintopad,.ad_margin,.ad_marker,.ad_masthead,.ad_med,.ad_medium_rectangle,.ad_medrec,.ad_medrect,.ad_megabanner,.ad_message,.ad_mid_post_body,.ad_middle_banner,.ad_mobile,.ad_mod,.ad_module,.ad_mp,.ad_mpu,.ad_mpu_top,.ad_mr,.ad_mrec,.ad_native,.ad_native_xrail,.ad_news,.ad_no_border,.ad_note,.ad_notice,.ad_oms,.ad_on_article,.ad_one,.ad_one_one,.ad_one_third,.ad_outer,.ad_overlays,.ad_p360,.ad_pagebody,.ad_panel,.ad_paragraphs_desktop_container,.ad_partner,.ad_partners,.ad_pause,.ad_pic,.ad_place,.ad_placeholder,.ad_placeholder_d_b,.ad_placeholder_d_s,.ad_placeholder_d_sticky,.ad_placement,.ad_player_container,.ad_plus,.ad_position,.ad_post,.ad_primary,.ad_promo,.ad_promo1,.ad_promo_spacer,.ad_push,.ad_r,.ad_rec,.ad_rect,.ad_rectangle,.ad_rectangle_300_250,.ad_rectangle_medium,.ad_rectangular,.ad_regular1,.ad_regular2,.ad_regular3,.ad_reminder,.ad_response,.ad_rhs,.ad_right,.ad_rightSky,.ad_right_300_250,.ad_right_cell,.ad_right_col,.ad_rightside,.ad_row,.ad_scroll,.ad_secondary,.ad_segment,.ad_sense_01,.ad_sense_footer_container,.ad_share_box,.ad_side,.ad_side_box,.ad_side_rectangle_banner,.ad_sidebar,.ad_sidebar_bigbox,.ad_sidebar_inner,.ad_sidebar_left,.ad_sidebar_right,.ad_size_160x600,.ad_skin,.ad_sky,.ad_sky2,.ad_sky2_2,.ad_skyscpr,.ad_skyscraper,.ad_skyscrapper,.ad_slider_out,.ad_slot,.ad_slot_inread,.ad_slot_right,.ad_slug,.ad_small,.ad_space,.ad_space_300_250,.ad_spacer,.ad_sponsor,.ad_sponsor_fp,.ad_sponsoredsection,.ad_spot_b,.ad_spot_c,.ad_spotlight,.ad_square,.ad_square_r,.ad_square_r_top,.ad_square_top,.ad_start,.ad_static,.ad_station,.ad_story_island,.ad_stream,.ad_stream_hd,.ad_sub,.ad_supersize,.ad_table,.ad_tag,.ad_tag_middle,.ad_text,.ad_text_link,.ad_text_links,.ad_text_vertical,.ad_text_w,.ad_textlink1,.ad_textlink_box,.ad_thumbnail_header,.ad_title_small,.ad_tlb,.ad_to_list,.ad_top1,.ad_top_1,.ad_top_2,.ad_top_3,.ad_top_banner,.ad_top_leaderboard,.ad_top_left,.ad_top_mpu,.ad_top_right,.ad_topic_content,.ad_topmain,.ad_topright,.ad_topshop,.ad_tower,.ad_trailer_header,.ad_trick_header,.ad_trick_left,.ad_ttl,.ad_two,.ad_two_third,.ad_txt2,.ad_type_1,.ad_type_adsense,.ad_type_dfp,.ad_under,.ad_under_royal_slider,.ad_unit,.ad_unit_300,.ad_unit_300_x_250,.ad_unit_600,.ad_unit_rail,.ad_unit_wrapper,.ad_unit_wrapper_main,.ad_url,.ad_v2,.ad_v3,.ad_vertisement,.ad_w,.ad_w300h450,.ad_w300i,.ad_w_us_a300,.ad_warn,.ad_warning,.ad_watch_now,.ad_watermark,.ad_wid300,.ad_wide,.ad_wide_vertical,.ad_widget,.ad_widget_200_100,.ad_widget_200_200,.ad_widget_image,.ad_widget_title,.ad_word,.ad_wrap,.ad_wrapper,.ad_wrapper_300,.ad_wrapper_970x90,.ad_wrapper_box,.ad_wrapper_false,.ad_wrapper_fixed,.ad_wrapper_top,.ad_wrp,.ad_xrail,.ad_xrail_top,.ad_zone,.adace-adi-popup-wrapper,.adace-slideup-slot-wrap,.adace-slot,.adace-slot-wrapper,.adace-sponsors-box,.adace-vignette,.adalert-overlayer,.adalert-toplayer,.adamazon,.adarea,.adarea-long,.adarticle,.adb-enabled,.adb-top,.adback,.adband,.adbanner-300-250,.adbanner-bottom,.adbanner1,.adbannerbox,.adbannerright,.adbannertop,.adbase,.adbbox,.adbckgrnd,.adbd-background,.adbd-message,.adbd-wrapper,.adbetween,.adbetweenarticles,.adbkgnd,.adblade,.adblade-container,.adbladeimg,.adblk,.adblock-bottom,.adblock-header,.adblock-header1,.adblock-main,.adblock-modal,.adblock-modal-content,.adblock-notification-wrapper,.adblock-popup,.adblock-top,.adblock-top-left,.adblock-warning-teaser,.adblock-wide,.adblock300,.adblock300250,.adblock728x90,.adblockOverlay,.adblock__banner,.adblock_detector,.adblock_enabled,.adblock_floating_message,.adblock_msg,.adblock_noborder,.adblock_primary,.adblockdiv,.adblocker-message,.adblocker-wrap,.adblocks-topright,.adboard,.adborder,.adborderbottom,.adbordertop,.adbot,.adbot_postbit,.adbot_showthread,.adbottom,.adbottomright,.adbox-300x250,.adbox-468x60,.adbox-border-desk,.adbox-box,.adbox-header,.adbox-outer,.adbox-rectangle,.adbox-sidebar,.adbox-slider,.adbox-style,.adbox-title,.adbox-topbanner,.adbox-wrapper,.adbox1,.adbox160,.adbox2,.adbox300,.adbox300x250,.adbox336,.adbox600,.adbox728,.adboxRightSide,.adboxTopBanner,.adboxVert,.adbox_300x600,.adbox_310x400,.adbox_366x280,.adbox_468X60,.adbox_border,.adbox_bottom,.adbox_br,.adbox_cont,.adbox_largerect,.adbox_left,.adbox_top,.adboxbg,.adboxbot,.adboxclass,.adboxcm,.adboxcontent,.adboxcontentsum,.adboxes,.adboxesrow,.adboxid,.adboxlarge,.adboxlong,.adboxo,.adboxtop,.adbreak,.adbrite2,.adbtn,.adbtns,.adbttm_right_300,.adbttm_right_label,.adbucks,.adbug,.adbutler-inline-ad,.adbutler-top-banner,.adbutler_top_banner,.adbutton-block,.adbuttons,.adcasing,.adchange,.adchoices,.adchoices-link,.adclass,.adcode-widget,.adcode300x250,.adcode728x90,.adcode_container,.adcodetop,.adcol1,.adcol2,.adcolumn,.adcolumn_wrapper,.adcomment,.adcon,.adcont,.adcontainer-Leaderboard,.adcontainer-Rectangle,.adcontainer2,.adcontainer_big,.adcontainer_footer,.adcopy,.add-box-side,.add-box-top,.add-sidebar,.add300,.add300top,.add300x250,.addAdvertContainer,.add_topbanner,.addarea,.addarearight,.addbanner,.addboxRight,.addisclaimer,.addiv,.adds2,.adds300x250,.adds620x90,.addtitle,.addvert,.addwide,.adengageadzone,.adenquire,.adex-ad-text,.adfbox,.adfeedback,.adfeeds,.adfix,.adflag,.adflexi,.adfliction,.adfoot,.adfootbox,.adfooter,.adform__topbanner,.adfoxly-overlay,.adfoxly-place-delay,.adfoxly-wrapper,.adframe,.adframe2,.adframe_banner,.adframe_rectangle,.adfree,.adfront,.adfront-head,.adfrp,.adfull,.adgear,.adgmleaderboard,.adguru-content-html,.adguru-modal-popup,.adhalfhome,.adhalfpage,.adhalfpageright,.adhead,.adheader,.adheightpromo,.adheighttall,.adherebox,.adhesion-block,.adhesion-header,.adhesiveAdWrapper,.adhesiveWrapper,.adhesive_holder,.adhi,.adhint,.adholder,.adholder-300,.adholderban,.adhoriz,.adiframe,.adindex,.adindicator,.adinfo,.adinjwidget,.adinner,.adinpost,.adinsert,.adinsert160,.adinside,.adintext,.adintro,.adisclaimer,.adisland,.adits,.adjlink,.adk-slot,.adkicker,.adkit,.adlabel-horz,.adlabel-vert,.adlabel1,.adlabel2,.adlabel3,.adlabelleft,.adlarge,.adlarger,.adlateral,.adlayer,.adleader,.adleft1,.adleftph,.adlgbox,.adline,.adlinkdiv,.adlinks,.adlinks-class {display: none !important; color: #00b3dd !important; background-color: #db1dff !important;}.adlist,.adlist1,.adlist2,.adloaded,.adlsot,.admain,.adman,.admarker,.admaster,.admediumred,.admedrec,.admeldBoxAd,.admessage,.admiddle,.admiddlesidebar,.admngr,.admngrfr,.admngrft,.admods,.admodule,.admoduleB,.admpu,.admpu-small,.admputop,.admz,.adnSpot,.adname,.adnet_area,.adnotecenter,.adnotice,.adnotification,.adnz-ad-placeholder,.adocean,.adocean728x90,.adocean_desktop_section,.adops,.adpacks,.adpacks_content,.adpadding,.adpane,.adparent,.adpic,.adplace,.adplace_center,.adplaceholder-top,.adplacement,.adplate-background,.adplugg-tag,.adpod,.adpopup,.adpos-300-mobile,.adpost,.adposter_pos,.adproxy,.adrec,.adrechts,.adrectangle,.adrectwrapper,.adrevtising-buttom,.adright,.adright300,.adrightlg,.adrightsm,.adrighttop,.adriverBanner,.adroot,.adrotate-sponsor,.adrotate-widget,.adrotate_ads_row,.adrotate_top_banner,.adrotate_widget,.adrotate_widgets,.adrotatediv,.adrule,.ads--bottom-spacing,.ads--desktop,.ads--full,.ads--no-preload,.ads--sidebar,.ads--single,.ads--square,.ads--super,.ads--top,.ads-1,.ads-120x600,.ads-125,.ads-160x600,.ads-160x600-outer,.ads-2,.ads-3,.ads-300,.ads-300-250,.ads-300-box,.ads-300x250,.ads-300x250-sidebar,.ads-300x300,.ads-300x600,.ads-320-50,.ads-320x250,.ads-336x280,.ads-468,.ads-728,.ads-728-90,.ads-728by90,.ads-728x90,.ads-980x90,.ads-above-comments,.ads-ad,.ads-advertorial,.ads-article-right,.ads-articlebottom,.ads-aside,.ads-banner-bottom,.ads-banner-js,.ads-banner-middle,.ads-banner-spacing,.ads-banner-top,.ads-banner-top-right,.ads-base,.ads-beforecontent,.ads-below-content,.ads-below-home,.ads-below-view-content,.ads-between-comments,.ads-bg,.ads-bigbox,.ads-bilboards,.ads-bing-bottom,.ads-bing-top,.ads-block-bottom-wrap,.ads-block-link-text,.ads-block-panel-tipo-1,.ads-block-rightside,.ads-block-top,.ads-block-top-right,.ads-bottom,.ads-bottom-block,.ads-bottom-center,.ads-bottom-content,.ads-bottom-left,.ads-bottom-right,.ads-box,.ads-box-cont,.ads-bt,.ads-btm,.ads-by,.ads-by-google,.ads-callback,.ads-card,.ads-carousel,.ads-center,.ads-centered,.ads-cnt,.ads-code,.ads-col,.ads-cols,.ads-cont,.ads-container-250,.ads-content,.ads-custom,.ads-decorator,.ads-desktop,.ads-div,.ads-el,.ads-end-content,.ads-favicon,.ads-feed,.ads-fieldset,.ads-footer,.ads-fr,.ads-global-header,.ads-global-top,.ads-google,.ads-google-bottom,.ads-google-top,.ads-grp,.ads-half,.ads-header-desktop,.ads-header-left,.ads-header-right,.ads-here,.ads-hints,.ads-holder,.ads-home,.ads-homepage-2,.ads-horizontal,.ads-horizontal-banner,.ads-inarticle,.ads-inner,.ads-instance,.ads-internal,.ads-item,.ads-label,.ads-label-inverse,.ads-large,.ads-leaderboard,.ads-leaderboard-border,.ads-leaderboard-panel,.ads-leaderbord,.ads-line,.ads-list,.ads-long,.ads-main,.ads-margin,.ads-marker,.ads-medium-rect,.ads-middle,.ads-middle-top,.ads-minheight,.ads-mini,.ads-mini-3rows,.ads-module,.ads-module-alignment,.ads-movie,.ads-mpu,.ads-narrow,.ads-native-wrapper,.ads-note,.ads-one,.ads-outer,.ads-panel,.ads-parent,.ads-pholder,.ads-placeholder,.ads-placeholder-inside,.ads-placeholder-wrapper,.ads-placment,.ads-post,.ads-post-closing,.ads-post-footer,.ads-post-full,.ads-posting,.ads-profile,.ads-rail,.ads-rect,.ads-rectangle,.ads-relatedbottom,.ads-rendering-fix,.ads-right,.ads-right-min,.ads-rotate,.ads-scroller-box,.ads-section,.ads-side,.ads-sidebar,.ads-sidebar-boxad,.ads-sidebar-widget,.ads-sidebarx,.ads-sign,.ads-single,.ads-site,.ads-size-small,.ads-skin,.ads-skin-mobile,.ads-sky,.ads-skyscraper,.ads-skyscraper-container-left,.ads-skyscraper-container-right,.ads-skyscraper-left,.ads-skyscraper-right,.ads-small,.ads-small-horizontal,.ads-small-squares,.ads-smartphone,.ads-social-box,.ads-sponsored-title,.ads-sponsors,.ads-square,.ads-square-large,.ads-square-small,.ads-squares,.ads-star,.ads-stick-footer,.ads-sticky,.ads-story,.ads-story-leaderboard-atf,.ads-stripe,.ads-styled,.ads-superbanner,.ads-system,.ads-text,.ads-to-hide,.ads-top,.ads-top-728,.ads-top-center,.ads-top-content,.ads-top-fixed,.ads-top-home,.ads-top-left,.ads-top-main,.ads-top-right,.ads-top-spacer,.ads-topbar,.ads-two,.ads-txt,.ads-ul,.ads-verticle,.ads-wall-container,.ads-wide,.ads-widget,.ads-widget-content,.ads-widget-content-wrap,.ads-widget-link,.ads-wrap,.ads-wrapper,.ads-wrapper-top,.ads-x1,.ads-zone,.ads.bottom,.ads.box,.ads.cell,.ads.cta,.ads.grid-layout,.ads.square,.ads.top,.ads.video-block,.ads01,.ads10,.ads11,.ads120,.ads120_600,.ads120_600-widget,.ads120_80,.ads120x,.ads123,.ads125,.ads125-widget,.ads160,.ads160-600,.ads2,.ads250,.ads250-250,.ads2Block,.ads3,.ads300,.ads300-200,.ads300-250,.ads300250,.ads300_250,.ads300_600-widget,.ads300box,.ads300x600,.ads336_280,.ads336x280,.ads4,.ads468,.ads468x60,.ads600,.ads720x90,.ads728,.ads728_90,.ads728b,.ads728x90,.ads728x90-1,.ads970,.adsAdvert,.adsArea,.adsBanner,.adsBannerLink,.adsBlockContainerHorizontal,.adsBot,.adsBottom,.adsBoxTop,.adsCap,.adsCell,.adsColumn,.adsConfig,.adsCont,.adsDef,.adsDesktop,.adsDetailsPage,.adsDisclaimer,.adsDiv,.adsFirst,.adsFixed,.adsFull,.adsHeader,.adsHeading,.adsHeight300x250,.adsHeight720x90,.adsHome-full,.adsImages,.adsInner,.adsLabel,.adsLibrary,.adsLine,.adsMPU,.adsMag,.adsMarker,.adsMiddle,.adsMvCarousel,.adsNetwork,.adsOuter,.adsOverPrimary,.adsPlaceHolder,.adsPostquare,.adsPushdown,.adsRectangleMedium,.adsRight,.adsRow,.adsSecond,.adsSectionRL,.adsSpacing,.adsSticky,.adsTag,.adsTop,.adsTopBanner,.adsTopCont,.adsTower2,.adsTowerWrap,.adsTxt,.adsWidget,.adsWrap,.ads_160,.ads_180,.ads_2,.ads_3,.ads_300,.ads_300_250,.ads_300x250,.ads_300x600,.ads_4,.ads_468,.ads_468x60,.ads_720x90,.ads_728,.ads_728x90,.ads_Header,.ads__article__header,.ads__aside,.ads__container,.ads__header,.ads__horizontal,.ads__hyperleaderboard--hyperleaderboard,.ads__inline,.ads__interstitial,.ads__link,.ads__listing,.ads__mid,.ads__middle,.ads__midpage-fullwidth,.ads__native,.ads__right-rail-ad,.ads__sidebar,.ads__top,.ads_after,.ads_after_more,.ads_amazon,.ads_area,.ads_article,.ads_ba_cad,.ads_banner,.ads_bar,.ads_before,.ads_between_content,.ads_bg,.ads_big,.ads_block,.ads_border,.ads_box_headline,.ads_box_type1,.ads_center,.ads_code,.ads_column,.ads_container:not(.text-ad),.ads_container_top,.ads_content,.ads_css,.ads_div,.ads_div1,.ads_foot,.ads_footer,.ads_footerad,.ads_full_1,.ads_google,.ads_h,.ads_h1,.ads_h2,.ads_header,.ads_header_bottom,.ads_holder,.ads_home,.ads_horizontal,.ads_inview,.ads_item,.ads_label,.ads_lb,.ads_leader,.ads_leaderboard,.ads_left,.ads_main,.ads_main_hp,.ads_media,.ads_medium,.ads_medium_rectangle,.ads_medrect,.ads_middle,.ads_middle-container,.ads_middle_container,.ads_mobile_vert,.ads_mpu,.ads_outer,.ads_outline,.ads_place,.ads_place_160,.ads_place_top,.ads_placeholder,.ads_player,.ads_post,.ads_prtext,.ads_rectangle,.ads_remove,.ads_rightbar_top,.ads_side,.ads_sideba,.ads_sidebar,.ads_single_center,.ads_single_side,.ads_single_top,.ads_singlepost,.ads_slice,.ads_slot,.ads_small,.ads_small_rectangle,.ads_space_long,.ads_spacer,.ads_square,.ads_takeover,.ads_text,.ads_tit,.ads_title,.ads_top,.ads_top_1,.ads_top_banner,.ads_top_both,.ads_top_middle,.ads_top_nav,.ads_topbanner,.ads_topleft,.ads_topright,.ads_tr,.ads_under_data,.ads_unit,.ads_up,.ads_video,.ads_wide,.ads_widesky,.ads_widget,.ads_wrap,.ads_wrap-para,.adsafp,.adsanity-alignnone,.adsanity-group,.adsanity-single,.adsarea,.adsartical,.adsbanner1,.adsbanner2,.adsbantop,.adsbar,.adsbg300,.adsbillboard,.adsblock,.adsblockvert,.adsbnr,.adsbody,.adsborder,.adsboth,.adsbottom,.adsbox--masthead,.adsbox-square,.adsbox970x90,.adsbox990x90,.adsboxBtn,.adsbox_300x250,.adsboxitem,.adsbx728x90,.adsbyadop,.adsbyexoclick,.adsbyexoclick-wrapper,.adsbygalaksion,.adsbygoogle-box,.adsbygoogle-noablate,.adsbygoogle-wrapper,.adsbygoogle2,.adsbypublift,.adsbypubmax,.adsbytrafficjunky,.adsbyvli,.adsbyxa,.adscaleTop,.adscenter,.adscentertext,.adsclick,.adscontent250,.adscontentcenter,.adscontntad,.adscreen,.adsdelivery,.adsdesktop,.adsdiv,.adsection_a2,.adsection_c2,.adsection_c3,.adsenbox,.adsens,.adsense-250,.adsense-300-600,.adsense-336,.adsense-336-280,.adsense-468,.adsense-728-90,.adsense-ad-results,.adsense-ads,.adsense-afterpost,.adsense-area,.adsense-article,.adsense-block,.adsense-box,.adsense-center,.adsense-code,.adsense-container,.adsense-content,.adsense-div,.adsense-float,.adsense-googleAds,.adsense-header,.adsense-heading,.adsense-iframe-container,.adsense-inline,.adsense-left,.adsense-links,.adsense-loading,.adsense-module,.adsense-overlay,.adsense-post,.adsense-resposivo-meio,.adsense-right,.adsense-slot,.adsense-square,.adsense-sticky-slide,.adsense-title,.adsense-top,.adsense-unit,.adsense-widget,.adsense-wrapper,.adsense1,.adsense160x600,.adsense250,.adsense3,.adsense300,.adsense300x250,.adsense728,.adsense728x90,.adsenseAds,.adsenseBannerArea,.adsenseBlock,.adsenseContainer,.adsenseList,.adsenseRow,.adsenseSky,.adsenseWrapper,.adsense_200,.adsense_336_280,.adsense_728x90_container,.adsense_ad,.adsense_block,.adsense_bottom,.adsense_container,.adsense_content_300x250,.adsense_div_wrapper,.adsense_inner,.adsense_label,.adsense_leader,.adsense_media,.adsense_menu,.adsense_mpu,.adsense_rectangle,.adsense_results,.adsense_right,.adsense_sidebar,.adsense_sidebar_top,.adsense_single,.adsense_top,.adsense_top_ad,.adsense_unit,.adsensebig,.adsensefloat,.adsenseformat,.adsenseframe,.adsenseleaderboard,.adsensemobile,.adsenvelope,.adsep,.adserve_728,.adserverBox,.adserver_zone,.adserverad,.adserving,.adset,.adsfloat,.adsfloatpanel,.adsforums,.adsghori,.adsgrd,.adsgvert,.adsheight-250,.adshowbig,.adshowcase,.adshp,.adside,.adside-box-index,.adside-box-single,.adside_box,.adsidebar,.adsidebox,.adsider,.adsincs2,.adsinfo,.adsingle,.adsingle-r,.adsingleph,.adsitem,.adsize728,.adsizer,.adsizewrapper,.adskeeperWrap,.adsky,.adsleaderboard,.adsleaderboardbox,.adsleff,.adsleftblock,.adslibraryArticle,.adslider,.adslink,.adslist,.adslisting,.adslisting2,.adslistingz,.adsload,.adsloading,.adslogan,.adslot--leaderboard,.adslot-area,.adslot-banner,.adslot-billboard,.adslot-feature,.adslot-inline-wide,.adslot-mpu,.adslot-rectangle,.adslot-widget,.adslot970,.adslotMid,.adslot_1,.adslot_1m,.adslot_2,.adslot_2m,.adslot_3,.adslot_300,.adslot_3d,.adslot_3m,.adslot_4,.adslot_728,.adslot__ad-container,.adslot__ad-wrapper,.adslot_blurred,.adslot_bot_300x250,.adslot_collapse,.adslot_popup,.adslot_side1,.adslothead,.adslotleft,.adslotright,.adslotright_1,.adslotright_2,.adslug,.adsmaintop,.adsmall,.adsmaller,.adsmalltext,.adsmanag,.adsmbody,.adsmedrect,.adsmedrectright,.adsmessage,.adsmobile,.adsninja-ad-zone-container-with-set-height,.adsninja-rail-zone,.adsnippet_widget,.adsns,.adsntl,.adsoptimal-slot,.adsother,.adspace,.adspace-300x600,.adspace-336x280,.adspace-728x90,.adspace-MR,.adspace-lb,.adspace-leaderboard,.adspace-lr,.adspace-mpu,.adspace-mtb,.adspace-top,.adspace-widget,.adspace1,.adspace180,.adspace2,.adspace728x90,.adspace_2,.adspace_bottom,.adspace_right,.adspace_rotate,.adspace_skyscraper,.adspace_top,.adspacer,.adspacer2,.adspan,.adspanel,.adspecial390,.adspeed,.adsplash-160x600,.adsplat,.adsponsor,.adspop,.adspost,.adspot,.adspot-desk,.adspot-title,.adspot1,.adspot200x90,.adspot468x60,.adspot728x90,.adspot_468x60,.adspot_728x90,.adsresponsive,.adsright,.adss,.adssidebar2,.adsskyscraper,.adsslotcustom2,.adsslotcustom4,.adssmall,.adssquare,.adssquare2,.adsterra,.adstext,.adstextpad,.adstipt,.adstitle,.adstop,.adstory,.adstrip,.adstyle,.adsverting,.adsvideo,.adswallpapr,.adswidget,.adswiper,.adswitch,.adswordatas,.adsystem_ad,.adszone,.adtc,.adtech,.adtech-ad-widget,.adtech-banner,.adtech-boxad,.adtech-copy,.adtech-video-2,.adtech-wrapper,.adtechMobile,.adtech_wrapper,.adtester-container,.adtext-bg,.adtext_gray,.adtext_horizontal,.adtext_onwhite,.adtext_vertical,.adtext_white,.adtextleft,.adtextright,.adthrive-ad,.adthrive-header,.adthrive-header-container,.adthrive-placeholder-content,.adthrive-placeholder-header,.adthrive-placeholder-static-sidebar,.adthrive-placeholder-video,.adthrive-sidebar,.adthrive_custom_ad,.adtile,.adtips,.adtips1,.adtoggle,.adtop,.adtop-border,.adtops,.adtower,.adtravel,.adttl,.adtxt,.adtxtlinks,.adult-adv,.adun,.adunit,.adunit-300-250,.adunit-active,.adunit-adbridg,.adunit-container,.adunit-container_sitebar_1,.adunit-googleadmanager,.adunit-lazy,.adunit-middle,.adunit-parent,.adunit-purch,.adunit-side,.adunit-title,.adunit-top,.adunit-wrap,.adunit-wrapper,.adunit125,.adunit160,.adunit300x250,.adunit468,.adunitContainer,.adunit_300x250,.adunit_728x90,.adunit_content,.adunit_footer,.adunit_leaderboard,.adunit_rectangle,.adv--square,.adv-120x600,.adv-160,.adv-160x600,.adv-200-200,.adv-250-250,.adv-300,.adv-300-1,.adv-300-250,.adv-300-600,.adv-300x250,.adv-336-280,.adv-4,.adv-468-60,.adv-468x60,.adv-700,.adv-728,.adv-728-90,.adv-970,.adv-970-250,.adv-970-250-2,.adv-ad,.adv-aside,.adv-background,.adv-bar,.adv-block,.adv-block-container,.adv-border,.adv-bottom,.adv-box-holder,.adv-box-wrapper,.adv-carousel,.adv-center,.adv-click,.adv-cont,.adv-cont1,.adv-conteiner,.adv-dvb,.adv-format-1,.adv-full-width,.adv-google,.adv-gpt-desktop-wrapper,.adv-gpt-wrapper-desktop,.adv-halfpage,.adv-header,.adv-holder,.adv-in-body,.adv-inset,.adv-intext,.adv-intext-label,.adv-key,.adv-label,.adv-leaderboard,.adv-leaderboard-banner,.adv-link,.adv-link--left,.adv-link--right,.adv-margin-bottom,.adv-margin-top,.adv-mobile-wrapper,.adv-mpu,.adv-outer,.adv-p,.adv-right,.adv-right-300,.adv-rotator,.adv-script-container,.adv-sidebar {display: none !important; color: #00b3dd !important; background-color: #db1dff !important;}</style><style type="text/css" class="abn_style" nonce="undefined">.adv-skin-spacer,.adv-slot-container,.adv-text,.adv-top,.adv-top-banner,.adv-top-container,.adv-top-page,.adv-top-skin,.adv-under-video,.adv-unit,.adv-videoad,.adv1,.adv120,.adv200,.adv250,.adv300,.adv300-250,.adv300-250-2,.adv300-70,.adv300left,.adv300x100,.adv300x250,.adv300x60,.adv300x70,.adv336,.adv350,.adv460x60,.adv468,.adv468x90,.adv728,.adv728x90,.advBottom,.advBottomHome,.advLeaderboard,.advRightBig,.advSquare,.advText,.advTop,.adv_120,.adv_120_600,.adv_120x240,.adv_120x600,.adv_160_600,.adv_160x600,.adv_250,.adv_250_250,.adv_300,.adv_300_300,.adv_300_top,.adv_300x250,.adv_336_280,.adv_468_60,.adv_728_90,.adv_728x90,.adv__box,.adv__leaderboard,.adv__wrapper,.adv_aff,.adv_banner,.adv_banner_hor,.adv_bg,.adv_box_narrow,.adv_here,.adv_img,.adv_leaderboard,.adv_left,.adv_link,.adv_main_middle,.adv_main_middle_wrapper,.adv_main_right_down,.adv_main_right_down_wrapper,.adv_medium_rectangle,.adv_message,.adv_msg,.adv_outbrain,.adv_panel,.adv_right,.adv_side1,.adv_side2,.adv_sidebar,.adv_title,.adv_top,.adv_top_table,.adv_txt,.adv_under_menu,.advads-background,.advads-close-button,.advads-parallax-container,.advads-sticky,.advads-target,.advads_ad_widget-11,.advads_ad_widget-18,.advads_ad_widget-2,.advads_ad_widget-21,.advads_ad_widget-3,.advads_ad_widget-4,.advads_ad_widget-5,.advads_ad_widget-8,.advads_ad_widget-9,.advads_widget,.advance-ads,.advart,.advbig,.adver-block,.adver-header,.adver-left,.adver-text,.adverTag,.adverTxt,.adver_bot,.adver_cont_below,.adver_home,.advert--background,.advert--banner-wrap,.advert--fallback,.advert--header,.advert--in-sidebar,.advert--inline,.advert--leaderboard,.advert--loading,.advert--outer,.advert--placeholder,.advert--right-rail,.advert--square,.advert--sticky,.advert-100,.advert-120x90,.advert-160x600,.advert-300,.advert-300-side,.advert-728,.advert-728-90,.advert-728x90,.advert-article-bottom,.advert-autosize,.advert-background,.advert-banner,.advert-banner-container,.advert-banner-holder,.advert-bannerad,.advert-bar,.advert-bg-250,.advert-block,.advert-border,.advert-bot-box,.advert-bottom,.advert-box,.advert-bronze,.advert-bronze-btm,.advert-btm,.advert-card,.advert-center,.advert-col,.advert-col-center,.advert-competitions,.advert-content,.advert-content-item,.advert-dfp,.advert-featured,.advert-footer,.advert-gold,.advert-group,.advert-head,.advert-header-728,.advert-horizontal,.advert-image,.advert-info,.advert-inner,.advert-label,.advert-leaderboard,.advert-leaderboard2,.advert-loader,.advert-mini,.advert-mpu,.advert-mrec,.advert-note,.advert-out-left,.advert-out-top,.advert-overlay,.advert-pane,.advert-panel,.advert-placeholder,.advert-placeholder-wrapper,.advert-preview-wrapper,.advert-right,.advert-row,.advert-section,.advert-sidebar,.advert-silver,.advert-sky,.advert-skyright,.advert-skyscraper,.advert-slider,.advert-spot-container,.advert-sticky-wrapper,.advert-stub,.advert-text,.advert-three,.advert-title,.advert-top,.advert-top-footer,.advert-txt,.advert-unit,.advert-wide,.advert-wingbanner-left,.advert-wingbanner-right,.advert-wrap,.advert-wrap1,.advert-wrap2,.advert-wrapper,.advert-wrapper-exco,.advert.box,.advert.desktop,.advert.mobile,.advert.mpu,.advert.skyscraper,.advert1,.advert120,.advert1Banner,.advert300,.advert4,.advert5,.advert728_90,.advert728x90,.advert8,.advertBanner,.advertBar,.advertBlock,.advertBottom,.advertBox,.advertCaption,.advertColumn,.advertCont,.advertContainer,.advertDownload,.advertFullBanner,.advertHeader,.advertHeadline,.advertLink,.advertLink1,.advertMPU,.advertMiddle,.advertMpu,.advertRight,.advertSideBar,.advertSign,.advertSlot,.advertSuperBanner,.advertText,.advertTitleSky,.advertWrapper,.advert_300x250,.advert_336,.advert_468x60,.advert__container,.advert__fullbanner,.advert__leaderboard,.advert__mpu,.advert__sidebar,.advert__tagline,.advert_banner,.advert_banners,.advert_block,.advert_box,.advert_caption,.advert_cont,.advert_container,.advert_div,.advert_foot,.advert_header,.advert_home_300,.advert_img,.advert_label,.advert_leaderboard,.advert_line,.advert_main,.advert_main_bottom,.advert_mpu,.advert_nav,.advert_note,.advert_pos,.advert_small,.advert_span,.advert_text,.advert_title,.advert_top,.advert_txt,.advert_wrapper,.advertbar,.advertbox,.adverteaser,.advertembed,.adverthome,.adverticum_container,.adverticum_content,.advertis,.advertis-left,.advertis-right,.advertise-1,.advertise-2,.advertise-box,.advertise-here,.advertise-horz,.advertise-info,.advertise-leaderboard,.advertise-link,.advertise-list,.advertise-pic,.advertise-small,.advertise-square,.advertise-top,.advertise-vert,.advertiseContainer,.advertiseHere,.advertiseText,.advertise_ads,.advertise_box,.advertise_brand,.advertise_carousel,.advertise_here,.advertise_link,.advertise_link_sidebar,.advertise_links,.advertise_sec,.advertise_text,.advertise_txt,.advertise_verRight,.advertisebtn,.advertisedBy,.advertisement-1,.advertisement-2,.advertisement-250,.advertisement-300,.advertisement-300x250,.advertisement-amazon-banner,.advertisement-background,.advertisement-banner,.advertisement-bottom,.advertisement-box,.advertisement-card,.advertisement-cell,.advertisement-container,.advertisement-content,.advertisement-copy,.advertisement-footer,.advertisement-google,.advertisement-header,.advertisement-holder,.advertisement-image,.advertisement-label,.advertisement-layout,.advertisement-leaderboard,.advertisement-left,.advertisement-link,.advertisement-nav,.advertisement-placeholder,.advertisement-right,.advertisement-sidebar,.advertisement-space,.advertisement-sponsor,.advertisement-tag,.advertisement-text,.advertisement-title,.advertisement-top,.advertisement-txt,.advertisement-wrapper,.advertisement.leaderboard,.advertisement.rectangle,.advertisement.under-article,.advertisement1,.advertisement300x250,.advertisement468,.advertisementBackground,.advertisementBanner,.advertisementBar,.advertisementBlock,.advertisementBox,.advertisementBoxBan,.advertisementContainer,.advertisementFull,.advertisementHeader,.advertisementImg,.advertisementLabel,.advertisementPanel,.advertisementRotate,.advertisementSection,.advertisementSmall,.advertisementText,.advertisementTop,.advertisement_160x600,.advertisement_300x250,.advertisement_728x90,.advertisement__header,.advertisement__label,.advertisement__leaderboard,.advertisement__wrapper,.advertisement_box,.advertisement_container,.advertisement_footer,.advertisement_header,.advertisement_horizontal,.advertisement_mobile,.advertisement_part,.advertisement_post,.advertisement_text,.advertisement_top,.advertisement_wrapper,.advertisements-link,.advertisements-right,.advertisements-sidebar,.advertisements_heading,.advertisementwrap,.advertiser-links,.advertising--row,.advertising--top,.advertising-banner,.advertising-block,.advertising-container,.advertising-container-top,.advertising-content,.advertising-disclaimer,.advertising-fixed,.advertising-header,.advertising-iframe,.advertising-inner,.advertising-leaderboard,.advertising-lrec,.advertising-mediumrectangle,.advertising-mention,.advertising-middle,.advertising-notice,.advertising-right,.advertising-right-d,.advertising-section,.advertising-side,.advertising-side-hp,.advertising-srec,.advertising-top,.advertising-top-banner,.advertising-top-box,.advertising-vert,.advertising-wrapper,.advertising1,.advertising160,.advertising2,.advertising300_home,.advertising300x250,.advertising728,.advertising728_3,.advertisingBanner,.advertisingBlock,.advertisingLabel,.advertisingLegend,.advertisingLrec,.advertisingMob,.advertisingRight,.advertisingSlide,.advertisingTable,.advertisingTop,.advertising_300x250,.advertising_banner,.advertising_block,.advertising_bottom_box,.advertising_box_bg,.advertising_header_1,.advertising_images,.advertising_square,.advertising_top,.advertising_widget,.advertising_wrapper,.advertisingarea,.advertisingarea-homepage,.advertisingimage,.advertisment-banner,.advertisment-label,.advertisment-left-panal,.advertisment-module,.advertisment-rth,.advertisment-top,.advertismentBox,.advertismentContainer,.advertismentContent,.advertismentText,.advertisment_bar,.advertisment_caption,.advertisment_full,.advertisment_notice,.advertisment_two,.advertize,.advertize_here,.advertizing-banner,.advertlabel,.advertleft,.advertlink,.advertnotice,.advertop,.advertorial-2,.advertorial-block,.advertorial-image,.advertorial-promo-box,.advertorial-teaser,.advertorial-wrapper,.advertorial2,.advertorial_728x90,.advertorial_red,.advertorialitem,.advertorialtitle,.advertorialview,.advertorialwidget,.advertouter,.advertplay,.adverts--banner,.adverts-125,.adverts-inline,.adverts2,.advertsLeaderboard,.adverts_RHS,.adverts_footer_advert,.adverts_header_advert,.adverts_side_advert,.advertspace,.adverttop,.advfrm,.advg468,.advhere,.adviewDFPBanner,.advn_zone,.advr,.advr-wrapper,.advr_top,.advrectangle,.advrst,.advslideshow,.advspot,.advt,.advt-banner-3,.advt-block,.advt-right,.advt-sec,.advt300,.advt720,.advtBlock,.advtMsg,.advt_160x600,.advt_468by60px,.advt_indieclick,.advt_single,.advt_widget,.advtbox,.advtcell,.advtext,.advtimg,.advtitle,.advtop,.advtop-leaderbord,.advttopleft,.advv_box,.adwblue,.adwert,.adwhitespace,.adwide,.adwideskyright,.adwithspace,.adwobs,.adwolf-holder,.adword-box,.adword-structure,.adword-text,.adword-title,.adword1,.adwordListings,.adwords-container,.adwordsHeader,.adworks,.adwrap,.adwrap-mrec,.adwrap-widget,.adwrap_MPU,.adwrapper--desktop,.adwrapper-lrec,.adwrapper1,.adwrapper948,.adwrappercls,.adwrappercls1,.adx-300x250-container,.adx-300x600-container,.adx-ads,.adx-wrapper,.adx-wrapper-middle,.adx_center,.adxli,.adz-horiz,.adz-horiz-ext,.adz2,.adz728x90,.adzbanner,.adzone,.adzone-footer,.adzone-preview,.adzone-sidebar,.adzone_skyscraper,.ae-player__itv,.af-block-ad-wrapper,.af-label-ads,.afc-box,.aff-big-unit,.aff-iframe,.affcodes,.afffix-custom-ad,.affiliate-ad,.affiliate-footer,.affiliate-link,.affiliate-sidebar,.affiliate-strip,.affiliateAdvertText,.affiliate_ad,.affiliate_header_ads,.afs_ads ad-placement,.after-content-ad,.after-intro-ad,.after-post-ads,.after-story-ad-wrapper,.after_ad,.after_comments_ads,.after_content_banner_advert,.after_post_ad,.afw_ad,.aggads-ad,.ahe-ad,.aisle-ad,.ajax_ad,.ajaxads,.ajdg_bnnrwidgets,.ajdg_grpwidgets,.alice-adslot,.alice-root-header-ads__ad--top,.align.Ad,.alignads,.alt_ad,.alt_ad_block,.altad,.am-adContainer,.am-adslot,.am-bazaar-ad,.amAdvert,.am_ads,.amazon-auto-links,.amazon_ad,.amazonads,.ami-video-wrapper,.amp-ad,.amp-ad-container,.amp-ad__wrapper,.amp-ads,.amp-ads-container,.amp-adv-container,.amp-adv-wrapper,.amp-article-ad-element,.amp-flying-carpet-text-border,.amp-sticky-ad-custom,.amp-sticky-ads,.amp-unresolved,.ampFlyAdd,.amp_ad_1,.amp_ad_header,.amp_ad_wrapper,.ampad,.ampexcoVideoPlayer,.anchor-ad,.anchor-ad-wrapper,.anchorAd,.anchored-ad-widget,.aniview-inline-player,.annonstext,.anyad,.anzeige_banner,.aoa_overlay,.ap-ad-block,.ape-ads-container,.apexAd,.apiAds,.aplvideo,.app-ad,.app_ad_unit,.app_advertising_skyscraper,.app_nexus_banners_common,.ar-header-m-ad,.arc-ad-wrapper,.arcAdsBox,.arcAdsContainer,.arcad-block-container,.archive-ad,.archive-ads,.archive-radio-ad-container,.areaAd,.area_ad,.area_ad03,.area_ad07,.area_ad09,.area_ad2,.art-text-ad,.artAd,.artAdInner,.art_ads,.artcl_ad_dsk,.article--ad,.article--content-ad,.article-ad,.article-ad-align-left,.article-ad-blk,.article-ad-bottom,.article-ad-box,.article-ad-cont,.article-ad-container,.article-ad-holder,.article-ad-horizontal,.article-ad-left,.article-ad-legend,.article-ad-main,.article-ad-placeholder,.article-ad-placement,.article-ad-primary,.article-ad-row,.article-ad-row-inner,.article-ad-section,.article-ads,.article-advert--text,.article-advert-container,.article-advert-dfp,.article-aside-ad,.article-aside-top-ad,.article-connatix-wrap,.article-content-ad,.article-content-adwrap,.article-detail-ad,.article-first-ad,.article-footer-ad,.article-footer-ad-container,.article-footer__ad,.article-footer__ads,.article-header-ad,.article-header__railAd,.article-inline-ad,.article-mid-ad,.article-small-ads,.article-sponsor,.article-sponsorship-header,.article-taboola,.article-top-ad,.articleADbox,.articleAd,.articleAdHeader,.articleAdTopRight,.articleAds,.articleAdsL,.articleAdvert,.articleBottom-ads,.articleEmbeddedAdBox,.articleFooterAd,.articleHeaderAd,.articleTop-ads,.articleTopAd,.article_OutbrainContent,.article__ad-holder,.article__adblock,.article__adhesion,.article__adv,.article_ad_1,.article_ad_2,.article_ad_text,.article_ad_top,.article_adbox,.article_ads_banner,.article_bottom-ads,.article_bottom_ad,.article_google-ad,.article_google_ads,.article_inline_ad,.article_inner_ad,.article_mpu,.article_tower_ad,.articlead,.articleads,.articles-ad-block,.artnet-ads-ad,.asg-vast-overlay,.aside-ad,.aside-ad-space,.aside-ad-wrapper,.aside-ads,.aside-ads-top,.asideAd,.aside_ad,.aside_ad_large,.aspace-300x169,.aspace-300x250,.async-ad-container,.at-header-ad,.at-sidebar-ad,.atf-ad,.atfAds,.atf_adWrapper,.atomsAdsCellModel,.attachment-advert_home,.attachment-dm-advert-bronze,.attachment-dm-advert-gold,.attachment-dm-advert-silver,.attachment-sidebar-ad,.attachment-squareAd,.avadvslot,.avap-ads-container,.avert--leaderboard,.avert--sidebar,.avert-text,.avp-p-wrapper,.azk-adsense,.b-ad,.b-ad-main,.b-adhesion,.b-adv,.b-advert,.b-advertising__down-menu,.b-aside-ads,.b-blockadblock,.b-header-ad,.b-right-rail--ads,.bAdvertisement,.b_adLastChild,.b_ads,.b_ads_cont,.b_ads_r,.b_ads_top,.babel_player_block,.background-ad,.background-ads,.background-adv,.backgroundAd,.bam-ad-slot,.bank-rate-ad,.banmanad,.banner--ad,.banner-125,.banner-300,.banner-300-100,.banner-300-250,.banner-300x250,.banner-300x600,.banner-320-100,.banner-336x280,.banner-468,.banner-468-60,.banner-468x60,.banner-728,.banner-728x90,.banner-ad,.banner-ad-b,.banner-ad-below,.banner-ad-block,.banner-ad-bottom-fixed,.banner-ad-contianer,.banner-ad-footer,.banner-ad-image,.banner-ad-inner,.banner-ad-label,.banner-ad-large,.banner-ad-pos,.banner-ad-row,.banner-ad-skeleton-box,.banner-ad-space,.banner-ad-wrap,.banner-ad-wrapper,.banner-ad2,.banner-ads-right,.banner-ads-sidebar,.banner-adsense,.banner-adv,.banner-advert,.banner-advert-wrapper,.banner-advertisement,.banner-advertising,.banner-adverts,.banner-asd__title,.banner-billboard,.banner-bottom,.banner-buysellads,.banner-footer,.banner-img > .pbl,.banner-on-player,.banner-sponsorship,.banner-top-ads,.banner120x600,.banner160,.banner160x600,.banner200x200,.banner300,.banner300x250,.banner336,.banner336x280,.banner350,.banner468,.banner728,.banner728-ad,.banner728-container,.banner728x90,.bannerADS,.bannerADV,.bannerAd,.bannerAd-module,.bannerAd3,.bannerAdContainer,.bannerAdLeaderboard,.bannerAdRectangle,.bannerAdSearch,.bannerAdSidebar,.bannerAdTower,.bannerAdWrap,.bannerAds,.bannerAdvert,.bannerAside,.bannerGoogle,.bannerRightAd,.banner_160x600,.banner_240x400,.banner_250x250,.banner_300_250,.banner_300x250,.banner_300x600,.banner_468_60,.banner_468x60,.banner_728_90,.banner_ad-728x90,.banner_ad_300x250,.banner_ad_728x90,.banner_ad_container,.banner_ad_footer,.banner_ad_full,.banner_ad_leaderboard,.banner_ad_link,.banner_ad_wrapper,.banner_ads1,.banner_inner,.banner_reklam,.banner_reklam2,.banner_slot,.banner_top_index,.bannerad,.bannerad3,.banneradd,.bannerads,.banneradv,.bannerandads,.bannergroup-ads,.bannermpu,.banners-container,.banners_ad,.banners_wrap,.bannervcms,.bar_ad,.base-ad-mpu,.base-ad-slot,.base-ad-top,.base-page_center > .banerBottom,.base-page_center > .banerTop,.base-page_container > .banerRight,.base_ad,.baseboard-ad,.bb-ad,.bb-ad-mrec,.bbccom-advert,.bbccom_advert,.bcom_ad,.before-header-ad,.before-injected-ad,.below-ad-border,.below-article-ad-sidebar,.below-nav-ad,.belowMastheadWrapper,.belowNavAds,.below_game_ad,.below_nav_ad_wrap,.below_player_ad,.bg-ad-gray,.bg-ads,.bg-ads-space,.bg-grey-ad,.bgAdBlue,.bg_ad,.bg_ads,.bgcolor_ad,.bgr-ad-leaderboard,.bh-ads,.bh_ad_container,.bidbarrel-ad,.big-ad,.big-ads,.big-advertisement,.big-banner-block,.big-box-ad,.big-right-ad,.bigAd {display: none !important; color: #00b3dd !important; background-color: #db1dff !important;}.bigAdContainer,.bigAds,.bigAdvBanner,.bigBoxAdArea,.bigCubeAd,.big_ad,.big_ad2,.big_ads,.bigad,.bigad1,.bigad2,.bigadleft,.bigadright,.bigads,.bigadtxt1,.bigbox-ad,.bigbox.ad,.bigbox_ad,.bigboxad,.bigsponsor,.billboard-ad,.billboard-ad-one,.billboard-ad-space,.billboard-ads,.billboard.ad,.billboardAd,.billboard__advert,.billboard_ad,.billboard_ad_wrap,.billboard_adwrap,.bing-ads-wrapper,.block--ad,.block--ads,.block--dfp,.block--doubleclick,.block--simpleads,.block-ad-entity,.block-ad-header,.block-ad-leaderboard,.block-ad-wrapper,.block-admanager,.block-ads,.block-ads-bottom,.block-ads-home,.block-ads-system,.block-ads-top,.block-ads-yahoo,.block-ads1,.block-ads2,.block-ads3,.block-ads_top,.block-adsense,.block-adtech,.block-adv,.block-advert,.block-advertisement,.block-advertisement-banner-block,.block-advertising,.block-adzerk,.block-bg-advertisement,.block-boxes-ad,.block-cdw-google-ads,.block-dfp,.block-dfp-ad,.block-dfp-blocks,.block-doubleclick_ads,.block-fusion-ads,.block-google-admanager,.block-openads,.block-openx,.block-quartz-ads,.block-reklama,.block-simpleads,.block-skyscraper-ad,.block-sponsored-links,.block-the-dfp,.block-wrap-ad,.block-yt-ads,.blockAd,.blockAds,.blockAdvertise,.block__ads__ad,.block_ad,.block_ad1,.block_ad303x1000_left,.block_ad303x1000_right,.block_ad_middle,.block_ad_top,.block_ads,.block_adslot,.block_adv,.block_advert,.block_article_ad,.blockad,.blocked-ads,.blog-ad,.blog-ad-image,.blog-ads,.blog-advertisement,.blogAd,.blogAdvertisement,.blog_ad,.blogads,.bmd_advert,.bn_ads,.bnr-bottom,.bnr_ad,.body-ad,.body-ads,.bodyAd,.body_ad,.bodyads,.bodyads2,.bordered-ad,.botAd,.bot_ad,.bot_ads,.bottom-ad,.bottom-ad--bigbox,.bottom-ad-banner,.bottom-ad-box,.bottom-ad-container,.bottom-ad-desktop,.bottom-ad-large,.bottom-ad-placeholder,.bottom-ad-wrapper,.bottom-ad-zone,.bottom-ad2,.bottom-ads,.bottom-ads-container,.bottom-ads-sticky,.bottom-ads-wrapper,.bottom-adv,.bottom-adv-container,.bottom-banner-ad,.bottom-bnr,.bottom-fixed-ad,.bottom-left-ad,.bottom-main-adsense,.bottom-mobile-ad,.bottom-mpu-ad,.bottom-post-ad-space,.bottom-post-ads,.bottom-right-advert,.bottom-side-advertisement,.bottomAd,.bottomAdBlock,.bottomAdContainer,.bottomAds,.bottomAdvert,.bottomAdvertisement,.bottom_ad_placeholder,.bottom_ad_responsive,.bottom_ads,.bottom_adsense,.bottom_adspace,.bottom_banner_ad,.bottom_banner_advert_text,.bottom_bar_ads,.bottom_left_advert,.bottom_right_ad,.bottom_rightad,.bottom_side_ad,.bottom_sponsor,.bottom_sticky_ad,.bottomad,.bottomads,.bottomadvert,.botton_advertisement,.box-ad,.box-ad-middle,.box-ads,.box-adsense,.box-adsense-top,.box-advert,.box-advertisement,.box-advertising,.box-adverts,.box-bannerads,.box-bannerads-leaderboard-fallback,.box-entry-ad,.box-fixed-ads,.box-footer-ad,.box-outbrain,.boxAd,.boxAdContainer,.boxAds2,.boxAdvertisement,.boxOverContent__banner,.boxSponsor,.box_ad,.box_ad_container,.box_ad_content,.box_ad_horizontal,.box_ad_spacer,.box_ad_wrap,.box_adv,.box_adv_728,.box_advert,.box_advertising,.box_content_ad,.box_content_ads,.box_layout_ad,.box_publicidad,.box_sidebar-ads,.boxad,.boxad1,.boxad2,.boxadcont,.boxads,.boxadv,.bps-ad-wrapper,.bps-advertisement,.bq_adleaderboard,.bq_rightAd,.br-ad,.br-ad-wrapper,.brandpost_inarticle,.breadads,.break-ads,.breaker-ad,.breakerAd,.briefNewsAd,.brn-ads-box,.brn-ads-mobile-container,.brn-ads-sticky-wrapper,.broker-ad,.browse-ad-container,.browsi-ad,.bs-sneaker-container,.btm_ad,.btn_ad,.bump-ad,.bunyad-ad,.buttom_ad,.buttom_ad_size,.button-ad,.button-ads,.buttonAd,.buttonAdSpot,.buttonAds,.button_ad,.button_ads,.button_advert,.button_left_ad,.button_right_ad,.buttonad,.buttonadbox,.buttonads,.buySellAdsContainer,.buysellAds,.buzzAd,.c-Ad,.c-Adhesion,.c-ArticleAds,.c-ad--adStickyContainer,.c-ad--bigbox,.c-ad--header,.c-ad-flex,.c-ad-fluid,.c-ad-placeholder,.c-ad-size2,.c-ad-size3,.c-adDisplay,.c-adDisplay_container,.c-adOmnibar,.c-adSense,.c-adSkyBox,.c-adbutler-ad,.c-adbutler-ad__wrapper,.c-adcontainer,.c-adunit,.c-adunit--billboard,.c-adunit--first,.c-adunit__container,.c-adv3__inner,.c-advert,.c-advert-app,.c-advert-superbanner,.c-advertisement,.c-advertisement--billboard,.c-advertisement--rectangle,.c-advertising,.c-advertising__banner-area,.c-adverts,.c-advscrollingzone,.c-box--advert,.c-gallery-vertical__advert,.c-googleadslot,.c-gpt-ad,.c-header__ad,.c-header__advert-container,.c-pageArticleSingle_bottomAd,.c-prebid,.c-sidebar-ad-stream__ad,.c-sitenav-adslot,.c-sitenavPlaceholder__ad,.c2_outbrain,.c_nt_ad,.cableads,.cactus-ads,.cactus-header-ads,.caja_ad,.california-ad,.california-sidebar-ad,.calloutAd,.carbon-ad,.carbon_ads,.carbonad,.carbonad-tag,.carbonads-widget,.card--ad,.card--article-ad,.card-ad,.card-ads,.card-article-ads,.cardAd,.catalog_ads,.category-ad:not(html):not(body):not(.post),.category-ads:not(html):not(body):not(.post),.categoryMosaic-advertising,.categoryMosaic-advertisingText,.cazAd,.cb-ad-banner,.cb-ad-container,.cbd_ad_manager,.cbs-ad,.cc-advert,.center-ad,.center-ad-long,.center-tag-rightad,.centerAD,.centerAd,.centerAds,.center_ad,.center_add,.center_ads,.center_inline_ad,.centerad,.centerads,.centeradv,.centered-ad,.ch-ad-item,.channel--ad,.channel-ad,.channel-adv,.channel-icon--ad,.channel-icon__ad-buffer,.channel-sidebar-big-box-ad,.channelBoxAds,.channel_ad_2016,.chapter-bottom-ads,.chapter-top-ads,.chart_ads,.chitika-ad,.cjpopup,.ck-anyclips,.ck-anyclips-article,.cl-ad-billboard,.clAdPlacementAnchorWrapper,.clever-core-ads,.click-track.partner,.click-track.shop-window-affiliate,.clickforceads,.clickio-side-ad,.client-ad,.clsy-c-advsection,.cmp-advertisement,.cmp-mobile-advertisement,.cms-ad,.cn-advertising,.cnbcHeaderAd,.cnc-ads,.cnx-player,.coinzilla-ad,.coinzilla-ad--mobile,.col-ad,.col-ad-hidden,.col-has-ad,.col-line-ad,.col2-ads,.colAd,.colBoxAdframe,.colBoxDisplayAd,.col_ad,.colads,.collapsed-ad,.colombiaAd,.columnAd,.columnAdvert,.columnBoxAd,.columnRightAdvert,.combinationAd,.comment-ad,.comment-ad-wrap,.comment-advertisement,.comment_ad,.comment_ad_box,.commercialAd,.companion-ad,.companion-ads,.companionAd,.companion_ad,.complex-ad,.component-ar-horizontal-bar-ad,.component-outbrain,.components-Ad-___Ad__ad,.con_ads,.connatix,.connatix-container,.connatix-hodler,.connatix-holder,.connatix-main-container,.connatix-wysiwyg-container,.consoleAd,.cont-ad,.container--ad,.container--ads,.container--ads-leaderboard-atf,.container--advert,.container--bannerAd,.container-ad-600,.container-ad-left,.container-adds,.container-adrotate,.container-adwords,.container-banner-ads,.container-bottom-ad,.container-content__container-relatedlinks,.container-first-ads,.container-lower-ad,.container-rectangle-ad,.container-top-adv,.containerAdsense,.containerSqAd,.container__ad,.container__box--ads,.container_ad,.container_publicidad,.containerads,.contains-ad,.contains-advertisment,.content--right-ads,.content-ad,.content-ad-article,.content-ad-box,.content-ad-container,.content-ad-left,.content-ad-right,.content-ad-side,.content-ad-widget,.content-ad-wrapper,.content-ads,.content-ads-bottom,.content-advert,.content-advertising,.content-advertisment,.content-bottom-ad,.content-bottom-mpu,.content-contentad,.content-footer-ad,.content-footer-ad-block,.content-header-ad,.content-kuss-ads,.content-leaderboard-ad,.content-leaderboard-ads,.content-page-ad_wrap,.content-result-ads,.content-top-ad-item,.content1-ad,.content2-ad,.contentAd,.contentAd--sb1,.contentAdBox,.contentAdContainer,.contentAdFoot,.contentAdIndex,.contentAdsCommon,.contentAdsWrapper,.contentAdvertisement,.contentTopAd,.contentTopAdSmall,.contentTopAds,.content__ad,.content__ad__content,.content_ad,.content_ad_728,.content_ad_head,.content_ad_side,.content_adsense,.content_adsq,.content_advert,.content_advertising,.content_advt,.content_bottom_adsense,.content_gpt_top_ads,.content_inner_ad,.content_left_advert,.contentad,.contentad-end,.contentad-home,.contentad-superbanner-2,.contentad-top,.contentad2,.contentadarticle,.contentadleft,.contentads1,.contentads2,.contentbox_ad,.contentleftad,.contest_ad,.context-ads,.contextualAds,.contextual_ad_unit,.cornerad,.counterAdblocks,.cpmstarHeadline,.cpmstarText,.crain-advertisement,.criteo-ad,.crm-adcontain,.crumb-ad,.cspAd,.css--ad,.ct-ads,.ct-advert,.ct-advertising-footer,.ct-bottom-ads,.ct_ad,.ct_ampad,.cta-ad,.cube-ad,.cubeAd,.cube_ad,.cube_ads,.custom-ad-area,.custom-ad-container,.custom-ads,.custom-advert-banner,.custom-sticky-ad-container,.customAd,.custom_ad,.custom_ad_responsive,.custom_ads,.custom_ads_positions,.custom_banner_ad,.custom_footer_ad,.customadvert,.customized_ad_module,.cwAdvert,.cxAdvertisement,.d3-c-adblock,.d3-o-adv-block,.da-custom-ad-box,.dac__banner__wrapper,.daily-adlabel,.dart-ad,.dart-ad-content,.dart-ad-grid,.dart-ad-title,.dart-advertisement,.dart-leaderboard,.dart-leaderboard-top,.dartAdImage,.dart_ad,.dart_tag,.dartad,.dartadbanner,.dartadvert,.dartiframe,.dc-ad,.dcmads,.dd-ad,.dd-ad-container,.deadblocker-header-bar,.deadblocker-header-bar-inner,.deckAd,.deckads,.default_rc_theme,.demand-supply,.desktop-ad,.desktop-ad-banner,.desktop-ad-container,.desktop-ad-inpage,.desktop-ad-slider,.desktop-ads,.desktop-adunit,.desktop-advert,.desktop-article-top-ad,.desktop-aside-ad-hide,.desktop-lazy-ads,.desktop-sidebar-ad-wrapper,.desktop-top-ad-wrapper,.desktop.ad,.desktopAd,.desktop_ad,.desktop_mpu,.desktop_only_ad,.desktopads,.detail-ad,.detail-ads,.detail__ad--small,.detail_ad,.detail_article_ad,.detail_top_advert,.details-advert,.dfm-featured-bottom-flex-container,.dfp-ad,.dfp-ad-bigbox2-wrap,.dfp-ad-container,.dfp-ad-container-box,.dfp-ad-container-wide,.dfp-ad-full,.dfp-ad-hideempty,.dfp-ad-lazy,.dfp-ad-lead2-wrap,.dfp-ad-lead3-wrap,.dfp-ad-midbreaker-wrap,.dfp-ad-midbreaker2-wrap,.dfp-ad-placeholder,.dfp-ad-rect,.dfp-ad-region-1,.dfp-ad-region-2,.dfp-ad-tags,.dfp-ad-top-wrapper,.dfp-ad-unit,.dfp-ad-widget,.dfp-ads-ad-article-middle,.dfp-ads-embedded,.dfp-adspot,.dfp-article-ad,.dfp-banner,.dfp-banner-slot,.dfp-billboard-wrapper,.dfp-block,.dfp-bottom,.dfp-button,.dfp-close-ad,.dfp-double-mpu,.dfp-dynamic-tag,.dfp-fixedbar,.dfp-here-bottom,.dfp-here-top,.dfp-interstitial,.dfp-leaderboard,.dfp-leaderboard-container,.dfp-mrec,.dfp-panel,.dfp-plugin-advert,.dfp-position,.dfp-slot,.dfp-slot-wallpaper,.dfp-space,.dfp-super-leaderboard,.dfp-tag-wrapper,.dfp-top,.dfp-top1,.dfp-top1-container,.dfp-top_leaderboard,.dfp-wrap,.dfp-wrapper,.dfpAd,.dfpAdUnitContainer,.dfpAds,.dfpAdspot,.dfpAdvert,.dfp_ATF_wrapper,.dfp_ad--outbrain,.dfp_ad_block,.dfp_ad_caption,.dfp_ad_content_bottom,.dfp_ad_content_top,.dfp_ad_footer,.dfp_ad_header,.dfp_ad_pos,.dfp_ad_unit,.dfp_ads_block,.dfp_frame,.dfp_slot,.dfp_strip,.dfp_top-ad,.dfp_txt,.dfp_unit,.dfp_unit--interscroller,.dfp_unit-ad_container,.dfpad,.dfrads,.dfx-ad,.dfx-adBlock1Wrapper,.dg-gpt-ad-container,.dianomi-ad,.dianomi-container,.dianomi-embed,.dianomiScriptContainer,.dianomi_context,.dikr-responsive-ads-slot,.directadvert-block,.discourse-adplugin,.discourse-google-dfp,.display-ad-block,.display-adhorizontal,.display-ads-block,.display-advertisement,.displayAd,.displayAdCode,.displayAdSlot,.displayAdUnit,.displayAds,.display_ads_right,.dispositifAdblock,.dispositifAdblockContent,.dispositifAdblockMessageBox,.div-gpt-ad-adhesion-leaderboard-wrap,.div-insticator-ad,.divAd,.divAdright,.divAds,.divAdsBanner,.divAdsLeft,.divAdsRight,.divReklama,.divRepAd,.divSponsoredBox,.divSponsoredLinks,.divTopADBanner,.divTopADBannerWapper,.divTopArticleAd,.div_advertisement,.divad1,.divad2,.divad3,.divads,.divider-ad,.divider-advert,.divider-full-width-ad,.divider-taboola,.divider_ad,.dlSponsoredLinks,.dm-adSlotBillboard,.dm-adSlotNative1,.dm-adSlotNative2,.dm-adSlotNative3,.dm-adSlotRectangle1,.dm-adSlotRectangle2,.dm-adSlotSkyscraper,.dm-adSlot__sticky,.dm_ad-billboard,.dm_ad-container,.dm_ad-halfpage,.dm_ad-leaderboard,.dm_ad-link,.dm_ad-skyscraper,.dmpu-ad,.dn-ad-wide,.dotcom-ad,.double-ad,.double-ads,.doubleClickAd,.doubleclickAds,.download-ad,.downloadAds,.download_ad,.dsk-box-ad-d,.dsq_ad,.dt-sponsor,.dtads-desktop,.dtads-slot,.dual-ads,.dualAds,.dyn-sidebar-ad,.dynamic-ads,.dynamicAdvertContainer,.dynamicLeadAd,.dynamic_adslot,.dynamicad1,.dynamicad2,.e-ad,.e-advertise,.e3lan,.e3lan-top,.e3lan-widget-content,.e3lan300-100,.e3lan300-250,.e3lan300_250-widget,.eaa-ad,.eads,.easy-ads,.easyAdsBox,.easyAdsSinglePosition,.ebayads,.ebm-ad-target__outer,.ecommerce-ad,.ecosia-ads,.eddy-adunit,.editor_ad,.eg-ad,.eg-custom-ad,.element--ad,.element-ad,.element-adplace,.element_contentad1,.element_contentad2,.element_contentad3,.element_contentad4,.element_contentad5,.elementor-widget-wp-widget-advads_ad_widget,.embAD,.embed-ad,.embedded-article-ad,.embeddedAd,.embeddedAds,.embedded_ad_wrapper,.empire-prefill-container-injected,.empire-unit-prefill-container,.empty-ad,.endAHolder,.endti-adlabel,.entry-ad,.entry-ads,.entry-bottom-ad,.entry-bottom-ads,.entry-top-ad,.entryAd,.entry_ad,.entryad,.etn-ad-text,.eu-advertisment1,.evo-ads-widget,.evolve-ad,.ex_pu_iframe,.exco-container,.exo_wrapper,.external-ad,.external-add,.ez-sidebar-wall-ad,.ezAdsWidget,.ezmob-footer,.ezmob-footer-desktop,.ezo_ad,.ezoic-ad,.ezoic-ad-adaptive,.ezoic-adpicker-ad,.ezoic-floating-bottom,.f-ad,.f-item-ad,.f-item-ad-inhouse,.fah-btn.nopop,.fah-btn__container,.fbs-ad--ntv-home-wrapper,.fbs-ad--top-wrapper,.fbs-ad--topx-wrapper,.fc_clmb_ad,.fce_ads,.fco-ad,.featureAd,.feature_ad,.featured-ad,.featured-ads,.featured-sponsors,.featured-story-ad,.featuredAdBox,.featuredAds,.featuredBoxAD,.featured_ad,.featuredadvertising,.feed-ad,.feed-ad-wrapper,.fh_ad_microbuttons,.field-59-companion-ad,.fig-ad-content,.first-article-ad-block,.first-banner-ad,.first-leaderbord-adv,.first-leaderbord-adv-mobile,.firstAd-container,.first_ad,.first_party_ad_wrapper,.first_post_ad,.firstad,.firstpost_advert,.firstpost_advert_container,.fix_ad,.fixadheight,.fixadheightbottom,.fixed-ad-aside,.fixed-ad-bottom,.fixed-ads,.fixed-bottom-ad,.fixed-sidebar-ad,.fixedAds,.fixedLeftAd,.fixedRightAd,.fixed_adslot,.fixed_advert_banner,.fjs-ad-hide-empty,.fla-ad,.flashAd,.flash_ad,.flash_advert,.flashad,.flashadd,.flex-ad,.flex-posts-ads,.flexAd,.flexAds,.flexContentAd,.flexad,.flexadvert,.flexiad,.flm-ad,.floatad,.floatads,.floated-ad,.floated_right_ad,.floating-ads,.floating-advert,.floatingAds,.fly-ad,.fm-badge-ad,.fnadvert,.fns_td_wrap,.fold-ads,.follower-ad-bottom,.following-ad,.following-ad-container,.foot-ad,.foot-ads,.foot-advertisement,.foot_adsense,.footad,.footer-300-ad,.footer-ad-full-wrapper,.footer-ad-labeling,.footer-ad-row,.footer-ad-section,.footer-ad-squares,.footer-ad-unit,.footer-ad-wrap,.footer-adrow,.footer-ads,.footer-ads-slide,.footer-ads-wrapper,.footer-ads_unlocked,.footer-adsbar,.footer-adsense,.footer-advert,.footer-advert-large,.footer-advertisement,.footer-advertisements,.footer-advertising,.footer-advertising-area,.footer-banner-ad,.footer-banner-ads,.footer-floating-ad,.footer-im-ad,.footer-leaderboard-ad,.footer-post-ad-blk,.footer-prebid,.footer-text-ads,.footerAd,.footerAdModule,.footerAdUnit,.footerAdWrapper,.footerAds,.footerAdsWrap,.footerAdslot,.footerAdverts,.footerBottomAdSec,.footerFullAd,.footerPageAds,.footerTextAd,.footer__ads--content,.footer__advert,.footer_ad336,.footer_ad_container,.footer_adv,.footer_advertisement,.footer_block_ad,.footer_bottom_ad,.footer_bottomad,.footer_line_ad,.footer_text_ad,.footer_text_adblog,.footerad,.footeradspace,.footertextadbox,.forbes-ad-container,.forex_ad_links,.fortune-ad-unit,.forum-ad,.forum-ad-2,.forum-teaser-ad,.forum-topic--adsense,.forumAd,.forum_ad_beneath,.four-ads,.fp-ad-nativendo-one-third,.fp-ad-rectangle,.fp-ad300,.fp-ads {display: none !important; color: #00b3dd !important; background-color: #db1dff !important;}.fp-right-ad,.fp-right-ad-list,.fp-right-ad-zone,.fp_ad_text,.fp_adv-box,.frame_adv,.framead,.freestar-ad-container,.freestar-ad-sidebar-container,.freestar-ad-wide-container,.freestar-incontent-ad,.frn_adbox,.front-ad,.front_ad,.frontads,.frontendAd,.frontone_ad,.frontpage__article--ad,.frontpage_ads,.fsAdContainer,.fs_ad,.fs_ads,.fsrads,.ft-ad,.full-ad-wrapper,.full-ads,.full-adv,.full-bleed-ad,.full-bleed-ad-container,.full-page-ad,.full-top-ad-area,.full-width-ad,.full-width-ad-container,.full-width-ads,.fullAdBar,.fullBleedAd,.fullSizeAd,.fullWidthAd,.full_AD,.full_ad_box,.full_ad_row,.full_width_ad,.fulladblock,.fullbanner_ad,.fullbannerad,.fullpage-ad,.fullsize-ad-square,.fullwidth-advertisement,.fusion-ads,.fuv_sidebar_ad_widget,.fwAdTags,.fw_ad,.g-ad,.g-ad-fix,.g-ad-leaderboard,.g-ad-slot,.g-adver,.g-advertisement-block,.g1-ads,.g1-advertisement,.g2-adsense,.g3-adsense,.gAdMTable,.gAdMainParent,.gAdMobileTable,.gAdOne,.gAdOneMobile,.gAdRows,.gAdSky,.gAdThreeDesktop,.gAdThreeMobile,.gAdTwo,.gAds,.gAds1,.gAdsBlock,.gAdsContainer,.gAdvertising,.g_ad,.g_adv,.ga-ads,.gaTeaserAds,.gaTeaserAdsBox,.gabfire_ad,.gabfire_simplead_widget,.gad-container,.gad-right1,.gad-right2,.gad300x600,.gad336x280,.gadContainer,.gad_container,.gads_container,.gadsense,.gadsense-ad,.gallery-ad-container,.gallery-ad-counter,.gallery-ad-holder,.gallery-ad-lazyload-placeholder,.gallery-ad-overlay,.gallery-adslot-top,.gallery-injectedAd,.gallery-sidebar-ad,.gallery-slide-ad,.galleryAds,.galleryLeftAd,.galleryRightAd,.gallery_ad,.gallery_ad_wrapper,.gallery_ads_box,.galleryad,.galleryads,.gam-ad,.gam-ad-hz-bg,.gam_ad_slot,.game-ads,.game-category-ads,.gameAd,.gameBottomAd,.gamepage_boxad,.games-ad-wrapper,.gb-ad-top,.gb_area_ads,.general-ad,.genericAds,.ggl_ads_row,.ggl_txt_ads,.giant_pushbar_ads_l,.glacier-ad,.globalAd,.gnm-ad-unit,.gnm-ad-unit-container,.gnm-ad-zones,.gnm-adhesion-ad,.gnm-banner-ad,.gnm-bg-ad,.gnt_em_vp__tavp,.gnt_em_vp_c[data-g-s="vp_dk"],.gnt_flp,.gnt_rr_xpst,.gnt_rr_xst,.gnt_tb.gnt_tbb,.gnt_tbr.gnt_tb,.gnt_x,.gnt_x__lbl,.gnt_xmst,.go-ad,.goAdMan,.goads,.googads,.google-2ad-m,.google-ad,.google-ad-160-600,.google-ad-468-60,.google-ad-728-90,.google-ad-block,.google-ad-container,.google-ad-content,.google-ad-header2,.google-ad-image,.google-ad-manager,.google-ad-placeholder,.google-ad-sidebar,.google-ad-space,.google-ad-widget,.google-ads,.google-ads-billboard,.google-ads-bottom,.google-ads-container,.google-ads-footer-01,.google-ads-footer-02,.google-ads-in_article,.google-ads-leaderboard,.google-ads-long,.google-ads-responsive,.google-ads-right,.google-ads-sidebar,.google-ads-widget,.google-ads-wrapper,.google-adsense,.google-advert-sidebar,.google-afc-wrapper,.google-bottom-ads,.google-dfp-ad-caption,.google-dfp-ad-wrapper,.google-right-ad,.google-sponsored,.google-sponsored-ads,.google-sponsored-link,.google-sponsored-links,.google468,.googleAd,.googleAdBox,.googleAdContainer,.googleAdSearch,.googleAdSense,.googleAdWrapper,.googleAdd,.googleAds,.googleAdsContainer,.googleAdsense,.googleAdv,.google_ad,.google_ad_container,.google_ad_label,.google_ad_wide,.google_add,.google_admanager,.google_ads,.google_ads_content,.google_ads_sidebar,.google_adsense,.google_adsense1,.google_adsense_footer,.google_afc,.google_afc_ad,.googlead,.googleadArea,.googleadbottom,.googleadcontainer,.googleaddiv,.googleads,.googleads-container,.googleads-height,.googleadsense,.googleadsrectangle,.googleadv,.googleadvertisement,.googleadwrap,.googleafc,.gpAds,.gpt-ad,.gpt-ad-container,.gpt-ad-sidebar-wrap,.gpt-ad-wrapper,.gpt-ads,.gpt-billboard,.gpt-breaker-container,.gpt-container,.gpt-leaderboard-banner,.gpt-mpu-banner,.gpt-sticky-sidebar,.gpt.top-slot,.gptSlot,.gptSlot-outerContainer,.gptSlot__sticky-footer,.gptslot,.gradientAd,.graphic_ad,.grev-ad,.grey-ad,.grey-ad-line,.grey-ad-notice,.greyad,.grid > .container > #aside-promotion,.grid-ad,.grid-ad-col__big,.grid-advertisement,.grid-block-ad,.grid-item-ad,.gridAd,.gridAdRow,.gridSideAd,.grid__module-sizer_name_taboola,.grid_ad_container,.gridad,.gridlove-ad,.gridstream_ad,.ground-ads-shared,.group-ad-leaderboard,.group-google-ads,.group-item-ad,.group_ad,.gsAd,.gtm-ad-slot,.guide__row--fixed-ad,.guj-ad--placeholder,.gujAd,.gutterads,.h-adholder,.h-ads,.h-adver,.h-large-ad-box,.h-top-ad,.h11-ad-top,.h_Ads,.h_ad,.half-ad,.half-page-ad,.half-page-ad-1,.half-page-ad-2,.halfPageAd,.half_ad_box,.halfpage_ad,.halfpage_ad_1,.halfpage_ad_container,.happy-inline-ad,.happy-inside-player_2,.happy-under-player,.has-adslot,.hasAD,.hdr-ad,.hdr-ads,.hdrAd,.hdr_ad,.head-ad,.head-ads,.head-banner468,.head-top-ads,.headAd,.head_ad,.head_ad_wrapper,.head_ads,.head_adv,.head_advert,.headad,.headadcontainer,.header-ad,.header-ad-area,.header-ad-banner,.header-ad-box,.header-ad-container,.header-ad-desktop,.header-ad-frame,.header-ad-holder,.header-ad-region,.header-ad-space,.header-ad-top,.header-ad-widget,.header-ad-wrap,.header-ad-wrapper,.header-ad-zone,.header-adbanner,.header-adbox,.header-adcode,.header-adplace,.header-ads,.header-ads-area,.header-ads-container,.header-ads-holder,.header-ads-wrap,.header-ads-wrapper,.header-adsense,.header-adslot-container,.header-adspace,.header-adv,.header-advert,.header-advert-wrapper,.header-advertise,.header-advertisement,.header-advertising,.header-article-ads,.header-banner-ad,.header-banner-ads,.header-banner-advertising,.header-bannerad,.header-pencil-ad,.header-sponsor,.header-top-ad,.header-top_ads,.headerAd,.headerAd1,.headerAdBanner,.headerAdContainer,.headerAdPosition,.headerAdSpacing,.headerAdWrapper,.headerAds,.headerAds250,.headerAdspace,.headerAdvert,.headerAdvertisement,.headerTextAd,.headerTopAd,.headerTopAds,.header__ad,.header__ads,.header__ads-wrapper,.header__advertisement,.header_ad1,.header_ad_center,.header_ad_div,.header_ad_space,.header_ads,.header_ads-container,.header_ads_box,.header_adspace,.header_advert,.header_advertisement,.header_advertisment,.header_leaderboard_ad,.header_top_ad,.headerad,.headeradarea,.headeradblock,.headeradright,.headerads,.heading-ad-space,.headline-adblock,.headline-ads,.headline_advert,.hederAd,.herald-ad,.hero-ad,.hero-ad-slot,.hero-advert,.heroAd,.hidden-ad,.hide-ad,.hide_ad,.hidead,.highlightsAd,.hm-ad,.holder-ad,.holder-ads,.home-ad-bigbox,.home-ad-container,.home-ad-inline,.home-ad-links,.home-ad-region-1,.home-ad-section,.home-ads,.home-ads-container,.home-ads1,.home-adv-box,.home-advert,.home-body-ads,.home-page-ad,.home-sidebar-ad,.home-sponsored-links,.home-sticky-ad,.home-top-ad,.homeAd,.homeAd1,.homeAd2,.homeAdBox,.homeAdSection,.homeMainAd,.homePageAdSquare,.homePageAds,.homeTopAdContainer,.home_ad,.home_ad_bottom,.home_ad_large,.home_ad_title,.home_adblock,.home_advert,.home_advertisement,.homepage-ad,.homepage-ad-block,.homepage-ad-module,.homepage-advertisement,.homepage-banner-ad,.homepage-footer-ad,.homepage-footer-ads,.homepageAd,.homepage__native-ad,.homepage_ads,.homepage_block_ad,.hor-ad,.hor_ad,.hor_banner,.horiAd,.horiz_adspace,.horizontal-ad,.horizontal-ad-container,.horizontal-ad-holder,.horizontal-ad-wrapper,.horizontal-ad2,.horizontal-ads,.horizontal-advert-container,.horizontal-full-ad,.horizontal.ad,.horizontalAd,.horizontalAdText,.horizontalAdvert,.horizontal_Fullad,.horizontal_ad,.horizontal_adblock,.horizontal_ads,.hortad,.hotel-ad,.house-ad,.house-ad-small,.house-ad-unit,.house-ads,.houseAd,.houseAd1,.housead,.hover_ads,.hoverad,.hp-ad-container,.hp-adsection,.htl-ad,.htl-ad-placeholder,.htl-inarticle-container,.htlad-GL_Adhesion,.html-advertisement,.hyperAd,.iAdserver,.iframe-ad,.iframe-ads,.iframeAd,.iframeAds,.image-advertisement,.imageAd,.imageAds,.imagead,.imageads,.img-advert,.img_ads,.imgad,.in-article-ad,.in-article-ad-placeholder,.in-article-ad-wrapper,.in-article-adx,.in-between-ad,.in-content-ad,.in-content-ad-wrapper,.in-page-ad,.in-slider-ad,.in-story-ads,.in-text-ad,.in-text__advertising,.in-thumb-ad,.in-thumb-video-ad,.inPageAd,.in_ad,.in_article_ad,.in_article_ad_wrapper,.in_content_ad_container,.in_content_advert,.inarticlead,.inc-ad,.incontent-ad1,.incontentAd,.incontent_ads,.index-adv,.index-module_adAfterContent__RcW1,.index-module_adBeforeContent__AMXn,.index-module_adBeforeContent__UYZT,.index-module_rightrailBottom__IJEl,.index-module_rightrailTop__mag4,.index-module_sd_background__Um4w,.index_728_ad,.index_ad,.index_ad_a2,.index_ad_a4,.index_ad_a5,.index_ad_a6,.index_right_ad,.inf-onclickvideo-adbox,.inf-onclickvideo-container,.infinity-ad,.inhousead,.injected-ad,.injectedAd,.inline-ad-card,.inline-ad-container,.inline-ad-desktop,.inline-ad-placeholder,.inline-ad-text,.inline-ad-wrap,.inline-ad-wrapper,.inline-adblock,.inline-advert,.inline-banner-ad,.inline-display-ad,.inline-google-ad-slot,.inline-mpu,.inline-story-add,.inlineAd,.inlineAdContainer,.inlineAdImage,.inlineAdInner,.inlineAdNotice,.inlineAdText,.inlineAdvert,.inlineAdvertisement,.inlinePageAds,.inlineSideAd,.inline_ad,.inline_ad_container,.inline_ad_title,.inline_ads,.inlinead,.inlinead_lazyload,.inlineadsense,.inlineadtitle,.inlist-ad,.inlistAd,.inner-ad,.inner-ad-disclaimer,.inner-ad-section,.inner-adv,.inner-advert,.inner-post-ad,.innerAdWrapper,.innerAds,.innerContentAd,.innerWidecontentAd,.inner_ad,.inner_ad_advertise,.inner_big_ad,.innerad,.inpostad,.inr_top_ads,.ins_adwrap,.insert-post-ads,.insert_ad,.insert_ad_column,.insert_advertisement,.insertad,.inside_ad,.insideads,.inslide-ad,.insticator-ads,.instream_ad,.intAdRow,.intad,.interAd,.internal-ad,.internalAd,.internal_ad,.interstitial-ad,.interstory_first_mobile,.interstory_second_mobile,.intext-ads,.intra-article-ad,.intro-ad,.ion-ad,.ione-widget-dart-ad,.ipc-advert,.ipc-advert-class,.ipsAd,.ipsAdvertisement,.iqadlinebottom,.iqadmarker,.iqadtile_wrapper,.is-ad,.is-carbon-ad,.is-desktop-ads,.is-mpu,.is-preload-ad,.is-script-ad,.is-sticky-ad,.isAd,.isAdPage,.isad_box,.ise-ad,.island-ad,.islandAd,.islandAdvert,.island_ad,.islandad,.item--ad,.item-ad,.item-ad-leaderboard,.item-advertising,.item-container-ad,.itemAdvertise,.item_ads,.itsanad,.j-ad,.jLinkSponsored,.jannah_ad,.jg-ad-5,.jg-ad-970,.jobbioapp,.jobs-ad-box,.jobs-ad-marker,.jquery-adi,.jquery-script-ads,.js-ad,.js-ad-banner-container,.js-ad-buttons,.js-ad-container,.js-ad-dynamic,.js-ad-frame,.js-ad-home,.js-ad-loader-bottom,.js-ad-slot,.js-ad-static,.js-ad-unit,.js-ad-unit-bottom,.js-ad-wrapper,.js-ad_iframe,.js-adfliction-iframe,.js-adfliction-standard,.js-ads,.js-ads-carousel,.js-advert,.js-advert-container,.js-adzone,.js-anchor-ad,.js-billboard-advert,.js-checkad-warning,.js-dfp-ad,.js-dfp-ad-bottom,.js-dfp-ad-top,.js-gpt-ad,.js-gptAd,.js-header-ad,.js-header-ad-wrapper,.js-lazy-ad,.js-mapped-ad,.js-mpu,.js-native-ad,.js-no-sticky-ad,.js-outbrain-container,.js-overlay_ad,.js-react-simple-ad,.js-results-ads,.js-right-ad-block,.js-sidebar-ads,.js-skyscraper-ad,.js-slide-right-ad,.js-slide-top-ad,.js-sticky-ad,.js-stream-ad,.js-taboola,.js-toggle-ad,.js-widget-distroscale,.js-widget-send-to-news,.jsAdSlot,.js_adContainer,.js_ad_wrapper,.jsx-adcontainer,.jw-ad,.jw-ad-block,.jw-ad-label,.jw-ad-media-container,.jw-ad-visible,.jwPlayer--floatingContainer,.kakao_ad_area,.keen_ad,.kill-adblock-container,.kiwi-ad-wrapper-300x250,.kiwi-ad-wrapper-728x90,.kiwi-ad-wrapper-950x80,.ktz-bannersingletop,.kumpulads-post,.kumpulads-side,.kwizly-psb-ad,.l-ad-top,.l-ads,.l-adsense,.l-article__ad,.l-bottom-ads,.l-grid--ad-card,.l-header-advertising,.l1-ads-wrapper,.label-ad,.labelads,.largeAd,.largeRectangleAd,.largeUnitAd,.large_ad,.lastads,.latest-ad,.layout-ad,.layout_h-ad,.lazy-ad,.lazy-ad-unit,.lazy-adv,.lazyad,.lazyadsense,.lazyadslot,.lazyload-ad,.lazyload_ad,.lazyload_ad_article,.lb-ad,.lb-adhesion-unit,.lb-advert-container,.lb-item-ad,.ld-ad,.ld-ad-inner,.ldm_ad,.lead-ad,.lead-ads,.leader-ad,.leader-ad-728,.leaderAd,.leaderAdTop,.leaderAdvert,.leaderBoardAdWrapper,.leaderBoardAdvert,.leader_ad,.leaderad,.leaderboard-ad,.leaderboard-ad-component,.leaderboard-ad-container,.leaderboard-ad-fixed,.leaderboard-ad-main,.leaderboard-ad-module,.leaderboard-ad-pane,.leaderboard-ad-placeholder,.leaderboard-ad-unit,.leaderboard-ad-wrapper,.leaderboard-adblock,.leaderboard-ads,.leaderboard-ads-text,.leaderboard-advert,.leaderboard-advertisement,.leaderboard-main-ad,.leaderboard-top-ad,.leaderboard-top-ad-wrapper,.leaderboard.advert,.leaderboard1AdWrapper,.leaderboardAd,.leaderboardAdWrapper,.leaderboard_ad_container,.leaderboard_ad_unit,.leaderboard_ads,.leaderboard_adsense,.leaderboard_adv,.leaderboard_banner_ad,.leaderboardad,.leaderboardadmiddle,.leaderboardadtop,.leaderboardadwrap,.lee-track-ilad,.left-ad,.left-ads,.left-advert,.left-rail-ad,.left-sponser-ad,.leftAd,.leftAdColumn,.leftAdContainer,.leftAdsEnabled,.leftAdvert,.leftCol_advert,.leftColumnAd,.left_300_ad,.left_ad,.left_ad_160,.left_ad_areas,.left_ad_box,.left_ad_container,.left_add_block,.left_adlink,.left_ads,.left_adsense,.left_advertisement_block,.left_col_ad,.left_google_add,.leftad,.leftadd,.leftadtag,.leftbar_ad2,.leftbarads,.leftbottomads,.leftnavad,.leftrighttopad,.leftsidebar_ad,.lefttopad1,.legacy-ads,.legion_primiswrapper,.lft_advt_container,.lg-ads-160x90,.lg-ads-311x500,.lg-ads-635x100,.lg-ads-skin-container,.liBannerImage,.ligatus,.lightad,.lijit-ad,.linead,.linkAD,.linkAds,.link_ad,.linkads,.list-ad,.list-adbox,.list-ads,.list-feature-ad,.list-footer-ad,.listad,.listicle-instream-ad-holder,.listing-item-ad,.listing-page-ad,.listingAd,.listings_ad,.lite-page-ad,.live-ad,.lng-ad,.local-ads,.localad,.location-ad,.log_ads,.logoAds,.logoad,.logoutAd,.logoutAdContainer,.long-ads,.longAd,.longAdBox,.longAds,.long_ad,.longform-ad,.loop-ad,.lower-ad,.lower-ads,.lowerAd,.lowerAds,.lower_ad,.lrec-container,.lst_ads,.m-ContentAd,.m-ad,.m-ad-brick,.m-ad-region,.m-ad-unit,.m-ad__wrapper,.m-advert,.m-advertisement,.m-advertisement--container,.m-article-taboola,.m-balloon-header--ad,.m-block-ad,.m-content-advert,.m-content-advert-wrap,.m-dfp-ad-text,.m-header-ad,.m-in-content-ad,.m-in-content-ad-row,.m-jac-ad,.m-sponsored,.m_ad,.m_ad1,.m_ad300,.m_banner_ads,.macAd,.macad,.mad_adcontainer,.magAd,.magad,.mai-ad-unit-container,.mai-ad-video,.main-ad,.main-ad-container,.main-ad-gallery,.main-add-sec,.main-ads,.main-advert,.main-advertising,.main-column-ad,.main-footer-ad,.main-header-ad,.main-header__ad-wrapper,.main-right-ads,.mainAdContainer,.mainAds,.mainLeftAd,.mainLinkAd,.mainRightAd,.main_ad,.main_adbox,.main_ads,.main_adv,.mantis-ad,.mantisadd,.manual-ad,.map-ad,.mar-block-ad,.mar-leaderboard--bottom,.margin-advertisement,.margin0-ads,.marginalContentAdvertAddition,.marketing-ad,.marketplace-ad,.marketplaceAd,.marquee-ad,.masonry-tile-ad,.masonry__ad,.master_post_advert,.masthead-ad,.masthead-ads,.mastheadAds,.masthead__ad,.match-ad,.mc-column-Taboola,.mc_floating_ad,.mc_text_ads_box,.md-advertisement,.medRect,.mediaAd,.mediaAdContainer,.medium-rectangle-ad,.medium-top-ad,.mediumRectAdWrapper,.mediumRectagleAd,.mediumRectangleAd,.mediumRectangleAdvert,.medium_ad,.mediumad,.medrec-ad,.medrect-ad,.medrect-ad2,.medrectAd {display: none !important; color: #00b3dd !important; background-color: #db1dff !important;}.medrect_ad,.mega-ad,.member-ads,.menu-ad,.menuAd,.message_ads,.meta-ad,.meta_ad,.metabet-sponsored,.meteored-ads,.mf-adsense-leaderboard,.mf-adsense-rightrail,.mg_box_ads,.mgid-wrapper,.mgid_3x2,.mid-ad-wrapper,.mid-ads,.mid-advert,.mid-article-banner-ad,.mid-outbrain,.mid-post-ad,.mid-section-ad,.midAd,.midAdv-cont,.midAdv-cont2,.midAdvert,.mid_ad,.mid_banner_ad,.midad,.midarticlead,.middle-ad,.middle-ads,.middle-ads728,.middle-footer-ad,.middleAd,.middleAdLeft,.middleAdMid,.middleAdRight,.middleAdWrapper,.middleAds,.middleBannerAd,.middle_AD,.middle_ad,.middle_ad_responsive,.middle_ads,.middleadouter,.midpost-ad,.min-height-ad,.min_navi_ad,.mini-ad,.mini-ads,.mini_ads,.miniad,.miniads,.misc-ad,.misc-ad-label,.miscAd,.mj-floating-ad-wrapper,.mks_ads_widget,.mm-ad-sponsored,.mm-ads-adhesive-ad,.mm-ads-gpt-adunit,.mm-ads-leaderboard-header,.mm-embed--sendtonews,.mm-widget--sendtonews,.mmads,.mntl-block.article__broad-video,.mntl-gpt-adunit,.mntl-jwplayer-broad.article__broad-video--jw,.mntl-jwplayer-broad.article__broad-video-jw,.mntl-leaderboard-header,.mntl-outbrain,.mntl-sc-block-adslot,.moads-top-banner,.moads-widget,.mob-ad-break-text,.mob-adspace,.mob-hero-banner-ad-wrap,.mob_ads,.mobads,.mobile-ad,.mobile-ad-container,.mobile-ad-negative-space,.mobile-ad-placeholder,.mobile-ad-slider,.mobile-ads,.mobile-fixed-ad,.mobile-instream-ad-holder,.mobile-instream-ad-holder-single,.mobileAd,.mobileAdWrap,.mobileAppAd,.mobile_ad_banner,.mobile_ad_container,.mobile_featuredad,.mobile_leaderboard_ad,.mobileadbig,.mobileadunit,.mobilesideadverts,.mod-ad,.mod-adblock,.mod-ads,.mod-google-ads,.mod-horizontal-ad,.mod-sponsored-links,.mod-vertical-ad,.mod_ad,.mod_ad_container,.mod_ad_text,.mod_ad_top,.mod_admodule,.mod_ads,.mod_advert,.mod_index_ad,.mod_js_ad,.mod_openads,.mod_r_ad,.mod_r_ad1,.modal-ad,.module--ad,.module-ad,.module-ad-small,.module-ads,.module-advert,.module-advertisement,.module-box-ads,.module-image-ad,.module-rectangleads,.module-sponsored-ads,.module-zerg,.moduleAd,.moduleAdSpot,.moduleAdvert,.moduleAdvertContent,.moduleBannerAd,.module__ad-wide,.module_box_ad,.module_home_ads,.module_single_ads,.modulegad,.moduletable-advert,.moduletable_advertisement,.moduletableadvert,.moduletablesquaread,.moduletabletowerad,.mos-ad,.movable-ad,.movv-ad,.mp-ad,.mpsponsor,.mpu-ad,.mpu-ad-con,.mpu-ad-river,.mpu-ad-top,.mpu-advert,.mpu-c,.mpu-footer,.mpu-fp,.mpu-holder,.mpu-leaderboard,.mpu-left,.mpu-left-bk,.mpu-mediatv,.mpu-right,.mpu-title,.mpu-top-left,.mpu-top-left-banner,.mpu-top-right,.mpu-unit,.mpu-wrap,.mpu-wrapper,.mpuAd,.mpuAdArea,.mpuAdSlot,.mpuAdvert,.mpuArea,.mpuBlock,.mpuBox,.mpuContainer,.mpu_Ad,.mpu_ad,.mpu_advert,.mpu_container,.mpu_holder,.mpu_placeholder,.mpu_side,.mpu_wrapper,.mpuad,.mpuads,.mrec-ads,.mrec-banners,.mrecAds,.mrec_advert,.mrf-adv,.mrf-adv__wrapper,.msg-ad,.msgad,.mt-ad-container,.mt_ad,.mt_ads,.mtop_adfit,.mu-ad-container,.mv_atf_ad_holder,.mvp-ad-label,.mvp-feat1-list-ad,.mvp-flex-ad,.mvp-post-ad-wrap,.mvp-widget-ad,.mvp-widget-feat2-side-ad,.mvp_ad_widget,.mw-ad,.my-ads,.myAds,.myAdsGroup,.my__container__ad,.my_responsive_ads,.n1ad-center-300,.narrow_ad_unit,.narrow_ads,.national_ad,.nationalad,.native-ad,.native-ad-article,.native-ad-container,.native-ad-item,.native-ad-mode,.native-ad-slot,.native-adv,.native-advts,.native-leaderboard-ad,.native-sidebar-ad,.native.ad,.nativeAd,.native_ad,.native_ad_inline,.native_ad_wrap,.native_ads,.nav-ad,.nav-ad-gpt-container,.nav-ad-plus-leader,.nav-adWrapper,.navbar-ad-section,.navbar-ads,.navbar-header-ad,.naviad,.ndmadkit,.netPost_ad1,.netPost_ad3,.netads,.netshelter-ad,.newHeaderAd,.new_ad1,.new_ad_left,.new_ad_normal,.new_ad_wrapper_all,.new_ads_unit,.newad,.newad1,.news-ad,.news-ad-square-a,.news-ad-square-box,.news-ads-top,.news-item--ad,.news_ad_box,.news_vibrant_ads_banner,.newsad,.newsblock-ads,.newsfeed_adunit,.newspack-broadstreet-ad,.newspack_global_ad,.newspack_global_ad_new,.nfy-ad,.nfy-ad-teaser,.nfy-ad-tile,.nfy-ad-wrapper,.nfy-cobo-ad,.nfy-col-ad,.ng-ad-banner,.ng-ad-insert,.nm-ad,.nn_mobile_mpu_wrapper,.noadblock,.node_ad_wrapper,.normalAds,.normal_ads,.normalad,.northad,.not-an-ad-header,.note-advertisement,.np-ad,.np-ad-background,.np-ad-border,.np-ads-wrapper,.np-adv-container,.np-advert_apu,.np-advert_apu-double,.np-advert_info,.np-header-ad,.np-header-ads-area,.np-right-ad,.nrAds,.nsAdRow,.nts-ad,.nts-video-wrapper,.ntv-ad,.nuffnangad,.nuk-ad-placeholder,.nv-ads-wrapper,.nw-ad,.nw-ad-label,.nw-c-leaderboard-ad,.nw-top-ad,.nw_adv_square,.nx-billboard-ad,.nx-placeholder-ad,.nya-slot[style],.o-ad,.o-ad-banner-top,.o-ad-container,.o-advert,.o-listing__ad,.o-site-header__advert,.oad-ad,.oas-ad,.oas-container,.oas-leaderboard-ads,.oas_ad,.oas_add,.oas_advertisement,.oasad,.oasads,.ob-hover.ob_what,.ob-p,.ob-p.ob-dynamic-rec-container,.ob-smartfeed-wrapper,.ob-widget-header,.ob_ads_header,.ob_container .item-container-obpd,.ob_dual_right > .ob_ads_header ~ .odb_div,.ob_what_resp,.offads,.oi-add-block,.oi-header-ad,.oio-banner-zone,.oio-link-sidebar,.oio-openslots,.oio-zone-position,.oko-adhesion,.on_player_ads,.oneColumnAd,.onet-ad,.online-ad-container,.oovvuu-embed-player,.opd_adsticky,.otd-ad-top,.outBrainWrapper,.outbrain,.outbrain-ad-slot,.outbrain-ad-units,.outbrain-ads,.outbrain-bg,.outbrain-bloc,.outbrain-content,.outbrain-group,.outbrain-module,.outbrain-placeholder,.outbrain-recommended,.outbrain-reserved-space,.outbrain-single-bottom,.outbrain-widget,.outbrain-wrap,.outbrain-wrapper,.outbrain-wrapper-container,.outbrain-wrapper-outer,.outbrainAdHeight,.outbrainWidget,.outbrain__main,.outbrain_container,.outbrain_skybox,.outbrainad,.outbrainbox,.outer-ad-container,.outer-ad-unit-wrapper,.outerAdWrapper,.outerAds,.outer_ad_container,.outside_ad,.outsider-ad,.ov-ad-slot,.overflow-ad,.overlay-ad,.overlay-ad-container,.overlay-ads,.overlay-box-ad,.overlay_ad,.p-ad-block,.p-ad-dfp-banner,.p-ad-dfp-middle-rec,.p-ad-feature-pr,.p-ad-outbreak,.p-ad-rectangle,.p-ad-thumbnail-txt,.p-ads-billboard,.p-ads-rec,.p-post-ad:not(html):not(body),.p75_sidebar_ads,.p_adv,.p_topad,.package_adBox,.padAdvx,.padvertlabel,.page-ad,.page-ads,.page-advert,.page-advertisement,.page-bottom-fixed-ads,.page-box-ad,.page-break-ad,.page-footer-ad,.page-header-ad,.page-header_ad,.page-top-ads,.pageAd,.pageAdSkin,.pageAdSkinUrl,.pageAds,.pageFooterAd,.pageGoogleAd,.pageGoogleAds,.pageHeaderAd,.pageHeaderAds,.pageTopAd,.page__top-ad-wrapper,.pagead,.pagepusheradATF,.pages__ad,.pane-ad-pane,.pane-ads,.pane-sasia-ad,.pane-site-ads,.pane-sponsored-links,.pane_ad_wide,.panel-ad,.panel-adsense,.panel-advert,.panel.ad,.panel_ad,.paneladvert,.par-ad,.par-adv-slot,.parade-ad-container,.parent-ad-desktop,.partial-ad,.partner-ad,.partner-ad-module-wrapper,.partner-ads-list,.partner-loading-shown.partner-label,.partnerAd,.partner_ads,.partnerad_container,.partnersTextLinks,.pauseAdPlacement,.pb-slot-container,.pc-ad,.pcads_widget,.pd-ads-mpu,.pdpads,.penci-ad-box,.penci-ad-image,.penci-ad_box,.penci-adsense-below-slider,.penci-google-adsense,.penci-google-adsense-1,.penci-promo-link,.penci_list_bannner_widget,.pencil-ad,.pencil-ad-container,.pencil-ad-section,.pencil_ad,.perm_ad,.pf_content_ad,.pf_sky_ad,.pf_top_ad,.pg-ad-block,.pg-adnotice,.pg-adtarget,.pgevoke-fp-bodyad2,.pgevoke-story-rightrail-ad1,.pgevoke-story-topads,.pgevoke-topads,.ph-ad,.photo-ad,.photo-ad-pad,.photoAd,.photoad,.phpads_container,.phpbb-ads-center,.pix_adzone,.pizza-x.pizza,.pizza-y.pizza,.placeholder-ad,.placeholder-dfp,.placeholderAd,.plain-ad,.plainAd,.player-ad,.player-ad-overlay,.player-ads,.player-ads2,.player-under-ad,.playerAd,.playerAdv,.player_ad,.player_ad2,.player_ad_box,.playerad,.playerdads,.playwire-article-leaderboard-ad,.plugin-ad,.plugin-ad-container,.pm-ad,.pm-ad-unit,.pm-ad-zone,.pm-ads-banner,.pm-ads-inplayer,.pm-banner-ad,.pmc-adm-boomerang-pub-div,.pmc-contextual-player,.polar-ad,.polaris-ad--wrapper-desktop,.polarisMarketing,.polaris__ad,.polaris__below-header-ad-wrapper,.pop-out-eplayer-container,.popup-box-ads,.position-ads,.post-ad,.post-ad-title,.post-ad-top,.post-ad-type,.post-ads,.post-ads-top,.post-adsense-bottom,.post-advert,.post-advert-row,.post-advertisement,.post-banners.anuncios,.post-load-ad,.post-news-ad,.post-sidebar-ad,.post-sponsored,.postAd,.postWideAd,.post_ad,.post_ads,.post_advert,.post_detail_right_advert,.post_sponsored,.postad,.postads,.postbit-ad,.poster_ad,.posts-ad,.pp-ad-container,.pp_ad_code_adtxt,.ppb_ads,.pr_adslot_0,.pr_adslot_1,.preheader_advert,.premium-ad,.premium-ads,.premium-adv,.premium-mpu-container,.premium_PremiumPlacement__2dEp0,.priad,.priad-1,.primary-ad,.primary-ad-widget,.primary-advertisment,.primis-ad,.primis-ad-wrap,.primis-custom,.primis-player,.primis-player-container,.primis-player__container,.primis-video,.primis-video-player,.primis-wrapper,.primis_1,.print-ad-wrapper,.print-adslot,.printAds,.product-inlist-ad,.profile-ad-container,.profile-ads-container,.profile__ad-wrapper,.profile_ad_bottom,.profile_ad_top,.promo-ad,.promo-mpu,.promoAds,.promoAdvertising,.promo_ad,.promo_ads,.promoad,.promoboxAd,.promoted-outbrain,.promotionAdContainer,.promotionTextAd,.proper-ad-insert,.proper-ad-unit,.ps-ad,.pt-ad--container,.pt-ad--scroll,.pt_ad03,.pt_col_ad02,.pub_ads,.pubexchange_module,.publication-ad,.publicidad_horizontal,.publisher_ad,.pubtech-adv-slot,.puff-ad,.puff-advertorials,.pull-ad,.pull_top_ad,.pullad,.purchad,.push--ad,.push-ad,.push-adv,.pushDownAd,.pushdown-ad,.pushdownAd,.pwa-ad,.pz-ad-box,.quads-ad-label,.quads-bg-ad,.quads-location,.queue_ad,.queued-ad,.quigo,.quigo-ad,.quigoads,.r-ad,.r-pause-ad-container,.r89-outstream-video,.r_ad,.r_ads,.rail-ad,.rail-ads-1,.rail-article-sponsored,.rail__ad,.rail_ad,.railad,.railadspace,.rc-sponsored,.rcom-freestar-ads-widget,.rec-sponsored,.rec_ad,.rec_article_footer,.rec_article_right,.rec_container__right,.rec_container_footer,.rec_container_right,.rec_title_footer,.recent-ad,.recentAds,.recent_ad_holder,.recipeFeatureAd,.rect-ad,.rect-ad-1,.rectAd300,.rect_ad,.rect_ad_module,.rect_advert,.rectad,.rectadv,.rectangle-ad,.rectangle-ad-container,.rectangle-embed-ad,.rectangleAd,.rectangleAdContainer,.rectangle_ad,.rectanglead,.rectangleads,.reform-top-container,.refreshAds,.region-ad-bottom-leaderboard,.region-ad-pan,.region-ad-right,.region-ads,.region-ads-content-top,.region-banner-ad,.region-banner-header,.region-dfp-ad-footer,.region-dfp-ad-header,.region-header-ad,.region-header-ads,.region-top-ad,.region-top-ad-block,.regular-ads,.regularad,.rekl-left,.rekl-right,.rekl-top,.rekl_left,.rekl_right,.rekl_top,.rekl_top_wrapper,.reklam,.reklam-block,.reklam-kare,.reklam-masthead,.reklam2,.reklam728,.reklama-vert,.reklama1,.reklame-wrapper,.reklamka,.related-ad,.related-ads,.relatedAds,.related_ad,.remnant_ad,.remove-ads,.remove-ads-link,.res_ad,.resads-adspot,.responsive-ad,.responsive-ad-header-container,.responsive-ad-outbrain,.responsive-ad-wrapper,.responsive-ads,.responsiveAdsense,.responsive_ad_top,.responsive_ads_468x60,.result-ad,.result-sponsored,.resultAd,.result_ad,.resultad,.results-ads,.revcontent-wrap,.review-ad,.reviews-display-ad,.revive-ad,.rh-ad,.rhads,.rhs-ad,.rhs-ads-panel,.rhs-advert-container,.rhs-mrec-wrapper,.rhs_ad,.rhs_ad_title,.rhs_ads,.rhsad,.rhsadvert,.right-ad,.right-ad-1,.right-ad-2,.right-ad-3,.right-ad-4,.right-ad-5,.right-ad-block,.right-ad-container,.right-ad-holder,.right-ad-wrapper,.right-ad2,.right-ad350px250px,.right-ads,.right-ads2,.right-adsense,.right-adv,.right-advert,.right-advertisement,.right-col-ad,.right-column-ad,.right-column-ads,.right-rail-ad,.right-rail-ad-container,.right-rail-box-ad-container,.right-side-ad,.right-side-ads,.right-sidebar-box-ad,.right-sidebar-box-ads,.right-sponser-ad,.right-top-ad,.right-video-dvertisement,.rightAD,.rightAd,.rightAd1,.rightAd2,.rightAdBlock,.rightAdBox,.rightAdColumn,.rightAdContainer,.rightAdsFix,.rightAdvert,.rightAdverts,.rightBoxAd,.rightBoxMidAds,.rightColAd,.rightColAdBox,.rightColumnAd,.rightColumnAdd,.rightColumnAdsTop,.rightColumnRectAd,.rightHeaderAd,.rightRailAd,.rightRailMiddleAd,.rightSecAds,.rightSideBarAd,.rightSideSponsor,.rightTopAdWrapper,.right_ad,.right_ad_1,.right_ad_2,.right_ad_box,.right_ad_box1,.right_ad_text,.right_ad_top,.right_ad_unit,.right_ad_wrap,.right_ads,.right_ads_column,.right_adsense_box_2,.right_adskin,.right_adv,.right_advert,.right_advertise_cnt,.right_advertisement,.right_block_advert,.right_box_ad,.right_col_ad,.right_column_ads,.right_content_ad,.right_image_ad,.right_long_ad,.right_outside_ads,.right_side_ads,.right_side_box_ad,.right_sponsor_main,.rightad,.rightadHeightBottom,.rightadblock,.rightadd,.rightads,.rightadunit,.rightadv,.rightboxads,.rightcolads,.rightcoladvert,.rightrail-ad-placed,.rightsideAd,.river-item-sponsored,.rj-ads-wrapper,.rm-adslot,.rolloverad,.roof-ad,.root-ad-anchor,.rotating-ad,.rotating-ads,.row-ad,.row-ad-leaderboard,.row-list.banniere,.row-list.native,.rowAd,.rowAds,.row_header_ads,.rpd_ads,.rr-ad,.rr_ads,.rs-ad,.rs-advert,.rs-advert__container,.rs_ad_block,.rs_ad_top,.rt_ad,.s-ad,.s-ads,.s2nContainer,.s_ads,.sadvert,.sagreklam,.sal-adv-gpt,.sam_ad,.sb-ad,.sb-ads,.sbAd,.sbAdUnitContainer,.sbTopadWrapper,.sb_ad,.sb_ad_holder,.sc-ad,.scad,.script-ad,.scroll-ad-item-container,.scroll-ads,.scroll-fixable.rail-right > .deals-rail,.scroll-track-ad,.scrolling-ads,.sda_adbox,.sdc-advert__top-1,.se-ligatus,.search-ad,.search-advertisement,.search-result-list-item--sidebar-ad,.search-result-list-item--topad,.search-results-ad,.search-sponsor,.search-sponsored,.searchAd,.searchAdTop,.searchAds,.searchad,.searchads,.secondary-ad-widget,.secondary-advertisment,.secondary_ad,.section-ad,.section-ad-unit,.section-ad-wrapper,.section-ad2,.section-ads,.section-adtag,.section-adv,.section-advertisement,.section-sponsor,.section-subheader > .section-hotel-prices-header,.section-widget-ad,.section_ad,.section_ad_left,.section_ads,.send-to-news,.seoAdWrapper,.servedAdlabel,.serviceAd,.sf_ad_box,.sg-adblock,.sgAd,.sh-section-ad,.shadvertisment,.sheknows-infuse-ad,.shift-ad,.shopee-search-user-brief,.shortadvertisement,.show-desk-ad,.show-sticky-ad,.showAd,.showAdContainer,.showads,.showcaseAd,.showcasead,.shr-ads-container,.sics-component__outbrain,.sidbaread,.side-ad-300,.side-ad-blocks,.side-ad-container,.side-ad-inner,.side-ad-top,.side-ads,.side-ads-block,.side-ads-wide,.side-adv-block,.side-adv-text,.side-advert,.side-advertising,.side-adverts,.side-bar-ad,.sideAd,.sideAdLeft,.sideAdWide,.sideBarAd,.sideBlockAd,.sideBoxAd,.side__ad,.side__ad-box,.side_ad,.side_ad2,.side_ad_top,.side_add_wrap,.side_ads,.side_adsense,.side_adv,.side_col_ad_wrap,.sidead,.sideadmid,.sideads,.sideads_l,.sideadsbox,.sideadtable,.sideadvert,.sideadverts,.sidebar-ad-area,.sidebar-ad-b,.sidebar-ad-box,.sidebar-ad-c,.sidebar-ad-component {display: none !important; color: #00b3dd !important; background-color: #db1dff !important;}</style><style type="text/css" class="abn_style" nonce="undefined">.sidebar-ad-cont,.sidebar-ad-container,.sidebar-ad-div,.sidebar-ad-label,.sidebar-ad-rect,.sidebar-ad-slot,.sidebar-ad-top,.sidebar-ad-wrapper,.sidebar-adbox,.sidebar-ads-block,.sidebar-ads-wrap,.sidebar-adsdiv,.sidebar-adv-container,.sidebar-advert,.sidebar-advertisement,.sidebar-advertisment,.sidebar-adverts,.sidebar-adverts-header,.sidebar-banner-ad,.sidebar-below-ad-unit,.sidebar-big-ad,.sidebar-big-box-ad,.sidebar-bottom-ad,.sidebar-box-ad,.sidebar-box-ads,.sidebar-content-ad,.sidebar-header-ads,.sidebar-outbrain,.sidebar-skyscraper-ad,.sidebar-sponsored,.sidebar-sponsors,.sidebar-square-ad,.sidebar-sticky--ad,.sidebar-text-ad,.sidebar-top-ad,.sidebar-top-banner,.sidebar-tower-ad,.sidebar-zergnet,.sidebarAD,.sidebarAd,.sidebarAdvert,.sidebar__ad,.sidebar_ad,.sidebar_ad_300,.sidebar_ad_300_250,.sidebar_ad_container,.sidebar_ad_holder,.sidebar_ad_leaderboard,.sidebar_ad_module,.sidebar_ads,.sidebar_ads_left,.sidebar_ads_right,.sidebar_ads_title,.sidebar_adsense,.sidebar_advertising,.sidebar_box_ad,.sidebar_right_ad,.sidebar_skyscraper_ad,.sidebar_sponsors,.sidebarad,.sidebarad_bottom,.sidebaradbox,.sidebaradcontent,.sidebarads,.sidebaradsense,.sidebarbox__advertising,.sidebarboxad,.sidebox-ad,.sidebox_ad,.sideright_ads,.sideskyad,.signad,.simple-ad-placeholder,.simple_ads_manager_widget,.simple_adsense_widget,.simplead-container,.simpleads-item,.single-ad,.single-ad-anchor,.single-ad-wrap,.single-ads,.single-ads-section,.single-bottom-ads,.single-mpu,.single-post-ad,.single-post-ads,.single-post-bottom-ads,.single-top-ad,.singleAd,.singleAdBox,.singleAdsContainer,.singlePostAd,.single__outbrain,.single_ad,.single_ad_300x250,.single_advert,.single_bottom_ad,.single_top_ad,.singlead,.singleads,.singleadstopcstm2,.singlebanner,.singlepageleftad,.singlepostad,.singlepostadsense,.singpagead,.sister-ads,.site-ad-block,.site-ads,.site-bottom-ad-slot,.site-head-ads,.site-header-ad,.site-header__ads,.site-top-ad,.siteWideAd,.site_ad,.site_ad--gray,.site_ad--label,.site_ads,.site_sponsers,.sitesponsor,.skinAd,.sky-ad,.sky-ad1,.skyAd,.skyAdd,.skyAdvert,.skyAdvert2,.sky_ad,.sky_ad_top,.skyad,.skyscraper-ad,.skyscraper-ad-1,.skyscraper-ad-container,.skyscraper.ad,.skyscraperAd,.skyscraper_ad,.skyscrapper-ads-container,.slate-ad,.slide-ad,.slideAd,.slide_ad,.slidead,.slider-ads,.slider-item-ad,.sliderad,.slideshow-ad,.slideshow-ad-container,.slideshow-ad-wrapper,.slideshow-ads,.slideshowAd,.slideshowadvert,.slottaboola,.sm-ad,.sm-admgnr-unit,.sm-ads,.sm-advertisement,.sm-widget-ad-holder,.sm_ad,.small-ad,.small-ad-header,.small-ad-long,.smallAd,.smallAdContainer,.smallAds,.smallAdvertisments,.small_ad_bg,.small_ads,.smallad,.smalladblock,.smalladscontainer,.smallsponsorad,.smart-ad,.smartAd,.smartad,.smn-new-gpt-ad,.snippet-ad,.speakol-widget,.spinAdvert,.splashy-ad-container,.spon_link,.sponadbox,.sponlinkbox,.spons-link,.spons-wrap,.sponsBox,.sponsLinks,.sponsWrap,.sponsbox,.sponser-link,.sponserLink,.sponslink,.sponsor-ads,.sponsor-area,.sponsor-block,.sponsor-bottom,.sponsor-btns,.sponsor-inner,.sponsor-left,.sponsor-link,.sponsor-links,.sponsor-popup,.sponsor-post,.sponsor-right,.sponsor-spot,.sponsor-text,.sponsor-text-container,.sponsor-wrap,.sponsorAd,.sponsorArea,.sponsorBottom,.sponsorBox,.sponsorFooter,.sponsorFooter-container,.sponsorLabel,.sponsorLink,.sponsorLinks,.sponsorPanel,.sponsorPost,.sponsorPostWrap,.sponsorStrip,.sponsorText,.sponsorTxt,.sponsor_ad,.sponsor_ad1,.sponsor_ad2,.sponsor_ad_area,.sponsor_ad_section,.sponsor_area,.sponsor_bar,.sponsor_block,.sponsor_columns,.sponsor_div,.sponsor_footer,.sponsor_image,.sponsor_label,.sponsor_line,.sponsor_links,.sponsor_logo,.sponsor_placement,.sponsor_popup,.sponsor_units,.sponsorad,.sponsoradlabel,.sponsorads,.sponsoradtitle,.sponsored-ad,.sponsored-ad-container,.sponsored-ad-label,.sponsored-add,.sponsored-ads,.sponsored-article-item,.sponsored-article-widget,.sponsored-block,.sponsored-buttons,.sponsored-container,.sponsored-container-bottom,.sponsored-default,.sponsored-display-ad,.sponsored-header,.sponsored-link,.sponsored-links,.sponsored-post,.sponsored-post-container,.sponsored-result,.sponsored-results,.sponsored-right,.sponsored-slot,.sponsored-tag,.sponsored-text,.sponsored-top,.sponsored-widget,.sponsoredAd,.sponsoredAds,.sponsoredBanners,.sponsoredBar,.sponsoredBottom,.sponsoredBox,.sponsoredContent,.sponsoredEntry,.sponsoredFeature,.sponsoredInfo,.sponsoredInner,.sponsoredLabel,.sponsoredLeft,.sponsoredLink,.sponsoredLinks,.sponsoredLinks2,.sponsoredLinksBox,.sponsoredListing,.sponsoredProduct,.sponsoredResults,.sponsoredSearch,.sponsoredTop,.sponsored_ad,.sponsored_ads,.sponsored_bar_text,.sponsored_box,.sponsored_by,.sponsored_link,.sponsored_links,.sponsored_links2,.sponsored_links_box,.sponsored_links_container,.sponsored_links_section,.sponsored_post,.sponsored_result,.sponsored_results,.sponsored_sidepanel,.sponsored_ss,.sponsored_text,.sponsored_title,.sponsored_well,.sponsoredby,.sponsoredlink,.sponsoredlinks,.sponsoredresults,.sponsorheader,.sponsoringbanner,.sponsorlink,.sponsorlink2,.sponsormsg,.sponsors-advertisment,.sponsors-box,.sponsors-footer,.sponsors-module,.sponsors-widget,.sponsorsBanners,.sponsors_links,.sponsors_spacer,.sponsorsbanner,.sponsorsbig,.sponsorship-box,.sponsorship-container,.sponsorship-leaderboard,.sponsorship_ad,.sponsorwrapper,.sponstop,.spot-ad,.spot_wrapper,.spotim-amp-list-ad,.spotlight-ad,.spotlightAd,.spots-title,.spt-footer-ad,.sq_ad,.sqrd-ad-manager,.square-ad,.square-ad-1,.square-ad-container,.square-ad-pane,.square-ads,.square-advt,.square-adwrap,.square-sidebar-ad,.square-sponsorship,.squareAd,.squareAdWrap,.squareAdd,.squareAds,.square_ad,.squaread,.squareads,.squared_ad,.sr-adsense,.sr-advert,.sraAdvert,.srp-sidebar-ads,.ssp-advert,.standalonead,.standard-ad-container,.standard_ad_slot,.static-ad,.staticAd,.static_mpu_wrap,.staticad,.sterra-ad,.stick-ad-container,.stickad,.sticky-ad,.sticky-ad-bottom,.sticky-ad-container,.sticky-ad-footer,.sticky-ad-header,.sticky-ad-wrapper,.sticky-ads,.sticky-ads-container,.sticky-ads-content,.sticky-adsense,.sticky-advert-widget,.sticky-bottom-ad,.sticky-footer-ad,.sticky-footer-ad-container,.sticky-navbar-ad-container,.sticky-rail-ad-container,.sticky-side-ad,.sticky-sidebar-ad,.sticky-top-ad-wrap,.stickyAd,.stickyAdWrapper,.stickyAdsGroup,.stickyContainerMpu,.stickyRailAd,.sticky_ad_sidebar,.sticky_ad_wrapper,.sticky_ads,.stickyad,.stickyads,.stickyadv,.stm-ad-player,.stock_ad,.store-ads,.story-ad,.story-ad-container,.story-ad-right,.story-inline-advert,.storyAd,.storyAdvert,.storyad,.storyad300,.stoybday-ad,.str-top-ad,.strack_bnr,.strack_cli,.strawberry-ads,.stream-ad,.streamAd,.strip-ad,.strip-banner,.stripad,.style_k8mr7b-o_O-style_uhlm2,.style_medTopAdsWrapper__rd6bz,.sub-ad,.subAdBannerArea,.subAdBannerHeader,.subNavAd,.subad,.subheader_adsense,.submenu_ad,.subnav-ad-layout,.subnav-ad-wrapper,.subscribeAd,.subscriber-ad,.subscribox-ad,.sudoku-ad,.sugarad,.super-ad,.superbanner-adcontent,.swipedAd,.tabAd,.tabAds,.tab_ad,.tab_ad_area,.table-ad,.tableAd1,.tablet-ad,.taboola,.taboola-above-article,.taboola-above-article-thumbnails,.taboola-ad,.taboola-banner,.taboola-block,.taboola-bottom-adunit,.taboola-container,.taboola-frame,.taboola-general,.taboola-in-plug-wrap,.taboola-inbetweener,.taboola-item,.taboola-like-block,.taboola-module,.taboola-placeholder,.taboola-recommends,.taboola-sidebar,.taboola-sidebar-container,.taboola-skip-wrapper,.taboola-thumbnails-container,.taboola-vertical,.taboola-widget,.taboola-wrapper,.taboolaArticle,.taboolaDiv,.taboolaHeight,.taboola__container,.taboola_blk,.taboola_body_ad,.taboola_container,.taboola_lhs,.taboola_module,.taboolaloader,.tadm_ad_unit,.takeover-ad,.tallAdvert,.tallad,.tappx-ad,.tbboxad,.tc-adbanner,.tc_ad,.tc_ad_unit,.tcf-ad,.td-a-ad,.td-a-rec,.td-ad,.td-ad-m,.td-ad-p,.td-ad-tp,.td-adspot-title,.td-sponsor-title,.tdAdHeader,.td_ad,.td_footer_ads,.teaser-ad,.teaser-advertisement,.teaser-sponsor,.teaserAd,.teaserAdContainer,.teaserAdHeadline,.teaserList-module_nativeAdWrapper__uBhF,.teaser_ad,.templates_ad_placement,.test-adsense,.testAd-holder,.text-ad-sitewide,.text-ad-top,.text-advertisement,.text-panel-ad,.text-sponsor,.textAd3,.textAdBlock,.textAdBox,.textAds,.textLinkAd,.textSponsor,.text_ad_title,.text_ad_website,.text_ads_2,.text_ads_wrapper,.text_adv,.textadContainer,.textadbox,.textadlink,.textadscontainer,.textadsds,.textadsfoot,.textadtext,.textlinkads,.th-ad,.theAdvert,.theads,.themonic-ad1,.themonic-ad2,.themonic-ad3,.themonic-ad6,.third-party-ad,.thread-ad-align,.thumb--adv,.thumb-ads,.thumb_ad,.thumbnailad,.thumbs-adv,.thumbs-adv-holder,.tile--ad,.tile-ad,.tile-ad-container,.tile-advert,.tileAdContainer,.tileAdWrap,.tileAds,.tile_AdBanner,.tile_ad,.tile_ad_container,.title-ad,.tl-ad-container,.tmiads,.tnt-ads,.tnt-ads-container,.toaster-ad,.top-ad-728,.top-ad-970x90,.top-ad-anchor,.top-ad-area,.top-ad-bloc,.top-ad-block,.top-ad-center,.top-ad-container,.top-ad-content,.top-ad-desktop,.top-ad-div,.top-ad-horizontal,.top-ad-inside,.top-ad-module,.top-ad-recirc,.top-ad-right,.top-ad-sidebar,.top-ad-slot,.top-ad-space,.top-ad-sticky,.top-ad-unit,.top-ad-wrap,.top-ad-wrapper,.top-ad-zone,.top-ad1,.top-adbox,.top-ads-amp,.top-ads-block,.top-ads-bottom-bar,.top-ads-container,.top-ads-mobile,.top-ads-wrapper,.top-adsense,.top-adsense-banner,.top-adspace,.top-adv,.top-adv-container,.top-advert,.top-advertisement,.top-banner-468,.top-banner-ad-container,.top-banner-ad-wrapper,.top-banner-add,.top-banner-ads,.top-banner-advert,.top-bar-adblock,.top-dfp-wrapper,.top-fixed-ad,.top-half-page-ad,.top-header-ad,.top-horiz-ad,.top-horizontal-ad,.top-item-ad,.top-leaderboard-ad,.top-left-ad,.top-post-ad,.top-post-ads,.top-right-ad,.top-side-advertisement,.top-sidebar-ad,.top-sidebar-adbox,.top-site-ad,.top-sponsored-header,.top-story-ad,.top-wide-ad-container,.top.ad,.topAD,.topAd728x90,.topAdBanner,.topAdBar,.topAdBlock,.topAdCenter,.topAdContainer,.topAdLeft,.topAdRight,.topAdSpacer,.topAdWrap,.topAdWrapper,.topAdd,.topAds,.topAdsWrappper,.topAdvBox,.topAdvert,.topAdvertisement,.topAdvertistemt,.topAdverts,.topAlertAds,.topArtAd,.topArticleAds,.topBannerAd,.topBarAd,.topBoxAdvertisement,.topLeaderboardAd,.topRightAd,.top_Ad,.top__ad,.top_ad1,.top_ad_728,.top_ad_728_90,.top_ad_banner,.top_ad_big,.top_ad_disclaimer,.top_ad_div,.top_ad_holder,.top_ad_inner,.top_ad_label,.top_ad_list,.top_ad_long,.top_ad_post,.top_ad_responsive,.top_ad_seperate,.top_ad_short,.top_ad_wrap,.top_ad_wrapper,.top_adbox1,.top_adbox2,.top_adh,.top_ads,.top_ads_container,.top_adsense,.top_adspace,.top_adv,.top_adv_content,.top_advert,.top_advertisement,.top_bar_ad,.top_big_ads,.top_container_ad,.top_corner_ad,.top_head_ads,.top_header_ad,.top_header_ad_inner,.top_right_ad,.top_rightad,.top_side_adv,.top_sponsor,.topad-area,.topad-bar,.topad-bg,.topad1,.topad2,.topadbar,.topadblock,.topadbox,.topadcont,.topadrow,.topads-spacer,.topadsbx,.topadsection,.topadspace,.topadspot,.topadtara,.topadtxt,.topadvert,.topbannerAd,.topbar-ad-parent,.topbar-ad-unit,.topboardads,.topright_ad,.topside_ad,.topsidebarad,.tout-ad,.tout-ad-embed,.tower-ad,.tower-ad-abs,.tower-ad-b,.tower-ad-wrapper,.tower-ads-container,.towerAd,.towerAdLeft,.towerAds,.tower_ad,.tower_ad_desktop,.tower_ad_disclaimer,.towerad,.tp-ad-label,.tp_ads,.tpd-banner-ad-container,.tpd-banner-desktop,.trb_taboola,.trc-content-sponsored,.trc-first-recommendation,.trc-spotlight-first-recommendation,.trc_excludable,.trc_rbox,.trc_rbox_border_elm,.trc_rbox_div,.trc_related_container,.trc_spotlight_item,.trend-card-advert,.trend-card-advert__title,.tsm-ad,.tt_ads,.tw-adv-slot,.txt_ads,.txtad_area,.txtadbox,.txtadvertise,.type-ad,.u-ads,.u-lazy-ad-wrapper,.u-margin-auto.banner,.udn-ads,.ue-c-ad,.ult_vp_videoPlayerAD,.under-header-ad,.under-player-ad,.under-player-ads,.under_ads,.underplayer_banner,.uniAdBox,.unit-ad,.upper-ad-box,.upper-ad-space,.upper_ad,.upx-ad-placeholder,.us_ad,.vadvert,.van_taboola,.van_vid_carousel,.variable-ad,.variableHeightAd,.vast-blocker,.vce-ad-below-header,.vce-ad-container,.vce-header-ads,.vce_adsense_expand,.vce_adsense_widget,.vce_adsense_wrapper,.vert-ad,.vert-ads,.vertad,.vertical-ad,.vertical-adsense,.verticalAd,.verticalAdText,.vertical_ad,.vertical_ads,.verticalad,.vf-ad-comments,.vf-conversation-starter__ad,.vf-promo-gtag,.vf-promo-wrapper,.vf3-conversations-list__promo,.vi-sticky-ad,.video--container--aniview,.video-ad-bottom,.video-ad-content,.video-ads-container,.video-ads-grid,.video-ads-wrapper,.video-adv,.video-advert,.video-archive-ad,.video-boxad,.video-inline-ads,.video-page__adv,.video-right-ad,.video-right-ads,.video-side__adv_title,.videoAd-wrapper,.videoAd300,.videoBoxAd,.videoPauseAd,.videoSideAds,.video__banner,.video_ad,.video_ads,.videoad,.videoad-base,.videoad2,.videos-ad-wrap,.vidible-wrapper,.view-Advertisment,.view-ad,.view-ads,.view-advertisement,.view-advertisements,.view-advertorials,.view-adverts,.view-article-inner-ads,.view-homepage-center-ads,.view-id-Advertisment,.view-id-ads,.view-id-advertisement,.view-image-ads,.view-site-ads,.view_ad,.views-field-field-ad,.visibleAd,.vjs-ad-iframe,.vjs-ad-overlay,.vjs-ima3-ad-container,.vjs-marker-ad,.vjs-overlay.size-300x250,.vl-ad-item,.vl-advertisment,.vl-header-ads,.vlog-ad,.vm-ad-horizontal,.vmag_medium_ad,.voc-ob-wrapper,.vodl-ad__bigsizebanner,.vpnad,.vs-advert-300x250,.vsw-ads,.vswAdContainer,.vuukle-ad-block,.vuukle-ads,.vw-header__ads,.w-ad-box,.w-content--ad,.wAdvert,.w_AdExternal,.w_ad,.waf-ad,.wahAd,.wahAdRight,.waldo-display-unit,.waldo-placeholder,.waldo-placeholder-bottom,.wall-ads-control,.wall-ads-left,.wall-ads-right,.wallAd,.wall_ad,.wcAd,.wcfAdLocation,.weatherad,.web_ads,.webpart-wrap-advert,.well-ad,.werbungAd,.wfb-ad,.wg-ad-square,.wh-advert,.wh_ad,.wh_ad_inner,.when-show-ads,.wide-ad,.wide-ad-container,.wide-ad-new-layout,.wide-ad-outer,.wide-ads-container,.wide-advert,.wide-footer-ad,.wide-header-ad,.wide-skyscraper-ad,.wideAd,.wideAdTable,.widePageAd,.wide_ad,.wide_adBox_footer,.wide_ad_unit,.wide_ad_unit_top,.wide_ads,.wide_google_ads,.wide_grey_ad_box,.wide_sponsors,.widead,.wideadbox,.widget--ad,.widget--local-ads,.widget-300x250ad,.widget-ad,.widget-ad-codes,.widget-ad-image,.widget-ad-script,.widget-ad-sky,.widget-ad-zone,.widget-ad300x250,.widget-adcode,.widget-ads,.widget-adsense,.widget-adv,.widget-advads-ad-widget,.widget-advert-970,.widget-advertisement,.widget-dfp,.widget-sponsor,.widget-sponsor--container,.widget-text-ad,.widgetAD,.widgetAds,.widgetSponsors,.widget_300x250_advertisement,.widget_ad,.widget_ad-widget,.widget_ad125,.widget_ad300,.widget_ad_300,.widget_ad_boxes_widget,.widget_ad_layers_ad_widget,.widget_ad_rotator,.widget_ad_widget,.widget_adace_ads_widget,.widget_admanagerwidget,.widget_adrotate_widgets,.widget_ads,.widget_ads_entries,.widget_ads_widget,.widget_adsblock,.widget_adsensem,.widget_adsensewidget,.widget_adsingle,.widget_adswidget1-quick-adsense,.widget_adswidget2-quick-adsense,.widget_adswidget3-quick-adsense,.widget_adv_location,.widget_advads_ad_widget,.widget_advert,.widget_advert_content,.widget_advert_widget,.widget_advertisement,.widget_advertisements,.widget_advertisment,.widget_advwidget,.widget_alaya_ad,.widget_arvins_ad_randomizer,.widget_awaken_pro_medium_rectangle_ad,.widget_better-ads,.widget_cpxadvert_widgets,.widget_customad_widget {display: none !important; color: #00b3dd !important; background-color: #db1dff !important;}.widget_customadvertising,.widget_dfp,.widget_doubleclick_widget,.widget_epcl_ads_fluid,.widget_evolve_ad_gpt_widget,.widget_html_snippet_ad_widget,.widget_ione-dart-ad,.widget_island_ad,.widget_long_ads_widget,.widget_newspack-ads-widget,.widget_openxwpwidget,.widget_outbrain,.widget_outbrain_widget,.widget_plugrush_widget,.widget_quads_ads_widget,.widget_sej_sidebar_ad,.widget_sidebaradwidget,.widget_singlead,.widget_sponsored_content,.widget_supermag_ad,.widget_supernews_ad,.widget_taboola,.widget_text_adsense,.widget_themoneytizer_widget,.widget_thesun_dfp_ad_widget,.widget_tt_ads_widget,.widget_viral_advertisement,.widget_wp-bannerize-widget,.widget_wp_insert_ad_widget,.widget_wpex_advertisement,.widget_wpstealthads_widget,.widgetads,.wikia-ad,.wio-xbanner,.wl_WidgetRel_Record_Div.wl_WidgetRel_Sponsor,.wordads-ad-wrapper,.wp-ads-target,.wp-block-ad-slot,.wp-block-tpd-block-tpd-ads,.wp125ad,.wp125ad_2,.wp_bannerize,.wp_bannerize_banner_box,.wp_bannerize_container,.wpadcenter-ad-container,.wpadvert,.wpd-advertisement,.wpex-ads-widget,.wppaszone,.wpvqgr-a-d-s,.wpx-bannerize,.wpx_bannerize,.wpx_bannerize_banner_box,.wrap-ad,.wrap-ads,.wrap_boxad,.wrapad,.wrapper-ad,.wrapper-banner-box-wallpaper,.wrapper-banner-wallpaper,.wrapper-header-ad-slot,.wrapper_ad,.wrapper_advertisement,.wrapperad,.ww_ads_banner_wrapper,.xeiro-ads,.xmlad,.xplayer-banner,.xplayer-banner-bottom,.xpot-horizontal,.yad-sponsored,.yahooad,.yahooads,.ympb_target,.zaf-adhesion-container,.zerg-widget,.zerg-widgets,.zergnet,.zergnet-holder,.zergnet-row,.zergnet-unit,.zergnet-widget,.zergnet-widget-container,.zergnet-widget__header,.zergnet-widget__subtitle,.zergnet__container,.zeus-ad,.zeusAdWrapper,.zeusAd__container,.zmgad-full-width,.zmgad-right-rail,.zone-advertisement,.zone.zone--loaded,.zoneAds,.zox-post-ad-wrap,.zox-post-bot-ad,.zox-widget-side-ad,.zox_ad_widget,.zox_adv_widget,AD-SLOT,AMP-AD,A[href*="delivery.bb2021.info"],DFP-AD,IFRAME[src*="alosafada.com/barra-disksexo/"],[alt="banner-300-x-250"],[class][data-sitename][data-header-version] > div[id^="detection-block"],[class^="adDisplay-module"],[class^="adFrameDiv"],[class^="adv_bottom_table"],[class^="amp-ad-"],[class^="div-gpt-ad"],[class^="s2nPlayer"],[class^="tile-picker__CitrusBannerContainer-sc-"],[data-ad-cls],[data-ad-manager-id],[data-ad-module],[data-ad-width],[data-adbridg-ad-class],[data-adshim],[data-advadstrackid],[data-asg-ins],[data-block-type="ad"],[data-cl-spot-id],[data-css-class="dfp-inarticle"],[data-d-ad-id],[data-desktop-ad-id],[data-dynamic-ads],[data-ez-name],[data-freestar-ad][id],[data-id^="div-gpt-ad"],[data-identity="adhesive-ad"],[data-m-ad-id],[data-mobile-ad-id],[data-rc-widget],[data-revive-zoneid],[data-role="tile-ads-module"],[data-taboola-options],[data-template-type="nativead"],[data-testid="adBanner-wrapper"],[data-testid="ad_testID"],[data-testid="commercial-label-taboola"],[data-testid="prism-ad-wrapper"],[data-testid^="section-AdRowBillboard"],[data-testid^="taboola-"],[data-type="ad-vertical"],[data-wpas-zoneid],[href$="/sexdating.php"],[href*=".afquptvqzw.biz"],[href*=".djuzsbnnm.biz"],[href*=".igkxr.biz"],[href*="/exoads/b/"],[href*="asyaaffiliate.com"] > *,[href*="edintorni.net/related/service/sponsor/redirect/"] > *,[href*="go2cloud.org/aff_"],[href*="mtwbedsl.biz"],[href*="nepeoripa.biz"],[href*="play4k.tv/download/"],[href*="territoryparcel.bid"],[href*="tmstrack.com"][target="_blank"],[href*="xxxpostpic.org/adslink.php"],[href="//sexcams.plus/"],[href="https://chaturbate.jjgirls.com/"] > img,[href="https://goo.gl/WRmu17"] > IMG,[href="https://jdrucker.com/gold"] > img,[href^="http://bannerstrckr.com/click.php"],[href^="http://clicks.totemcash.com/"],[href^="http://friwap.ru/go/"],[href^="http://m.hsrve.com/click.php"],[href^="http://pixelmarkway.com/"],[href^="http://track.brucelead.com/"][target="_blank"],[href^="http://track.double6-track"][target="_blank"],[href^="http://www.outbrain.com/what-is/default/"] IMG,[href^="http://xifg6h.ru/click/"],[href^="https://aads.com/campaigns/"],[href^="https://ad.admitad.com/"],[href^="https://ad1.adfarm1.adition.com/"],[href^="https://adsrv.me/"],[href^="https://affiliate.fastcomet.com/"] > img,[href^="https://antiagingbed.com/discount/"] > img,[href^="https://ap.octopuspop.com/click/"] > img,[href^="https://app.monetizze.com.br"][target="_blank"],[href^="https://awbbjmp.com/"],[href^="https://charmingdatings.life/"],[href^="https://clicks.affstrack.com/"] > img,[href^="https://glersakr.com/"],[href^="https://go.xlrdr.com"],[href^="https://groorsoa.net/"],[href^="https://ilovemyfreedoms.com/landing-"],[href^="https://istlnkcl.com/"],[href^="https://join.girlsoutwest.com/"],[href^="https://join.playboyplus.com/track/"],[href^="https://join3.bannedsextapes.com"],[href^="https://mylead.global/stl/"] > img,[href^="https://optimizedelite.com/"] > img,[href^="https://questolovoglio.com/"][target="_blank"],[href^="https://rapidgator.net/article/premium/ref/"],[href^="https://rpwmct.com/"],[href^="https://shiftnetwork.infusionsoft.com/go/"] > img,[href^="https://t.bawafx.com/"],[href^="https://t.frty"],[href^="https://t.grty"],[href^="https://t.irty"],[href^="https://toroadvertisingmedia.com/ads"][target="_blank"],[href^="https://track.aftrk1.com/"],[href^="https://track.fiverr.com/visit/"] > img,[href^="https://turtlebids.irauctions.com/"] img,[href^="https://url.totaladblock.com/"],[href^="https://wct.link/click?"],[href^="https://wsup.ai/"],[href^="https://www.avantlink.com/click.php"] img,[href^="https://www.brighteonstore.com/products/"] img,[href^="https://www.cloudways.com/en/?id"],[href^="https://www.grand-ads.com/ads/click"],[href^="https://www.hostg.xyz/"] > img,[href^="https://www.profitablegatecpm.com/"],[href^="https://www.targetingpartner.com/"],[href^="https://zone.gotrackier.com/"],[id^="ad-wrap-"],[id^="ad_sky"],[id^="ad_slider"],[id^="bannerId"],[id^="section-ad-banner"],[id^="smi2adblock"],[name^="google_ads_iframe"],[onclick*="content.ad/"],[onclick="document.getElementById('happy-place').remove(); this.remove();"],[onclick^="location.href='https://1337x.vpnonly.site/"],[src^="https://a.adtng.com/"],[target="_blank"] > .banner-img,a-ad,a[data-href^="http://ads.trafficjunky.net/"],a[data-oburl^="https://paid.outbrain.com/network/redir?"],a[data-redirect^="https://paid.outbrain.com/network/redir?"],a[href*="&maxads="],a[href*=".adsrv.eacdn.com/"],a[href*=".cfm?domain="][href*="&fp="],a[href*=".engine.adglare.net/"],a[href*=".foxqck.com/"],a[href*=".g2afse.com/"],a[href*="//daichoho.com/"],a[href*="//jjgirls.com/sex/Chaturbate"],a[href*="/jump/next.php?r="],a[href*="adtracks.biz"],a[href*="bubblesmedia.ru/sb/clk/"],a[href*="ex.24smi.info"],a[href*="https://relap.io/r?"],a[href^=" https://www.friendlyduck.com/AF_"],a[href^="//ejitsirdosha.net/"],a[href^="//go.eabids.com/"],a[href^="//hoodingluster.com/"],a[href^="//native.publy.com/related/service/sponsor/"],a[href^="//s.zlinkd.com/"],a[href^="//stighoazon.com/"],a[href^="//w.linkwelove.com/urls/"],a[href^="/bitrix/rk.php"][target="_blank"],a[href^="http://ads1.adzmob.com/"],a[href^="http://ads1.mojiva.com/"],a[href^="http://ads2.adzmob.com/"],a[href^="http://adultfriendfinder.com/go/"],a[href^="http://annulmentequitycereals.com/"],a[href^="http://avthelkp.net/"],a[href^="http://bongacams.com/track?"],a[href^="http://c.ad4fun.com/"],a[href^="http://c.admob.com/"],a[href^="http://c.adtwirl.com/click.php?ad="],a[href^="http://c.mobpartner.mobi/"],a[href^="http://c27.smaato.net/oapi/"],a[href^="http://cam4com.go2cloud.org/aff_c?"],a[href^="http://click.buzzcity.net/"],a[href^="http://click.revsharecash.com"],a[href^="http://clk.mobgold.com/click.php?"],a[href^="http://com-1.pro/"],a[href^="http://join.brokestraightboys.com/track/"],a[href^="http://li.blogtrottr.com/click?"],a[href^="http://newtraffic.mobi/?i="],a[href^="http://partners.etoro.com/"],a[href^="http://revolvemockerycopper.com/"],a[href^="http://sarcasmadvisor.com/"],a[href^="http://secure.spoiledvirgins.com"],a[href^="http://sneakyadministration.com/"],a[href^="http://stickingrepute.com/"],a[href^="http://tc.tradetracker.net/"] > img,a[href^="http://trk.globwo.online/"],a[href^="http://tubecorporate.com/home/advertising"],a[href^="http://usmed.amobee.com/"],a[href^="http://wap4ads.com/ref.php?id="],a[href^="http://www.adultempire.com/unlimited/promo?"][href*="&partner_id="],a[href^="http://www.friendlyduck.com/AF_"],a[href^="http://www.fucking-cash.com"],a[href^="http://www.h4trck.com/"],a[href^="http://www.iyalc.com/"],a[href^="https://123-stream.org/"],a[href^="https://1betandgonow.com/"],a[href^="https://1winpb.com/"],a[href^="https://6-partner.com/"],a[href^="https://Click.ggpickaff.com/"],a[href^="https://a-ads.com/"],a[href^="https://a.adtng.com/"],a[href^="https://a.bestcontentfood.top/"],a[href^="https://a.bestcontentoperation.top/"],a[href^="https://a.bestcontentweb.top/"],a[href^="https://a.candyai.love/"],a[href^="https://a.medfoodhome.com/"],a[href^="https://a.medfoodsafety.com/"],a[href^="https://a2.adform.net/"],a[href^="https://ab.advertiserurl.com/aff/"],a[href^="https://activate-game.com/"],a[href^="https://ad.zanox.com/ppc/"] > img,a[href^="https://ads.betfair.com/redirect.aspx?"],a[href^="https://ads.leovegas.com/"],a[href^="https://ads.planetwin365affiliate.com/"],a[href^="https://adultfriendfinder.com/go/"],a[href^="https://aj1070.online/"],a[href^="https://ak.psaltauw.net/"],a[href^="https://ausoafab.net/"],a[href^="https://aweptjmp.com/"],a[href^="https://awptjmp.com/"],a[href^="https://banners.livepartners.com/"],a[href^="https://bc.game/"],a[href^="https://believessway.com/"],a[href^="https://best-experience-cool.com/"],a[href^="https://billing.purevpn.com/aff.php"] > img,a[href^="https://black77854.com/"],a[href^="https://bngprm.com/"],a[href^="https://bngpt.com/"],a[href^="https://bodelen.com/"],a[href^="https://bongacams10.com/track?"],a[href^="https://bongacams2.com/track?"],a[href^="https://cam4com.go2cloud.org/"],a[href^="https://camfapr.com/landing/click/"],a[href^="https://chaturbate.com/in/?"],a[href^="https://claring-loccelkin.com/"],a[href^="https://click.Ggpickaff.com/"],a[href^="https://click.candyoffers.com/"],a[href^="https://click.dtiserv2.com/"],a[href^="https://click.hoolig.app/"],a[href^="https://click.linksynergy.com/fs-bin/"] > img,a[href^="https://clickadilla.com/"],a[href^="https://clickins.slixa.com/"],a[href^="https://clicks.pipaffiliates.com/"],a[href^="https://clixtrac.com/"],a[href^="https://combodef.com/"],a[href^="https://ctjdwm.com/"],a[href^="https://ctosrd.com/"],a[href^="https://ctrdwm.com/"],a[href^="https://datewhisper.life/"],a[href^="https://dl-protect.net/"],a[href^="https://engine.phn.doublepimp.com/"],a[href^="https://explore-site.com/"],a[href^="https://fastestvpn.com/lifetime-special-deal?a_aid="],a[href^="https://fc.lc/ref/"],a[href^="https://financeads.net/tc.php?"],a[href^="https://gamingadlt.com/?offer="],a[href^="https://get-link.xyz/"],a[href^="https://get.surfshark.net/aff_c?"][href*="&aff_id="] > img,a[href^="https://getmatchedlocally.com/"],a[href^="https://gml-grp.com/"],a[href^="https://go.admjmp.com"],a[href^="https://go.bbrdbr.com"],a[href^="https://go.bushheel.com/"],a[href^="https://go.cmtaffiliates.com/"],a[href^="https://go.dmzjmp.com"],a[href^="https://go.etoro.com/"] > img,a[href^="https://go.goaserv.com/"],a[href^="https://go.grinsbest.com/"],a[href^="https://go.hpyjmp.com"],a[href^="https://go.hpyrdr.com/"],a[href^="https://go.kingtrx.com/click"],a[href^="https://go.markets.com/visit/?bta="],a[href^="https://go.mnaspm.com/"],a[href^="https://go.nordvpn.net/aff"] > img,a[href^="https://go.rmhfrtnd.com"],a[href^="https://go.rmishe.com/"],a[href^="https://go.skinstrip.net"][href*="?campaignId="],a[href^="https://go.strpjmp.com/"],a[href^="https://go.tmrjmp.com"],a[href^="https://go.trackitalltheway.com/"],a[href^="https://go.xlirdr.com"],a[href^="https://go.xlivrdr.com"],a[href^="https://go.xlviiirdr.com"],a[href^="https://go.xlviirdr.com"],a[href^="https://go.xlvirdr.com"],a[href^="https://go.xtbaffiliates.com/"],a[href^="https://go.xxxiijmp.com"],a[href^="https://go.xxxijmp.com"],a[href^="https://go.xxxjmp.com"],a[href^="https://go.xxxvjmp.com/"],a[href^="https://golinks.work/"],a[href^="https://helmethomicidal.com/"],a[href^="https://hot-growngames.life/"],a[href^="https://identicaldrench.com/"],a[href^="https://in.rabbtrk.com/"],a[href^="https://iqbroker.com/"][href*="?aff="],a[href^="https://ismlks.com/"],a[href^="https://italarizege.xyz/"],a[href^="https://jaxofuna.com/"],a[href^="https://join.bannedsextapes.com/track/"],a[href^="https://join.dreamsexworld.com/"],a[href^="https://join.sexworld3d.com/track/"],a[href^="https://join.virtuallust3d.com/"],a[href^="https://join.virtualtaboo.com/track/"],a[href^="https://juicyads.in/"],a[href^="https://landing.brazzersnetwork.com/"],a[href^="https://lead1.pl/"],a[href^="https://lijavaxa.com/"],a[href^="https://lnkxt.bannerator.com/"],a[href^="https://loboclick.com/"],a[href^="https://losingoldfry.com/"],a[href^="https://mediaserver.entainpartners.com/renderBanner.do?"],a[href^="https://mmwebhandler.aff-online.com/"],a[href^="https://myclick-2.com/"],a[href^="https://offhandpump.com/"],a[href^="https://osfultrbriolenai.info/"],a[href^="https://paid.outbrain.com/network/redir?"],a[href^="https://pb-front.com/"],a[href^="https://pb-imc.com/"],a[href^="https://pb-track.com/"],a[href^="https://playnano.online/offerwalls/?ref="],a[href^="https://porntubemate.com/"],a[href^="https://postback1win.com/"],a[href^="https://prf.hn/click/"][href*="/adref:"] > img,a[href^="https://prf.hn/click/"][href*="/camref:"] > img,a[href^="https://prf.hn/click/"][href*="/creativeref:"] > img,a[href^="https://pubads.g.doubleclick.net/"],a[href^="https://quotationfirearmrevision.com/"],a[href^="https://random-affiliate.atimaze.com/"],a[href^="https://rixofa.com/"],a[href^="https://s.cant3am.com/"],a[href^="https://s.eunow4u.com/"],a[href^="https://s.ma3ion.com/"],a[href^="https://s.zlink3.com/"],a[href^="https://s.zlink7.com/"],a[href^="https://s.zlinkd.com/"],a[href^="https://s.zlinkn.com/"],a[href^="https://s.zlinkr.com/"],a[href^="https://serve.awmdelivery.com/"],a[href^="https://service.bv-aff-trx.com/"],a[href^="https://sexynearme.com/"],a[href^="https://slkmis.com/"],a[href^="https://snowdayonline.xyz/"],a[href^="https://stardomcoit.com/"],a[href^="https://static.fleshlight.com/images/banners/"],a[href^="https://streamate.com/landing/click/"],a[href^="https://svb-analytics.trackerrr.com/"],a[href^="https://syndicate.contentsserved.com/"],a[href^="https://syndication.dynsrvtbg.com/"],a[href^="https://syndication.exoclick.com/"],a[href^="https://t.acam.link/"],a[href^="https://t.adating.link/"],a[href^="https://t.ajrkm1.com/"],a[href^="https://t.ajrkm3.com/"],a[href^="https://t.ajump1.com/"],a[href^="https://t.aslnk.link/"],a[href^="https://tatrck.com/"],a[href^="https://tc.tradetracker.net/"] > img,a[href^="https://tm-offers.gamingadult.com/"],a[href^="https://torguard.net/aff.php"] > img,a[href^="https://tour.mrskin.com/"],a[href^="https://track.1234sd123.com/"],a[href^="https://track.adform.net/"],a[href^="https://track.afcpatrk.com/"],a[href^="https://track.aftrk3.com/"],a[href^="https://track.aftrk5.com/"],a[href^="https://track.totalav.com/"],a[href^="https://track.ultravpn.com/"],a[href^="https://track.wg-aff.com"],a[href^="https://tracker.loropartners.com/"],a[href^="https://tracking.avapartner.com/"],a[href^="https://traffdaq.com/"],a[href^="https://trk.nfl-online-streams.club/"],a[href^="https://trk.softonixs.xyz/"],a[href^="https://twinrdsrv.com/"],a[href^="https://twinrdsyte.com/"],a[href^="https://upsups.click/"],a[href^="https://voluum.prom-xcams.com/"],a[href^="https://wittered-mainging.com/"],a[href^="https://wmctjd.com/"],a[href^="https://www.adskeeper.com"],a[href^="https://www.adultempire.com/"][href*="?partner_id="],a[href^="https://www.adxsrve.com/"],a[href^="https://www.bang.com/?aff="],a[href^="https://www.bet365.com/"][href*="affiliate="],a[href^="https://www.brazzersnetwork.com/landing/"],a[href^="https://www.dating-finder.com/?ai_d="],a[href^="https://www.dating-finder.com/signup/?ai_d="],a[href^="https://www.dql2clk.com/"],a[href^="https://www.effectiveratecpm.com/"],a[href^="https://www.financeads.net/tc.php?"],a[href^="https://www.friendlyduck.com/AF_"],a[href^="https://www.geekbuying.com/dynamic-ads/"],a[href^="https://www.get-express-vpn.com/offer/"],a[href^="https://www.goldenfrog.com/vyprvpn?offer_id="][href*="&aff_id="],a[href^="https://www.googleadservices.com/pagead/aclk?"] > img,a[href^="https://www.gotrks.com/"][target="_blank"],a[href^="https://www.highcpmrevenuenetwork.com/"],a[href^="https://www.highperformancecpmgate.com/"],a[href^="https://www.infowarsstore.com/"] > img,a[href^="https://www.liquidfire.mobi/"],a[href^="https://www.mrskin.com/account/"],a[href^="https://www.mrskin.com/tour"],a[href^="https://www.nutaku.net/signup/landing/"],a[href^="https://www.onlineusershielder.com/"],a[href^="https://www.purevpn.com/"][href*="&utm_source=aff-"],a[href^="https://www.toprevenuegate.com/"],a[href^="https://www8.smartadserver.com/"],a[href^="https://zirdough.net/"],a[onclick^="window.location.replace('https://random-affiliate.atimaze.com/"],a[onmousedown^="this.href='https://paid.outbrain.com/network/redir?"],a[onmousedown^="this.href='https://paid.outbrain.com/network/redir?"] + .ob_source,a[style="width:100%;height:100%;z-index:10000000000000000;position:absolute;top:0;left:0;"],ad-shield-ads,ad-slot,amp-ad,amp-ad-custom,amp-connatix-player,amp-embed[type="taboola"],amp-fx-flying-carpet,app-ad,app-advertisement,app-large-ad,aside[id^="adrotate_widgets-"],atf-ad-slot,bottomadblock,broadstreet-zone-container,citrus-ad-wrapper,display-ad-component,display-ads,div[class$="-adlabel"],div[class^="Adstyled__AdWrapper-"],div[class^="leftBarBanner"],div[class^="nativeAd-DS-"],div[class^="rightBarBanner"],div[data-ad-placeholder],div[data-ad-region],div[data-ad-wrapper],div[data-adname],div[data-adunit-path],div[data-adunit],div[data-adzone],div[data-alias="300x250 Ad 1"],div[data-alias="300x250 Ad 2"],div[data-contentexchange-widget],div[data-dfp-id],div[data-id-advertdfpconf],div[id*="MarketGid"],div[id*="ScriptRoot"],div[id^="ad-div-"],div[id^="ad-in-article"],div[id^="ad-position-"],div[id^="adngin-"],div[id^="adrotate_widgets-"],div[id^="adspot-"],div[id^="apn_native_ad_slot_"],div[id^="banner_orta"],div[id^="banner_sag"],div[id^="crt-"][style],div[id^="div-ads-"],div[id^="google_dfp_"],div[id^="gpt_ad_"],div[id^="lazyad-"],div[id^="optidigital-adslot"],div[id^="rc-widget-"],div[id^="st"][style^="z-index: 999999999;"],div[id^="sticky_ad_"],div[id^="taboola-stream-"],div[id^="vuukle-ad-"],div[id^="zergnet-widget"],div[ow-ad-unit-wrapper],div[style="position: fixed; inset: 0px; z-index: 2147483647; pointer-events: auto;"],gpt-ad,guj-ad,hl-adsense,iframe[scrolling="no"][sandbox*="allow-popups allow-modals"][style^="width: 100%; height: 100%; border: none;"],iframe[src^="//adspaces.ero-advertising.com"],iframe[src^="https://www.xlovecam.com/"],img[src^="https://images.purevpnaffiliates.com"],img[src^="https://s-img.adskeeper.com/"],ps-connatix-module,span[data-ez-ph-id],span[id^="ezoic-pub-ad-placeholder-"],topadblock,zeus-ad {display: none !important; color: #00b3dd !important; background-color: #db1dff !important;}#ad-carousel,#ad-rotator,#ad-top,#ad-wrapper,#adModal,#ad_1,#ad_2,#ad_3,#ad_4,#ad_banner,#ad_link,#ad_top,#adbar,#adbox,#adcontainer,#adcontainer1,#adhesion,#ads-header,#ads-left,#ads-wrapper,#adsContainer,#adsensewide,#adspace,#adtop,#adv-text,#adv-top,#advertise,#article_ad,#banner-ad,#centerads,#footer-ads,#footer_ad,#google-ads,#headerAd,#header_ad,#leftad,#mplayer-embed,#outbrain_widget_0,#page_ad,#prerollAd,#related_ads,#right_ads,#rightad,#side-ad,#sidebar-ad,#stickyads,#taboola-below-article-1,#topAd,#topbannerad,#videoAdContainer,.Adsense,.ProductAd,.ac-widget-placeholder,.ad-160-600,.ad-area:not(.text-ad),.ad-block,.ad-bottom,.ad-box:not(#ad-banner):not(:empty),.ad-button,.ad-center,.ad-click,.ad-container,.ad-content,.ad-cover,.ad-current,.ad-enabled,.ad-hero,.ad-holder,.ad-icon,.ad-label,.ad-links,.ad-list-item,.ad-notice,.ad-outside,.ad-padding,.ad-point,.ad-popup,.ad-root,.ad-section,.ad-sidebar,.ad-source,.ad-stickyhero,.ad-stickyhero--standard,.ad-stickyhero-enable-mobile,.ad-text,.ad-title,.ad-unit,.ad-widget,.ad-wrap:not(#google_ads_iframe_checktag),.ad-wrapper,.ad-zone,.ad-zone-container,.ad336,.ad728x90,.adActive,.adChoicesLogo,.adHolder,.adImg,.adLink,.adMiddle,.adResult,.adText,.adWrap,.ad_Right,.ad__item,.ad_banner,.ad_bg,.ad_block,.ad_body,.ad_bottom,.ad_box:not(.text-ad),.ad_btn,.ad_caption,.ad_container,.ad_div,.ad_frame,.ad_global_header,.ad_item,.ad_left,.ad_main,.ad_middle,.ad_spot,.ad_title,.ad_top,.adban,.adbutton,.adcard,.adcenter,.adhesion:not(body),.adhide,.adholder2,.adlink,.adplaceholder,.adrect,.adrow,.ads-banner,.ads-block,.ads-border,.ads-box-border,.ads-core-placer,.ads-header,.ads-image,.ads-inline,.ads-left,.ads-loaded,.ads-mobile,.ads-row,.ads-title,.ads.widget,.ads1,.adsBlock,.adsList,.adsText,.ads_ad_box,.ads_box,.ads_right,.ads_wrapper,.adsbottombox,.adscontainer,.adsense_wrapper,.adshome,.adsleft,.adslot,.adsninja-ad-zone,.adtable,.adtag,.adthrive,.adthrive-content,.adthrive-video-player,.adtitle,.adv-banner,.adv-box,.advBox,.advads-widget,.adver,.advert-container,.advert-detail,.advert2,.advertSlider,.advert_area,.advert_list,.advertisement-block,.advertiser,.advertisment,.advertorial,.adverts,.adverttext,.adwidget,.adwords,.after-post-ad,.anyClipWrapper,.article-advert,.article_ad,.b-banner,.banner-ad-container,.block-ad,.block-sponsor,.body-top-ads,.bottom_ad,.bottom_ad_block,.boxAds,.box_ads,.c-ad,.c-ads,.cnx-player-wrapper,.column-ad,.connatix-wrapper,.container-ads,.container-banner,.content-banner,.contentAds,.content_ads,.custom-ad,.display-ad,.display_ad,.ez-video-wrap,.fixed_ad,.footer-ad,.footer_ad,.footer_ads,.full-ad,.gallery-ad,.greyAd,.has-ad,.has-fixed-bottom-ad,.header-ad-row,.header_ad,.home-ad,.inline-ad,.is-sponsored,.l-ad,.large-advert,.leftAds,.logo-ad,.m1-header-ad,.mainAd,.middlead,.mntl-leaderboard-spacer,.module_ad,.nativead,.nav_ad,.node-ad,.p-ad,.page_ad,.product-ad,.product-ads,.promoAd,.publicidade,.region-ad-top,.reklama,.rightAds,.side-ad,.sidebar-ad:not(.adsbygoogle),.sidebar-ads,.sidebar_advert,.small-ads,.small_ad,.smallads,.sponsor-box,.sponsorBlock,.sponsorTitle,.sponsor_post,.sponsored-article,.sponsoredItem,.textad,.tnt-dmp-reactive,.top-ad,.top-ads,.top-banner-ad,.topAd,.top_ad,.topads,.vertical-ads,.video-ad-container,.video-ads,.videos-ad,.w-adsninja-video-player,.wps-player-wrap,[data-ad-name],[data-adblockkey],[href*="xlovecam.com/promo/tracking/"],[href^="http://in.mydirtyhobby.com/track/"],[href^="http://join.allofgfs.com/track/"],[href^="http://join.freshgfs.com/track/"],[href^="http://join.innocenthigh.com/track/"],[href^="http://join.muffx.com/track/"],[href^="http://join.seemygf.com/track/"],[href^="http://join.self-shot.com/track/"],[href^="http://join.teengfsex.com/track/"],[href^="http://myalternativegflink.com/track/"],[href^="http://mypillow.com/"] > img,[href^="http://secure.18exgfs.com/track/"],[href^="http://secure.badassgirlfriends.com/track/"],[href^="http://secure.bustygfsexposed.com/track/"],[href^="http://secure.chatrevenge.com/track/"],[href^="http://secure.dagfs.com/track/"],[href^="http://secure.fubilov.com/track/"],[href^="http://secure.hotgfvideos.com/track/"],[href^="http://secure.mynngf.com/track/"],[href^="http://secure.obsessedwithmyself.com/track/"],[href^="http://secure.publicgfvideos.com/track/"],[href^="http://secure.realgfsexposed.com/track/"],[href^="http://secure.slutswithphones.com/track/"],[href^="http://secure.watchmygf.com/track/"],[href^="http://www.mypillow.com/"] > img,[href^="https://mypatriotsupply.com/"] > img,[href^="https://mypillow.com/"] > img,[href^="https://mystore.com/"] > img,[href^="https://www.herbanomic.com/"] > img,[href^="https://www.mypatriotsupply.com/"] > img,[href^="https://www.mypillow.com/"] > img,[href^="https://www.restoro.com/"],[href^="https://zstacklife.com/"] img,[id^="div-gpt-ad"],a[href*="/relap.io/adv/"],a[href*="marketgid.com/"],a[href*="medicinetizer.ru"],a[href*="runetki.com"],a[href*="universallnk.com"],a[href^="https://ad.doubleclick.net/"],a[href^="https://adclick.g.doubleclick.net/"],a[href^="https://natour.naughtyamerica.com/track/"],a[href^="https://ndt5.net/"],a[href^="https://www.privateinternetaccess.com/"] > img,a[href^="https://www.sheetmusicplus.com/"][href*="?aff_id="],div[aria-label="Ads"],div[data-ad-targeting],div[id^="MarketGid"],div[id^="ad_position_"],div[id^="dfp-ad-"],div[id^="div-gpt-"],div[id^="ezoic-pub-ad-"],iframe[src*=".cameraprive.com"],ins.adsbygoogle[data-ad-client],ins.adsbygoogle[data-ad-slot] {display: none !important; color: #00b3dd !important; background-color: #db1dff !important;}</style><link rel="stylesheet" href="chrome-extension://ihcjicgdanjaechkgeegckofjjedodee/app/content-style.css">
<!-- === POLISH OVERRIDES (cosmetic-only; no JS/HTML changes) === -->
<style>
/* Premium console polish - glossy surfaces, controlled glow, unified components */
:root{
  /* Accent system (keep your existing tokens; we override a few key ones safely) */
  --color-teal-accent: #22d3ee;          /* cyan */
  --color-teal-accent-dark: #8b5cf6;     /* purple */
  --color-gold: #ffb020;                 /* amber */

  /* Fix: cyan badge should be cyan (your file had this as red) */
  --color-cyan-badge: #22d3ee;

  /* Softer, more premium shadows */
  --shadow-premium: 0 18px 50px rgba(0,0,0,.55);
  --shadow-soft: 0 12px 30px rgba(0,0,0,.40);

  /* Controlled glow (used for active/focus/primary only) */
  --glow-accent: 0 0 0 3px rgba(34,211,238,.12), 0 18px 60px rgba(139,92,246,.12);
}

/* Background atmosphere (subtle; doesn't fight your layout) */
body{
  background:
    radial-gradient(900px 500px at 18% -10%, rgba(139,92,246,.16), transparent 60%),
    radial-gradient(900px 500px at 82% 0%, rgba(34,211,238,.12), transparent 55%),
    radial-gradient(700px 450px at 50% 110%, rgba(255,45,85,.06), transparent 55%),
    linear-gradient(180deg, #0a0f1c 0%, #07090f 65%, #06070b 100%) !important;
}

/* Header branding: modern purpleâ†’cyan gradient */
.header h1{
  background: linear-gradient(135deg, var(--color-teal-accent-dark) 0%, var(--color-teal-accent) 100%) !important;
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
}

/* Tabs: keep premium, reduce "neon everywhere" */
.tab-btn{
  background: rgba(255,255,255,.04) !important;
  border: 1px solid rgba(255,255,255,.10) !important;
  box-shadow: none !important;
  transition: transform .18s ease, background .18s ease, border-color .18s ease, box-shadow .18s ease !important;
}
.tab-btn:hover{
  background: rgba(34,211,238,.10) !important;
  border-color: rgba(34,211,238,.25) !important;
  transform: translateY(-1px) !important;
  box-shadow: 0 10px 26px rgba(34,211,238,.10) !important;
}
.tab-btn.active{
  background: linear-gradient(135deg, rgba(139,92,246,.22) 0%, rgba(34,211,238,.12) 100%) !important;
  border-color: rgba(34,211,238,.28) !important;
  box-shadow: var(--glow-accent) !important;
  transform: translateY(-1px) !important;
}

/* Glossy card language: premium-card / tool-card / news-card / cve-card / threat-card */
.premium-card, .tool-card, .news-card, .cve-card, .threat-card{
  position: relative !important;
  overflow: hidden !important;
  border: 1px solid rgba(255,255,255,.10) !important;
  box-shadow: var(--shadow-premium) !important;
  background:
    linear-gradient(180deg, rgba(255,255,255,.07), rgba(255,255,255,0) 40%),
    radial-gradient(800px 260px at 30% 0%, rgba(255,255,255,.08), transparent 60%),
    rgba(255,255,255,.03) !important;
  backdrop-filter: blur(16px) !important;
  transition: transform .18s ease, border-color .18s ease, box-shadow .18s ease !important;
}

/* Sheen/bloom layer */
.premium-card::before, .tool-card::before, .news-card::before, .cve-card::before, .threat-card::before{
  content:"";
  position:absolute;
  inset:-2px;
  background: radial-gradient(520px 180px at 20% 0%,
    rgba(34,211,238,.11), transparent 55%);
  opacity:.55;
  pointer-events:none;
}

/* Reduce overly "bouncy" hover; keep it subtle */
.premium-card:hover, .tool-card:hover, .news-card:hover, .cve-card:hover, .threat-card:hover{
  transform: translateY(-2px) !important;
  border-color: rgba(34,211,238,.20) !important;
  box-shadow: 0 22px 60px rgba(0,0,0,.60) !important;
}

/* Buttons: more sophisticated gradients and consistent glow */
.btn-primary{
  background: linear-gradient(135deg, rgba(139,92,246,.35) 0%, rgba(34,211,238,.22) 100%) !important;
  color: rgba(255,255,255,.95) !important;
  border: 1px solid rgba(34,211,238,.25) !important;
  box-shadow: 0 14px 36px rgba(34,211,238,.12) !important;
  transition: transform .18s ease, box-shadow .18s ease, border-color .18s ease !important;
}
.btn-primary:hover{
  transform: translateY(-1px) !important;
  box-shadow: 0 18px 46px rgba(34,211,238,.16) !important;
  border-color: rgba(34,211,238,.34) !important;
}

/* Inputs: console-grade focus rings */
.form-input, input[type="text"], input[type="email"], input[type="url"], textarea, select{
  background: rgba(0,0,0,.22) !important;
  border: 1px solid rgba(255,255,255,.10) !important;
}
.form-input:focus, input:focus, textarea:focus, select:focus{
  outline: none !important;
  border-color: rgba(34,211,238,.45) !important;
  box-shadow: 0 0 0 4px rgba(34,211,238,.14) !important;
}

/* Callouts/results: look like designed console outputs (not debug text) */
.tool-result, .result-box, .status-box, .error-box{
  border-radius: 14px !important;
  border: 1px solid rgba(255,255,255,.10) !important;
  background: rgba(255,255,255,.03) !important;
  box-shadow: var(--shadow-soft) !important;
}

/* Badges: make 'cyan' actually cyan; keep danger reserved for critical/exploited */
.badge-cyan{
  background: rgba(34,211,238,.14) !important;
  border: 1px solid rgba(34,211,238,.28) !important;
  color: rgba(233,255,255,.95) !important;
}

/* Typography smoothing and slightly tighter console feel */
h1,h2,h3{
  letter-spacing: .2px !important;
}
p, .muted-text, .subtitle{
  color: rgba(167,178,199,.95) !important;
}


/* Header title: avoid full-width gradient bar on browsers that don't support text clipping */
.header h1{
  background: none !important;
  -webkit-text-fill-color: initial !important;
  color: var(--color-white) !important;
  text-shadow: 0 2px 20px rgba(34,211,238,.15), 0 2px 18px rgba(139,92,246,.12) !important;
}

/* Use gradient text only when supported */
@supports (-webkit-background-clip: text) {
  .header h1{
    background: linear-gradient(135deg, var(--color-teal-accent-dark) 0%, var(--color-teal-accent) 100%) !important;
    -webkit-background-clip: text !important;
    -webkit-text-fill-color: transparent !important;
    background-clip: text !important;
  }
}
</style>
<style>
/* === Investigation Clipboard === */
.clipboard-panel {
  position: sticky;
  top: 132px;
  width: 100%;
  max-width: 360px;
  height: calc(100vh - 180px);
  display: none;
  flex-direction: column;
  background: rgba(12, 16, 26, 0.92);
  border: 1px solid rgba(139, 92, 246, 0.35);
  border-radius: var(--radius-lg);
  box-shadow: var(--shadow-premium);
  backdrop-filter: blur(18px);
  z-index: 2;
  overflow: hidden;
  align-self: start;
}

@media (min-width: 1200px) {
  .clipboard-panel {
    display: flex;
  }
}

.clipboard-panel.is-collapsed {
  position: fixed;
  right: 16px;
  top: 148px;
  width: 64px;
  height: auto;
  padding: 6px;
  border-radius: 999px;
  border-color: rgba(34,211,238,0.45);
  box-shadow: var(--shadow-glow);
}

.clipboard-panel.is-collapsed .clipboard-header,
.clipboard-panel.is-collapsed .clipboard-body {
  display: none;
}

.clipboard-panel.is-collapsed .clipboard-collapsed-pill {
  display: flex;
}

.clipboard-header {
  padding: 14px 16px 10px;
  border-bottom: 1px solid rgba(255,255,255,0.08);
  display: flex;
  flex-direction: column;
  gap: 10px;
  flex-shrink: 0;
}

.clipboard-title-row {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 10px;
}

.clipboard-title-actions {
  display: flex;
  align-items: center;
  gap: 8px;
}

.clipboard-title {
  font-size: 15px;
  font-weight: 600;
  color: #fff;
}

.clipboard-count {
  font-size: 12px;
  color: rgba(255,255,255,0.65);
  background: rgba(34,211,238,0.12);
  border: 1px solid rgba(34,211,238,0.35);
  padding: 2px 8px;
  border-radius: 999px;
}

.clipboard-collapse-toggle {
  background: rgba(255,255,255,0.06);
  border: 1px solid rgba(255,255,255,0.2);
  color: rgba(255,255,255,0.85);
  border-radius: 999px;
  padding: 4px 10px;
  font-size: 11px;
  cursor: pointer;
  transition: all var(--duration-normal) var(--ease-standard);
}

.clipboard-collapse-toggle:hover {
  border-color: rgba(34,211,238,0.5);
  color: #fff;
}

.clipboard-collapsed-pill {
  display: none;
  align-items: center;
  justify-content: center;
  gap: 6px;
  width: 100%;
  padding: 10px 6px;
  background: linear-gradient(135deg, rgba(139,92,246,0.3), rgba(34,211,238,0.35));
  color: #fff;
  border: none;
  border-radius: 999px;
  font-size: 12px;
  font-weight: 600;
  cursor: pointer;
  writing-mode: vertical-rl;
  text-orientation: mixed;
  transform: rotate(180deg);
}

.clipboard-collapsed-count {
  color: #e6fbff;
  font-weight: 700;
}

.clipboard-actions {
  display: flex;
  gap: 8px;
  flex-wrap: wrap;
}

.clipboard-action-btn {
  background: rgba(255,255,255,0.08);
  border: 1px solid rgba(255,255,255,0.2);
  color: #fff;
  border-radius: var(--radius-md);
  padding: 6px 10px;
  font-size: 12px;
  cursor: pointer;
  transition: all var(--duration-normal) var(--ease-standard);
}

.clipboard-action-btn:hover {
  border-color: rgba(34,211,238,0.5);
  box-shadow: 0 8px 24px rgba(34,211,238,0.16);
}

.clipboard-body {
  padding: 12px 12px 16px;
  overflow-y: auto;
  flex: 1;
  display: flex;
  flex-direction: column;
  gap: 12px;
  min-height: 0;
}

.clipboard-group-title {
  font-size: 12px;
  text-transform: uppercase;
  letter-spacing: 0.04em;
  color: rgba(255,255,255,0.5);
  margin-bottom: 6px;
  padding-left: 4px;
}

.clipboard-group {
  display: flex;
  flex-direction: column;
  gap: 10px;
}

.clipboard-group-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  background: rgba(255,255,255,0.05);
  border: 1px solid rgba(255,255,255,0.1);
  border-radius: var(--radius-md);
  padding: 6px 10px;
}

.clipboard-group-toggle {
  display: flex;
  align-items: center;
  gap: 8px;
  background: transparent;
  border: none;
  color: #fff;
  font-size: 12px;
  font-weight: 600;
  cursor: pointer;
  width: 100%;
}

.clipboard-group-count {
  background: rgba(34,211,238,0.14);
  border: 1px solid rgba(34,211,238,0.4);
  color: #e6fbff;
  padding: 2px 8px;
  border-radius: 999px;
  font-size: 11px;
  margin-left: auto;
}

.clipboard-group-chevron {
  color: rgba(255,255,255,0.6);
  font-size: 12px;
  transition: transform var(--duration-normal) var(--ease-standard);
  margin-left: 4px;
}

.clipboard-group.is-collapsed .clipboard-group-chevron {
  transform: rotate(-90deg);
}

.clipboard-group.is-collapsed .clipboard-group-body {
  display: none;
}

.clipboard-group-body {
  display: flex;
  flex-direction: column;
  gap: 10px;
}

.clipboard-item {
  background: rgba(255,255,255,0.04);
  border: 1px solid rgba(255,255,255,0.1);
  border-radius: var(--radius-md);
  padding: 10px 12px;
  display: flex;
  flex-direction: column;
  gap: 8px;
}

.clipboard-item-header {
  display: flex;
  justify-content: space-between;
  gap: 8px;
}

.clipboard-item-actions {
  display: flex;
  align-items: center;
  gap: 6px;
}

.clipboard-item-title a {
  color: #fff;
  text-decoration: none;
}

.clipboard-item-title a:hover {
  text-decoration: underline;
}

.clipboard-item-subtitle {
  font-size: 12px;
  color: rgba(255,255,255,0.6);
}

.clipboard-meta {
  display: flex;
  flex-wrap: wrap;
  gap: 6px;
}

.clipboard-chip {
  font-size: 11px;
  padding: 2px 8px;
  border-radius: 999px;
  border: 1px solid rgba(255,255,255,0.16);
  color: rgba(255,255,255,0.8);
  background: rgba(255,255,255,0.05);
}

.clipboard-chip.severity {
  background: rgba(255,0,64,0.16);
  border-color: rgba(255,0,64,0.4);
  color: #ff7a96;
}

.clipboard-controls {
  display: flex;
  align-items: center;
  gap: 8px;
  flex-wrap: wrap;
}

.clipboard-status {
  background: rgba(0,0,0,0.35);
  border: 1px solid rgba(255,255,255,0.2);
  color: #fff;
  border-radius: 8px;
  padding: 4px 8px;
  font-size: 12px;
}

.clipboard-notes {
  display: none;
}

.clipboard-notes.active {
  display: block;
}

.clipboard-notes textarea {
  width: 100%;
  min-height: 70px;
  background: rgba(0,0,0,0.3);
  border: 1px solid rgba(255,255,255,0.2);
  color: #fff;
  border-radius: var(--radius-md);
  padding: 8px;
  font-size: 12px;
  resize: vertical;
}

.clipboard-remove {
  background: transparent;
  border: none;
  color: rgba(255,255,255,0.6);
  cursor: pointer;
  font-size: 16px;
}

.clipboard-remove:hover {
  color: #ff7a96;
}

.clipboard-goto {
  background: rgba(34,211,238,0.12);
  border: 1px solid rgba(34,211,238,0.35);
  color: #e6fbff;
  border-radius: 999px;
  padding: 4px 10px;
  font-size: 11px;
  cursor: pointer;
  transition: all var(--duration-normal) var(--ease-standard);
}

.clipboard-goto:hover {
  background: rgba(139,92,246,0.2);
  border-color: rgba(139,92,246,0.5);
}

.clipboard-empty {
  text-align: center;
  color: rgba(255,255,255,0.6);
  font-size: 13px;
  padding: 12px 6px;
}

.clipboard-fab {
  position: fixed;
  right: 16px;
  bottom: 18px;
  background: linear-gradient(135deg, rgba(139,92,246,0.9) 0%, rgba(34,211,238,0.9) 100%);
  border: 1px solid rgba(34,211,238,0.6);
  color: #05070c;
  font-weight: 700;
  border-radius: 999px;
  padding: 12px 18px;
  display: flex;
  align-items: center;
  gap: 8px;
  z-index: 140;
  cursor: pointer;
  box-shadow: 0 16px 40px rgba(34,211,238,0.18);
}

@media (min-width: 1200px) {
  .clipboard-fab {
    display: none;
  }
}

.clipboard-fab .clipboard-count {
  background: rgba(5,7,12,0.75);
  color: #fff;
  border-color: rgba(255,255,255,0.2);
}

.clipboard-modal .clipboard-body {
  max-height: 60vh;
}

.clipboard-modal-backdrop {
  background: rgba(4, 6, 12, 0.75);
}

.clipboard-footer {
  display: flex;
  justify-content: flex-end;
  gap: 8px;
  margin-top: 12px;
  padding-top: 12px;
  border-top: 1px solid rgba(255,255,255,0.08);
}

.pin-btn {
  display: inline-flex;
  align-items: center;
  gap: 6px;
  background: rgba(34,211,238,0.12);
  border: 1px solid rgba(34,211,238,0.35);
  color: #e6fbff;
  padding: 4px 8px;
  border-radius: 999px;
  font-size: 11px;
  cursor: pointer;
  transition: all var(--duration-normal) var(--ease-standard);
}

.pin-btn:hover {
  background: rgba(139,92,246,0.18);
  border-color: rgba(139,92,246,0.4);
}

.pin-btn--compact .pin-label {
  display: none;
}

.pin-btn.is-pinned {
  background: rgba(0,255,136,0.2);
  border-color: rgba(0,255,136,0.5);
  color: #b6ffe3;
}

.cve-card {
  position: relative;
}

.cve-card.is-pinned {
  border-color: rgba(0,255,136,0.5);
  box-shadow: 0 0 0 1px rgba(0,255,136,0.4), var(--shadow-premium);
}

.card-pin-indicator {
  position: absolute;
  top: 10px;
  right: 10px;
  background: rgba(0,255,136,0.18);
  border: 1px solid rgba(0,255,136,0.5);
  color: #b6ffe3;
  border-radius: 999px;
  padding: 4px 6px;
  font-size: 12px;
  cursor: pointer;
  opacity: 0;
  pointer-events: none;
  transition: all var(--duration-normal) var(--ease-standard);
}

.cve-card.is-pinned .card-pin-indicator {
  opacity: 1;
  pointer-events: auto;
}

.clipboard-highlight {
  animation: clipboardGlow 1.2s ease;
  outline: 2px solid rgba(34,211,238,0.35);
  outline-offset: 2px;
}

@keyframes clipboardGlow {
  0% {
    box-shadow: 0 0 0 0 rgba(34,211,238,0.0), 0 0 0 0 rgba(139,92,246,0.0);
  }
  30% {
    box-shadow: 0 0 0 3px rgba(34,211,238,0.25), 0 0 24px rgba(139,92,246,0.3);
  }
  100% {
    box-shadow: 0 0 0 0 rgba(34,211,238,0.0), 0 0 0 0 rgba(139,92,246,0.0);
  }
}

.toast-container {
  position: fixed;
  right: 16px;
  bottom: 80px;
  display: flex;
  flex-direction: column;
  gap: 8px;
  z-index: 200;
}

.toast {
  background: rgba(15, 20, 30, 0.95);
  border: 1px solid rgba(255,255,255,0.18);
  color: #fff;
  padding: 10px 14px;
  border-radius: 10px;
  font-size: 12px;
  box-shadow: var(--shadow-soft);
}
</style>
</head>
<body>
    <div class="app-container">
        <!-- Header -->
        <header class="header">
            <h1>ðŸ›¡ï¸ CyberSec Command</h1>
            <p>Enterprise-Grade Cybersecurity Intelligence &amp; Analysis Platform</p>
        </header>

        <!-- Navigation Tabs -->
        <nav class="nav-tabs">
            <button class="tab-btn active" data-tab="dashboard">ðŸ  Dashboard</button>
            <button class="tab-btn" data-tab="threats">ðŸ“º Threat Intel</button>
            <button class="tab-btn" data-tab="tools">ðŸ” Security Tools</button>
            <button class="tab-btn" data-tab="learning">ðŸ§  Learning Hub</button>
            <button class="tab-btn" data-tab="settings">âš™ï¸ Settings</button>
            <button class="clipboard-nav-btn" id="clipboard-nav-btn" type="button">ðŸ“Œ Clipboard</button>
        </nav>

        <div class="app-shell" id="app-shell">
        <!-- Main Content -->
        <main class="main-content">
            <!-- Dashboard Tab -->
            <div class="tab-content main-panel active" id="dashboard-tab">
                <!-- Real-Time CISA KEV Data Notice -->
<div class="premium-card" style="background: rgba(15,20,25,0.9); color: #ff4444; border-left: 4px solid #ff0040; margin-bottom: 18px;">
    <div style="font-size: 14px; font-weight: 500; color: #ff0040; margin-bottom: 6px;">LIVE DATA from <strong>CISA Known Exploited Vulnerabilities Catalog</strong></div>
    <div style="font-size: 13px; color: #fff; margin-bottom: 2px;">Last updated: <strong id="dashboard-update-time">Loading...</strong></div>
    <div style="font-size: 13px; color: #fff;">Real-time threat intelligence from U.S. Cybersecurity &amp; Infrastructure Security Agency</div>
    <button class="btn btn-secondary" onclick="refreshDashboard()" style="margin-top:10px; padding:8px 16px; font-size:13px;">Refresh Dashboard</button>
</div>

<!-- CISA Known Exploited Vulnerabilities -->
<div class="premium-card" style="margin-bottom: 30px;">
    <h2 style="margin-bottom: 10px; font-size: 22px; font-weight: 600; color: #fff;">ðŸš¨ CISA Known Exploited Vulnerabilities</h2>
    <p style="font-size: 15px; color: #ff0040; margin-bottom: 24px; font-weight:500;">Active CVEs being exploited in the wild RIGHT NOW</p>
    <div class="cve-grid" id="cisa-kev-grid"><div style="text-align:center; padding:40px; color:#ff0040;">Error loading CISA data: Failed to fetch<br><br>Please refresh and try again.</div></div>
</div>

<!-- Recent Data Breaches (Verified Dataset) -->
<div class="premium-card dashboard-module" id="breaches-module">
    <div class="module-header">
        <div>
            <h2 id="breach-header">Recent Data Breaches (Verified Dataset)</h2>
            <div class="module-meta" id="breach-subtitle">Verified breach registry (HIBP catalog)</div>
        </div>
    </div>
    <div id="breach-fallback-callout" style="display: none; margin-bottom: 16px; padding: 10px 12px; border-radius: 8px; background: rgba(255, 153, 51, 0.12); border: 1px solid rgba(255, 153, 51, 0.4); color: rgba(255,255,255,0.9); font-size: 13px;">
      Verified breach registry unavailable; showing live intelligence feed.
    </div>
    <div class="filter-bar" style="margin-bottom: 12px;">
      <select class="form-select" id="breach-mode-switch" style="flex: 1;">
        <option value="verified" selected>Verified Breach Dataset</option>
        <option value="live">Live Intelligence (Filtered)</option>
      </select>
    </div>
    <div class="filter-bar" style="margin-bottom: 16px;">
      <select class="form-select" id="breach-category-filter" style="flex: 1;">
        <option value="all" selected>Category: All</option>
        <option value="ransomware">Ransomware</option>
        <option value="breach">Breach</option>
        <option value="incident">Incident</option>
      </select>
      <select class="form-select" id="breach-severity-filter" style="flex: 1;">
        <option value="medium" selected>Severity: â‰¥ MEDIUM</option>
        <option value="high">Severity: â‰¥ HIGH</option>
        <option value="critical">Severity: CRITICAL only</option>
        <option value="all">Severity: All</option>
      </select>
    </div>
    <div class="module-list" id="real-breaches-grid">
      <!-- Dynamic breach data will load here -->
    </div>
</div>

<!-- Vendor Advisories Radar -->
<div class="premium-card dashboard-module" id="vendor-advisories-module">
    <div class="module-header">
        <div>
            <h2>ðŸ›°ï¸ Vendor Advisories Radar</h2>
            <div class="module-meta">Last updated: <strong id="advisories-updated">Loading...</strong></div>
        </div>
        <div style="display: flex; gap: 8px; align-items: center;">
            <button class="btn btn-secondary" type="button" id="advisories-refresh-btn">Refresh</button>
            <a class="btn btn-secondary" href="/api/feeds?type=advisories&debug=1" target="_blank" rel="noopener" style="padding: 6px 10px; font-size: 12px;">Diagnostics</a>
        </div>
    </div>
    <div class="module-degraded" id="advisories-degraded">Degraded: Showing last cached advisories while upstream feeds recover.</div>
    <div class="module-controls">
        <select class="form-select" id="advisories-vendor-filter">
            <option value="all" selected>Vendor: All</option>
        </select>
        <label style="display:flex; align-items:center; gap:6px; font-size:12px; color: rgba(255,255,255,0.7);">
            <input type="checkbox" id="advisories-cve-only">
            Has CVE only
        </label>
    </div>
    <div class="module-list" id="advisories-list"></div>
    <button class="btn btn-secondary" type="button" id="advisories-load-more" style="margin-top: 12px;">Load more</button>
</div>

<!-- Supply Chain Advisories (OSV) -->
<div class="premium-card dashboard-module" id="osv-module">
    <div class="module-header">
        <div>
            <h2>ðŸ§© Supply Chain Advisories (OSV)</h2>
            <div class="module-meta">Last updated: <strong id="osv-updated">Loading...</strong></div>
        </div>
        <div style="display: flex; gap: 8px; align-items: center;">
            <button class="btn btn-secondary" type="button" id="osv-refresh-btn">Refresh</button>
            <a class="btn btn-secondary" href="/api/feeds?type=osv&debug=1" target="_blank" rel="noopener" style="padding: 6px 10px; font-size: 12px;">Diagnostics</a>
        </div>
    </div>
    <div class="module-degraded" id="osv-degraded">Degraded: Showing last cached OSV advisories while API recovers.</div>
    <div class="module-controls">
        <select class="form-select" id="osv-ecosystem-filter" multiple size="3">
            <option value="npm" selected>npm</option>
            <option value="PyPI" selected>PyPI</option>
            <option value="Maven" selected>Maven</option>
            <option value="Go">Go</option>
            <option value="RubyGems">RubyGems</option>
        </select>
        <select class="form-select" id="osv-severity-filter">
            <option value="MEDIUM" selected>Severity: â‰¥ MEDIUM</option>
            <option value="HIGH">Severity: â‰¥ HIGH</option>
            <option value="CRITICAL">Severity: CRITICAL only</option>
            <option value="LOW">Severity: â‰¥ LOW</option>
            <option value="UNKNOWN">Severity: All</option>
        </select>
        <label style="display:flex; align-items:center; gap:6px; font-size:12px; color: rgba(255,255,255,0.7);">
            <input type="checkbox" id="osv-include-unknown">
            Include unknown severities
        </label>
    </div>
    <div class="module-list" id="osv-list"></div>
    <button class="btn btn-secondary" type="button" id="osv-load-more" style="margin-top: 12px;">Load more</button>
</div>

<!-- Cloud/SaaS Status Board -->
<div class="premium-card dashboard-module" id="status-module">
    <div class="module-header">
        <div>
            <h2>â˜ï¸ Cloud/SaaS Status Board</h2>
            <div class="module-meta">Last updated: <strong id="status-updated">Loading...</strong></div>
        </div>
        <div style="display: flex; gap: 8px; align-items: center;">
            <button class="btn btn-secondary" type="button" id="status-refresh-btn">Refresh</button>
            <a class="btn btn-secondary" href="/api/feeds?type=status&debug=1" target="_blank" rel="noopener" style="padding: 6px 10px; font-size: 12px;">Diagnostics</a>
        </div>
    </div>
    <div class="module-degraded" id="status-degraded">Degraded: Showing last cached status updates while feeds recover.</div>
    <div class="intel-summary-chips" id="status-summary-chips"></div>
    <div class="module-list" id="status-list"></div>
    <div class="module-actions" style="margin-top: 12px;">
        <button class="btn btn-secondary" type="button" id="status-load-more">Load more</button>
        <button class="btn btn-secondary" type="button" id="status-show-less" style="display: none;">Show less</button>
    </div>
</div>

<!-- API Health -->
<div class="health-card" id="intel-health-card" style="margin-bottom: 30px;">
    <h3 style="font-size: 16px; margin-bottom: 8px;">API Health</h3>
    <div class="health-row">
        <div>
            <div>Vendor Advisories Radar</div>
            <div class="module-meta" id="health-advisories-time">Last update: --</div>
        </div>
        <span class="health-badge ok" id="health-advisories-status">OK</span>
    </div>
    <div class="health-row">
        <div>
            <div>Supply Chain Advisories (OSV)</div>
            <div class="module-meta" id="health-osv-time">Last update: --</div>
        </div>
        <span class="health-badge ok" id="health-osv-status">OK</span>
    </div>
    <div class="health-row">
        <div>
            <div>Cloud/SaaS Status Board</div>
            <div class="module-meta" id="health-status-time">Last update: --</div>
        </div>
        <span class="health-badge ok" id="health-status-status">OK</span>
    </div>
</div>

<script>
let cisaKevCache = [];
let fixFirstSourceCache = [];
const fixFirstModeKey = 'fixfirst_mode_v1';

// Load CISA KEV data on page load
async function loadCISAKEV() {
    const grid = document.getElementById('cisa-kev-grid');
    const updateTime = document.getElementById('dashboard-update-time');
    if (!grid) return;
    
    grid.innerHTML = '<div style="text-align:center; padding:40px; color:#ff4444;"><span class="spinner" style="width:32px; height:32px;"></span><br><br>Loading real-time CISA data...</div>';
    
    try {
        // Call CISA KEV API directly (free, no key required)
        const cisaUrl = '/api/cisa-kev';  // Call your Vercel API instead
        const res = await fetch(cisaUrl);

        if (!res.ok) throw new Error('CISA API unavailable');
        const data = await res.json();
        
        if (!data.vulnerabilities || data.vulnerabilities.length === 0) {
            grid.innerHTML = '<div style="text-align:center; padding:40px; color:#ff4444;">No vulnerabilities found</div>';
            return;
        }

        cisaKevCache = data.vulnerabilities || [];
        renderFixFirstQueue(fixFirstSourceCache);

        updateTime.innerHTML = new Date().toLocaleString('en-US', {weekday:'long', year:'numeric', month:'long', day:'numeric', hour:'numeric', minute:'numeric', timeZoneName:'short'});
        
        grid.innerHTML = (data.vulnerabilities || []).slice(0,15).map(vuln => {
            const severityColor = '#ff0040'; // All CISA KEV are critical
            const anchorId = `kev:${vuln.cveID}`;
            return `
                <div class="cve-card" style="border-left-color: ${severityColor}; background: rgba(255,0,64,0.05);" data-clipboard-anchor="${anchorId}">
                    <button class="card-pin-indicator" type="button" data-clipboard-id="${anchorId}" aria-label="Unpin from clipboard">ðŸ“Œ</button>
                    <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 12px;">
                        <div>
                            
                            <div style="font-weight: 600; color: ${severityColor}; margin-bottom: 4px;">${vuln.cveID}</div>
                            
                              
                            <div style="font-size: 16px; font-weight: 500; margin-bottom: 8px;">${vuln.vulnerabilityName}</div>
                            
                        </div>
                        <div style="display: flex; flex-direction: column; align-items: flex-end; gap: 6px;">
                            <div class="cvss-badge" style="background: ${severityColor};">EXPLOITED</div>
                            ${getLibrarySaveMarkup({
                                id: `kev:${vuln.cveID}`,
                                type: 'kev',
                                title: `${vuln.cveID} ${vuln.vulnerabilityName}`,
                                url: 'https://www.cisa.gov/known-exploited-vulnerabilities-catalog',
                                source: 'CISA KEV',
                                date: vuln.dateAdded || 'Unknown',
                                summary: vuln.shortDescription || vuln.vulnerabilityName || '',
                                tags: []
                            }, { label: 'Save' })}
                            ${getPinButtonMarkup({
                                id: anchorId,
                                anchor: anchorId,
                                type: 'kev',
                                title: vuln.cveID,
                                subtitle: `${vuln.vendorProject || 'Unknown'} â€¢ ${vuln.product || 'Unknown'}`,
                                url: 'https://www.cisa.gov/known-exploited-vulnerabilities-catalog',
                                severity: 'CRITICAL',
                                meta: {
                                    cveId: vuln.cveID,
                                    title: vuln.vulnerabilityName || vuln.cveID,
                                    vendor: vuln.vendorProject || 'Unknown',
                                    product: vuln.product || 'Unknown',
                                    date: vuln.dateAdded || 'Unknown',
                                    cvss: vuln.cvss ? String(vuln.cvss) : 'Unknown',
                                    epss: vuln.epss ? String(vuln.epss) : 'Unknown',
                                    isKEV: true,
                                    due: vuln.dueDate || 'N/A'
                                }
                            }, { compact: true })}
                        </div>
                    </div>
                    <div style="font-size:13px; margin-bottom:8px; color:#ff4444;"><strong>Vendor:</strong> ${vuln.vendorProject || 'Unknown'}</div>
                    <div style="font-size:13px; margin-bottom:8px; color:#fff;"><strong>Product:</strong> ${vuln.product || 'Unknown'}</div>
                    <div style="font-size: 13px; margin-bottom: 8px; color:rgba(255,255,255,0.8);">Description: ${vuln.shortDescription || vuln.vulnerabilityName || 'No description'}</div>
                    <div style="display: flex; justify-content: space-between; font-size: 12px; color: rgba(255,255,255,0.6); margin-top:8px;">
                        <span>Added: ${vuln.dateAdded || 'Unknown'}</span>
                        <span style="color: #ff0040;">Due: ${vuln.dueDate || 'N/A'}</span>
                    </div>
                </div>
            `;
        }).join('');
        updatePinButtons();
        renderPostureDashboard();
    } catch (err) {
        grid.innerHTML = `<div style="text-align:center; padding:40px; color:#ff0040;">Error loading CISA data: ${err.message}<br><br>Please refresh and try again.</div>`;
    }
}

const advisoriesState = {
    items: [],
    filtered: [],
    vendor: 'all',
    cveOnly: false,
    visible: 10,
    degraded: false,
    timestamp: null,
    parsedCount: 0,
    filteredCount: 0,
    fetchedCount: 0,
    errors: [],
    filteredByCveOnly: false
};

const osvState = {
    items: [],
    filtered: [],
    ecosystems: ['npm', 'PyPI', 'Maven'],
    severity: 'MEDIUM',
    includeUnknown: false,
    visible: 5,
    degraded: false,
    timestamp: null,
    parsedCount: 0,
    filteredCount: 0,
    fetchedCount: 0,
    errors: []
};

const statusState = {
    items: [],
    visible: 5,
    degraded: false,
    timestamp: null,
    parsedCount: 0,
    filteredCount: 0,
    fetchedCount: 0,
    errors: []
};

function updateHealthStatus(key, isDegraded, timestamp) {
    const statusEl = document.getElementById(`health-${key}-status`);
    const timeEl = document.getElementById(`health-${key}-time`);
    if (statusEl) {
        statusEl.textContent = isDegraded ? 'Degraded' : 'OK';
        statusEl.classList.toggle('degraded', isDegraded);
        statusEl.classList.toggle('ok', !isDegraded);
    }
    if (timeEl) {
        timeEl.textContent = `Last update: ${timestamp ? new Date(timestamp).toLocaleString() : '--'}`;
    }
}

function setDegradedBanner(id, show) {
    const banner = document.getElementById(id);
    if (banner) banner.style.display = show ? 'block' : 'none';
}

function formatModuleDate(iso) {
    if (!iso) return 'Unknown';
    const date = new Date(iso);
    if (Number.isNaN(date.getTime())) return 'Unknown';
    return date.toLocaleString('en-US', { month: 'short', day: 'numeric', year: 'numeric', hour: 'numeric', minute: '2-digit' });
}

function getVendorBadgeClass(vendor) {
    const map = {
        Microsoft: 'badge-blue',
        Cisco: 'badge-cyan',
        Fortinet: 'badge-orange',
        'Palo Alto Networks': 'badge-purple',
        VMware: 'badge-green'
    };
    return map[vendor] || 'badge-blue';
}

function getEcosystemBadgeClass(ecosystem) {
    const map = {
        npm: 'badge-blue',
        PyPI: 'badge-purple',
        Maven: 'badge-orange',
        Go: 'badge-green',
        RubyGems: 'badge-pink'
    };
    return map[ecosystem] || 'badge-blue';
}

function getSeverityBadgeClass(severity) {
    const value = (severity || '').toUpperCase();
    if (value === 'CRITICAL') return 'badge-cyan';
    if (value === 'HIGH') return 'badge-orange';
    if (value === 'MEDIUM') return 'badge-pink';
    if (value === 'LOW') return 'badge-green';
    return 'badge-blue';
}

function severityRank(value) {
    const map = { CRITICAL: 4, HIGH: 3, MEDIUM: 2, LOW: 1, UNKNOWN: 0 };
    return map[(value || '').toUpperCase()] ?? 0;
}

function decodeEntities(text) {
    const entityMap = {
        '&lt;': '<',
        '&gt;': '>',
        '&amp;': '&',
        '&quot;': '"',
        '&#39;': "'",
        '&nbsp;': ' '
    };
    return text.replace(/(&lt;|&gt;|&amp;|&quot;|&#39;|&nbsp;)/g, match => entityMap[match] || match);
}

function cleanText(raw) {
    if (!raw) return '';
    const decoded = decodeEntities(String(raw));
    return decoded.replace(/<[^>]*>/g, ' ').replace(/\s+/g, ' ').trim();
}

function buildSummaryData(raw, maxLength) {
    const fullText = cleanText(raw);
    if (fullText.length <= maxLength) {
        return { fullText, shortText: fullText, isTrimmed: false };
    }
    const shortText = `${fullText.slice(0, maxLength).trimEnd()}â€¦`;
    return { fullText, shortText, isTrimmed: true };
}

function renderDebugDetails(errors) {
    if (!Array.isArray(errors) || errors.length === 0) return '';
    const items = errors.map(error => {
        const source = escapeHtml(error.sourceName || 'Source');
        const url = escapeHtml(error.url || '');
        const status = error.status != null ? escapeHtml(String(error.status)) : 'n/a';
        const message = escapeHtml(error.message || 'Unknown error');
        return `<li style="margin-bottom:6px;"><strong>${source}</strong> (${status})<br><span style="color: rgba(255,255,255,0.65);">${message}</span>${url ? `<br><span style="color: rgba(255,255,255,0.45);">${url}</span>` : ''}</li>`;
    }).join('');
    return `
        <div style="margin-top: 12px; text-align: left;">
            <div style="font-size: 12px; color: rgba(255,255,255,0.75); margin-bottom: 6px;">Degraded: sources failed.</div>
            <details style="font-size: 12px; color: rgba(255,255,255,0.75); background: rgba(255,255,255,0.04); padding: 8px 10px; border-radius: 8px; border: 1px solid rgba(255,255,255,0.1);">
                <summary style="cursor:pointer; color:#22d3ee;">View debug</summary>
                <ul style="margin: 8px 0 0 16px;">${items}</ul>
            </details>
        </div>
    `;
}

function updateAdvisoryVendors(items) {
    const vendorSelect = document.getElementById('advisories-vendor-filter');
    if (!vendorSelect) return;
    const currentValue = vendorSelect.value || 'all';
    const vendors = Array.from(new Set((items || []).map(item => item.vendor).filter(Boolean))).sort();
    vendorSelect.innerHTML = '<option value="all">Vendor: All</option>' +
        vendors.map(vendor => `<option value="${escapeHtml(vendor)}">${escapeHtml(vendor)}</option>`).join('');
    vendorSelect.value = vendors.includes(currentValue) ? currentValue : 'all';
}

async function loadVendorAdvisories(force = false) {
    const listEl = document.getElementById('advisories-list');
    if (!listEl) return;
    listEl.innerHTML = '<div style="text-align:center; padding:24px; color:#22d3ee;"><span class="spinner" style="width:28px; height:28px;"></span><br><br>Loading vendor advisories...</div>';

    try {
        const params = new URLSearchParams({ type: 'advisories' });
        if (advisoriesState.cveOnly) params.set('cveOnly', '1');
        if (force) params.set('force', '1');
        const url = `/api/feeds?${params.toString()}`;
        const res = await fetch(url);
        if (!res.ok) throw new Error('Vendor advisories unavailable');
        const data = await res.json();
        advisoriesState.items = data.items || [];
        advisoriesState.timestamp = data.timestamp;
        advisoriesState.degraded = Boolean(data.degraded) || !advisoriesState.items.length;
        advisoriesState.parsedCount = Number(data.parsedCount ?? advisoriesState.items.length);
        advisoriesState.fetchedCount = Number(data.fetchedCount ?? 0);
        advisoriesState.errors = data.errors || [];
        advisoriesState.filteredByCveOnly = Boolean(data.filteredByCveOnly);
        updateAdvisoryVendors(advisoriesState.items);
        applyAdvisoriesFilters();
        setDegradedBanner('advisories-degraded', advisoriesState.degraded);
        const updatedEl = document.getElementById('advisories-updated');
        if (updatedEl) updatedEl.textContent = formatModuleDate(advisoriesState.timestamp);
        updateHealthStatus('advisories', advisoriesState.degraded, advisoriesState.timestamp);
    } catch (error) {
        if (advisoriesState.items.length) {
            setDegradedBanner('advisories-degraded', true);
            updateHealthStatus('advisories', true, advisoriesState.timestamp);
            renderAdvisoriesList();
        } else {
            listEl.innerHTML = `<div style="text-align:center; padding:24px; color:#ff4444;">${error.message}</div>`;
            updateHealthStatus('advisories', true, advisoriesState.timestamp);
        }
    }
}

function applyAdvisoriesFilters() {
    const vendor = advisoriesState.vendor;
    const cveOnly = advisoriesState.cveOnly;
    advisoriesState.filtered = advisoriesState.items.filter(item => {
        const vendorMatch = vendor === 'all' || item.vendor === vendor;
        const cveMatch = !cveOnly || (item.cves && item.cves.length > 0);
        return vendorMatch && cveMatch;
    });
    advisoriesState.filteredCount = advisoriesState.filtered.length;
    advisoriesState.filteredByCveOnly = advisoriesState.filteredByCveOnly || (cveOnly && advisoriesState.parsedCount > 0 && advisoriesState.filteredCount === 0);
    renderAdvisoriesList();
}

function renderAdvisoriesList() {
    const listEl = document.getElementById('advisories-list');
    const loadMoreBtn = document.getElementById('advisories-load-more');
    if (!listEl) return;
    const visibleItems = advisoriesState.filtered.slice(0, advisoriesState.visible);

    if (!visibleItems.length) {
        if (advisoriesState.parsedCount > 0 && advisoriesState.filteredCount === 0) {
            listEl.innerHTML = '<div style="text-align:center; padding:24px; color: rgba(255,255,255,0.6);">Items were fetched but filtered outâ€”try disabling Has CVE only / include unknown severity.</div>';
        } else if (!advisoriesState.items.length) {
            const diagnosticsLink = '<a href="/api/feeds?type=advisories&debug=1" target="_blank" rel="noopener" style="color:#22d3ee; font-size:12px;">Open Diagnostics</a>';
            const errorDetails = advisoriesState.errors.length && advisoriesState.parsedCount === 0
                ? renderDebugDetails(advisoriesState.errors)
                : '';
            listEl.innerHTML = `<div style="text-align:center; padding:24px; color: rgba(255,255,255,0.75);">Degraded â€” no advisories returned.<br>${diagnosticsLink}</div>${errorDetails}`;
        } else {
            listEl.innerHTML = '<div style="text-align:center; padding:24px; color: rgba(255,255,255,0.6);">No advisories available at the moment.</div>';
        }
    } else {
        listEl.innerHTML = visibleItems.map(item => {
            const anchorId = `advisory:${item.id}`;
            const summaryData = buildSummaryData(item.summary || '', 180);
            const cves = item.cves || [];
            const visibleCves = cves.slice(0, 6);
            const extraCves = cves.slice(6);
            const cveChips = visibleCves
                .map(cve => `<button class="news-cve-chip" type="button" data-cve-chip="${escapeHtml(cve)}">${escapeHtml(cve)}</button>`)
                .join('');
            const extraCveChips = extraCves
                .map(cve => `<button class="news-cve-chip" type="button" data-cve-chip="${escapeHtml(cve)}">${escapeHtml(cve)}</button>`)
                .join('');
            const cveToggle = extraCves.length
                ? `<button class="news-cve-chip" type="button" data-cve-toggle="true" data-cve-toggle-label="+${extraCves.length} more">+${extraCves.length} more</button>`
                : '';
            return `
                <div class="module-item" data-clipboard-anchor="${anchorId}">
                    <div class="module-item-header">
                        <div>
                            <div class="module-badges">
                                <span class="news-badge ${getVendorBadgeClass(item.vendor)}">${escapeHtml(item.vendor)}</span>
                                <span style="font-size:12px; color: rgba(255,255,255,0.6);">${formatNewsDate(item.publishedISO)}</span>
                            </div>
                            <div class="module-title">${escapeHtml(item.title)}</div>
                        </div>
                        <div class="module-actions">
                            ${getLibrarySaveMarkup({
                                id: anchorId,
                                type: 'advisory',
                                title: item.title,
                                url: item.url,
                                source: item.vendor,
                                date: formatNewsDate(item.publishedISO),
                                summary: item.summary || '',
                                tags: ['vendor', item.vendor]
                            }, { label: 'Save' })}
                            ${getPinButtonMarkup({
                                id: anchorId,
                                anchor: anchorId,
                                type: 'advisory',
                                title: item.title,
                                subtitle: item.vendor,
                                url: item.url,
                                severity: null,
                                meta: {
                                    vendor: item.vendor,
                                    published: item.publishedISO,
                                    cves: item.cves || []
                                }
                            }, { compact: true })}
                        </div>
                    </div>
                    <div class="module-summary">
                        <span class="summary-text" data-summary-full="${escapeHtml(summaryData.fullText)}" data-summary-short="${escapeHtml(summaryData.shortText)}">${escapeHtml(summaryData.shortText)}</span>
                        ${summaryData.isTrimmed ? '<button class="summary-toggle" type="button" data-summary-toggle="true">Show more</button>' : ''}
                    </div>
                    ${cveChips ? `<div class="news-cve-chips">${cveChips}${extraCveChips ? `<span class="extra-cve-chips">${extraCveChips}</span>` : ''}${cveToggle}</div>` : ''}
                    <div class="module-actions" style="margin-top: 10px;">
                        <a class="library-action-btn" href="${escapeHtml(item.url)}" target="_blank" rel="noopener">Open link</a>
                    </div>
                </div>
            `;
        }).join('');
        updatePinButtons();
    }

    if (loadMoreBtn) {
        loadMoreBtn.style.display = advisoriesState.filtered.length > advisoriesState.visible ? 'inline-flex' : 'none';
    }
}

async function loadOsvAdvisories(force = false) {
    const listEl = document.getElementById('osv-list');
    if (!listEl) return;
    listEl.innerHTML = '<div style="text-align:center; padding:24px; color:#22d3ee;"><span class="spinner" style="width:28px; height:28px;"></span><br><br>Loading OSV advisories...</div>';

    try {
        const ecosystems = (osvState.ecosystems || []).join(',');
        const url = `/api/feeds?type=osv&ecosystem=${encodeURIComponent(ecosystems)}&days=7${force ? '&force=1' : ''}`;
        const res = await fetch(url);
        if (!res.ok) throw new Error('OSV advisories unavailable');
        const data = await res.json();
        osvState.items = data.items || [];
        osvState.visible = 5;
        osvState.timestamp = data.timestamp;
        osvState.degraded = Boolean(data.degraded) || !osvState.items.length;
        osvState.parsedCount = Number(data.parsedCount ?? osvState.items.length);
        osvState.fetchedCount = Number(data.fetchedCount ?? 0);
        osvState.errors = data.errors || [];
        applyOsvFilters();
        setDegradedBanner('osv-degraded', osvState.degraded);
        const updatedEl = document.getElementById('osv-updated');
        if (updatedEl) updatedEl.textContent = formatModuleDate(osvState.timestamp);
        updateHealthStatus('osv', osvState.degraded, osvState.timestamp);
    } catch (error) {
        if (osvState.items.length) {
            setDegradedBanner('osv-degraded', true);
            updateHealthStatus('osv', true, osvState.timestamp);
            renderOsvList();
        } else {
            listEl.innerHTML = `<div style="text-align:center; padding:24px; color:#ff4444;">${error.message}</div>`;
            updateHealthStatus('osv', true, osvState.timestamp);
        }
    }
}

function applyOsvFilters() {
    const minSeverity = severityRank(osvState.severity);
    const includeUnknown = osvState.includeUnknown || minSeverity <= severityRank('MEDIUM');
    osvState.filtered = osvState.items.filter(item => {
        const severity = (item.severity || 'UNKNOWN').toUpperCase();
        if (severity === 'UNKNOWN') {
            return includeUnknown;
        }
        return severityRank(severity) >= minSeverity;
    });
    osvState.filteredCount = osvState.filtered.length;
    renderOsvList();
}

function renderOsvList() {
    const listEl = document.getElementById('osv-list');
    const loadMoreBtn = document.getElementById('osv-load-more');
    if (!listEl) return;
    const visibleItems = osvState.filtered.slice(0, osvState.visible);

    if (!visibleItems.length) {
        if (osvState.parsedCount > 0 && osvState.filteredCount === 0) {
            listEl.innerHTML = '<div style="text-align:center; padding:24px; color: rgba(255,255,255,0.6);">Items were fetched but filtered outâ€”try lowering the severity filter or include unknown severity.</div>';
        } else if (!osvState.items.length) {
            const diagnosticsLink = '<a href="/api/feeds?type=osv&debug=1" target="_blank" rel="noopener" style="color:#22d3ee; font-size:12px;">Open Diagnostics</a>';
            const errorDetails = osvState.errors.length && osvState.parsedCount === 0
                ? renderDebugDetails(osvState.errors)
                : '';
            listEl.innerHTML = `<div style="text-align:center; padding:24px; color: rgba(255,255,255,0.75);">Degraded â€” no supply chain advisories returned.<br>${diagnosticsLink}</div>${errorDetails}`;
        } else {
            listEl.innerHTML = '<div style="text-align:center; padding:24px; color: rgba(255,255,255,0.6);">No supply chain advisories available at the moment.</div>';
        }
    } else {
        listEl.innerHTML = visibleItems.map(item => {
            const anchorId = `osv:${item.id}`;
            const summaryData = buildSummaryData(item.summary || '', 160);
            const aliases = item.aliases || [];
            const cveAliases = aliases.filter(alias => alias.toUpperCase().startsWith('CVE-'));
            const otherAliases = aliases.filter(alias => !alias.toUpperCase().startsWith('CVE-'));
            const visibleCves = cveAliases.slice(0, 6);
            const extraCves = cveAliases.slice(6);
            const cveChips = visibleCves
                .map(cve => `<button class="news-cve-chip" type="button" data-cve-chip="${escapeHtml(cve)}">${escapeHtml(cve)}</button>`)
                .join('');
            const extraCveChips = extraCves
                .map(cve => `<button class="news-cve-chip" type="button" data-cve-chip="${escapeHtml(cve)}">${escapeHtml(cve)}</button>`)
                .join('');
            const cveToggle = extraCves.length
                ? `<button class="news-cve-chip" type="button" data-cve-toggle="true" data-cve-toggle-label="+${extraCves.length} more">+${extraCves.length} more</button>`
                : '';
            const aliasChips = otherAliases.map(alias => `<span class="news-cve-chip" style="cursor: default;">${escapeHtml(alias)}</span>`).join('');
            return `
                <div class="module-item" data-clipboard-anchor="${anchorId}">
                    <div class="module-item-header">
                        <div>
                            <div class="module-badges">
                                <span class="news-badge ${getEcosystemBadgeClass(item.ecosystem)}">${escapeHtml(item.ecosystem)}</span>
                                <span class="news-badge ${getSeverityBadgeClass(item.severity)}">${escapeHtml(item.severity || 'Unknown')}</span>
                                <span style="font-size:12px; color: rgba(255,255,255,0.6);">${formatNewsDate(item.publishedISO)}</span>
                            </div>
                            <div class="module-title">${escapeHtml(item.package)}</div>
                        </div>
                        <div class="module-actions">
                            ${getLibrarySaveMarkup({
                                id: anchorId,
                                type: 'osv',
                                title: `${item.package} (${item.ecosystem})`,
                                url: item.url,
                                source: `OSV ${item.ecosystem}`,
                                date: formatNewsDate(item.publishedISO),
                                summary: item.summary || '',
                                tags: ['osv', item.ecosystem, item.severity]
                            }, { label: 'Save' })}
                            ${getPinButtonMarkup({
                                id: anchorId,
                                anchor: anchorId,
                                type: 'osv',
                                title: item.package,
                                subtitle: item.ecosystem,
                                url: item.url,
                                severity: item.severity,
                                meta: {
                                    aliases: item.aliases || [],
                                    published: item.publishedISO
                                }
                            }, { compact: true })}
                        </div>
                    </div>
                    <div class="module-summary">
                        <span class="summary-text" data-summary-full="${escapeHtml(summaryData.fullText)}" data-summary-short="${escapeHtml(summaryData.shortText)}">${escapeHtml(summaryData.shortText)}</span>
                        ${summaryData.isTrimmed ? '<button class="summary-toggle" type="button" data-summary-toggle="true">Show more</button>' : ''}
                    </div>
                    ${cveChips ? `<div class="news-cve-chips">${cveChips}${extraCveChips ? `<span class="extra-cve-chips">${extraCveChips}</span>` : ''}${cveToggle}</div>` : ''}
                    ${aliasChips ? `<div class="news-cve-chips" style="margin-top: 8px;">${aliasChips}</div>` : ''}
                    <div class="module-actions" style="margin-top: 10px;">
                        <a class="library-action-btn" href="${escapeHtml(item.url)}" target="_blank" rel="noopener">Open link</a>
                    </div>
                </div>
            `;
        }).join('');
        updatePinButtons();
    }

    if (loadMoreBtn) {
        loadMoreBtn.style.display = osvState.filtered.length > osvState.visible ? 'inline-flex' : 'none';
    }
}

async function loadStatusBoard(force = false) {
    const listEl = document.getElementById('status-list');
    if (!listEl) return;
    listEl.innerHTML = '<div style="text-align:center; padding:24px; color:#22d3ee;"><span class="spinner" style="width:28px; height:28px;"></span><br><br>Loading status updates...</div>';

    try {
        const url = `/api/feeds?type=status${force ? '&force=1' : ''}`;
        const res = await fetch(url);
        if (!res.ok) throw new Error('Status feeds unavailable');
        const data = await res.json();
        statusState.items = data.items || [];
        statusState.visible = 5;
        statusState.timestamp = data.timestamp;
        statusState.degraded = Boolean(data.degraded);
        statusState.parsedCount = Number(data.parsedCount ?? statusState.items.length);
        statusState.fetchedCount = Number(data.fetchedCount ?? 0);
        statusState.errors = data.errors || [];
        statusState.filteredCount = statusState.items.length;
        renderStatusBoard();
        setDegradedBanner('status-degraded', statusState.degraded);
        const updatedEl = document.getElementById('status-updated');
        if (updatedEl) updatedEl.textContent = formatModuleDate(statusState.timestamp);
        updateHealthStatus('status', statusState.degraded, statusState.timestamp);
    } catch (error) {
        if (statusState.items.length) {
            setDegradedBanner('status-degraded', true);
            updateHealthStatus('status', true, statusState.timestamp);
            renderStatusBoard();
        } else {
            listEl.innerHTML = `<div style="text-align:center; padding:24px; color:#ff4444;">${error.message}</div>`;
            updateHealthStatus('status', true, statusState.timestamp);
        }
    }
}

function renderStatusBoard() {
    const listEl = document.getElementById('status-list');
    const summaryEl = document.getElementById('status-summary-chips');
    const loadMoreBtn = document.getElementById('status-load-more');
    const showLessBtn = document.getElementById('status-show-less');
    if (!listEl) return;
    const now = Date.now();
    const active = statusState.items
        .filter(item => item.statusType === 'incident')
        .sort((a, b) => new Date(b.publishedISO || 0) - new Date(a.publishedISO || 0));
    const maintenance = statusState.items
        .filter(item => item.statusType === 'maintenance')
        .sort((a, b) => new Date(b.publishedISO || 0) - new Date(a.publishedISO || 0));
    const resolved = statusState.items
        .filter(item => item.statusType === 'resolved')
        .sort((a, b) => new Date(b.publishedISO || 0) - new Date(a.publishedISO || 0));
    const resolvedRecent = resolved.filter(item => (now - new Date(item.publishedISO).getTime()) <= 24 * 60 * 60 * 1000);

    if (summaryEl) {
        summaryEl.innerHTML = `
            <div class="intel-summary-chip">Active incidents: ${active.length}</div>
            <div class="intel-summary-chip">Maintenance: ${maintenance.length}</div>
            <div class="intel-summary-chip">Resolved (24h): ${resolvedRecent.length}</div>
        `;
    }

    const ordered = [...active, ...maintenance, ...resolved].filter(Boolean);

    if (!ordered.length) {
        if (statusState.errors.length && statusState.parsedCount === 0) {
            listEl.innerHTML = `<div style="text-align:center; padding:24px; color: rgba(255,255,255,0.7);">No status updates available.</div>${renderDebugDetails(statusState.errors)}`;
        } else {
            listEl.innerHTML = '<div style="text-align:center; padding:24px; color: rgba(255,255,255,0.6);">No recent status updates.</div>';
        }
        if (loadMoreBtn) loadMoreBtn.style.display = 'none';
        if (showLessBtn) showLessBtn.style.display = 'none';
        return;
    }

    listEl.innerHTML = ordered.slice(0, statusState.visible).map(item => {
        const anchorId = `status:${item.id}`;
        const summaryData = buildSummaryData(item.summary || '', 220);
        return `
            <div class="module-item" data-clipboard-anchor="${anchorId}">
                <div class="module-item-header">
                    <div>
                        <div class="module-badges">
                            <span class="news-badge badge-blue">${escapeHtml(item.service)}</span>
                            <span class="status-pill ${escapeHtml(item.statusType)}">${escapeHtml(item.statusType)}</span>
                            <span style="font-size:12px; color: rgba(255,255,255,0.6);">${formatNewsDate(item.publishedISO)}</span>
                        </div>
                        <div class="module-title">${escapeHtml(item.title)}</div>
                    </div>
                    <div class="module-actions">
                        ${getLibrarySaveMarkup({
                            id: anchorId,
                            type: 'status',
                            title: item.title,
                            url: item.url,
                            source: item.service,
                            date: formatNewsDate(item.publishedISO),
                            summary: item.summary || '',
                            tags: ['status', item.statusType]
                        }, { label: 'Save' })}
                        ${getPinButtonMarkup({
                            id: anchorId,
                            anchor: anchorId,
                            type: 'status',
                            title: item.title,
                            subtitle: item.service,
                            url: item.url,
                            severity: null,
                            meta: {
                                status: item.statusType,
                                published: item.publishedISO
                            }
                        }, { compact: true })}
                    </div>
                </div>
                <div class="module-summary">
                    <span class="summary-text" data-summary-full="${escapeHtml(summaryData.fullText)}" data-summary-short="${escapeHtml(summaryData.shortText)}">${escapeHtml(summaryData.shortText)}</span>
                    ${summaryData.isTrimmed ? '<button class="summary-toggle" type="button" data-summary-toggle="true">Show more</button>' : ''}
                </div>
                <div class="module-actions" style="margin-top: 10px;">
                    <a class="library-action-btn" href="${escapeHtml(item.url)}" target="_blank" rel="noopener">Open link</a>
                </div>
            </div>
        `;
    }).join('');
    updatePinButtons();

    if (loadMoreBtn) {
        loadMoreBtn.style.display = ordered.length > statusState.visible ? 'inline-flex' : 'none';
    }
    if (showLessBtn) {
        showLessBtn.style.display = statusState.visible > 5 ? 'inline-flex' : 'none';
    }
}

function setupDashboardIntel() {
    const vendorSelect = document.getElementById('advisories-vendor-filter');
    const cveOnlyToggle = document.getElementById('advisories-cve-only');
    const advisoriesLoadMore = document.getElementById('advisories-load-more');
    const advisoriesRefresh = document.getElementById('advisories-refresh-btn');

    if (vendorSelect) {
        vendorSelect.addEventListener('change', () => {
            advisoriesState.vendor = vendorSelect.value;
            advisoriesState.visible = 10;
            applyAdvisoriesFilters();
        });
    }
    if (cveOnlyToggle) {
        cveOnlyToggle.addEventListener('change', () => {
            advisoriesState.cveOnly = cveOnlyToggle.checked;
            advisoriesState.visible = 10;
            loadVendorAdvisories();
        });
    }
    if (advisoriesLoadMore) {
        advisoriesLoadMore.addEventListener('click', () => {
            advisoriesState.visible += 10;
            renderAdvisoriesList();
        });
    }
    if (advisoriesRefresh) {
        advisoriesRefresh.addEventListener('click', () => loadVendorAdvisories(true));
    }

    const ecosystemSelect = document.getElementById('osv-ecosystem-filter');
    const osvSeveritySelect = document.getElementById('osv-severity-filter');
    const osvIncludeUnknownToggle = document.getElementById('osv-include-unknown');
    const osvLoadMore = document.getElementById('osv-load-more');
    const osvRefresh = document.getElementById('osv-refresh-btn');

    if (ecosystemSelect) {
        ecosystemSelect.addEventListener('change', () => {
            const selected = Array.from(ecosystemSelect.selectedOptions).map(option => option.value);
            osvState.ecosystems = selected.length ? selected : ['npm', 'PyPI', 'Maven'];
            osvState.visible = 5;
            loadOsvAdvisories();
        });
    }
    if (osvSeveritySelect) {
        osvSeveritySelect.addEventListener('change', () => {
            osvState.severity = osvSeveritySelect.value;
            osvState.visible = 5;
            applyOsvFilters();
        });
    }
    if (osvIncludeUnknownToggle) {
        osvState.includeUnknown = osvIncludeUnknownToggle.checked;
        osvIncludeUnknownToggle.addEventListener('change', () => {
            osvState.includeUnknown = osvIncludeUnknownToggle.checked;
            osvState.visible = 5;
            applyOsvFilters();
        });
    }
    if (osvLoadMore) {
        osvLoadMore.addEventListener('click', () => {
            osvState.visible += 5;
            renderOsvList();
        });
    }
    if (osvRefresh) {
        osvRefresh.addEventListener('click', () => loadOsvAdvisories(true));
    }

    const statusRefresh = document.getElementById('status-refresh-btn');
    const statusLoadMore = document.getElementById('status-load-more');
    const statusShowLess = document.getElementById('status-show-less');
    if (statusRefresh) {
        statusRefresh.addEventListener('click', () => loadStatusBoard(true));
    }
    if (statusLoadMore) {
        statusLoadMore.addEventListener('click', () => {
            statusState.visible += 5;
            renderStatusBoard();
        });
    }
    if (statusShowLess) {
        statusShowLess.addEventListener('click', () => {
            statusState.visible = 5;
            renderStatusBoard();
        });
    }
}

document.addEventListener('click', event => {
    const summaryToggle = event.target.closest('[data-summary-toggle]');
    if (summaryToggle) {
        const summaryContainer = summaryToggle.closest('.module-summary');
        const summaryText = summaryContainer?.querySelector('.summary-text');
        if (!summaryText) return;
        const isExpanded = summaryContainer.classList.toggle('expanded');
        const fullText = summaryText.dataset.summaryFull || '';
        const shortText = summaryText.dataset.summaryShort || '';
        summaryText.textContent = isExpanded ? fullText : shortText;
        summaryToggle.textContent = isExpanded ? 'Show less' : 'Show more';
        return;
    }

    const cveToggle = event.target.closest('[data-cve-toggle]');
    if (cveToggle) {
        const chipRow = cveToggle.closest('.news-cve-chips');
        if (!chipRow) return;
        const isExpanded = chipRow.classList.toggle('expanded');
        const defaultLabel = cveToggle.dataset.cveToggleLabel || 'Show more';
        cveToggle.textContent = isExpanded ? 'Show less' : defaultLabel;
    }
});

function refreshDashboard() {
    loadCISAKEV();
    loadVendorAdvisories(true);
    loadOsvAdvisories(true);
    loadStatusBoard(true);
}

document.addEventListener('DOMContentLoaded', function() {
    loadCISAKEV();
    loadVendorAdvisories();
    loadOsvAdvisories();
    loadStatusBoard();
    setupDashboardIntel();

    setInterval(() => loadVendorAdvisories(), 30 * 60 * 1000);
    setInterval(() => loadOsvAdvisories(), 60 * 60 * 1000);
    setInterval(() => loadStatusBoard(), 15 * 60 * 1000);
});
</script>

<script>


function getSeverityColor(severity) {
  if (!severity) return '#aaa';
  const sev = severity.toUpperCase();
  switch(sev) {
    case 'CRITICAL': return '#ff5454';
    case 'HIGH': return '#ff6b35';
    case 'MEDIUM': return '#ff6b35';
    case 'LOW': return '#27ae60';
    default: return '#aaa';
  }
}


// Global variable to store all breaches for "Load More" functionality
let allBreachesData = [];
let filteredBreaches = [];
let currentBreachesShown = 5;
const breachModeStorageKey = 'breach_mode_v1';

// Load real-time breach data from backend aggregator
async function loadRealBreaches() {
  const headerEl = document.getElementById('breach-header');
  const subtitleEl = document.getElementById('breach-subtitle');
  const fallbackCallout = document.getElementById('breach-fallback-callout');
  try {
    const mode = getBreachMode();
    const response = mode === 'verified'
      ? await fetch('/api/hibp-breaches')
      : await fetch(`/api/breaches?mode=${encodeURIComponent(mode)}`);
    
    if (!response.ok) {
      throw new Error('Breach API failed');
    }
    
    const breachPayload = await response.json();
    const breachList = breachPayload?.breaches || [];
    const responseMode = mode === 'verified' ? 'verified' : (breachPayload?.mode || mode);

    if (headerEl) {
      headerEl.textContent = responseMode === 'live'
        ? 'Incidents & Breach Intelligence (Filtered)'
        : 'Recent Data Breaches (Verified Dataset)';
    }
    if (subtitleEl) {
      subtitleEl.textContent = responseMode === 'live'
        ? 'Confirmed breach, ransomware, and major incident intelligence.'
        : 'Verified breach registry (HIBP catalog)';
    }
    if (fallbackCallout) {
      fallbackCallout.style.display = responseMode === 'live' ? 'block' : 'none';
    }
    
    // Filter for recent breaches (2023-2025) and sort by date (newest first)
    const recentBreaches = breachList
      .filter(breach => {
        const breachYear = new Date(breach.date).getFullYear();
        return breachYear >= 2023;
      })
      .sort((a, b) => new Date(b.date) - new Date(a.date));
    
    // Fallback to all breaches if no recent ones
    const breachesToProcess = recentBreaches.length > 0 ? recentBreaches : breachList;
    
    // Convert API format
    allBreachesData = breachesToProcess.map(breach => ({
      name: breach.name,
      date: breach.date,
      recordsAffected: breach.recordsAffected || 0,
      dataExposed: breach.dataExposed,
      description: breach.description || '',
      severity: breach.severity || calculateSeverityFromCount(breach.recordsAffected || 0),
      category: breach.category || 'breach',
      sourceName: breach.sourceName || 'Breach Directory',
      url: breach.url || '',
      attackType: breach.attackType || 'Unknown'
    }));
    
    // Reset and show first 5
    currentBreachesShown = 5;
    updateBreachFilters();
    renderPostureDashboard();
    console.log('âœ… Loaded ' + allBreachesData.length + ' breaches from backend');
    
  } catch (error) {
    console.warn('âš ï¸ Breach API failed, using fallback:', error.message);
    const mode = getBreachMode();
    if (mode === 'verified') {
      if (fallbackCallout) {
        fallbackCallout.style.display = 'block';
      }
      const liveSelect = document.getElementById('breach-mode-switch');
      if (liveSelect) {
        liveSelect.value = 'live';
      }
      localStorage.setItem(breachModeStorageKey, 'live');
      await loadRealBreaches();
      return;
    }
    if (headerEl) {
      headerEl.textContent = 'Recent Data Breaches (Verified Dataset)';
    }
    if (subtitleEl) {
      subtitleEl.textContent = 'Verified breach registry (HIBP catalog)';
    }
    if (fallbackCallout) {
      fallbackCallout.style.display = 'none';
    }
    
    if (typeof realBreaches2025 !== 'undefined' && realBreaches2025.length > 0) {
      allBreachesData = realBreaches2025.map(breach => ({
        name: breach.company,
        date: breach.date,
        recordsAffected: parseInt(breach.affected.replace(/[^0-9]/g, '')) || 0,
        dataExposed: breach.data_exposed,
        description: breach.description,
        severity: breach.severity,
        category: 'breach',
        sourceName: 'Local Fallback',
        url: '',
        attackType: 'Unknown'
      })).sort((a, b) => new Date(b.date) - new Date(a.date));
      
      currentBreachesShown = 5;
      updateBreachFilters();
      renderPostureDashboard();
      console.log('ðŸ“¦ Using local fallback data');
    }
  }
}

function loadMoreBreaches() {
  currentBreachesShown += 5;
  displayBreaches(filteredBreaches.slice(0, currentBreachesShown), filteredBreaches.length > currentBreachesShown);
}

function getBreachMode() {
  const selectEl = document.getElementById('breach-mode-switch');
  const stored = localStorage.getItem(breachModeStorageKey);
  const mode = selectEl?.value || stored || 'verified';
  if (selectEl) {
    selectEl.value = mode;
  }
  return mode;
}

function setupBreachMode() {
  const selectEl = document.getElementById('breach-mode-switch');
  if (!selectEl) return;
  const stored = localStorage.getItem(breachModeStorageKey) || 'verified';
  selectEl.value = stored;
  selectEl.addEventListener('change', () => {
    localStorage.setItem(breachModeStorageKey, selectEl.value);
    loadRealBreaches();
  });
}

function updateBreachFilters() {
  const categoryFilter = document.getElementById('breach-category-filter')?.value || 'all';
  const severityFilter = document.getElementById('breach-severity-filter')?.value || 'medium';

  filteredBreaches = allBreachesData.filter(breach => {
    const matchesCategory = categoryFilter === 'all' || breach.category === categoryFilter;
    const matchesSeverity = matchesSeverityFilter(breach.severity, severityFilter);
    return matchesCategory && matchesSeverity;
  }).sort((a, b) => new Date(b.date) - new Date(a.date));

  currentBreachesShown = 5;
  displayBreaches(filteredBreaches.slice(0, currentBreachesShown), filteredBreaches.length > currentBreachesShown);
}

function matchesSeverityFilter(severity, filterValue) {
  if (filterValue === 'all') return true;
  const severityRank = getSeverityRank(severity);
  if (filterValue === 'critical') return severityRank >= 4;
  if (filterValue === 'high') return severityRank >= 3;
  return severityRank >= 2;
}

function getSeverityRank(severity) {
  switch ((severity || '').toUpperCase()) {
    case 'CRITICAL':
      return 4;
    case 'HIGH':
      return 3;
    case 'MEDIUM':
      return 2;
    case 'LOW':
      return 1;
    default:
      return 1;
  }
}

function setupBreachFilters() {
  const categoryFilter = document.getElementById('breach-category-filter');
  const severityFilter = document.getElementById('breach-severity-filter');
  if (categoryFilter) {
    categoryFilter.addEventListener('change', updateBreachFilters);
  }
  if (severityFilter) {
    severityFilter.addEventListener('change', updateBreachFilters);
  }
}

function calculateSeverityFromCount(pwnCount) {
  if (pwnCount > 1000000) return 'CRITICAL';
  if (pwnCount > 100000) return 'HIGH';
  if (pwnCount > 10000) return 'MEDIUM';
  return 'LOW';
}

function displayBreaches(breaches, showLoadMore = false) {
  const container = document.getElementById('real-breaches-grid');
  
  let html = '';
  
  breaches.forEach(breach => {
           // Escape any HTML in the description to prevent link interpretation
    const safeDescription = breach.description
      .replace(/</g, '&lt;')
      .replace(/>/g, '&gt;')
      .replace(/&/g, '&amp;');
    const recordsLabel = typeof breach.recordsAffected === 'number'
      ? formatNumber(breach.recordsAffected)
      : (breach.recordsAffected || 'Unknown');
    const dataLabel = breach.dataExposed || 'Unknown';
    const attackTypeLabel = breach.attackType || 'Unknown';
    const breachAnchor = `${(breach.category || 'breach')}:${breach.name}:${breach.date}`;

    
    html += `<div style="background: rgba(20, 25, 30, 0.95); border-left: 5px solid ${getSeverityColor(breach.severity)}; border-radius: 6px; padding: 16px; margin-bottom: 12px; box-shadow: 0 2px 6px rgba(0,0,0,0.4); position: relative;" data-clipboard-anchor="${breachAnchor}">
      <div style="display: flex; justify-content: space-between; align-items: flex-start; gap: 12px; margin-bottom: 12px;">
        <div style="flex: 1;">
          <h4 style="margin: 0 0 4px 0; font-size: 15px; font-weight: 700; color: #fff; word-wrap: break-word;">
            ${breach.url ? `<a href="${breach.url}" target="_blank" rel="noopener" style="color: #fff; text-decoration: none;">${breach.name}</a>` : breach.name}
          </h4>
          <div style="display: flex; gap: 8px; flex-wrap: wrap; font-size: 11px; margin-top: 6px;">
            <span style="background: rgba(34,211,238,0.12); border: 1px solid rgba(34,211,238,0.35); color: #22d3ee; padding: 2px 8px; border-radius: 999px; text-transform: uppercase;">${breach.category || 'breach'}</span>
            <span style="background: rgba(255,255,255,0.08); border: 1px solid rgba(255,255,255,0.2); color: rgba(255,255,255,0.8); padding: 2px 8px; border-radius: 999px;">${breach.sourceName || 'Source'}</span>
          </div>
        </div>
        <div style="display: flex; flex-direction: column; align-items: flex-end; gap: 6px;">
          <span style="background: ${getSeverityColor(breach.severity)}; color: #fff; padding: 5px 10px; border-radius: 4px; font-size: 11px; font-weight: 700; white-space: nowrap; flex-shrink: 0;">${breach.severity}</span>
          ${getLibrarySaveMarkup({
              id: `${(breach.category || 'breach')}:${breach.name}:${breach.date}`,
              type: breach.category || 'breach',
              title: breach.name,
              url: breach.url || '',
              source: breach.sourceName || 'Breach Directory',
              date: breach.date,
              summary: breach.description || '',
              tags: []
          }, { label: 'Save' })}
          ${getPinButtonMarkup({
              id: breachAnchor,
              anchor: breachAnchor,
              type: (breach.category || 'breach') === 'breach' ? 'breach' : 'incident',
              title: breach.name,
              subtitle: breach.sourceName || 'Breach Directory',
              url: breach.url || '',
              severity: breach.severity ? breach.severity.toUpperCase() : null,
              meta: {
                date: breach.date || 'Unknown',
                records: recordsLabel,
                attack: attackTypeLabel,
                data: dataLabel
              }
          }, { compact: true })}
        </div>
      </div>
      
      <div style="border-top: 1px solid rgba(255,255,255,0.1); padding-top: 12px;">
        <div style="font-size: 12px; color: #ff4444; margin-bottom: 8px;">ðŸ“… <strong>${breach.date}</strong></div>
        <div style="font-size: 12px; color: rgba(255,255,255,0.8); margin-bottom: 8px;"><strong style="color: #fff;">Records:</strong> <span style="color: #ff4444;">${recordsLabel}</span></div>
        <div style="font-size: 12px; color: rgba(255,255,255,0.8); margin-bottom: 8px;"><strong style="color: #fff;">Attack Type:</strong> ${attackTypeLabel}</div>
        <div style="font-size: 12px; color: rgba(255,255,255,0.8);"><strong style="color: #fff;">Data:</strong> ${dataLabel}</div>
      </div>
    </div>`;

  });
  
  if (showLoadMore) {
    html += `<div style="text-align: center; margin-top: 24px; padding: 20px 0;">
      <button onclick="loadMoreBreaches()" style="background: linear-gradient(135deg, #ff6b6b 0%, #ff5454 100%); color: white; border: none; padding: 12px 28px; font-size: 14px; font-weight: 600; border-radius: 6px; cursor: pointer; transition: all 0.3s ease; box-shadow: 0 4px 12px rgba(255, 107, 107, 0.3); font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;">
        ðŸ“Š Load More Breaches
      </button>
    </div>`;
  }
  
  container.innerHTML = html;
  updatePinButtons();
}



function formatNumber(num) {
  if (!num) return 'Unknown';
  if (num > 1000000) return (num / 1000000).toFixed(1) + 'M';
  if (num > 1000) return (num / 1000).toFixed(1) + 'K';
  return num.toString();
}

// Call on page load
window.addEventListener('DOMContentLoaded', () => {
  setupBreachMode();
  setupBreachFilters();
  loadRealBreaches();
});



</script>



            </div>

            <!-- Threat Intelligence Tab -->
            <div class="tab-content main-panel" id="threats-tab">
                <!-- Real-Time API Notice -->
                <div class="premium-card" style="background: rgba(34,211,238,0.1); border-left: 4px solid #22d3ee; margin-bottom: 20px;">
                    <div style="font-size: 15px; font-weight: 600; color: #22d3ee; margin-bottom: 8px;">ðŸ”´ LIVE THREAT INTELLIGENCE</div>
                    <div style="font-size: 14px; color: #fff; margin-bottom: 4px;">Real-time data from NVD (National Vulnerability Database) &amp; MITRE ATT&amp;CK</div>
                    <div style="font-size: 13px; color: rgba(255,255,255,0.7);">Last updated: <strong id="threat-update-time">Loading...</strong></div>
                    <button class="btn btn-secondary" onclick="refreshThreatIntel()" style="margin-top:12px; padding:8px 16px; font-size:13px;">ðŸ”„ Refresh Data</button>
                </div>

                <!-- Section 1: Critical CVEs from NVD -->
                <div class="premium-card" style="margin-bottom: 30px;">
                    <h2 style="margin-bottom: 10px; font-size: 22px; font-weight: 600; display: flex; align-items: center; gap: 8px;">
                        <span>ðŸ›</span> Critical CVEs &amp; Vulnerabilities (NVD)
                    </h2>
                    <p style="font-size: 14px; color: #ff4444; margin-bottom: 20px;">Real-time CVE data from National Vulnerability Database</p>
                    
                    <!-- Filter Bar -->
                    <div class="filter-bar" style="margin-bottom: 20px;">
                        <select class="form-select" id="nvd-severity-filter" onchange="filterNVDCVEs()" style="flex: 1;">
                            <option value="all">All Severities</option>
                            <option value="CRITICAL" selected="">Critical Only</option>
                            <option value="HIGH">High</option>
                            <option value="MEDIUM">Medium</option>
                        </select>
                        <select class="form-select" id="nvd-view-mode" onchange="updateCVEViewMode()" style="flex: 1;">
                            <option value="group" selected="">Group: Severity</option>
                            <option value="epss">Sort: EPSS (Highâ†’Low)</option>
                            <option value="cvss">Sort: CVSS (Highâ†’Low)</option>
                            <option value="newest">Sort: Newest</option>
                        </select>
                        <select class="form-select" id="nvd-group-sort" onchange="updateCVEViewMode()" style="flex: 1;">
                            <option value="cvss" selected="">Within-group: CVSS</option>
                            <option value="epss">Within-group: EPSS</option>
                            <option value="newest">Within-group: Newest</option>
                        </select>
                        <select class="form-select" id="nvd-epss-filter" onchange="updateCVEViewMode()" style="flex: 1;">
                            <option value="all" selected="">EPSS: All</option>
                            <option value="0.01">EPSS â‰¥ 1%</option>
                            <option value="0.1">EPSS â‰¥ 10%</option>
                            <option value="0.5">EPSS â‰¥ 50%</option>
                        </select>
                        <button class="btn btn-secondary" onclick="exportCVEReport()">ðŸ“„ Export PDF Report</button>
                    </div>

                    <div class="fix-first-card" id="fix-first-card">
                        <div class="fix-first-header">
                            <div class="fix-first-title">âš¡ Fix-First Queue (Top 5)</div>
                            <select class="form-select fix-first-mode" id="fix-first-mode" aria-label="Fix-first priority mode">
                                <option value="combined">Priority: Combined</option>
                                <option value="epss">Priority: EPSS only</option>
                                <option value="cvss">Priority: CVSS only</option>
                                <option value="kev">Priority: KEV only</option>
                            </select>
                        </div>
                        <div class="fix-first-list" id="fix-first-list"></div>
                    </div>

                    <div class="wide-layout">
                        <div class="main-col">
                            <div class="cve-grid nvd-grid" id="nvd-cve-grid"></div>
                        </div>
                        <div class="side-col">
                            <div class="epss-insights-card" id="epss-insights-card">
                                <h3 style="font-size: 16px; margin-bottom: 12px; color: #22d3ee;">ðŸ“Š EPSS Insights</h3>
                                <div class="epss-kpis">
                                    <div class="epss-kpi">
                                        <h4>Avg EPSS</h4>
                                        <span id="epss-avg">--</span>
                                    </div>
                                    <div class="epss-kpi">
                                        <h4>Max EPSS</h4>
                                        <span id="epss-max">--</span>
                                    </div>
                                    <div class="epss-kpi">
                                        <h4>â‰¥10%</h4>
                                        <span id="epss-10">--</span>
                                    </div>
                                    <div class="epss-kpi">
                                        <h4>â‰¥50%</h4>
                                        <span id="epss-50">--</span>
                                    </div>
                                </div>
                                <div style="font-size: 12px; color: rgba(255,255,255,0.6); margin-bottom: 6px;">EPSS Distribution</div>
                                <div class="mini-histogram" id="epss-histogram"></div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Section 2: Active Threat Actors from MITRE ATT&CK -->
                <div class="premium-card" style="margin-bottom: 30px;">
                    <h2 style="margin-bottom: 10px; font-size: 22px; font-weight: 600; display: flex; align-items: center; gap: 8px;">
                        <span>â˜ ï¸</span> Active Threat Actors (MITRE ATT&amp;CK)
                    </h2>
                    <p style="font-size: 14px; color: #ff4444; margin-bottom: 20px;">Real threat actor campaigns and techniques</p>
                    <div class="wide-layout">
                        <div class="side-col">
                            <div class="details-card" id="actor-details-card">
                                <h3>Actor Details</h3>
                                <p style="font-size: 13px; color: rgba(255,255,255,0.7); line-height: 1.6;">Select an actor to view techniques, tactics, and ATT&amp;CK references.</p>
                            </div>
                        </div>
                        <div class="main-col">
                            <div class="malware-grid" id="mitre-threat-actors-grid"></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Security Tools Tab -->
            <div class="tab-content main-panel" id="tools-tab">
                <div class="tools-grid">
                    <!-- Password Strength Analyzer -->
<div class="premium-card tool-card">
    <h3 style="margin-bottom: 16px; font-size: 18px; display: flex; align-items: center; gap: 8px;">
        <span>ðŸ”’</span> Password Strength Analyzer
    </h3>
    <div class="form-group">
        <input type="password" class="form-input" id="password-input" placeholder="Enter password to analyze" oninput="analyzePassword()">
    </div>
    <div id="password-result" class="hidden">
        <div class="strength-meter">
            <div class="strength-bar" id="strength-bar"></div>
        </div>
        <div class="strength-label" id="strength-label"></div>
        <div class="strength-details" id="strength-details"></div>
    </div>
    <p style="font-size: 12px; color: rgba(255,255,255,0.5); margin-top: 12px;">ðŸ” Privacy-first: Analysis happens in your browser</p>
</div>

<!-- Malicious URL Detector -->
<div class="premium-card tool-card">
    <h3 style="margin-bottom: 16px; font-size: 18px; display: flex; align-items: center; gap: 8px;">
        <span>ðŸŒ</span> Malicious URL Detector
    </h3>
    <div class="form-group">
        <input type="text" class="form-input" id="url-input" placeholder="https://example.com">
    </div>
    <button class="btn btn-primary btn-full" onclick="checkMaliciousURL()">Scan URL</button>
    <div id="url-result" class="hidden"></div>
</div>

<!-- Email Breach Checker -->
<div class="premium-card tool-card">
    <h3 style="margin-bottom: 16px; font-size: 18px; display: flex; align-items: center; gap: 8px;">
        <span>ðŸ“§</span> Email Breach Checker
    </h3>
    <div class="form-group">
        <input type="email" class="form-input" id="email-input" placeholder="your@email.com">
    </div>
    <button class="btn btn-primary btn-full" onclick="checkEmail()">Check Breaches</button>
    <div id="email-result" class="hidden"></div>
</div>

<!-- CVE Lookup Tool -->
<div class="premium-card tool-card">
    <h3 style="margin-bottom: 16px; font-size: 18px; display: flex; align-items: center; gap: 8px;">
        <span>ðŸ”</span> CVE Lookup Tool
    </h3>
    <div class="form-group">
        <input type="text" class="form-input" id="cve-input" placeholder="CVE-2025-12345 or software name">
    </div>
    <button class="btn btn-primary btn-full" onclick="lookupCVE()">Search CVE</button>
    <div id="cve-result" class="hidden"></div>
</div>

<!-- IP Reputation Checker -->
<div class="premium-card tool-card">
    <h3 style="margin-bottom: 16px; font-size: 18px; display: flex; align-items: center; gap: 8px;">
        <span>ðŸ“¡</span> IP Reputation Checker
    </h3>
    <div class="form-group">
        <input type="text" class="form-input" id="ip-input" placeholder="Enter IP address">
    </div>
    <button class="btn btn-primary btn-full" onclick="checkIPReputation(document.getElementById(&#39;ip-input&#39;).value)">Check IP</button>
    <div id="ip-result" class="hidden"></div>
</div>

<!-- Threat Intelligence Search (ThreatMiner) -->
<div class="premium-card tool-card">
    <h3 style="margin-bottom: 16px; font-size: 18px; display: flex; align-items: center; gap: 8px;">
        <span>ðŸ’¡</span> ThreatMiner Search
    </h3>
    <div class="form-group">
        <input type="text" class="form-input" id="threatminer-input" placeholder="File hash, domain, IP, or malware name">
    </div>
    <button class="btn btn-primary btn-full" onclick="threatMinerSearch(document.getElementById(&#39;threatminer-input&#39;).value)">ThreatMiner Search</button>
    <div id="threatminer-result" class="hidden"></div>
</div>

<!-- File Hash Analyzer (VirusTotal hash only) -->
<div class="premium-card tool-card">
    <h3 style="margin-bottom: 16px; font-size: 18px; display: flex; align-items: center; gap: 8px;">
        <span>ðŸ”</span> File Hash Analyzer
    </h3>
    <div class="form-group">
        <input type="text" class="form-input" id="hash-input" placeholder="SHA256 hash">
    </div>
    <button class="btn btn-primary btn-full" onclick="analyzeHash()">Analyze Hash</button>
    <div id="hash-result" class="hidden"></div>
</div>

<!-- (Optional) URL Safety Checker (PhishTank+URLhaus) --><!-- not implemented (complex cross-click/joint lookup) -->
<!-- To be implemented later securely. -->
                </div>
            </div>

            <!-- Learning Hub Tab -->
            <div class="tab-content main-panel" id="learning-tab">
                <!-- Learning Hub Sub-Navigation -->
                <div class="learning-hub-subtabs">
                    <button id="learning-news-btn" class="learning-subtab-btn active" data-subtab="news">ðŸ“° News</button>
                    <button id="learning-research-btn" class="learning-subtab-btn" data-subtab="research">ðŸ”¬ Research</button>
                    <button id="learning-youtube-btn" class="learning-subtab-btn" data-subtab="youtube">ðŸ“º YouTube</button>
                    <button id="learning-docs-btn" class="learning-subtab-btn" data-subtab="document">ðŸ“„ Documents</button>
                    <button id="learning-library-btn" class="learning-subtab-btn" data-subtab="library">ðŸ“‚ Library</button>
                    <button id="learning-databank-btn" class="learning-subtab-btn" data-subtab="databank">ðŸ“š Data Bank</button>
                </div>

                <!-- News Feed Sub-Tab -->
                <div class="learning-subtab learning-subpanel active" id="learning-news-content">
                    <div class="premium-card news-brief" id="news-brief">
                        <div class="news-brief-header">
                            <div>
                                <h3 style="margin-bottom: 6px; font-size: 20px;">Todayâ€™s Brief</h3>
                                <p style="font-size: 13px; color: rgba(255,255,255,0.7);">Top high-impact advisories, incidents, and vulnerabilities since your last visit.</p>
                            </div>
                            <div class="news-brief-meta" id="news-brief-updated">Updated --</div>
                        </div>
                        <div class="news-brief-grid">
                            <div class="news-brief-section" id="news-brief-priority-section">
                                <h4>Priority Alerts</h4>
                                <div id="news-brief-priority"></div>
                            </div>
                            <div class="news-brief-section" id="news-brief-cve-section">
                                <h4>Critical CVEs</h4>
                                <div id="news-brief-cves"></div>
                            </div>
                            <div class="news-brief-section" id="news-brief-incident-section">
                                <h4>Active Incidents</h4>
                                <div id="news-brief-incidents"></div>
                            </div>
                        </div>
                    </div>

                    <div class="premium-card news-controls">
                        <div class="news-category-tabs" id="news-category-tabs">
                            <button class="news-category-btn active" data-category="all">All</button>
                            <button class="news-category-btn" data-category="advisories">Advisories</button>
                            <button class="news-category-btn" data-category="breaches">Breaches/Ransomware</button>
                            <button class="news-category-btn" data-category="incidents">Incidents</button>
                            <button class="news-category-btn" data-category="vulns">Vulns</button>
                        </div>
                        <div class="news-filter-row">
                            <div>
                                <label class="form-label" for="news-severity-filter">Severity</label>
                                <select class="form-select" id="news-severity-filter">
                                    <option value="LOW">Low+</option>
                                    <option value="MEDIUM" selected>Medium+</option>
                                    <option value="HIGH">High+</option>
                                    <option value="CRITICAL">Critical</option>
                                </select>
                            </div>
                            <div>
                                <label class="form-label" for="news-time-filter">Time Range</label>
                                <select class="form-select" id="news-time-filter">
                                    <option value="24h">24h</option>
                                    <option value="7d" selected>7d</option>
                                    <option value="30d">30d</option>
                                </select>
                            </div>
                            <div>
                                <label class="form-label" for="news-search">Search</label>
                                <input class="news-search-input" id="news-search" type="text" placeholder="Search intel, CVEs, or vendors">
                            </div>
                        </div>
                    </div>

                    <div class="news-feed-meta" id="news-feed-meta">Loading intel feed...</div>
                    <div class="news-grid" id="news-grid"></div>
                    <div class="news-empty" id="news-empty" style="display:none;">No stories match your filters. Try widening the time range or severity.</div>
                    <button class="btn btn-secondary btn-full" onclick="refreshNewsFeed()">Refresh Feed</button>
                </div>

                <!-- Deep Research Sub-Tab -->
                <div class="learning-subtab learning-subpanel" id="learning-research-content">
                    <!-- API Key Configuration -->
                    <div class="premium-card" style="background: linear-gradient(135deg, rgba(34,211,238,0.1) 0%, rgba(255,165,0,0.1) 100%); border: 2px solid rgba(34,211,238,0.3);">
                        <h3 style="margin-bottom: 16px; font-size: 18px; display: flex; align-items: center; gap: 8px;">
                            <span>ðŸ”‘</span> Perplexity API Configuration
                        </h3>
                        <p style="font-size: 14px; color: rgba(255,255,255,0.75); margin-bottom: 12px;">
                            Perplexity is configured securely on the server. No manual key entry is required.
                        </p>
                        <button class="btn btn-secondary" onclick="testAPIKey()" style="padding: 8px 16px; font-size: 13px;">Test Connection</button>
                    </div>

                    <div class="premium-card">
                        <h2 style="margin-bottom: 24px; font-size: 24px;">ðŸ”¬ Deep Research Assistant</h2>
                        
                        <div class="form-group">
                            <label class="form-label">Research Topic</label>
                            <textarea class="form-textarea" id="research-topic" placeholder="Enter your GRC research question... (e.g., &#39;Compare NIST CSF 2.0 with ISO 27001:2022&#39;)" rows="4"></textarea>
                        </div>

                        <div class="form-group">
                            <label class="form-label">Research Depth</label>
                            <select class="form-select" id="research-depth">
                                <option value="summary">Summary - Quick Overview</option>
                                <option value="detailed" selected="">Detailed - Comprehensive Analysis</option>
                                <option value="expert">Expert - In-Depth Technical Review</option>
                            </select>
                        </div>

                        <button class="btn btn-primary btn-full" onclick="performResearch()">
                            <span>Start Research</span>
                        </button>

                        <div id="research-results" class="hidden"></div>
                        <div id="research-export-buttons" class="hidden" style="display: flex; gap: 12px; margin-top: 16px;">
                            <button class="btn btn-secondary" onclick="downloadAsPDF(&#39;research&#39;)" style="flex: 1;">
                                ðŸ“„ Download as PDF
                            </button>
                            <button class="btn btn-secondary" onclick="downloadAsWord(&#39;research&#39;)" style="flex: 1;">
                                ðŸ“ Download as Word
                            </button>
                            <button class="btn btn-secondary" onclick="copyToClipboard(&#39;research&#39;)" style="padding: 12px 20px;">
                                ðŸ“‹ Copy
                            </button>
                        </div>
                    </div>

                    <div class="tips-container">
                        <h4>ðŸ’¡ Popular Research Topics</h4>
                        <ul class="tips-list">
                            <li>NIST 800-53 Security Controls Implementation</li>
                            <li>ISO 27001 vs ISO 27002 Differences</li>
                            <li>Zero Trust Architecture Design</li>
                            <li>3 Lines of Defense Model</li>
                            <li>Risk Assessment Frameworks</li>
                            <li>Compliance Automation Strategies</li>
                            <li>Third-Party Risk Management</li>
                            <li>Incident Response Planning</li>
                        </ul>
                    </div>
                </div>

                <!-- YouTube Analyzer Sub-Tab -->
                <div class="learning-subtab learning-subpanel" id="learning-youtube-content">
                    <div class="premium-card">
                        <h2 style="margin-bottom: 24px; font-size: 24px;">ðŸ“º YouTube Video Analyzer</h2>
                        
                        <div class="form-group">
                            <label class="form-label">YouTube Video URL</label>
                            <input type="text" class="form-input" id="youtube-url" placeholder="https://www.youtube.com/watch?v=...">
                        </div>

                        <div class="form-group">
                            <label class="form-label">Analysis Type</label>
                            <select class="form-select" id="youtube-action">
                                <option value="summary">Summary - Key Takeaways</option>
                                <option value="quiz">Quiz - Test Your Understanding</option>
                                <option value="keypoints">Key Points - Detailed Breakdown</option>
                            </select>
                        </div>

                        <button class="btn btn-primary btn-full" onclick="analyzeYouTube()">
                            <span>Analyze Video</span>
                        </button>

                        <div id="youtube-results" class="hidden"></div>
                        <div id="youtube-export-buttons" class="hidden" style="display: flex; gap: 12px; margin-top: 16px;">
                            <button class="btn btn-secondary" onclick="downloadAsPDF(&#39;youtube&#39;)" style="flex: 1;">
                                ðŸ“„ Download as PDF
                            </button>
                            <button class="btn btn-secondary" onclick="downloadAsWord(&#39;youtube&#39;)" style="flex: 1;">
                                ðŸ“ Download as Word
                            </button>
                            <button class="btn btn-secondary" onclick="copyToClipboard(&#39;youtube&#39;)" style="padding: 12px 20px;">
                                ðŸ“‹ Copy
                            </button>
                        </div>
                    </div>

                    <div class="tips-container">
                        <h4>ðŸ’¡ Analysis Tips</h4>
                        <ul class="tips-list">
                            <li>Works with any cybersecurity or GRC video</li>
                            <li>Generate quizzes to test comprehension</li>
                            <li>Extract key timestamps and topics</li>
                            <li>Perfect for training and certification prep</li>
                        </ul>
                    </div>
                </div>

                <!-- Document Analyzer Sub-Tab -->
                <div class="learning-subtab learning-subpanel" id="learning-docs-content">
                    <div class="premium-card">
                        <h2 style="margin-bottom: 24px; font-size: 24px;">ðŸ“„ Document Analyzer</h2>
                        
                        <div class="file-upload-area" id="file-upload-area">
                            <div class="file-icon">ðŸ“</div>
                            <h3 style="margin-bottom: 8px;">Drop your document here</h3>
                            <p style="color: rgba(255, 255, 255, 0.6); font-size: 14px;">or click to browse</p>
                            <input type="file" id="file-input" accept=".pdf,.doc,.docx,.txt" style="display: none;">
                        </div>

                        <div id="file-info" class="hidden"></div>

                        <div class="form-group" style="margin-top: 24px;">
                            <label class="form-label">Analysis Action</label>
                            <select class="form-select" id="document-action">
                                <option value="summarize">Summarize - Executive Summary</option>
                                <option value="quiz">Quiz - Knowledge Check</option>
                                <option value="qa">Q&amp;A - Ask Questions</option>
                            </select>
                        </div>

                        <button class="btn btn-primary btn-full" onclick="analyzeDocument()" id="analyze-doc-btn" disabled="">
                            <span>Analyze Document</span>
                        </button>

                        <div id="document-results" class="hidden"></div>
                        <div id="document-export-buttons" class="hidden" style="display: flex; gap: 12px; margin-top: 16px;">
                            <button class="btn btn-secondary" onclick="downloadAsPDF(&#39;document&#39;)" style="flex: 1;">
                                ðŸ“„ Download as PDF
                            </button>
                            <button class="btn btn-secondary" onclick="downloadAsWord(&#39;document&#39;)" style="flex: 1;">
                                ðŸ“ Download as Word
                            </button>
                            <button class="btn btn-secondary" onclick="copyToClipboard(&#39;document&#39;)" style="padding: 12px 20px;">
                                ðŸ“‹ Copy
                            </button>
                            <button class="btn btn-secondary" onclick="pinDocumentSummary()" style="padding: 12px 20px;">
                                ðŸ“Œ Pin to Clipboard
                            </button>
                            <button class="btn btn-secondary" onclick="createDocumentCase()" style="padding: 12px 20px;">
                                ðŸ—‚ï¸ Create Case
                            </button>
                        </div>
                    </div>

                    <div class="tips-container">
                        <h4>ðŸ’¡ Document Tips</h4>
                        <ul class="tips-list">
                            <li>Supports PDF, Word, and text files</li>
                            <li>Generate executive summaries instantly</li>
                            <li>Create quizzes from policy documents</li>
                            <li>Ask specific questions about content</li>
                            <li>Perfect for compliance documentation review</li>
                        </ul>
                    </div>
                </div>

                <!-- Library Sub-Tab -->
                <div class="learning-subtab learning-subpanel" id="learning-library-content">
                    <div class="premium-card">
                        <h2 style="margin-bottom: 8px; font-size: 24px;">ðŸ“‚ Saved Library</h2>
                        <p style="font-size: 14px; color: rgba(255,255,255,0.7); margin-bottom: 16px;">
                            Collect research highlights, threat intel, and CVEs into a weekly brief.
                        </p>
                        <div class="library-toolbar">
                            <input type="text" class="form-input" id="library-search" placeholder="Search saved items (title, summary, tags)">
                            <div class="library-controls">
                                <select class="form-select" id="library-sort">
                                    <option value="saved">Newest saved</option>
                                    <option value="date">Date</option>
                                    <option value="type">Type</option>
                                </select>
                                <button class="library-action-btn" id="library-export" type="button">ðŸ“¤ Export Weekly Brief</button>
                            </div>
                        </div>
                        <div class="library-tag-filters" id="library-tag-filters"></div>
                        <div class="library-items" id="library-items"></div>
                        <div class="library-empty" id="library-empty">No saved items yet. Save from News/CVEs/Breaches.</div>
                    </div>
                </div>

                <!-- Data Bank Sub-Tab (Posture lives only under Learning Hub â†’ Data Bank) -->
                <div class="learning-subtab learning-subpanel" id="learning-databank-content">
                    <div class="premium-card">
                        <h2 style="margin-bottom: 20px; font-size: 24px; display: flex; align-items: center; gap: 8px;">
                            <span>ðŸ“š</span> Cybersecurity &amp; GRC Data Bank
                        </h2>
                        <div class="form-group" style="margin-bottom: 24px;">
                            <div class="databank-search-wrapper">
                                <input type="text" class="form-input" id="databank-search" placeholder="ðŸ”Ž Quick Search (e.g., NIST, Risk Matrix, Access Control ...)">
                                <div class="databank-search-results" id="databank-search-results" role="listbox" aria-label="Data Bank search results"></div>
                            </div>
                        </div>
                        <div class="databank-mini-rows">
                            <div class="databank-mini-row">
                                <div class="databank-mini-header">â­ Favorites</div>
                                <div class="databank-mini-list" id="databank-favorites"></div>
                                <div class="databank-mini-empty" id="databank-favorites-empty">No favorites yet. Star items to pin them here.</div>
                            </div>
                            <div class="databank-mini-row">
                                <div class="databank-mini-header">ðŸ•˜ Recently viewed</div>
                                <div class="databank-mini-list" id="databank-recent"></div>
                                <div class="databank-mini-empty" id="databank-recent-empty">Items you open will appear here.</div>
                            </div>
                        </div>
                        <div class="nav-tabs" style="position: static; top: auto; background: transparent; backdrop-filter: none; border: none; padding: 0; gap: 8px; margin-bottom: 18px;">
                            <button class="tab-btn active" data-databank="frameworks" onclick="switchDataBankSection(&#39;frameworks&#39;)">ðŸ›¡ï¸ Frameworks &amp; Standards</button>
                            <button class="tab-btn" data-databank="controls" onclick="switchDataBankSection(&#39;controls&#39;)">ðŸ”— Control Families</button>
                            <button class="tab-btn" data-databank="glossary" onclick="switchDataBankSection(&#39;glossary&#39;)">ðŸ“– Glossary</button>
                            <button class="tab-btn" data-databank="risk" onclick="switchDataBankSection(&#39;risk&#39;)">âš ï¸ Risk Matrices</button>
                            <button class="tab-btn" data-databank="posture" onclick="switchDataBankSection(&#39;posture&#39;)">ðŸ“Š Posture</button>
                            <button class="tab-btn" data-databank="guides" onclick="switchDataBankSection(&#39;guides&#39;)">ðŸ“ Implementation Guides</button>
                        </div>
                        <div id="databank-content"></div>
                    </div>
                </div>
            </div>

            <!-- Settings Tab -->
            <div class="tab-content main-panel" id="settings-tab">
                <div class="premium-card">
                    <h2 style="margin-bottom: 24px; font-size: 24px;">âš™ï¸ Settings &amp; API Keys</h2>
                    
                    <!-- API Key Management -->
                    <div class="settings-section">
                        <h3 style="font-size: 18px; margin-bottom: 16px; color: #22d3ee;">ðŸ”‘ API Key Management</h3>
                        <p style="font-size:14px; color:rgba(255,255,255,0.7); margin-bottom:20px;">API keys are managed securely. Free APIs are pre-configured in the backend.</p>
                        
                        <!-- FREE APIs (Display Only - Configured in Backend) -->
                        <div style="background: rgba(34,211,238,0.05); border: 1px solid rgba(34,211,238,0.2); border-radius: 10px; padding: 16px; margin-bottom: 24px;">
                            <h4 style="font-size: 16px; color: #22d3ee; margin-bottom: 12px;">âœ… Free APIs (Pre-Configured)</h4>
                            <p style="font-size: 13px; color: rgba(255,255,255,0.6); margin-bottom: 12px;">These are configured in the backend. No action needed.</p>
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 12px;">
                                <div style="display: flex; align-items: center; gap: 8px; font-size: 13px;">
                                    <span style="color: #00ff88;">âœ…</span>
                                    <span><strong>NVD API:</strong> Active</span>
                                </div>
                                <div style="display: flex; align-items: center; gap: 8px; font-size: 13px;">
                                    <span style="color: #00ff88;">âœ…</span>
                                    <span><strong>CISA KEV:</strong> Active</span>
                                </div>
                                <div style="display: flex; align-items: center; gap: 8px; font-size: 13px;">
                                    <span style="color: #00ff88;">âœ…</span>
                                    <span><strong>MITRE ATT&amp;CK:</strong> Active</span>
                                </div>
                                <div style="display: flex; align-items: center; gap: 8px; font-size: 13px;">
                                    <span style="color: #00ff88;">âœ…</span>
                                    <span><strong>ThreatMiner:</strong> Active</span>
                                </div>
                                <div style="display: flex; align-items: center; gap: 8px; font-size: 13px;">
                                    <span style="color: #00ff88;">âœ…</span>
                                    <span><strong>Breach Directory:</strong> Active</span>
                                </div>
                            </div>
                        </div>
                        
                        <!-- OPTIONAL User-Provided APIs -->
                        <div style="background: rgba(255,165,0,0.05); border: 1px solid rgba(255,165,0,0.2); border-radius: 10px; padding: 16px;">
                            <h4 style="font-size: 16px; color: #ff4444; margin-bottom: 12px;">âš™ï¸ Backend API Keys</h4>
                            <p style="font-size: 13px; color: rgba(255,255,255,0.6); margin-bottom: 16px;">All integrations are configured securely in Vercel. No user keys required.</p>
                            
                            <div style="margin-top: 16px; padding: 12px; background: rgba(34,211,238,0.1); border-radius: 8px; font-size: 13px; color: rgba(255,255,255,0.8);">
                                <strong>âœ… Backend API Keys Configured:</strong><br>
                                â€¢ Perplexity (Learning Hub)<br>
                                â€¢ NVD (Threat Intel &amp; CVE Lookup)<br>
                                â€¢ AbuseIPDB (IP Reputation)<br>
                                â€¢ VirusTotal (URL Scanner)<br>
                                â€¢ HIBP (Email Breach Checker)<br>
                                â€¢ All keys stored securely in Vercel environment variables
                            </div>
                        </div>
                    </div>
                    
                    <div class="settings-section">
                        <h3 style="font-size: 18px; margin-bottom: 16px;">Theme Preferences</h3>
                        <div class="form-group">
                            <label class="form-label">Color Scheme</label>
                            <select class="form-select" id="theme-select">
                                <option value="dark" selected="">Dark Mode (Default)</option>
                                <option value="light">Light Mode</option>
                                <option value="auto">Auto (System)</option>
                            </select>
                        </div>
                    </div>

                    <div class="settings-section">
                        <h3 style="font-size: 18px; margin-bottom: 16px;">Notification Settings</h3>
                        <div class="form-group">
                            <label style="display: flex; align-items: center; gap: 12px; cursor: pointer;">
                                <input type="checkbox" checked="" style="width: 20px; height: 20px;">
                                <span>Critical CVE Alerts</span>
                            </label>
                        </div>
                        <div class="form-group">
                            <label style="display: flex; align-items: center; gap: 12px; cursor: pointer;">
                                <input type="checkbox" checked="" style="width: 20px; height: 20px;">
                                <span>Data Breach Notifications</span>
                            </label>
                        </div>
                        <div class="form-group">
                            <label style="display: flex; align-items: center; gap: 12px; cursor: pointer;">
                                <input type="checkbox" style="width: 20px; height: 20px;">
                                <span>Daily Security Digest</span>
                            </label>
                        </div>
                    </div>

                    <div class="settings-section">
                        <h3 style="font-size: 18px; margin-bottom: 16px;">Data Privacy</h3>
                        <div class="form-group">
                            <label style="display: flex; align-items: center; gap: 12px; cursor: pointer;">
                                <input type="checkbox" checked="" disabled="" style="width: 20px; height: 20px;">
                                <span>Local Processing Only (All analysis happens in-browser)</span>
                            </label>
                        </div>
                        <div class="form-group">
                            <label style="display: flex; align-items: center; gap: 12px; cursor: pointer;">
                                <input type="checkbox" style="width: 20px; height: 20px;">
                                <span>Anonymous Usage Statistics</span>
                            </label>
                        </div>
                    </div>

                    <div class="settings-section">
                        <h3 style="font-size: 18px; margin-bottom: 16px;">About &amp; Deployment Guide</h3>
                        <p style="color: rgba(255,255,255,0.7); line-height: 1.6;">
                            <strong>CyberSec Command</strong> v3.0 - Production Ready with Real APIs<br>
                            Enterprise-grade cybersecurity intelligence platform<br>
                            Built for security professionals and analysts<br><br>
                            <strong>Integrated APIs (All Free Tier):</strong><br>
                            âœ“ <strong>CISA KEV</strong> - Known Exploited Vulnerabilities (No key required)<br>
                            âœ“ <strong>NVD</strong> - National Vulnerability Database (Server key supported)<br>
                            âœ“ <strong>MITRE ATT&amp;CK</strong> - Threat actor intelligence (No key required)<br>
                            âœ“ <strong>VirusTotal</strong> - URL scanning (Server key required)<br>
                            âœ“ <strong>AbuseIPDB</strong> - IP reputation (Server key required)<br>
                            âœ“ <strong>ThreatMiner</strong> - Threat intelligence (No key required)<br>
                            âœ“ <strong>HIBP</strong> - Email breach checker (Server key required)<br>
                            âœ“ <strong>Perplexity AI</strong> - Deep research (Server key required)<br><br>
                            <strong>Status:</strong> All APIs real-time, zero placeholders<br>
                            <strong>Security:</strong> All backend keys hidden in Vercel environment variables<br><br>
                            Â© 2025 All rights reserved
                        </p>
                        
                        <!-- Deployment Instructions -->
                        <details style="margin-top: 20px; background: rgba(34,211,238,0.05); border: 1px solid rgba(34,211,238,0.2); border-radius: 10px; padding: 16px;">
                            <summary style="font-size: 16px; font-weight: 600; color: #22d3ee; cursor: pointer; margin-bottom: 12px;">
                                ðŸš€ Deployment Instructions (Click to Expand)
                            </summary>
                            <div style="font-size: 14px; color: rgba(255,255,255,0.8); line-height: 1.8; margin-top: 12px;">
                                <strong style="color: #ff4444;">STEP 1: Create Vercel Project</strong><br>
                                1. Sign up at <a href="https://vercel.com/" target="_blank" style="color: #22d3ee;">vercel.com</a> (free tier)<br>
                                2. Create new project<br>
                                3. Connect to GitHub or upload files<br><br>
                                
                                <strong style="color: #ff4444;">STEP 2: File Structure</strong><br>
                                Create this structure in your project:<br>
                                <code style="display: block; background: rgba(0,0,0,0.3); padding: 12px; border-radius: 6px; margin: 8px 0; font-family: monospace; font-size: 12px;">
                                /<br>
                                â”œâ”€â”€ index.html (this file)<br>
                                â”œâ”€â”€ api/<br>
                                â”‚   â”œâ”€â”€ breaches.js<br>
                                â”‚   â”œâ”€â”€ check-ip.js<br>
                                â”‚   â”œâ”€â”€ cisa-kev.js<br>
                                â”‚   â”œâ”€â”€ nvd-cves.js<br>
                                â”‚   â”œâ”€â”€ nvd-lookup.js<br>
                                â”‚   â”œâ”€â”€ perplexity.js<br>
                                â”‚   â”œâ”€â”€ scan-url.js<br>
                                â”‚   â””â”€â”€ hibp-check.js
                                </code><br>
                                
                                <strong style="color: #ff4444;">STEP 3: Copy Backend Functions</strong><br>
                                From the app.js file provided, copy each function section into separate files.<br>
                                Example: Copy the entire "// ========== /api/nvd-cves.js ==========" section â†’ Save as /api/nvd-cves.js<br><br>
                                
                                <strong style="color: #ff4444;">STEP 4: Set Environment Variables</strong><br>
                                In Vercel Dashboard â†’ Settings â†’ Environment Variables:<br>
                                - <strong>PERPLEXITY_API_KEY</strong> (Required for Learning Hub AI features)<br>
                                - <strong>NVD_API_KEY</strong> (Optional - Get from <a href="https://nvd.nist.gov/developers/request-an-api-key" target="_blank" style="color: #22d3ee;">nvd.nist.gov</a>)<br>
                                  Without key: 5 requests/30s | With key: 50 requests/30s<br>
                                - <strong>ABUSEIPDB_API_KEY</strong> (Required for IP reputation checks)<br>
                                - <strong>VIRUSTOTAL_API_KEY</strong> (Required for URL scanning)<br>
                                - <strong>HIBP_API_KEY</strong> (Required for email breach checks)<br><br>
                                
                                <strong style="color: #ff4444;">STEP 5: Deploy</strong><br>
                                1. Push to Vercel<br>
                                2. Deploy completes automatically<br>
                                3. Your app is live!<br><br>
                                
                                <strong style="color: #ff4444;">STEP 6: Test</strong><br>
                                1. Open Threat Intel tab<br>
                                2. Data should load automatically from real APIs<br>
                                3. Check Settings tab for API status<br><br>
                                
                                <strong style="color: #00ff88;">âœ“ NO Keys Visible to Users</strong><br>
                                <strong style="color: #00ff88;">âœ“ All Backend Keys Secure</strong><br>
                                <strong style="color: #00ff88;">âœ“ Zero Configuration for Most Features</strong><br>
                            </div>
                        </details>
                    </div>
                </div>
            </div>

            <!-- Old tabs removed - now part of Learning Hub sub-tabs -->
            <div class="tab-content hidden" id="research-tab-old">
                <div class="premium-card">
                    <h2 style="margin-bottom: 24px; font-size: 24px;">Deep Research Assistant</h2>
                    
                    <div class="form-group">
                        <label class="form-label">Research Topic</label>
                        <textarea class="form-textarea" id="research-topic" placeholder="Enter your GRC research question... (e.g., &#39;Compare NIST CSF 2.0 with ISO 27001:2022&#39;)" rows="4"></textarea>
                    </div>

                    <div class="form-group">
                        <label class="form-label">Research Depth</label>
                        <select class="form-select" id="research-depth">
                            <option value="summary">Summary - Quick Overview</option>
                            <option value="detailed" selected="">Detailed - Comprehensive Analysis</option>
                            <option value="expert">Expert - In-Depth Technical Review</option>
                        </select>
                    </div>

                    <button class="btn btn-primary btn-full" onclick="performResearch()">
                        <span>Start Research</span>
                    </button>

                    <div id="research-results" class="hidden"></div>
                </div>

                <div class="tips-container">
                    <h4>ðŸ’¡ Research Tips</h4>
                    <ul class="tips-list">
                        <li>Be specific with your question</li>
                        <li>Include context from your security role</li>
                        <li>Ask for real-world examples</li>
                        <li>Request framework comparisons</li>
                        <li>Explore implementation timelines</li>
                        <li>Discuss threat mitigation strategies</li>
                    </ul>
                </div>
            </div>

            <div class="tab-content hidden" id="youtube-tab-old">
                <div class="premium-card">
                    <h2 style="margin-bottom: 24px; font-size: 24px;">YouTube Video Analyzer</h2>
                    
                    <div class="form-group">
                        <label class="form-label">YouTube Video URL</label>
                        <input type="text" class="form-input" id="youtube-url" placeholder="https://www.youtube.com/watch?v=...">
                    </div>

                    <div class="form-group">
                        <label class="form-label">Analysis Type</label>
                        <select class="form-select" id="youtube-action">
                            <option value="summary">Summary - Key Takeaways</option>
                            <option value="quiz">Quiz - Test Your Understanding</option>
                            <option value="keypoints">Key Points - Detailed Breakdown</option>
                        </select>
                    </div>

                    <button class="btn btn-primary btn-full" onclick="analyzeYouTube()">
                        <span>Analyze Video</span>
                    </button>

                    <div id="youtube-results" class="hidden"></div>
                </div>
            </div>

            <div class="tab-content hidden" id="document-tab-old">
                <div class="premium-card">
                    <h2 style="margin-bottom: 24px; font-size: 24px;">Document Analyzer</h2>
                    
                    <div class="file-upload-area" id="file-upload-area">
                        <div class="file-icon">ðŸ“</div>
                        <h3 style="margin-bottom: 8px;">Drop your document here</h3>
                        <p style="color: rgba(255, 255, 255, 0.6); font-size: 14px;">or click to browse</p>
                        <input type="file" id="file-input" accept=".pdf,.doc,.docx,.txt" style="display: none;">
                    </div>

                    <div id="file-info" class="hidden"></div>

                    <div class="form-group" style="margin-top: 24px;">
                        <label class="form-label">Analysis Action</label>
                        <select class="form-select" id="document-action">
                            <option value="summarize">Summarize - Executive Summary</option>
                            <option value="quiz">Quiz - Knowledge Check</option>
                            <option value="qa">Q&amp;A - Ask Questions</option>
                        </select>
                    </div>

                    <button class="btn btn-primary btn-full" onclick="analyzeDocument()" id="analyze-doc-btn" disabled="">
                        <span>Analyze Document</span>
                    </button>

                    <div id="document-results" class="hidden"></div>
                </div>
            </div>

        </main>
        <aside class="clipboard-panel" id="clipboard-panel" aria-live="polite">
            <div class="clipboard-header">
                <div class="clipboard-title-row">
                    <div class="clipboard-title">Investigation Clipboard</div>
                    <div class="clipboard-title-actions">
                        <span class="clipboard-count" id="clipboard-count">0 pinned</span>
                        <button class="clipboard-collapse-toggle" id="clipboard-collapse-toggle" type="button" aria-expanded="true">Collapse</button>
                    </div>
                </div>
                <div class="clipboard-actions">
                    <button class="clipboard-action-btn" type="button" data-clipboard-action="export">Export</button>
                    <button class="clipboard-action-btn" type="button" data-clipboard-action="clear-closed">Clear Closed</button>
                </div>
            </div>
            <button class="clipboard-collapsed-pill" id="clipboard-collapsed-pill" type="button" aria-label="Expand clipboard">
                Clipboard Â· <span class="clipboard-collapsed-count" id="clipboard-collapsed-count">0</span>
            </button>
            <div class="clipboard-body" id="clipboard-panel-body"></div>
        </aside>
        </div>
    </div>

    <div class="modal-backdrop" id="actor-detail-modal" aria-hidden="true">
        <div class="modal" role="dialog" aria-modal="true" aria-labelledby="actor-detail-modal-title">
            <div class="modal-header">
                <h3 id="actor-detail-modal-title" style="font-size: 18px; color: #22d3ee;">Actor Details</h3>
                <button class="modal-close" type="button" aria-label="Close actor details">Close</button>
            </div>
            <div id="actor-detail-modal-body"></div>
        </div>
    </div>

    <div class="modal-backdrop" id="databank-detail-modal" aria-hidden="true">
        <div class="modal databank-modal" role="dialog" aria-modal="true" aria-labelledby="databank-detail-modal-title">
            <div class="modal-header">
                <h3 id="databank-detail-modal-title" style="font-size: 18px; color: #22d3ee;">Data Bank Details</h3>
                <button class="modal-close" type="button" aria-label="Close databank details">Close</button>
            </div>
            <div id="databank-detail-modal-body"></div>
        </div>
    </div>

    <div class="modal-backdrop" id="risk-register-modal" aria-hidden="true">
        <div class="modal" role="dialog" aria-modal="true" aria-labelledby="risk-register-modal-title">
            <div class="modal-header">
                <h3 id="risk-register-modal-title" style="font-size: 18px; color: #ffb020;">Risk Register Entry</h3>
                <button class="modal-close" type="button" aria-label="Close risk register">Close</button>
            </div>
            <form id="risk-register-form">
                <input type="hidden" id="risk-id">
                <div class="form-group">
                    <label for="risk-title">Title *</label>
                    <input class="form-input" id="risk-title" type="text" required>
                </div>
                <div class="form-group">
                    <label for="risk-description">Description</label>
                    <textarea class="form-input" id="risk-description" rows="3"></textarea>
                </div>
                <div class="risk-modal-grid">
                    <div class="form-group">
                        <label for="risk-category">Category</label>
                        <select class="form-input" id="risk-category">
                            <option>Security</option>
                            <option>Compliance</option>
                            <option>Vendor</option>
                            <option>Cloud</option>
                            <option>AppSec</option>
                            <option>Other</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="risk-likelihood">Likelihood</label>
                        <select class="form-input" id="risk-likelihood"></select>
                    </div>
                    <div class="form-group">
                        <label for="risk-impact">Impact</label>
                        <select class="form-input" id="risk-impact"></select>
                    </div>
                    <div class="form-group">
                        <label>Risk Rating</label>
                        <div class="risk-rating-preview" id="risk-rating-preview"></div>
                    </div>
                </div>
                <div class="risk-modal-grid">
                    <div class="form-group">
                        <label for="risk-treatment">Treatment</label>
                        <select class="form-input" id="risk-treatment">
                            <option>Mitigate</option>
                            <option>Transfer</option>
                            <option>Accept</option>
                            <option>Avoid</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="risk-owner">Owner</label>
                        <input class="form-input" id="risk-owner" type="text">
                    </div>
                    <div class="form-group">
                        <label for="risk-due">Due date</label>
                        <input class="form-input" id="risk-due" type="date">
                    </div>
                    <div class="form-group">
                        <label for="risk-status">Status</label>
                        <select class="form-input" id="risk-status">
                            <option>Open</option>
                            <option>In Progress</option>
                            <option>Closed</option>
                        </select>
                    </div>
                </div>
                <div class="risk-controls-section">
                    <div class="risk-controls-header">
                        <div>
                            <h4 style="margin-bottom:4px; color:#ffb020;">Mitigating Controls</h4>
                            <div style="font-size:12px; color: rgba(255,255,255,0.65);">Map the risk to control families or specific controls to track treatment progress.</div>
                        </div>
                        <div class="risk-controls-actions">
                            <button class="library-action-btn" type="button" data-risk-control-suggest="true">Auto-suggest controls</button>
                            <button class="library-action-btn" type="button" data-risk-control-clear="true">Clear mappings</button>
                        </div>
                    </div>
                    <div class="risk-controls-search">
                        <input class="form-input" id="risk-control-search" type="text" placeholder="Search control families or specific controls (e.g., Access Control, MFA, AU-2)">
                        <div class="risk-controls-suggestions" id="risk-control-suggestions"></div>
                    </div>
                    <div class="risk-controls-auto" id="risk-control-auto"></div>
                    <div class="mapped-controls-list" id="risk-control-list"></div>
                    <div class="form-group" style="margin-top:10px;">
                        <label for="risk-treatment-notes">Treatment Plan Notes</label>
                        <textarea class="form-input" id="risk-treatment-notes" rows="3" placeholder="Add tracking notes, mitigation plans, or evidence pointers."></textarea>
                    </div>
                </div>
                <div class="form-group">
                    <label for="risk-notes">Notes</label>
                    <textarea class="form-input" id="risk-notes" rows="3"></textarea>
                </div>
                <div style="display:flex; justify-content: space-between; align-items: center; gap: 10px; flex-wrap: wrap;">
                    <button class="btn btn-primary" type="submit">Save Risk</button>
                    <button class="btn btn-danger" type="button" id="risk-delete-btn" style="display:none;">Delete Risk</button>
                </div>
            </form>
        </div>
    </div>

    <div class="modal-backdrop" id="risk-treatment-modal" aria-hidden="true">
        <div class="modal risk-treatment-modal" role="dialog" aria-modal="true" aria-labelledby="risk-treatment-modal-title">
            <div class="modal-header">
                <h3 id="risk-treatment-modal-title" style="font-size: 18px; color: #ffb020;">Risk Treatment Plan</h3>
                <button class="modal-close" type="button" aria-label="Close risk treatment plan">Close</button>
            </div>
            <div class="modal-body" id="risk-treatment-modal-body"></div>
        </div>
    </div>

    <div class="modal-backdrop" id="checklist-modal" aria-hidden="true">
        <div class="modal" role="dialog" aria-modal="true" aria-labelledby="checklist-modal-title">
            <div class="modal-header">
                <h3 id="checklist-modal-title" style="font-size: 18px; color: #22d3ee;">Implementation Checklist</h3>
                <button class="modal-close" type="button" aria-label="Close checklist">Close</button>
            </div>
            <div id="checklist-modal-body"></div>
        </div>
    </div>

    <button class="clipboard-fab" id="clipboard-fab" type="button">
        ðŸ“Œ Clipboard <span class="clipboard-count" id="clipboard-fab-count">0</span>
    </button>

    <div class="modal-backdrop clipboard-modal-backdrop" id="clipboard-modal" aria-hidden="true">
        <div class="modal clipboard-modal" role="dialog" aria-modal="true" aria-labelledby="clipboard-modal-title">
            <div class="modal-header">
                <div>
                    <h3 id="clipboard-modal-title" style="font-size: 18px; color: #22d3ee;">Investigation Clipboard</h3>
                    <span class="clipboard-count" id="clipboard-modal-count">0 items</span>
                </div>
                <button class="modal-close" type="button" aria-label="Close clipboard">Ã—</button>
            </div>
            <div class="clipboard-body" id="clipboard-modal-body"></div>
            <div class="clipboard-footer">
                <button class="clipboard-action-btn" type="button" data-clipboard-action="export">Export</button>
                <button class="clipboard-action-btn" type="button" data-clipboard-action="clear-closed">Clear Closed</button>
            </div>
        </div>
    </div>

    <div class="toast-container" id="toast-container" aria-live="polite"></div>

    <script>
        // App State
        const appState = {
            currentTab: 'dashboard',
            uploadedFile: null,
            documentText: '',
            lastResults: {
                research: null,
                youtube: null,
                document: null
            }
        };

        const mitreDataUrl = 'https://raw.githubusercontent.com/mitre/cti/master/enterprise-attack/enterprise-attack.json';
        let mitreDataCache = null;
        let mitreDataPromise = null;
        let actorCardListenerBound = false;
        let threatActorsCache = null;

        const mitreIndexes = {
            techniqueById: new Map(),
            techniqueDetailsById: new Map(),
            actorById: new Map(),
            relationshipsUses: [],
            actorToTechniques: new Map(),
            ready: false
        };

        // Perplexity API Integration (server-side proxy)
        const PERPLEXITY_API_ENDPOINT = '/api/perplexity';
        const FEED_ENDPOINTS = {
            advisories: '/api/feeds?type=advisories',
            status: '/api/feeds?type=status',
            osv: (ecosystem, days) => `/api/feeds?type=osv&ecosystem=${encodeURIComponent(ecosystem)}&days=${encodeURIComponent(days)}`
        };

        // Load saved API key on init (no-op: keys are managed in Vercel)
        function loadSavedAPIKey() {
            return;
        }

        // Test API Connection
        async function testAPIKey() {
            const btn = event.target;

            btn.innerHTML = '<span class="spinner"></span> Testing...';
            btn.classList.add('loading');

            try {
                const response = await callPerplexityAPI('Test connection');
                if (response) {
                    alert('âœ“ Connection successful! You can now use all research features.');
                } else {
                    alert('âœ— Connection test failed. Please check the server configuration.');
                }
            } catch (error) {
                alert('âœ— Error: ' + error.message);
            } finally {
                btn.innerHTML = 'Test Connection';
                btn.classList.remove('loading');
            }
        }

        // Call Perplexity API
        async function callPerplexityAPI(query) {
            try {
                const response = await fetch(PERPLEXITY_API_ENDPOINT, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ query })
                });

                if (!response.ok) {
                    const errorData = await response.json().catch(() => ({}));
                    throw new Error(`API Error: ${response.status} - ${errorData.error || 'Unknown error'}`);
                }

                const data = await response.json();
                return data.content;
            } catch (error) {
                console.error('Perplexity API Error:', error);
                throw error;
            }
        }

        // CVE Data
        const cveData = [
            { id: 'CVE-2025-33053', title: 'Microsoft WebDAV RCE Zero-Day', cvss: 9.8, severity: 'Critical', affected: 'Windows Server', date: 'Jun 10, 2025', status: 'Actively Exploited' },
            { id: 'CVE-2025-53783', title: 'Microsoft Teams Buffer Overflow', cvss: 8.8, severity: 'High', affected: 'Microsoft Teams', date: 'Aug 12, 2025', status: 'Patched' },
            { id: 'CVE-2025-3464', title: 'ASUS Armoury Crate Kernel Driver', cvss: 8.4, severity: 'High', affected: 'ASUS Systems', date: 'Jun 16, 2025', status: 'Exploited' },
            { id: 'CVE-2025-54911', title: 'Windows BitLocker Privilege Escalation', cvss: 7.5, severity: 'High', affected: 'Windows Systems', date: 'Sep 9, 2025', status: 'Exploited' },
            { id: 'CVE-2025-4123', title: 'Grafana Open Redirect', cvss: 7.2, severity: 'High', affected: 'Grafana 46K+ instances', date: 'Jun 15, 2025', status: 'Unpatched' }
        ];

        // Breach Data
        const breachData = [
            { org: 'Qantas Airways', records: '5.7M', date: 'Oct 11, 2025', type: 'Customer Data', status: 'Active', industry: 'Aviation' },
            { org: 'Red Hat', records: '570GB', date: 'Oct 15, 2025', type: 'Source Code & Credentials', status: 'Active', industry: 'Software' },
            { org: 'TransUnion', records: '4.4M', date: 'Jul 30, 2025', type: 'Personal Information', status: 'Active', industry: 'Financial' },
            { org: 'Google/Salesforce', records: '2.5B', date: 'Aug 15, 2025', type: 'Email Accounts', status: 'Active', industry: 'Technology' },
            { org: 'Infostealer Log', records: '183M', date: 'Oct 21, 2025', type: 'Credentials', status: 'Active', industry: 'Multiple' }
        ];

        // Malware Data
        const malwareData = [
            { name: 'Scattered Spider', type: 'APT/Crime Syndicate', status: 'Active', targets: '39 Organizations', regions: 'Global' },
            { name: 'Lapsus$', type: 'Cyber Extortion', status: 'Active', targets: 'Multiple Fortune 500', regions: 'North America, Europe' },
            { name: 'Crimson Collective', type: 'Ransomware/Extortion', status: 'Active', targets: 'Healthcare & Finance', regions: 'Global' },
            { name: 'ShinyHunters', type: 'Data Theft', status: 'Active', targets: 'E-commerce & SaaS', regions: 'Global' }
        ];

        // News Data (fallback list)
        const newsFallbackItems = [
            {
                id: 'fallback-1',
                title: 'CISA issues alert on active exploitation of enterprise VPNs',
                url: 'https://www.cisa.gov/news-events/alerts',
                dateISO: new Date().toISOString(),
                sourceName: 'CISA',
                sourceType: 'official',
                summary: 'CISA warns of active exploitation affecting multiple VPN vendors; apply patches and update MFA policies.',
                tags: ['advisory', 'vulnerability'],
                severity: 'HIGH',
                cves: []
            },
            {
                id: 'fallback-2',
                title: 'Major ransomware group targets healthcare providers',
                url: 'https://www.bleepingcomputer.com/feed/',
                dateISO: new Date().toISOString(),
                sourceName: 'BleepingComputer',
                sourceType: 'news',
                summary: 'Campaign highlights credential theft and lateral movement techniques; review segmentation and backups.',
                tags: ['ransomware', 'breach'],
                severity: 'HIGH',
                cves: []
            },
            {
                id: 'fallback-3',
                title: 'Cloud service incident impacts auth workflows',
                url: 'https://status.cloud.google.com/incidents.rss',
                dateISO: new Date().toISOString(),
                sourceName: 'Google Cloud Status',
                sourceType: 'status',
                summary: 'Service degradation reported in identity services; monitor status page and update incident comms.',
                tags: ['incident'],
                severity: 'MEDIUM',
                cves: []
            }
        ];

        const newsSeverityRank = { LOW: 1, MEDIUM: 2, HIGH: 3, CRITICAL: 4 };
        const newsState = {
            items: [],
            filtered: [],
            category: 'all',
            severity: 'MEDIUM',
            timeRange: '7d',
            search: ''
        };
        const newsLastVisitKey = 'news_last_visit_v1';

        async function fetchLatestNews() {
            const newsGrid = document.getElementById('news-grid');
            if (newsGrid) {
                newsGrid.innerHTML = '<div style="text-align:center; padding:40px; color:#22d3ee;"><span class="spinner" style="width:32px; height:32px;"></span><br><br>Loading intel feed...</div>';
            }
            try {
                const res = await fetch('/api/news');
                if (!res.ok) {
                    newsState.items = [...newsFallbackItems];
                    return;
                }
                const data = await res.json();
                const incoming = Array.isArray(data.items) ? data.items : [];
                newsState.items = incoming.length ? incoming.map(normalizeNewsItem) : [...newsFallbackItems];
            } catch (error) {
                console.warn('News fetch failed, using fallback.', error);
                newsState.items = [...newsFallbackItems];
            }
        }

        function normalizeNewsItem(item) {
            return {
                id: item.id || `news-${Math.random().toString(36).slice(2)}`,
                title: item.title || 'Security update',
                url: item.url || item.link || '#',
                dateISO: item.dateISO || new Date().toISOString(),
                sourceName: item.sourceName || item.source || 'Unknown',
                sourceType: item.sourceType || 'news',
                summary: item.summary || item.description || '',
                tags: item.tags || [],
                severity: item.severity || 'LOW',
                cves: item.cves || [],
                clusterItems: item.clusterItems || []
            };
        }

        function getLastVisitTimestamp() {
            const raw = localStorage.getItem(newsLastVisitKey);
            const value = Number(raw);
            return Number.isNaN(value) ? null : value;
        }

        function setLastVisitTimestamp() {
            localStorage.setItem(newsLastVisitKey, String(Date.now()));
        }

        function formatNewsDate(iso) {
            if (!iso) return 'Recent';
            const date = new Date(iso);
            if (Number.isNaN(date.getTime())) return 'Recent';
            return date.toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' });
        }

        function isWithinRange(dateISO, range) {
            const value = new Date(dateISO).getTime();
            if (Number.isNaN(value)) return false;
            const now = Date.now();
            const ranges = { '24h': 1, '7d': 7, '30d': 30 };
            const days = ranges[range] || 7;
            return value >= now - days * 24 * 60 * 60 * 1000;
        }

        function matchesCategory(item, category) {
            if (category === 'all') return true;
            if (category === 'advisories') return item.sourceType === 'official' || item.tags.includes('advisory');
            if (category === 'breaches') return item.tags.includes('breach') || item.tags.includes('ransomware');
            if (category === 'incidents') return item.sourceType === 'status' || item.tags.includes('incident');
            if (category === 'vulns') return item.tags.includes('vulnerability') || item.cves.length > 0;
            return true;
        }

        function matchesSearch(item, query) {
            if (!query) return true;
            const haystack = [item.title, item.summary, item.sourceName, ...(item.tags || []), ...(item.cves || [])]
                .join(' ')
                .toLowerCase();
            return haystack.includes(query);
        }

        function applyNewsFilters() {
            const minSeverity = newsSeverityRank[newsState.severity] || 1;
            const query = newsState.search.trim().toLowerCase();
            const filtered = newsState.items.filter(item => {
                const itemSeverity = newsSeverityRank[item.severity] || 1;
                return itemSeverity >= minSeverity &&
                    isWithinRange(item.dateISO, newsState.timeRange) &&
                    matchesCategory(item, newsState.category) &&
                    matchesSearch(item, query);
            });
            newsState.filtered = filtered;
        }

        // Initialize App
        function initApp() {
            renderNews();
            setupNewsFilters();
            setupTabNavigation();
            setupFileUpload();
            setupDocumentAnalyzerEnhancements();
            renderBreaches();
            setupLearningHubTabs();
            setupLibrary();
            setupActorDetailModal();
            setupDataBank();
            setupPostureDashboard();
            renderPostureDashboard();
        }
        
        // Load Threat Intel data when user opens Threat Intel tab
        function setupTabNavigation() {
            // Bind only main tabs (data-tab) to prevent Data Bank sub-tabs from leaking across pages.
            const tabButtons = document.querySelectorAll('.tab-btn[data-tab]');
            const tabContents = document.querySelectorAll('.main-panel');
            const learningSubpanels = document.querySelectorAll('.learning-subpanel');
            const databankRoot = document.getElementById('learning-databank-content');

            tabButtons.forEach(btn => {
                btn.addEventListener('click', () => {
                    const tabName = btn.dataset.tab;
                    
                    // Update active states
                    tabButtons.forEach(b => b.classList.remove('active'));
                    btn.classList.add('active');
                    
                    tabContents.forEach(content => {
                        content.classList.remove('active');
                    });

                    const targetPanel = document.getElementById(`${tabName}-tab`);
                    if (targetPanel) {
                        targetPanel.classList.add('active');
                    }
                    appState.currentTab = tabName;

                    if (tabName !== 'learning') {
                        learningSubpanels.forEach(panel => {
                            panel.classList.remove('active');
                            panel.style.display = 'none';
                        });
                    } else {
                        learningSubpanels.forEach(panel => {
                            panel.style.display = '';
                        });
                        const activeButton = document.querySelector('.learning-subtab-btn.active');
                        const subtab = activeButton?.dataset?.subtab || 'news';
                        activateLearningSubTab(subtab);
                    }

                    if (tabName !== 'learning' && databankRoot) {
                        databankRoot.classList.remove('active');
                        databankRoot.style.display = 'none';
                    }
                    
                    // Load threat intel data when tab is opened
                    if (tabName === 'threats') {
                        loadNVDCVEs();
                        loadMITREThreatActors();
                    }
                });
            });
        }

        // Load NVD CVEs from backend API
        let nvdCVEsCache = [];
        const epssCacheKey = 'epss_cache_v1';
        const epssCacheTtl = 43200000;
        const cveViewStorageKey = 'nvd_view_mode_v1';
        const cveGroupSortStorageKey = 'nvd_group_sort_v1';
        const cveEpssFilterStorageKey = 'nvd_epss_filter_v1';
        
        async function loadNVDCVEs() {
            const grid = document.getElementById('nvd-cve-grid');
            const updateTime = document.getElementById('threat-update-time');
            if (!grid) return;
            
            grid.innerHTML = '<div style="text-align:center; padding:40px; color:#22d3ee;"><span class="spinner" style="width:32px; height:32px;"></span><br><br>Loading real-time CVE data from NVD...</div>';
            
            try {
                const response = await fetch('/api/nvd-cves?days=7&severity=CRITICAL');
                
                if (!response.ok) throw new Error('NVD API rate limit reached. Try again in a few minutes.');
                const data = await response.json();
                
                if (!data.vulnerabilities || data.vulnerabilities.length === 0) {
                    grid.innerHTML = '<div style="text-align:center; padding:40px; color:#ff4444;">No critical CVEs found in the last 7 days</div>';
                    return;
                }
                
                const cves = data.vulnerabilities.slice(0, 15).map(item => {
                    const vuln = item.cve;
                    const metrics = vuln.metrics?.cvssMetricV31?.[0] || vuln.metrics?.cvssMetricV2?.[0] || {};
                    const cvss = metrics.cvssData?.baseScore || 0;
                    const severity = metrics.cvssData?.baseSeverity || 'UNKNOWN';
                    
                    let products = 'Various products';
                    if (vuln.configurations?.nodes && vuln.configurations.nodes.length > 0) {
                        const cpeMatches = vuln.configurations.nodes[0].cpeMatch || [];
                        if (cpeMatches.length > 0) {
                            products = cpeMatches.slice(0, 2).map(cpe => {
                                const parts = cpe.criteria.split(':');
                                return parts[3] || 'Unknown';
                            }).join(', ');
                        }
                    }
                    
                    return {
                        cve_id: vuln.id,
                        title: (vuln.descriptions?.[0]?.value || 'No title').substring(0, 150),
                        description: (vuln.descriptions?.[0]?.value || 'No description').substring(0, 200),
                        cvss: cvss,
                        severity: severity,
                        products: products,
                        date_published: vuln.published ? new Date(vuln.published).toLocaleDateString() : 'Unknown',
                        date_published_raw: vuln.published || null,
                        status: vuln.vulnStatus === 'Analyzed' ? 'Patched' : 'Active',
                        epss: null,
                        epss_percentile: null
                    };
                });
                
                nvdCVEsCache = cves;
                updateTime.innerHTML = new Date().toLocaleString('en-US', {weekday:'long', year:'numeric', month:'long', day:'numeric', hour:'numeric', minute:'numeric', timeZoneName:'short'});
                
                restoreCVEControls();
                renderNVDCVEs(nvdCVEsCache);

                const epssMap = await fetchEPSSForCves(cves.map(cve => cve.cve_id));
                if (epssMap && epssMap.size) {
                    nvdCVEsCache = nvdCVEsCache.map(cve => {
                        const epssData = epssMap.get(cve.cve_id);
                        return epssData ? { ...cve, ...epssData } : cve;
                    });
                    renderNVDCVEs(nvdCVEsCache);
                }
                renderPostureDashboard();
            } catch (err) {
                grid.innerHTML = `<div style="text-align:center; padding:40px; color:#ff0040;">Error loading NVD data: ${err.message}<br><br>Note: NVD API has rate limits. Please wait a moment and try refreshing.</div>`;
            }
        }
        
        function renderNVDCVEs(cves) {
            const grid = document.getElementById('nvd-cve-grid');
            if (!grid || !cves) return;

            const viewMode = document.getElementById('nvd-view-mode')?.value || 'group';
            const groupSort = document.getElementById('nvd-group-sort')?.value || 'cvss';
            const epssThreshold = getEpssThreshold();
            const severityFilter = document.getElementById('nvd-severity-filter')?.value || 'all';

            let filtered = cves.filter(cve => {
                if (severityFilter !== 'all' && cve.severity !== severityFilter) return false;
                if (epssThreshold > 0) {
                    const epssPercent = cve.epss != null ? cve.epss * 100 : null;
                    return epssPercent != null && epssPercent >= epssThreshold;
                }
                return true;
            });

            updateEpssInsights(filtered);
            fixFirstSourceCache = filtered;
            renderFixFirstQueue(filtered);

            if (viewMode === 'group') {
                const groups = ['CRITICAL', 'HIGH', 'MEDIUM'];
                const groupHtml = groups.map(group => {
                    const groupItems = filtered.filter(cve => cve.severity === group);
                    const sortedItems = sortCves(groupItems, groupSort);
                    if (sortedItems.length === 0) return '';
                    return `
                        <div style="margin-bottom: 18px;">
                            <div style="font-size: 13px; text-transform: uppercase; color: rgba(255,255,255,0.6); margin-bottom: 10px;">${group} Severity</div>
                            <div class="cve-grid nvd-grid">
                                ${sortedItems.map(renderCveCard).join('')}
                            </div>
                        </div>
                    `;
                }).join('');
                grid.innerHTML = groupHtml || `<div style="text-align:center; padding:40px; color:#ff4444;">No CVEs match the current filters.</div>`;
            } else {
                const sorted = sortCves(filtered, viewMode);
                grid.innerHTML = sorted.length ? sorted.map(renderCveCard).join('') : `<div style="text-align:center; padding:40px; color:#ff4444;">No CVEs match the current filters.</div>`;
            }
            updatePinButtons();
        }
        
        function filterNVDCVEs() {
            renderNVDCVEs(nvdCVEsCache);
        }

        function updateCVEViewMode() {
            const viewMode = document.getElementById('nvd-view-mode')?.value || 'group';
            const groupSort = document.getElementById('nvd-group-sort')?.value || 'cvss';
            const epssFilter = document.getElementById('nvd-epss-filter')?.value || 'all';
            localStorage.setItem(cveViewStorageKey, viewMode);
            localStorage.setItem(cveGroupSortStorageKey, groupSort);
            localStorage.setItem(cveEpssFilterStorageKey, epssFilter);

            const groupSortSelect = document.getElementById('nvd-group-sort');
            if (groupSortSelect) {
                groupSortSelect.style.display = viewMode === 'group' ? '' : 'none';
            }
            renderNVDCVEs(nvdCVEsCache);
        }

        function restoreCVEControls() {
            const viewMode = localStorage.getItem(cveViewStorageKey) || 'group';
            const groupSort = localStorage.getItem(cveGroupSortStorageKey) || 'cvss';
            const epssFilter = localStorage.getItem(cveEpssFilterStorageKey) || 'all';
            const viewSelect = document.getElementById('nvd-view-mode');
            const groupSelect = document.getElementById('nvd-group-sort');
            const epssSelect = document.getElementById('nvd-epss-filter');
            if (viewSelect) viewSelect.value = viewMode;
            if (groupSelect) groupSelect.value = groupSort;
            if (epssSelect) epssSelect.value = epssFilter;
            if (groupSelect) groupSelect.style.display = viewMode === 'group' ? '' : 'none';
        }

        function getEpssThreshold() {
            const value = document.getElementById('nvd-epss-filter')?.value || 'all';
            if (value === 'all') return 0;
            return Number(value) * 100;
        }

        function sortCves(cves, mode) {
            const sorted = [...cves];
            if (mode === 'epss') {
                sorted.sort((a, b) => (b.epss ?? -1) - (a.epss ?? -1));
            } else if (mode === 'cvss') {
                sorted.sort((a, b) => (b.cvss ?? 0) - (a.cvss ?? 0));
            } else if (mode === 'newest') {
                sorted.sort((a, b) => new Date(b.date_published_raw || 0) - new Date(a.date_published_raw || 0));
            }
            return sorted;
        }

        function renderCveCard(cve) {
            const severityColor = cve.cvss >= 9 ? '#ff0040' : cve.cvss >= 7 ? '#ff6b00' : '#ffd700';
            const anchorId = `cve:${cve.cve_id}`;
            const epssPercent = cve.epss != null ? (cve.epss * 100) : null;
            const percentile = cve.epss_percentile != null ? (cve.epss_percentile > 1 ? cve.epss_percentile : cve.epss_percentile * 100) : null;
            const epssLabel = epssPercent != null
                ? `EPSS: ${epssPercent.toFixed(1)}% â€¢ Percentile: ${percentile != null ? percentile.toFixed(0) : '--'}`
                : 'EPSS: unavailable';
            const meterWidth = epssPercent != null ? Math.min(100, Math.max(0, epssPercent)) : 0;

            return `
                <div class="cve-card" style="border-left-color: ${severityColor}; background: rgba(255,0,64,0.03);" data-clipboard-anchor="${anchorId}">
                    <button class="card-pin-indicator" type="button" data-clipboard-id="${anchorId}" aria-label="Unpin from clipboard">ðŸ“Œ</button>
                    <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 12px;">
                        <div>
                            <div style="font-weight: 600; color: ${severityColor}; margin-bottom: 4px;">${cve.cve_id}</div>
                            <div style="font-size: 15px; font-weight: 500; margin-bottom: 8px; line-height: 1.4;">${cve.title}</div>
                        </div>
                        <div style="display: flex; flex-direction: column; align-items: flex-end; gap: 6px;">
                            <div class="cvss-badge" style="background: ${severityColor};">${cve.cvss}</div>
                            ${getLibrarySaveMarkup({
                                id: `cve:${cve.cve_id}`,
                                type: 'cve',
                                title: `${cve.cve_id} ${cve.title}`,
                                url: `https://nvd.nist.gov/vuln/detail/${cve.cve_id}`,
                                source: 'NVD',
                                date: cve.date_published,
                                summary: cve.description,
                                tags: []
                            }, { label: 'Save' })}
                            ${getPinButtonMarkup({
                                id: anchorId,
                                anchor: anchorId,
                                type: 'cve',
                                title: cve.cve_id,
                                subtitle: cve.products,
                                url: `https://nvd.nist.gov/vuln/detail/${cve.cve_id}`,
                                severity: cve.severity ? cve.severity.toUpperCase() : null,
                                meta: {
                                    cveId: cve.cve_id,
                                    title: cve.title,
                                    vendor: 'Unknown',
                                    product: cve.products,
                                    date: cve.date_published,
                                    cvss: cve.cvss,
                                    epss: epssPercent != null ? `${epssPercent.toFixed(1)}%` : 'Unknown',
                                    isKEV: false
                                }
                            }, { compact: true })}
                        </div>
                    </div>
                    <div style="font-size:13px; margin-bottom:8px; color:rgba(255,255,255,0.8);">${cve.description}</div>
                    <div style="display: flex; gap: 8px; flex-wrap: wrap; margin-bottom: 8px;">
                        <span class="info-tag">${cve.severity}</span>
                        <span class="info-tag">${cve.products}</span>
                    </div>
                    <div style="display: flex; justify-content: space-between; font-size: 12px; color: rgba(255,255,255,0.6);">
                        <span>Published: ${cve.date_published}</span>
                        <span style="color: ${cve.status === 'Patched' ? '#00ff88' : '#ff0040'};">${cve.status}</span>
                    </div>
                    <div class="epss-row ${epssPercent == null ? 'epss-muted' : ''}">
                        <span>${epssLabel}</span>
                        <div class="epss-meter">
                            <div class="epss-meter-fill" style="width:${meterWidth}%;"></div>
                        </div>
                    </div>
                </div>
            `;
        }

        function updateEpssInsights(cves) {
            const epssValues = cves.map(cve => cve.epss).filter(val => val != null);
            const avg = epssValues.length ? epssValues.reduce((sum, val) => sum + val, 0) / epssValues.length : null;
            const max = epssValues.length ? Math.max(...epssValues) : null;
            const count10 = epssValues.filter(val => val >= 0.1).length;
            const count50 = epssValues.filter(val => val >= 0.5).length;

            const avgEl = document.getElementById('epss-avg');
            const maxEl = document.getElementById('epss-max');
            const count10El = document.getElementById('epss-10');
            const count50El = document.getElementById('epss-50');
            if (avgEl) avgEl.textContent = avg != null ? `${(avg * 100).toFixed(1)}%` : 'â€”';
            if (maxEl) maxEl.textContent = max != null ? `${(max * 100).toFixed(1)}%` : 'â€”';
            if (count10El) count10El.textContent = `${count10}`;
            if (count50El) count50El.textContent = `${count50}`;

            const histogram = document.getElementById('epss-histogram');
            if (histogram) {
                const bins = new Array(10).fill(0);
                epssValues.forEach(val => {
                    const index = Math.min(9, Math.floor((val * 100) / 10));
                    bins[index] += 1;
                });
                const maxBin = Math.max(...bins, 1);
                histogram.innerHTML = bins.map(count => {
                    const height = Math.max(6, Math.round((count / maxBin) * 60));
                    return `<div class="mini-hist-bar" style="height:${height}px;"></div>`;
                }).join('');
            }
        }

        function getFixFirstMode() {
            const allowed = ['combined', 'epss', 'cvss', 'kev'];
            const stored = localStorage.getItem(fixFirstModeKey);
            return allowed.includes(stored) ? stored : 'combined';
        }

        function getKevIdSet() {
            return new Set((cisaKevCache || []).map(item => item.cveID || item.cve || item.cveId).filter(Boolean));
        }

        function getRecencyBoost(publishedDate) {
            if (!publishedDate) return 0;
            const published = new Date(publishedDate);
            if (Number.isNaN(published.getTime())) return 0;
            const days = (Date.now() - published.getTime()) / 86400000;
            if (days <= 7) return 10;
            if (days <= 30) return 8;
            if (days <= 60) return 6;
            if (days <= 90) return 4;
            if (days <= 180) return 2;
            return 0;
        }

        function buildFixFirstItems(cves) {
            const kevSet = getKevIdSet();
            return (cves || []).map(cve => {
                const epssPercent = cve.epss != null ? (cve.epss * 100) : null;
                return {
                    cveId: cve.cve_id,
                    title: cve.title || 'No title',
                    vendorProduct: cve.products || 'Unknown',
                    cvss: Number(cve.cvss) || 0,
                    epssPercent,
                    isKEV: kevSet.has(cve.cve_id),
                    publishedDate: cve.date_published_raw || cve.date_published || null
                };
            });
        }

        function getFixFirstScore(item, mode) {
            const epssValue = item.epssPercent || 0;
            const cvssValue = item.cvss || 0;
            const recencyBoost = getRecencyBoost(item.publishedDate);
            if (mode === 'epss') return epssValue * 1.5;
            if (mode === 'cvss') return cvssValue * 4;
            if (mode === 'kev') return item.isKEV ? 100 : 0;
            let score = 0;
            if (item.isKEV) score += 100;
            score += epssValue * 1.5;
            score += cvssValue * 4;
            score += recencyBoost;
            return score;
        }

        function renderFixFirstQueue(cves) {
            const list = document.getElementById('fix-first-list');
            const modeSelect = document.getElementById('fix-first-mode');
            if (!list) return;
            const mode = modeSelect?.value || getFixFirstMode();
            const items = buildFixFirstItems(cves).map(item => ({
                ...item,
                score: getFixFirstScore(item, mode),
                recencyBoost: getRecencyBoost(item.publishedDate)
            }));

            const sorted = items.sort((a, b) => {
                if (b.score !== a.score) return b.score - a.score;
                if (b.recencyBoost !== a.recencyBoost) return b.recencyBoost - a.recencyBoost;
                if ((b.epssPercent || 0) !== (a.epssPercent || 0)) return (b.epssPercent || 0) - (a.epssPercent || 0);
                if ((b.cvss || 0) !== (a.cvss || 0)) return (b.cvss || 0) - (a.cvss || 0);
                return new Date(b.publishedDate || 0) - new Date(a.publishedDate || 0);
            }).slice(0, 5);

            if (!sorted.length) {
                list.innerHTML = '<div style="font-size: 12px; color: rgba(255,255,255,0.6); padding: 8px;">No CVEs available for the current filters.</div>';
                return;
            }

            list.innerHTML = sorted.map((item, index) => {
                const anchorId = `cve:${item.cveId}`;
                const epssLabel = item.epssPercent != null ? `${item.epssPercent.toFixed(1)}%` : '--';
                const cvssLabel = item.cvss ? item.cvss.toFixed(1) : '--';
                const title = escapeHtml(item.title.length > 90 ? `${item.title.slice(0, 87)}...` : item.title);
                const pinMarkup = getPinButtonMarkup({
                    id: anchorId,
                    anchor: anchorId,
                    type: 'cve',
                    title: item.cveId,
                    subtitle: item.vendorProduct,
                    url: `https://nvd.nist.gov/vuln/detail/${item.cveId}`,
                    severity: null,
                    meta: {
                        cveId: item.cveId,
                        title: item.title,
                        product: item.vendorProduct,
                        cvss: item.cvss,
                        epss: item.epssPercent != null ? `${item.epssPercent.toFixed(1)}%` : 'Unknown',
                        isKEV: item.isKEV ? 'Yes' : 'No'
                    }
                }, { compact: true });

                return `
                    <div class="fix-first-item" data-fixfirst-go="${anchorId}" tabindex="0" role="button" aria-label="Go to ${item.cveId}">
                        <div class="fix-first-rank">${index + 1}</div>
                        <div class="fix-first-content">
                            <div class="fix-first-id">${item.cveId}</div>
                            <div class="fix-first-title-text">${title}</div>
                            <div class="fix-first-meta">
                                ${item.isKEV ? '<span class="fix-first-badge kev">KEV</span>' : ''}
                                <span class="fix-first-badge">EPSS ${epssLabel}</span>
                                <span class="fix-first-badge">CVSS ${cvssLabel}</span>
                            </div>
                        </div>
                        <div class="fix-first-actions">${pinMarkup}</div>
                    </div>
                `;
            }).join('');
        }

        function setupFixFirstQueue() {
            const modeSelect = document.getElementById('fix-first-mode');
            if (modeSelect) {
                modeSelect.value = getFixFirstMode();
                modeSelect.addEventListener('change', () => {
                    localStorage.setItem(fixFirstModeKey, modeSelect.value);
                    renderFixFirstQueue(fixFirstSourceCache);
                });
            }
            const list = document.getElementById('fix-first-list');
            if (list) {
                list.addEventListener('click', event => {
                    if (event.target.closest('.pin-btn')) return;
                    const row = event.target.closest('.fix-first-item');
                    if (row?.dataset.fixfirstGo) {
                        scrollToClipboardAnchor(row.dataset.fixfirstGo);
                    }
                });
                list.addEventListener('keydown', event => {
                    if (event.key !== 'Enter' && event.key !== ' ') return;
                    const row = event.target.closest('.fix-first-item');
                    if (row?.dataset.fixfirstGo) {
                        event.preventDefault();
                        scrollToClipboardAnchor(row.dataset.fixfirstGo);
                    }
                });
            }
        }

        function getEpssCache() {
            try {
                const raw = localStorage.getItem(epssCacheKey);
                if (!raw) return { timestamp: 0, data: {} };
                const parsed = JSON.parse(raw);
                if (Date.now() - parsed.timestamp > epssCacheTtl) {
                    return { timestamp: 0, data: {} };
                }
                return parsed;
            } catch {
                return { timestamp: 0, data: {} };
            }
        }

        function setEpssCache(data) {
            localStorage.setItem(epssCacheKey, JSON.stringify({ timestamp: Date.now(), data }));
        }

        async function fetchEPSSForCves(cveIds) {
            const cache = getEpssCache();
            const cachedData = cache.data || {};
            const missing = cveIds.filter(id => !cachedData[id]);
            if (missing.length === 0) {
                return new Map(Object.entries(cachedData));
            }

            const result = { ...cachedData };
            try {
                const chunks = [];
                for (let i = 0; i < missing.length; i += 50) {
                    chunks.push(missing.slice(i, i + 50));
                }
                for (const chunk of chunks) {
                    const data = await fetchEpssBatch(chunk);
                    data.forEach(item => {
                        result[item.cve] = { epss: item.epss, epss_percentile: item.percentile };
                    });
                }
                setEpssCache(result);
                return new Map(Object.entries(result));
            } catch (error) {
                console.warn('EPSS batch fetch failed, falling back to individual requests.', error);
            }

            const individualResults = await fetchWithConcurrency(missing, 5, fetchEpssSingle);
            individualResults.forEach(item => {
                if (item) {
                    result[item.cve] = { epss: item.epss, epss_percentile: item.percentile };
                }
            });
            setEpssCache(result);
            return new Map(Object.entries(result));
        }

        async function fetchEpssBatch(cveIds) {
            const url = `https://api.first.org/data/v1/epss?cve=${cveIds.join(',')}`;
            const data = await fetchWithTimeout(url, 8000);
            return (data?.data || []).map(item => ({
                cve: item.cve,
                epss: Number(item.epss),
                percentile: Number(item.percentile)
            }));
        }

        async function fetchEpssSingle(cveId) {
            try {
                const data = await fetchWithTimeout(`https://api.first.org/data/v1/epss?cve=${cveId}`, 8000);
                const item = data?.data?.[0];
                if (!item) return null;
                return { cve: item.cve, epss: Number(item.epss), percentile: Number(item.percentile) };
            } catch (error) {
                return null;
            }
        }

        async function fetchWithTimeout(url, timeoutMs) {
            const controller = new AbortController();
            const timeout = setTimeout(() => controller.abort(), timeoutMs);
            try {
                const response = await fetch(url, { signal: controller.signal });
                const data = await response.json();
                if (!response.ok) {
                    throw new Error('EPSS API error');
                }
                return data;
            } finally {
                clearTimeout(timeout);
            }
        }

        async function fetchWithConcurrency(items, limit, handler) {
            const results = [];
            let index = 0;
            const workers = new Array(limit).fill(null).map(async () => {
                while (index < items.length) {
                    const current = items[index++];
                    const result = await handler(current);
                    results.push(result);
                }
            });
            await Promise.all(workers);
            return results;
        }
        
        function exportCVEReport() {
            alert('ðŸ“„ CVE Report export feature coming soon! Will generate PDF with all critical vulnerabilities.');
        }

        // Render Breaches Table
        function renderBreaches() {
            const tbody = document.getElementById('breach-table-body');
            if (!tbody) return;
            
            tbody.innerHTML = breachData.map(breach => `
                <tr>
                    <td><strong>${breach.org}</strong></td>
                    <td><span style="color: #ff0040; font-weight: 600;">${breach.records}</span></td>
                    <td>${breach.date}</td>
                    <td>${breach.type}</td>
                    <td><span class="status-badge status-active">${breach.status}</span></td>
                    <td>${breach.industry}</td>
                </tr>
            `).join('');
        }

        function escapeHtml(value) {
            return String(value || '')
                .replace(/&/g, '&amp;')
                .replace(/</g, '&lt;')
                .replace(/>/g, '&gt;')
                .replace(/"/g, '&quot;')
                .replace(/'/g, '&#39;');
        }

        async function fetchMitreData() {
            if (mitreDataCache) return mitreDataCache;
            if (mitreDataPromise) return mitreDataPromise;
            mitreDataPromise = fetch(mitreDataUrl)
                .then(response => {
                    if (!response.ok) {
                        throw new Error('MITRE ATT&CK API unavailable');
                    }
                    return response.json();
                })
                .then(data => {
                    mitreDataCache = data;
                    return data;
                })
                .catch(error => {
                    mitreDataPromise = null;
                    throw error;
                });
            return mitreDataPromise;
        }

        function extractTechniqueDetails(technique) {
            const ref = (technique.external_references || []).find(reference => {
                return reference.source_name === 'mitre-attack'
                    && reference.external_id
                    && reference.external_id.startsWith('T');
            });
            const tactics = (technique.kill_chain_phases || [])
                .map(phase => phase.phase_name)
                .filter(Boolean);
            return {
                id: technique.id,
                name: technique.name || 'Unknown technique',
                externalId: ref?.external_id || '',
                tactics: Array.from(new Set(tactics))
            };
        }

        function buildMitreIndexes(data) {
            if (mitreIndexes.ready) return;
            const objects = data.objects || [];
            objects.forEach(obj => {
                if (obj.type === 'attack-pattern') {
                    mitreIndexes.techniqueById.set(obj.id, obj);
                    mitreIndexes.techniqueDetailsById.set(obj.id, extractTechniqueDetails(obj));
                } else if (obj.type === 'intrusion-set') {
                    mitreIndexes.actorById.set(obj.id, obj);
                } else if (obj.type === 'relationship' && obj.relationship_type === 'uses') {
                    mitreIndexes.relationshipsUses.push(obj);
                }
            });

            mitreIndexes.relationshipsUses.forEach(rel => {
                if (mitreIndexes.actorById.has(rel.source_ref) && mitreIndexes.techniqueById.has(rel.target_ref)) {
                    const existing = mitreIndexes.actorToTechniques.get(rel.source_ref) || new Set();
                    existing.add(rel.target_ref);
                    mitreIndexes.actorToTechniques.set(rel.source_ref, existing);
                }
            });

            mitreIndexes.ready = true;
        }

        function getActorExternalLink(actor) {
            const ref = (actor.external_references || []).find(reference => {
                return reference.source_name === 'mitre-attack'
                    && reference.external_id
                    && reference.external_id.startsWith('G');
            });
            if (!ref) return '';
            return ref.url || `https://attack.mitre.org/groups/${ref.external_id}/`;
        }

        function buildActorDetailMarkup(actor) {
            const actorName = escapeHtml(actor.name || 'Unknown Actor');
            const aliases = actor.aliases ? actor.aliases.join(', ') : '';
            const aliasMarkup = aliases ? `<div class="detail-meta"><strong>Aliases:</strong> ${escapeHtml(aliases)}</div>` : '';
            const description = escapeHtml(actor.description || 'No description available.');
            const techniqueIds = Array.from(mitreIndexes.actorToTechniques.get(actor.id) || []);
            const techniques = techniqueIds
                .map(id => mitreIndexes.techniqueDetailsById.get(id))
                .filter(Boolean)
                .filter(detail => detail.externalId);

            const topTechniques = techniques.slice(0, 10);
            const techniquesMarkup = topTechniques.length
                ? topTechniques.map(detail => {
                    const tacticLabel = detail.tactics[0] || 'Unknown';
                    const techLabel = `${detail.externalId} â€¢ ${detail.name}`;
                    return `
                        <div class="tech-item" data-tech="${escapeHtml(techLabel.toLowerCase())}" data-clipboard-anchor="technique:${escapeHtml(detail.externalId)}" style="display: flex; justify-content: space-between; align-items: center; gap: 8px;">
                            <div>
                                <a href="https://attack.mitre.org/techniques/${detail.externalId}/" target="_blank" rel="noopener">
                                    <strong>${escapeHtml(detail.externalId)}</strong> ${escapeHtml(detail.name)}
                                </a>
                                <span class="tech-chip">${escapeHtml(tacticLabel)}</span>
                            </div>
                            <div style="display: flex; gap: 6px; align-items: center;">
                                ${getLibrarySaveMarkup({
                                    id: `technique:${detail.externalId}`,
                                    type: 'technique',
                                    title: `${detail.externalId} ${detail.name}`,
                                    url: `https://attack.mitre.org/techniques/${detail.externalId}/`,
                                    source: 'MITRE ATT&CK',
                                    date: '',
                                    summary: `Tactic: ${tacticLabel}`,
                                    tags: [tacticLabel]
                                }, { label: 'Save technique' })}
                                ${getPinButtonMarkup({
                                    id: `technique:${detail.externalId}`,
                                    anchor: `technique:${detail.externalId}`,
                                    type: 'technique',
                                    title: `${detail.externalId} ${detail.name}`,
                                    subtitle: `Tactic: ${tacticLabel}`,
                                    url: `https://attack.mitre.org/techniques/${detail.externalId}/`,
                                    severity: null,
                                    meta: {
                                        tactic: tacticLabel
                                    }
                                }, { compact: true })}
                            </div>
                        </div>
                    `;
                }).join('')
                : `<div style="font-size: 13px; color: rgba(255,255,255,0.7);">No technique data mapped yet.</div>`;

            const tacticCounts = {};
            techniques.forEach(detail => {
                const tacticList = detail.tactics.length ? detail.tactics : ['Uncategorized'];
                tacticList.forEach(tactic => {
                    tacticCounts[tactic] = (tacticCounts[tactic] || 0) + 1;
                });
            });
            const tacticEntries = Object.entries(tacticCounts)
                .sort((a, b) => b[1] - a[1]);
            const maxCount = Math.max(...tacticEntries.map(entry => entry[1]), 1);
            const tacticsMarkup = tacticEntries.length
                ? tacticEntries.map(([tactic, count]) => {
                    const width = Math.round((count / maxCount) * 100);
                    return `
                        <div class="tactic-row">
                            <span>${escapeHtml(tactic)}</span>
                            <div class="bar" style="width: ${width}%;"></div>
                            <span>${count}</span>
                        </div>
                    `;
                }).join('')
                : `<div style="font-size: 13px; color: rgba(255,255,255,0.6);">No tactics breakdown available.</div>`;

            const externalLink = getActorExternalLink(actor);
            const externalButton = externalLink
                ? `<a class="btn btn-primary btn-full" href="${externalLink}" target="_blank" rel="noopener">Open in MITRE ATT&amp;CK</a>`
                : '';

            return `
                <div>
                    <div style="font-size: 20px; font-weight: 600; color: #ff0040; margin-bottom: 6px;">${actorName}</div>
                    ${aliasMarkup}
                    <div class="detail-description" data-description>${description}</div>
                    <button class="detail-toggle" type="button">Show more</button>
                    <div style="margin-top: 10px; display: flex; gap: 8px; flex-wrap: wrap;">
                        ${getLibrarySaveMarkup({
                            id: `actor:${actor.id || actor.name}`,
                            type: 'actor',
                            title: actor.name || 'Unknown Actor',
                            url: externalLink,
                            source: 'MITRE ATT&CK',
                            date: '',
                            summary: actor.description || '',
                            tags: []
                        }, { label: 'Save actor' })}
                    </div>
                    <div class="detail-search" style="margin-top: 12px;">
                        <input type="text" placeholder="Search techniques..." aria-label="Search techniques" data-tech-search>
                    </div>
                    <div style="margin-top: 14px; font-weight: 600; color: #22d3ee;">Top Techniques Used</div>
                    <div class="tech-list" data-tech-list>
                        ${techniquesMarkup}
                    </div>
                    <div style="margin-top: 16px; font-weight: 600; color: #22d3ee;">Tactics Breakdown</div>
                    <div class="tactic-bars">
                        ${tacticsMarkup}
                    </div>
                    <div style="margin-top: 16px;">
                        ${externalButton}
                    </div>
                </div>
            `;
        }

        function bindActorDetailInteractions(container, descriptionText) {
            const description = container.querySelector('[data-description]');
            const toggleBtn = container.querySelector('.detail-toggle');
            if (description && toggleBtn) {
                if (!descriptionText || descriptionText.length < 240) {
                    toggleBtn.style.display = 'none';
                }
                toggleBtn.addEventListener('click', () => {
                    const expanded = description.classList.toggle('expanded');
                    toggleBtn.textContent = expanded ? 'Show less' : 'Show more';
                });
            }

            const searchInput = container.querySelector('[data-tech-search]');
            const techList = container.querySelector('[data-tech-list]');
            if (searchInput && techList) {
                searchInput.addEventListener('input', () => {
                    const query = searchInput.value.trim().toLowerCase();
                    const items = techList.querySelectorAll('.tech-item');
                    items.forEach(item => {
                        const techText = item.getAttribute('data-tech') || '';
                        item.style.display = techText.includes(query) ? '' : 'none';
                    });
                });
            }
        }

        function renderActorDetails(actor, container) {
            if (!actor || !container) return;
            const markup = buildActorDetailMarkup(actor);
            container.innerHTML = markup;
            bindActorDetailInteractions(container, actor.description || '');
            updatePinButtons();
        }

        function openActorModal(actor) {
            const backdrop = document.getElementById('actor-detail-modal');
            const body = document.getElementById('actor-detail-modal-body');
            if (!backdrop || !body) return;
            renderActorDetails(actor, body);
            backdrop.classList.add('active');
            backdrop.setAttribute('aria-hidden', 'false');
            document.body.style.overflow = 'hidden';
            const closeBtn = backdrop.querySelector('.modal-close');
            if (closeBtn) closeBtn.focus();
        }

        function closeActorModal() {
            const backdrop = document.getElementById('actor-detail-modal');
            if (!backdrop || !backdrop.classList.contains('active')) return;
            backdrop.classList.remove('active');
            backdrop.setAttribute('aria-hidden', 'true');
            document.body.style.overflow = '';
        }

        function openActorDetails(actorId) {
            const actor = mitreIndexes.actorById.get(actorId);
            if (!actor) return;
            const isDesktop = window.matchMedia('(min-width: 1200px)').matches;
            if (isDesktop) {
                const detailsCard = document.getElementById('actor-details-card');
                renderActorDetails(actor, detailsCard);
            } else {
                openActorModal(actor);
            }
        }

        function setupActorDetailModal() {
            const backdrop = document.getElementById('actor-detail-modal');
            if (!backdrop) return;
            const closeBtn = backdrop.querySelector('.modal-close');
            if (closeBtn) {
                closeBtn.addEventListener('click', closeActorModal);
            }
            backdrop.addEventListener('click', event => {
                if (event.target === backdrop) {
                    closeActorModal();
                }
            });
            document.addEventListener('keydown', event => {
                if (event.key === 'Escape') {
                    closeActorModal();
                }
            });
        }

        // Load MITRE ATT&CK Threat Actors from public API
        async function loadMITREThreatActors() {
            const grid = document.getElementById('mitre-threat-actors-grid');
            if (!grid) return;
            
            grid.innerHTML = '<div style="text-align:center; padding:40px; color:#22d3ee;"><span class="spinner" style="width:32px; height:32px;"></span><br><br>Loading MITRE ATT&amp;CK threat actor data...</div>';
            
            try {
                const data = await fetchMitreData();
                buildMitreIndexes(data);
                
                // Extract threat actors (intrusion-sets)
                if (!threatActorsCache) {
                    threatActorsCache = (data.objects || [])
                        .filter(obj => obj.type === 'intrusion-set')
                        .slice(0, 12)
                        .map(actor => {
                            const description = (actor.description || 'Advanced persistent threat group').substring(0, 200);
                            return {
                                id: actor.id,
                                name: actor.name || 'Unknown Actor',
                                type: actor.aliases ? actor.aliases.join(', ').substring(0, 50) : 'APT Group',
                                status: 'Active',
                                description: description,
                                targets: extractTargets(actor.description || ''),
                                regions: extractRegions(actor.description || ''),
                                techniques: 'Multiple techniques'
                            };
                        });
                }
                const threatActors = threatActorsCache;
                
                if (threatActors.length === 0) {
                    grid.innerHTML = '<div style="text-align:center; padding:40px; color:#ff4444;">No threat actor data available</div>';
                    return;
                }
                
                grid.innerHTML = threatActors.map(actor => `
                    <div class="malware-card actor-card" tabindex="0" role="button" data-actor-id="${actor.id}" data-clipboard-anchor="actor:${actor.id}" style="border: 1px solid rgba(255,0,64,0.3); background: rgba(255,0,64,0.05);">
                        <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 12px;">
                            <div>
                                <div style="font-size: 18px; font-weight: 600; margin-bottom: 4px; color: #ff0040;">${actor.name}</div>
                                <div style="font-size: 14px; color: rgba(255,255,255,0.7);">${actor.type}</div>
                            </div>
                            <div style="display: flex; flex-direction: column; align-items: flex-end; gap: 6px;">
                                <span class="status-badge" style="background: rgba(255,0,64,0.2); border-color: #ff0040; color: #ff0040;">${actor.status}</span>
                                ${getPinButtonMarkup({
                                    id: `actor:${actor.id}`,
                                    anchor: `actor:${actor.id}`,
                                    type: 'actor',
                                    title: actor.name,
                                    subtitle: actor.type,
                                    url: '',
                                    severity: null,
                                    meta: {
                                        targets: actor.targets,
                                        regions: actor.regions
                                    }
                                }, { compact: true })}
                            </div>
                        </div>
                        <div style="font-size: 13px; color: rgba(255,255,255,0.9); margin-bottom: 8px; line-height: 1.5;">${actor.description}</div>
                        <div style="font-size: 13px; color: rgba(255,255,255,0.7); line-height: 1.6;">
                            <div style="margin-bottom: 4px;">ðŸŽ¯ <strong>Targets:</strong> ${actor.targets}</div>
                            <div style="margin-bottom: 4px;">ðŸŒ <strong>Regions:</strong> ${actor.regions}</div>
                            <div>âš”ï¸ <strong>Techniques:</strong> ${actor.techniques}</div>
                        </div>
                    </div>
                `).join('');
                updatePinButtons();

                if (!actorCardListenerBound) {
                    grid.addEventListener('click', event => {
                        if (event.target.closest('.pin-btn')) return;
                        const card = event.target.closest('.actor-card');
                        if (!card) return;
                        openActorDetails(card.dataset.actorId);
                    });
                    grid.addEventListener('keydown', event => {
                        if (event.key !== 'Enter' && event.key !== ' ') return;
                        const card = event.target.closest('.actor-card');
                        if (!card) return;
                        event.preventDefault();
                        openActorDetails(card.dataset.actorId);
                    });
                    actorCardListenerBound = true;
                }
            } catch (err) {
                grid.innerHTML = `<div style="text-align:center; padding:40px; color:#ff0040;">Error loading MITRE data: ${err.message}<br><br>Please refresh and try again.</div>`;
            }
        }
        
        // Helper functions for MITRE data extraction
        function extractTargets(description) {
            const keywords = ['government', 'healthcare', 'finance', 'energy', 'technology', 'defense', 'critical infrastructure'];
            const found = keywords.filter(kw => description.toLowerCase().includes(kw));
            return found.length > 0 ? found.join(', ') : 'Multiple sectors';
        }
        
        function extractRegions(description) {
            const regions = ['North America', 'Europe', 'Asia', 'Middle East', 'South America', 'Africa'];
            const found = regions.filter(region => description.toLowerCase().includes(region.toLowerCase()));
            return found.length > 0 ? found.join(', ') : 'Global';
        }
        
        function refreshThreatIntel() {
            loadNVDCVEs();
            loadMITREThreatActors();
        }

        // --- SECURITY TOOLS: Real API Functions ---
// === 1. CVE Lookup (NVD API direct) ===
        async function lookupCVE() {
            const query = document.getElementById('cve-input').value;
            const resultDiv = document.getElementById('cve-result');
            const btn = event.target;
            if (!query.trim()) {
                alert('Please enter a CVE ID or software name');
                return;
            }
            btn.innerHTML = '<span class="spinner"></span> Searching...';
            btn.classList.add('loading');
            resultDiv.classList.add('hidden');
            try {
        // Call backend NVD proxy
        const res = await fetch(`/api/nvd-lookup?query=${encodeURIComponent(query.trim())}`);
        if (!res.ok) throw new Error('CVE not found or NVD rate limit hit');
        const data = await res.json();
        if (!data.vulnerabilities || data.vulnerabilities.length === 0) throw new Error('CVE not found');
        
        const vuln = data.vulnerabilities[0].cve;
        const metrics = vuln.metrics?.cvssMetricV31?.[0] || vuln.metrics?.cvssMetricV2?.[0] || {};
        const cve = {
            cve_id: vuln.id,
            title: vuln.descriptions?.[0]?.value || 'No title',
            description: vuln.descriptions?.[0]?.value || 'No description',
            cvss: metrics.cvssData?.baseScore || 0,
            severity: metrics.cvssData?.baseSeverity || 'Unknown',
            products: (vuln.configurations?.nodes || []).map(n => n.cpeMatch?.[0]?.criteria || 'Unknown').slice(0, 3).join(', ') || 'Various products',
            date_published: vuln.published ? new Date(vuln.published).toLocaleDateString() : 'Unknown',
            status: vuln.vulnStatus === 'Analyzed' ? 'Patched' : 'Active',
            references: (vuln.references || []).slice(0, 5).map(ref => ({ url: ref.url, source: ref.source || 'Unknown' }))
        };
        const color = cve.cvss >= 9 ? '#ff0040' : cve.cvss >= 7 ? '#ff6b00' : '#ffd700';
        const anchorId = `cve:${cve.cve_id}`;
        resultDiv.innerHTML = `
            <div class="tool-result" style="border-left-color: ${color};" data-clipboard-anchor="${anchorId}">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px;">
                    <h4 style="color: ${color};">${cve.cve_id}</h4>
                    ${getPinButtonMarkup({
                        id: anchorId,
                        anchor: anchorId,
                        type: 'cve',
                        title: cve.cve_id,
                        subtitle: cve.products,
                        url: `https://nvd.nist.gov/vuln/detail/${cve.cve_id}`,
                        severity: cve.severity ? cve.severity.toUpperCase() : null,
                        meta: {
                            cvss: cve.cvss,
                            published: cve.date_published
                        }
                    }, { compact: true })}
                </div>
                <div style="font-size: 14px; line-height: 1.8; color: rgba(255,255,255,0.8);">
                    <strong>${cve.title}</strong><br><br>
                    <strong>CVSS Score:</strong> ${cve.cvss} (${cve.severity})<br>
                    <strong>Affected:</strong> ${cve.products}<br>
                    <strong>Published:</strong> ${cve.date_published}<br>
                    <strong>Status:</strong> ${cve.status}<br><br>
                    <strong>Description:</strong> ${cve.description}<br>
                    <strong>References:</strong> <ul>${cve.references.map(ref => `<li><a href='${ref.url}' target='_blank'>${ref.url}</a></li>`).join('')}</ul>
                    ${cve.status === 'Patched' ? 
                        '<strong style="color: #00ff88;">âœ“ Patch available - Update immediately</strong>' :
                        '<strong style="color: #ff0040;">âš ï¸ Active threat - Implement mitigations immediately</strong>'}
                </div>
            </div>
        `;
        updatePinButtons();
    } catch (err) {
        resultDiv.innerHTML = `<div class="tool-result"><p style="color:#ff0040;">${err.message}</p></div>`;
    } finally {
        resultDiv.classList.remove('hidden');
        btn.innerHTML = 'Search CVE';
        btn.classList.remove('loading');
    }
}

// 2. Malware Scanner (VirusTotal API - backend)
async function analyzeHash() {
    const hash = document.getElementById('hash-input').value;
    const resultDiv = document.getElementById('hash-result');
    const btn = event.target;
    if (!hash.trim()) {
        alert('Please enter a file hash');
        return;
    }
    
    btn.innerHTML = '<span class="spinner"></span> Analyzing...';
    btn.classList.add('loading');
    resultDiv.classList.add('hidden');
    try {
        // Note: VirusTotal requires file upload for URL scanning
        // Hash lookup is read-only and checks existing database
        alert('âš ï¸ Note: File hash analysis requires the hash to already exist in VirusTotal database.\n\nFor URL scanning, use the Malicious URL Detector tool instead.');
        throw new Error('Feature requires VirusTotal file upload API (not implemented in free tier)');
    } catch (err) {
        resultDiv.innerHTML = `<div class="tool-result"><p style="color:#ff0040;">${err.message}</p></div>`;
    } finally {
        resultDiv.classList.remove('hidden');
        btn.innerHTML = 'Analyze Hash';
        btn.classList.remove('loading');
    }
}

// 3. IP Reputation Checker (AbuseIPDB API - backend)
async function checkIPReputation(ip) {
    const resultDiv = document.getElementById('ip-result');
    const btn = event.target;
    if (!ip.trim()) {
        alert('Please enter an IP address');
        return;
    }
    
    btn.innerHTML = '<span class="spinner"></span> Checking...';
    btn.classList.add('loading');
    resultDiv.classList.add('hidden');
    try {
        // Call backend API (Vercel function with API key in env vars)
        const res = await fetch('/api/check-ip', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ ip: ip.trim() })
        });


        
        if (!res.ok) {
            const errData = await res.json();
            throw new Error(errData.error || 'API error');
        }
        
        const data = await res.json();
        
        if (!data.success) {
            throw new Error(data.error || 'Failed to check IP');
        }
        
        const abuseScore = data.abuseScore || 0;
        const threatLevel = abuseScore >= 90 ? 'Critical' : abuseScore >= 70 ? 'High' : abuseScore >= 40 ? 'Medium' : 'Low';
        const color = abuseScore >= 90 ? '#ff0040' : abuseScore >= 70 ? '#ff6b00' : '#ffd700';
        const severity = abuseScore >= 90 ? 'CRITICAL' : abuseScore >= 70 ? 'HIGH' : abuseScore >= 40 ? 'MEDIUM' : 'LOW';
        
        const anchorId = `tool:ip:${ip.trim()}`;
        resultDiv.innerHTML = `
            <div class="tool-result" style="border-left-color: ${color};" data-clipboard-anchor="${anchorId}">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px;">
                    <h4 style="color: ${color};">Threat Level: ${threatLevel}</h4>
                    ${getPinButtonMarkup({
                        id: anchorId,
                        anchor: anchorId,
                        type: 'tool',
                        title: `IP Reputation: ${ip.trim()}`,
                        subtitle: 'AbuseIPDB Lookup',
                        url: '',
                        severity: severity,
                        meta: {
                            abuseScore: abuseScore,
                            totalReports: data.totalReports || 0,
                            isp: data.isp || 'Unknown'
                        }
                    }, { compact: true })}
                </div>
                <div style="font-size: 14px; line-height: 1.8; color: rgba(255,255,255,0.8);">
                    <strong>IP:</strong> ${ip.trim()}<br>
                    <strong>Abuse Score:</strong> ${abuseScore}/100<br>
                    <strong>Total Reports:</strong> ${data.totalReports || 0}<br>
                    <strong>ISP:</strong> ${data.isp || 'Unknown'}<br>
                    <strong>Domain:</strong> ${data.domain || 'None'}<br>
                    <strong>Usage Type:</strong> ${data.usageType || 'Unknown'}<br>
                    <strong>Status:</strong> ${abuseScore > 70 ? 'High risk - Block recommended' : 'Normal'}<br>
                </div>
            </div>
        `;
        updatePinButtons();
    } catch (err) {
        resultDiv.innerHTML = `<div class="tool-result"><p style="color:#ff0040;">âš ï¸ ${err.message}</p><p style="font-size:12px; margin-top:8px;">Note: Backend API keys must be configured in Vercel environment variables.</p></div>`;
    } finally {
        resultDiv.classList.remove('hidden');
        btn.innerHTML = 'Check IP';
        btn.classList.remove('loading');
    }
}
// 4. Threat Intelligence (ThreatMiner API - free, no key required)
async function threatMinerSearch(input) {
    const resultDiv = document.getElementById('threatminer-result');
    const btn = event.target;
    if (!input.trim()) { alert('Please enter file hash, domain, IP, or malware name'); return; }
    btn.innerHTML = '<span class="spinner"></span> Searching...';
    btn.classList.add('loading');
    resultDiv.classList.add('hidden');
    try {
        // Call ThreatMiner API directly (free, no key)
        const tmUrl = `https://api.threatminer.org/v2/domain.php?q=${encodeURIComponent(input.trim())}&rt=1`;
        const res = await fetch(tmUrl);
        if (!res.ok) throw new Error('ThreatMiner API error or no results');
        const tmData = await res.json();
        
        const data = {
            connections: tmData.results?.length || 0,
            relatedThreats: (tmData.results || []).slice(0, 5),
            status: tmData.status_message || 'No data found'
        };
        const anchorId = `tool:threatminer:${input}`;
        resultDiv.innerHTML = `
            <div class="tool-result" style="border-left-color:#22d3ee;" data-clipboard-anchor="${anchorId}">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px;">
                    <h4 style="color:#22d3ee;">Threat Intelligence Results</h4>
                    ${getPinButtonMarkup({
                        id: anchorId,
                        anchor: anchorId,
                        type: 'tool',
                        title: `ThreatMiner: ${input}`,
                        subtitle: 'Threat Intelligence Search',
                        url: '',
                        severity: null,
                        meta: {
                            connections: data.connections,
                            status: data.status
                        }
                    }, { compact: true })}
                </div>
                <div style="font-size: 14px; line-height: 1.8; color: rgba(255,255,255,0.8);">
                    <strong>Input:</strong> ${input}<br>
                    <strong>Connections:</strong> ${data.connections}<br>
                    <strong>Related Threats:</strong> <ul>${data.relatedThreats.map(t=>`<li>${t}</li>`).join('')}</ul>
                    <strong>Status:</strong> ${data.status}<br>
                </div>
            </div>
        `;
        updatePinButtons();
    } catch (err) {
        resultDiv.innerHTML = `<div class="tool-result"><p style="color:#ff0040;">${err.message}</p></div>`;
    } finally {
        resultDiv.classList.remove('hidden');
        btn.innerHTML = 'ThreatMiner Search';
        btn.classList.remove('loading');
    }
}
// 5. Malicious URL Detector (VirusTotal backend API)
async function checkMaliciousURL() {
    const url = document.getElementById('url-input').value;
    const resultDiv = document.getElementById('url-result');
    const btn = event.target;
    if (!url.trim()) {
        alert('Please enter a URL');
        return;
    }
    btn.innerHTML = '<span class="spinner"></span> Scanning...';
    btn.classList.add('loading');
    resultDiv.classList.add('hidden');
    try {
        // Call backend API (VirusTotal URL scan)
        const res = await fetch('/api/scan-url', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ url: url.trim() })
        });


        
        if (!res.ok) {
            const errData = await res.json();
            throw new Error(errData.error || 'API error');
        }
        
        const data = await res.json();
        
        if (!data.success) {
            throw new Error(data.error || 'Failed to scan URL');
        }
        
        const stats = data.lastAnalysisStats || {};
        const malicious = stats.malicious || 0;
        const suspicious = stats.suspicious || 0;
        const total = malicious + suspicious + (stats.harmless || 0) + (stats.undetected || 0);
        const isMalicious = malicious > 0 || suspicious > 0;
        const color = malicious > 0 ? '#ff0040' : suspicious > 0 ? '#ff6b00' : '#00ff88';
        const severity = malicious > 0 ? 'HIGH' : suspicious > 0 ? 'MEDIUM' : 'LOW';
        
        const anchorId = `tool:urlscan:${url.trim()}`;
        resultDiv.innerHTML = `
            <div class="tool-result" style="border-left-color:${color};" data-clipboard-anchor="${anchorId}">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px;">
                    <h4 style="color:${color};">${isMalicious ? 'âš ï¸ THREAT DETECTED' : 'âœ“ URL APPEARS SAFE'}</h4>
                    ${getPinButtonMarkup({
                        id: anchorId,
                        anchor: anchorId,
                        type: 'tool',
                        title: `URL Scan: ${url.trim()}`,
                        subtitle: 'Malicious URL Detector',
                        url: url.trim(),
                        severity: severity,
                        meta: {
                            detectionRate: `${malicious + suspicious}/${total}`,
                            malicious: malicious,
                            suspicious: suspicious
                        }
                    }, { compact: true })}
                </div>
                <div style="font-size: 14px; line-height: 1.6; color: rgba(255,255,255,0.8);">
                    <strong>URL:</strong> ${url.trim()}<br>
                    <strong>Detection Rate:</strong> ${malicious + suspicious}/${total} vendors flagged this URL<br>
                    <strong>Malicious:</strong> ${malicious}<br>
                    <strong>Suspicious:</strong> ${suspicious}<br>
                    <strong>Harmless:</strong> ${stats.harmless || 0}<br>
                    <strong>Status:</strong> ${isMalicious ? 'Do NOT visit this URL' : 'No known threats'}<br>
                </div>
            </div>
        `;
        updatePinButtons();
    } catch (err) {
        resultDiv.innerHTML = `<div class="tool-result"><p style="color:#ff0040;">âš ï¸ ${err.message}</p><p style="font-size:12px; margin-top:8px;">Note: Backend API keys must be configured in Vercel environment variables.</p></div>`;
    } finally {
        resultDiv.classList.remove('hidden');
        btn.innerHTML = 'Scan URL';
        btn.classList.remove('loading');
    }
}
// 7. Email Breach Checker (HIBP - backend)
async function checkEmail() {
    const email = document.getElementById('email-input').value;
    const resultDiv = document.getElementById('email-result');
    const btn = event.target;
    if (!email.trim()) {
        alert('Please enter an email address');
        return;
    }
    btn.innerHTML = '<span class="spinner"></span> Checking...';
    btn.classList.add('loading');
    resultDiv.classList.add('hidden');
    try {
        const res = await fetch('/api/hibp-check', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ email: email.trim() })
        });
        
        if (res.status === 404) {
            resultDiv.innerHTML = `<div class="tool-result" style="border-left-color:#00ff88;"><h4 style="color:#00ff88; margin-bottom: 12px;">âœ“ No breaches found</h4><div style="font-size: 14px; line-height: 1.6; color: rgba(255,255,255,0.8);">Your email has not been found in any known data breaches. Continue following security best practices.</div></div>`;
            resultDiv.classList.remove('hidden');
            btn.innerHTML = 'Check Breaches';
            btn.classList.remove('loading');
            return;
        }
        
        if (!res.ok) {
            const errData = await res.json().catch(() => ({}));
            throw new Error(errData.error || 'HIBP API error');
        }
        const hibpData = await res.json();
        
        const data = {
            breaches: (hibpData.breaches || []).map(breach => ({
                name: breach.Name,
                date: breach.BreachDate,
                description: breach.Description
            }))
        };
        if (data.breaches.length === 0) {
            resultDiv.innerHTML = `<div class="tool-result" style="border-left-color:#00ff88;"><h4 style="color:#00ff88; margin-bottom: 12px;">âœ“ No breaches found</h4><div style="font-size: 14px; line-height: 1.6; color: rgba(255,255,255,0.8);">Your email has not been found in any known data breaches. Continue following security best practices.</div></div>`;
        } else {
            resultDiv.innerHTML = `<div class="tool-result" style="border-left-color:#ff6b00;"><h4 style="color:#ff6b00; margin-bottom: 12px;">âš ï¸ Found in ${data.breaches.length} breaches</h4><div style="font-size: 14px; line-height: 1.6; color: rgba(255,255,255,0.8);">Your email appeared in: ${data.breaches.map(b=>`${b.name} (${b.date})`).join(', ')}<br><br><strong>Recommendations:</strong><br>â€¢ Change passwords for affected accounts<br>â€¢ Enable 2FA<br>â€¢ Monitor for suspicious activity</div></div>`;
        }
    } catch (err) {
        resultDiv.innerHTML = `<div class="tool-result"><p style="color:#ff0040;">${err.message}<br><br>Note: HIBP requires a server API key and may rate limit requests.</p></div>`;
    } finally {
        resultDiv.classList.remove('hidden');
        btn.innerHTML = 'Check Breaches';
        btn.classList.remove('loading');
    }
}
// 6. Password Analyzer (local)
function analyzePassword() {
            const password = document.getElementById('password-input').value;
            const resultDiv = document.getElementById('password-result');
            const bar = document.getElementById('strength-bar');
            const label = document.getElementById('strength-label');
            const details = document.getElementById('strength-details');
            
            if (!password) {
                resultDiv.classList.add('hidden');
                return;
            }
            
            resultDiv.classList.remove('hidden');
            
            let strength = 0;
            let feedback = [];
            
            if (password.length >= 8) strength++; else feedback.push('Use at least 8 characters');
            if (password.length >= 12) strength++;
            if (/[a-z]/.test(password) && /[A-Z]/.test(password)) strength++; else feedback.push('Mix uppercase and lowercase');
            if (/[0-9]/.test(password)) strength++; else feedback.push('Add numbers');
            if (/[^a-zA-Z0-9]/.test(password)) strength++; else feedback.push('Include special characters');
            
            const strengthText = ['Very Weak', 'Weak', 'Fair', 'Strong', 'Very Strong'][strength];
            const colors = ['#ff0040', '#ff6b00', '#ffd700', '#22d3ee', '#00ff88'];
            const widths = ['20%', '40%', '60%', '80%', '100%'];
            
            bar.style.width = widths[strength];
            bar.style.background = colors[strength];
            label.innerHTML = `<strong>${strengthText}</strong> - Crack time: ${['Instant', 'Minutes', 'Hours', 'Months', 'Centuries'][strength]}`;
            label.style.color = colors[strength];
            
            details.innerHTML = feedback.length ? 'âš ï¸ ' + feedback.join(' â€¢ ') : 'âœ“ Excellent password strength!';
        }

        function checkURL() {
            const url = document.getElementById('url-input').value;
            const resultDiv = document.getElementById('url-result');
            const btn = event.target;
            
            if (!url.trim()) {
                alert('Please enter a URL');
                return;
            }
            
            btn.innerHTML = '<span class="spinner"></span> Scanning...';
            btn.classList.add('loading');
            
            setTimeout(() => {
                const isSafe = Math.random() > 0.3;
                resultDiv.innerHTML = `
                    <div class="tool-result" style="border-left-color: ${isSafe ? '#00ff88' : '#ff0040'};">
                        <h4 style="color: ${isSafe ? '#00ff88' : '#ff0040'}; margin-bottom: 12px;">
                            ${isSafe ? 'âœ“ URL appears safe' : 'âš ï¸ Suspicious URL detected'}
                        </h4>
                        <div style="font-size: 14px; line-height: 1.6; color: rgba(255,255,255,0.8);">
                            ${isSafe ? 
                                'â€¢ No malware detected<br>â€¢ Valid SSL certificate<br>â€¢ No phishing indicators<br>â€¢ Domain reputation: Good' :
                                'â€¢ Potential phishing site<br>â€¢ Suspicious redirects detected<br>â€¢ Domain registered recently<br>â€¢ Recommendation: Do not visit'}
                        </div>
                    </div>
                `;
                resultDiv.classList.remove('hidden');
                btn.innerHTML = 'Scan URL';
                btn.classList.remove('loading');
            }, 1500);
        }

        function checkEmail() {
            const email = document.getElementById('email-input').value;
            const resultDiv = document.getElementById('email-result');
            const btn = event.target;
            
            if (!email.trim()) {
                alert('Please enter an email address');
                return;
            }
            
            btn.innerHTML = '<span class="spinner"></span> Checking...';
            btn.classList.add('loading');
            
            setTimeout(() => {
                const breachCount = Math.floor(Math.random() * 5);
                resultDiv.innerHTML = `
                    <div class="tool-result" style="border-left-color: ${breachCount > 0 ? '#ff6b00' : '#00ff88'};">
                        <h4 style="color: ${breachCount > 0 ? '#ff6b00' : '#00ff88'}; margin-bottom: 12px;">
                            ${breachCount > 0 ? `âš ï¸ Found in ${breachCount} breaches` : 'âœ“ No breaches found'}
                        </h4>
                        <div style="font-size: 14px; line-height: 1.6; color: rgba(255,255,255,0.8);">
                            ${breachCount > 0 ? 
                                `Your email appeared in: LinkedIn (2021), Adobe (2019), Collection #1 (2019)<br><br>
                                <strong>Recommendations:</strong><br>
                                â€¢ Change passwords for affected accounts<br>
                                â€¢ Enable 2FA where available<br>
                                â€¢ Monitor for suspicious activity` :
                                'Your email has not been found in any known data breaches. Continue following security best practices.'}
                        </div>
                    </div>
                `;
                resultDiv.classList.remove('hidden');
                btn.innerHTML = 'Check Breaches';
                btn.classList.remove('loading');
            }, 1500);
        }

        function lookupCVE() {
            const query = document.getElementById('cve-input').value;
            const resultDiv = document.getElementById('cve-result');
            const btn = event.target;
            
            if (!query.trim()) {
                alert('Please enter a CVE ID or software name');
                return;
            }
            
            btn.innerHTML = '<span class="spinner"></span> Searching...';
            btn.classList.add('loading');
            
            setTimeout(() => {
                const matchedCVE = cveData.find(cve => cve.id.toLowerCase().includes(query.toLowerCase()));
                
                if (matchedCVE) {
                    const color = matchedCVE.cvss >= 9 ? '#ff0040' : matchedCVE.cvss >= 7 ? '#ff6b00' : '#ffd700';
                    const anchorId = `cve:${matchedCVE.id}`;
                    resultDiv.innerHTML = `
                        <div class="tool-result" style="border-left-color: ${color};" data-clipboard-anchor="${anchorId}">
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px;">
                                <h4 style="color: ${color};">${matchedCVE.id}</h4>
                                ${getPinButtonMarkup({
                                    id: anchorId,
                                    anchor: anchorId,
                                    type: 'cve',
                                    title: matchedCVE.id,
                                    subtitle: matchedCVE.affected,
                                    url: `https://nvd.nist.gov/vuln/detail/${matchedCVE.id}`,
                                    severity: matchedCVE.severity ? matchedCVE.severity.toUpperCase() : null,
                                    meta: {
                                        cvss: matchedCVE.cvss,
                                        published: matchedCVE.date
                                    }
                                }, { compact: true })}
                            </div>
                            <div style="font-size: 14px; line-height: 1.8; color: rgba(255,255,255,0.8);">
                                <strong>${matchedCVE.title}</strong><br><br>
                                <strong>CVSS Score:</strong> ${matchedCVE.cvss} (${matchedCVE.severity})<br>
                                <strong>Affected:</strong> ${matchedCVE.affected}<br>
                                <strong>Published:</strong> ${matchedCVE.date}<br>
                                <strong>Status:</strong> ${matchedCVE.status}<br><br>
                                ${matchedCVE.status === 'Patched' ? 
                                    '<strong style="color: #00ff88;">âœ“ Patch available - Update immediately</strong>' :
                                    '<strong style="color: #ff0040;">âš ï¸ Active threat - Implement mitigations immediately</strong>'}
                            </div>
                        </div>
                    `;
                    updatePinButtons();
                } else {
                    resultDiv.innerHTML = `
                        <div class="tool-result">
                            <p>No CVE found matching "${query}". Try searching with a specific CVE ID like CVE-2025-12345.</p>
                        </div>
                    `;
                }
                
                resultDiv.classList.remove('hidden');
                btn.innerHTML = 'Search CVE';
                btn.classList.remove('loading');
            }, 1500);
        }

        function analyzeNetwork() {
            const resultDiv = document.getElementById('network-result');
            const btn = event.target;
            
            btn.innerHTML = '<span class="spinner"></span> Analyzing...';
            btn.classList.add('loading');
            
            setTimeout(() => {
                resultDiv.innerHTML = `
                    <div class="tool-result">
                        <h4 style="color: #22d3ee; margin-bottom: 12px;">Network Security Analysis</h4>
                        <div style="font-size: 14px; line-height: 1.8; color: rgba(255,255,255,0.8);">
                            <strong>Open Ports:</strong> 80 (HTTP), 443 (HTTPS), 22 (SSH)<br>
                            <strong>Services:</strong> Apache 2.4, OpenSSH 8.2<br>
                            <strong>Security Score:</strong> 7.5/10<br><br>
                            <strong>Recommendations:</strong><br>
                            â€¢ Close unnecessary ports<br>
                            â€¢ Update OpenSSH to latest version<br>
                            â€¢ Enable firewall rules<br>
                            â€¢ Implement rate limiting
                        </div>
                    </div>
                `;
                resultDiv.classList.remove('hidden');
                btn.innerHTML = 'Analyze Network';
                btn.classList.remove('loading');
            }, 1500);
        }

        function analyzeHash() {
            const hash = document.getElementById('hash-input').value;
            const resultDiv = document.getElementById('hash-result');
            const btn = event.target;
            
            if (!hash.trim()) {
                alert('Please enter a file hash');
                return;
            }
            
            btn.innerHTML = '<span class="spinner"></span> Analyzing...';
            btn.classList.add('loading');
            
            setTimeout(() => {
                const isMalicious = Math.random() > 0.7;
                const detectionRate = isMalicious ? Math.floor(Math.random() * 40 + 20) : 0;
                
                resultDiv.innerHTML = `
                    <div class="tool-result" style="border-left-color: ${isMalicious ? '#ff0040' : '#00ff88'};">
                        <h4 style="color: ${isMalicious ? '#ff0040' : '#00ff88'}; margin-bottom: 12px;">
                            ${isMalicious ? 'âš ï¸ Malicious file detected' : 'âœ“ File appears clean'}
                        </h4>
                        <div style="font-size: 14px; line-height: 1.8; color: rgba(255,255,255,0.8);">
                            <strong>Detection Rate:</strong> ${detectionRate}/65 security vendors<br>
                            <strong>File Type:</strong> ${isMalicious ? 'Executable' : 'Document'}<br>
                            <strong>First Seen:</strong> ${isMalicious ? '2 days ago' : 'Never'}<br><br>
                            ${isMalicious ? 
                                '<strong>Threat:</strong> Trojan.Generic<br><strong>Action:</strong> Delete immediately and run full system scan' :
                                '<strong>Status:</strong> No known threats associated with this file'}
                        </div>
                    </div>
                `;
                resultDiv.classList.remove('hidden');
                btn.innerHTML = 'Analyze Hash';
                btn.classList.remove('loading');
            }, 1500);
        }

        function applyFilters() {
            alert('Filters applied! (This is a demo - filters would refine the threat data)');
        }

        // Render News Items (populates the Learning Hub News Grid)
        function populateNewsGrid(itemsToRender = null, lastVisit = null) {
            const newsGrid = document.getElementById('news-grid');
            const emptyState = document.getElementById('news-empty');
            if (!newsGrid) return;

            const items = itemsToRender && itemsToRender.length ? itemsToRender : [];
            if (!items.length) {
                newsGrid.innerHTML = '';
                if (emptyState) emptyState.style.display = 'block';
                return;
            }

            if (emptyState) emptyState.style.display = 'none';
            newsGrid.innerHTML = items.map(item => {
                const isNew = lastVisit ? new Date(item.dateISO).getTime() > lastVisit : false;
                const severityClass = item.severity ? item.severity.toLowerCase() : 'low';
                const cveChips = (item.cves || []).map(cve => `
                    <button class="news-cve-chip" type="button" data-cve-chip="${cve}">${cve}</button>
                `).join('');
                const clusterMarkup = item.clusterItems && item.clusterItems.length ? `
                    <details class="news-cluster">
                        <summary>More sources (${item.clusterItems.length})</summary>
                        <div class="news-cluster-list">
                            ${item.clusterItems.map(clusterItem => `
                                <div class="news-cluster-item">
                                    <a href="${clusterItem.url}" target="_blank" rel="noopener">${clusterItem.sourceName}</a>
                                    <span>â€¢ ${formatNewsDate(clusterItem.dateISO)}</span>
                                </div>
                            `).join('')}
                        </div>
                    </details>
                ` : '';

                return `
                    <div class="news-card news-card--intel ${isNew ? 'is-new' : ''}" data-clipboard-anchor="news:${item.id}">
                        <div class="news-meta-row">
                            ${isNew ? '<span class="news-alert-pill">New</span>' : ''}
                            <span class="news-severity ${severityClass}">${item.severity}</span>
                            <span class="news-source-pill">${item.sourceName}</span>
                            <span>${formatNewsDate(item.dateISO)}</span>
                        </div>
                        <h3>${item.title}</h3>
                        <p>${item.summary || 'Summary unavailable.'}</p>
                        ${cveChips ? `<div class="news-cve-chips">${cveChips}</div>` : ''}
                        ${clusterMarkup}
                        <div class="news-actions">
                            <a href="${item.url}" target="_blank" rel="noopener" class="news-link">Read Full Article â†’</a>
                            ${getLibrarySaveMarkup({
                                id: `news:${item.id}`,
                                type: item.sourceType === 'status' ? 'incident' : 'news',
                                title: item.title,
                                url: item.url,
                                source: item.sourceName,
                                date: formatNewsDate(item.dateISO),
                                summary: item.summary,
                                tags: item.tags
                            })}
                            ${getPinButtonMarkup({
                                id: `news:${item.id}`,
                                anchor: `news:${item.id}`,
                                type: item.sourceType === 'status' ? 'incident' : 'news',
                                title: item.title,
                                subtitle: item.sourceName,
                                url: item.url,
                                severity: item.severity,
                                meta: {
                                    source: item.sourceName,
                                    date: item.dateISO,
                                    cves: item.cves
                                }
                            }, { compact: true })}
                        </div>
                    </div>
                `;
            }).join('');
            updatePinButtons();
        }

        function renderNewsBrief(items) {
            const updatedEl = document.getElementById('news-brief-updated');
            const priorityEl = document.getElementById('news-brief-priority');
            const cveEl = document.getElementById('news-brief-cves');
            const incidentEl = document.getElementById('news-brief-incidents');
            const cveSection = document.getElementById('news-brief-cve-section');

            if (updatedEl) {
                updatedEl.textContent = `Updated ${new Date().toLocaleTimeString('en-US', { hour: 'numeric', minute: '2-digit' })}`;
            }

            const priorityItems = items.filter(item => (newsSeverityRank[item.severity] || 1) >= newsSeverityRank.HIGH).slice(0, 3);
            const incidentItems = items.filter(item => item.sourceType === 'status' || item.tags.includes('incident')).slice(0, 1);

            if (priorityEl) {
                priorityEl.innerHTML = priorityItems.length ? priorityItems.map(item => `
                    <div class="news-brief-item">
                        <div>
                            <a href="${item.url}" target="_blank" rel="noopener">${item.title}</a>
                            <div class="news-brief-meta">${item.sourceName}</div>
                        </div>
                        ${getPinButtonMarkup({
                            id: `brief:${item.id}`,
                            anchor: `news:${item.id}`,
                            type: 'news',
                            title: item.title,
                            subtitle: item.sourceName,
                            url: item.url,
                            severity: item.severity
                        }, { compact: true, label: 'Pin' })}
                    </div>
                `).join('') : '<div class="news-brief-meta">No high-severity items in range.</div>';
            }

            if (incidentEl) {
                incidentEl.innerHTML = incidentItems.length ? incidentItems.map(item => `
                    <div class="news-brief-item">
                        <div>
                            <a href="${item.url}" target="_blank" rel="noopener">${item.title}</a>
                            <div class="news-brief-meta">${item.sourceName}</div>
                        </div>
                        ${getPinButtonMarkup({
                            id: `brief-incident:${item.id}`,
                            anchor: `news:${item.id}`,
                            type: 'incident',
                            title: item.title,
                            subtitle: item.sourceName,
                            url: item.url,
                            severity: item.severity
                        }, { compact: true, label: 'Pin' })}
                    </div>
                `).join('') : '<div class="news-brief-meta">No active incidents in range.</div>';
            }

            if (cveEl && cveSection) {
                const criticalCves = Array.isArray(nvdCVEsCache)
                    ? nvdCVEsCache.filter(cve => cve.severity === 'CRITICAL').slice(0, 3)
                    : [];
                if (criticalCves.length) {
                    cveSection.style.display = '';
                    cveEl.innerHTML = criticalCves.map(cve => `
                        <div class="news-brief-item">
                            <div>
                                <a href="https://nvd.nist.gov/vuln/detail/${cve.cve_id}" target="_blank" rel="noopener">${cve.cve_id}</a>
                                <div class="news-brief-meta">${cve.title}</div>
                            </div>
                            ${getPinButtonMarkup({
                                id: `brief-cve:${cve.cve_id}`,
                                anchor: `cve:${cve.cve_id}`,
                                type: 'cve',
                                title: cve.cve_id,
                                subtitle: cve.title,
                                url: `https://nvd.nist.gov/vuln/detail/${cve.cve_id}`,
                                severity: cve.severity
                            }, { compact: true, label: 'Pin' })}
                        </div>
                    `).join('');
                } else {
                    cveSection.style.display = 'none';
                }
            }
        }

        async function renderNews() {
            await fetchLatestNews();
            applyNewsFilters();
            renderNewsBrief(newsState.filtered);
            const lastVisit = getLastVisitTimestamp();
            populateNewsGrid(newsState.filtered, lastVisit);
            setLastVisitTimestamp();
            const meta = document.getElementById('news-feed-meta');
            if (meta) {
                meta.textContent = `Showing ${newsState.filtered.length} stories â€¢ ${newsState.items.length} total â€¢ ${newsState.timeRange.toUpperCase()} range`;
            }
            renderPostureDashboard();
        }

        function updateNewsView() {
            applyNewsFilters();
            renderNewsBrief(newsState.filtered);
            const lastVisit = getLastVisitTimestamp();
            populateNewsGrid(newsState.filtered, lastVisit);
            const meta = document.getElementById('news-feed-meta');
            if (meta) {
                meta.textContent = `Showing ${newsState.filtered.length} stories â€¢ ${newsState.items.length} total â€¢ ${newsState.timeRange.toUpperCase()} range`;
            }
        }

        function setupNewsFilters() {
            const categoryTabs = document.getElementById('news-category-tabs');
            if (categoryTabs) {
                categoryTabs.addEventListener('click', event => {
                    const btn = event.target.closest('.news-category-btn');
                    if (!btn) return;
                    newsState.category = btn.dataset.category || 'all';
                    categoryTabs.querySelectorAll('.news-category-btn').forEach(button => {
                        button.classList.toggle('active', button === btn);
                    });
                    updateNewsView();
                });
            }

            const severitySelect = document.getElementById('news-severity-filter');
            if (severitySelect) {
                severitySelect.value = newsState.severity;
                severitySelect.addEventListener('change', () => {
                    newsState.severity = severitySelect.value;
                    updateNewsView();
                });
            }

            const timeSelect = document.getElementById('news-time-filter');
            if (timeSelect) {
                timeSelect.value = newsState.timeRange;
                timeSelect.addEventListener('change', () => {
                    newsState.timeRange = timeSelect.value;
                    updateNewsView();
                });
            }

            const searchInput = document.getElementById('news-search');
            if (searchInput) {
                searchInput.addEventListener('input', () => {
                    newsState.search = searchInput.value;
                    updateNewsView();
                });
            }

            document.addEventListener('click', event => {
                const chip = event.target.closest('[data-cve-chip]');
                if (!chip) return;
                const cve = chip.dataset.cveChip;
                if (cve) {
                    prefillCveLookup(cve);
                }
            });
        }

        function activateMainTab(tabName) {
            const tabBtn = document.querySelector(`.tab-btn[data-tab="${tabName}"]`);
            if (tabBtn) tabBtn.click();
        }

        function prefillCveLookup(cveId) {
            activateMainTab('threats');
            setTimeout(() => {
                const input = document.getElementById('cve-input');
                if (input) {
                    input.value = cveId;
                    input.focus();
                    input.scrollIntoView({ behavior: 'smooth', block: 'center' });
                }
            }, 200);
        }

        // Tab Navigation
        function setupTabNavigation() {
            // Bind only main tabs (data-tab) to prevent Data Bank sub-tabs from leaking across pages.
            const tabButtons = document.querySelectorAll('.tab-btn[data-tab]');
            const tabContents = document.querySelectorAll('.main-panel');
            const learningSubpanels = document.querySelectorAll('.learning-subpanel');
            const databankRoot = document.getElementById('learning-databank-content');

            tabButtons.forEach(btn => {
                btn.addEventListener('click', () => {
                    const tabName = btn.dataset.tab;
                    
                    // Update active states
                    tabButtons.forEach(b => b.classList.remove('active'));
                    btn.classList.add('active');
                    
                    tabContents.forEach(content => {
                        content.classList.remove('active');
                    });

                    const targetPanel = document.getElementById(`${tabName}-tab`);
                    if (targetPanel) {
                        targetPanel.classList.add('active');
                    }
                    appState.currentTab = tabName;

                    if (tabName !== 'learning') {
                        learningSubpanels.forEach(panel => {
                            panel.classList.remove('active');
                            panel.style.display = 'none';
                        });
                    } else {
                        learningSubpanels.forEach(panel => {
                            panel.style.display = '';
                        });
                        const activeButton = document.querySelector('.learning-subtab-btn.active');
                        const subtab = activeButton?.dataset?.subtab || 'news';
                        activateLearningSubTab(subtab);
                    }

                    if (tabName !== 'learning' && databankRoot) {
                        databankRoot.classList.remove('active');
                        databankRoot.style.display = 'none';
                    }

                    if (tabName === 'threats') {
                        loadNVDCVEs();
                        loadMITREThreatActors();
                    }
                });
            });
        }

        function refreshNewsFeed() {
            const btn = event?.target;
            if (btn) {
                btn.innerHTML = '<span class="spinner"></span> Refreshing...';
                btn.classList.add('loading');
            }
            renderNews().finally(() => {
                if (btn) {
                    btn.innerHTML = 'Refresh Feed';
                    btn.classList.remove('loading');
                }
            });
        }

        // Load More News (legacy)
        function loadMoreNews() {
            refreshNewsFeed();
        }

        // Perform Research with Perplexity API
        async function performResearch() {
            const topic = document.getElementById('research-topic').value;
            const depth = document.getElementById('research-depth').value;
            const resultsDiv = document.getElementById('research-results');
            const exportBtns = document.getElementById('research-export-buttons');
            const btn = event.target;

            if (!topic.trim()) {
                alert('Please enter a research topic');
                return;
            }

            btn.innerHTML = '<span class="spinner"></span> Researching with AI...';
            btn.classList.add('loading');
            resultsDiv.classList.add('hidden');
            exportBtns.classList.add('hidden');

            try {
                const depthPrompt = {
                    'summary': 'Provide a concise summary',
                    'detailed': 'Provide a comprehensive detailed analysis',
                    'expert': 'Provide an in-depth expert-level technical review'
                }[depth];

                const query = `${depthPrompt} about: ${topic}. Include key points, practical recommendations, and implementation guidance for cybersecurity and GRC professionals.`;
                
                const result = await callPerplexityAPI(query);
                
                const timestamp = new Date().toLocaleString();
                appState.lastResults.research = {
                    title: topic,
                    content: result,
                    depth: depth,
                    timestamp: timestamp
                };

                resultsDiv.innerHTML = `
                    <div class="results-card" id="research-result-content">
                        <h3>Research Results: ${depth.charAt(0).toUpperCase() + depth.slice(1)} Analysis</h3>
                        <p><strong>Topic:</strong> ${topic}</p>
                        <p><strong>Generated:</strong> ${timestamp}</p>
                        <hr style="border: 0; border-top: 1px solid rgba(255,255,255,0.2); margin: 16px 0;">
                        <div style="line-height: 1.8; white-space: pre-wrap;">${result}</div>
                    </div>
                `;
                resultsDiv.classList.remove('hidden');
                exportBtns.classList.remove('hidden');
            } catch (error) {
                resultsDiv.innerHTML = `
                    <div class="results-card" style="border-left-color: #ff0040;">
                        <h3 style="color: #ff0040;">âš ï¸ Error</h3>
                        <p>${error.message}</p>
                        <p style="font-size: 13px; color: rgba(255,255,255,0.6);">Please check the server configuration and try again.</p>
                    </div>
                `;
                resultsDiv.classList.remove('hidden');
            } finally {
                btn.innerHTML = '<span>Start Research</span>';
                btn.classList.remove('loading');
            }
        }

        // Analyze YouTube with Perplexity API
        async function analyzeYouTube() {
            const url = document.getElementById('youtube-url').value;
            const action = document.getElementById('youtube-action').value;
            const resultsDiv = document.getElementById('youtube-results');
            const exportBtns = document.getElementById('youtube-export-buttons');
            const btn = event.target;

            if (!url.trim()) {
                alert('Please enter a YouTube URL');
                return;
            }

            btn.innerHTML = '<span class="spinner"></span> Analyzing with AI...';
            btn.classList.add('loading');
            resultsDiv.classList.add('hidden');
            exportBtns.classList.add('hidden');

            try {
                const actionPrompt = {
                    'summary': 'Provide a comprehensive summary with key takeaways',
                    'quiz': 'Generate a knowledge check quiz with 5 multiple choice questions',
                    'keypoints': 'Extract key points with timestamps and detailed breakdown'
                }[action];

                const query = `For the YouTube video at ${url}, ${actionPrompt}. Focus on cybersecurity and GRC content if applicable.`;
                
                const result = await callPerplexityAPI(query);
                
                const timestamp = new Date().toLocaleString();
                appState.lastResults.youtube = {
                    title: 'YouTube Video Analysis',
                    url: url,
                    content: result,
                    action: action,
                    timestamp: timestamp
                };

                let content = '';
                
                if (action === 'summary') {
                    content = `
                        <div class="video-info">
                            <div class="video-thumbnail">â–¶ï¸</div>
                            <div class="video-details">
                                <h4>Video Analysis</h4>
                                <div class="video-meta">
                                    <span>ðŸ“º ${url}</span>
                                </div>
                            </div>
                        </div>
                        <div class="results-card" id="youtube-result-content">
                            <h3>Video Summary</h3>
                            <p><strong>Generated:</strong> ${timestamp}</p>
                            <hr style="border: 0; border-top: 1px solid rgba(255,255,255,0.2); margin: 16px 0;">
                            <div style="line-height: 1.8; white-space: pre-wrap;">${result}</div>
                        </div>
                    `;
                } else {
                    content = `
                        <div class="results-card" id="youtube-result-content">
                            <h3>${action === 'quiz' ? 'Knowledge Check Quiz' : 'Key Points Breakdown'}</h3>
                            <p><strong>Video:</strong> ${url}</p>
                            <p><strong>Generated:</strong> ${timestamp}</p>
                            <hr style="border: 0; border-top: 1px solid rgba(255,255,255,0.2); margin: 16px 0;">
                            <div style="line-height: 1.8; white-space: pre-wrap;">${result}</div>
                        </div>
                    `;
                }

                resultsDiv.innerHTML = content;
                resultsDiv.classList.remove('hidden');
                exportBtns.classList.remove('hidden');
            } catch (error) {
                resultsDiv.innerHTML = `
                    <div class="results-card" style="border-left-color: #ff0040;">
                        <h3 style="color: #ff0040;">âš ï¸ Error</h3>
                        <p>${error.message}</p>
                        <p style="font-size: 13px; color: rgba(255,255,255,0.6);">Please check the server configuration and try again.</p>
                    </div>
                `;
                resultsDiv.classList.remove('hidden');
            } finally {
                btn.innerHTML = '<span>Analyze Video</span>';
                btn.classList.remove('loading');
            }
        }

        // Legacy function for compatibility
        function analyzeYouTubeLegacy() {
            const url = document.getElementById('youtube-url').value;
            const action = document.getElementById('youtube-action').value;
            const resultsDiv = document.getElementById('youtube-results');
            const btn = event.target;

            if (!url.trim()) {
                alert('Please enter a YouTube URL');
                return;
            }

            btn.innerHTML = '<span class="spinner"></span> Analyzing...';
            btn.classList.add('loading');

            setTimeout(() => {
                let content = '';
                
                if (action === 'summary') {
                    content = `
                        <div class="video-info">
                            <div class="video-thumbnail">â–¶ï¸</div>
                            <div class="video-details">
                                <h4>NIST CSF 2.0 Deep Dive</h4>
                                <div class="video-meta">
                                    <span>ðŸ“º GRC Academy</span>
                                    <span>â±ï¸ 45:23</span>
                                    <span>ðŸ‘ï¸ 12.5K views</span>
                                </div>
                            </div>
                        </div>
                        <div class="results-card">
                            <h3>Video Summary</h3>
                            <p><strong>Overview:</strong> This comprehensive video covers the latest updates to NIST Cybersecurity Framework 2.0, focusing on governance enhancements and practical implementation strategies.</p>
                            <p><strong>Key Takeaways:</strong></p>
                            <p>â€¢ Framework now includes 6 core functions (Govern added)<br>
                            â€¢ Enhanced focus on supply chain security<br>
                            â€¢ Better alignment with other frameworks (ISO, CIS)<br>
                            â€¢ Practical implementation examples from Fortune 500 companies<br>
                            â€¢ Common pitfalls and how to avoid them</p>
                            <p><strong>Best For:</strong> GRC professionals, security architects, and compliance managers looking to understand and implement NIST CSF 2.0.</p>
                        </div>
                    `;
                } else if (action === 'quiz') {
                    content = `
                        <div class="results-card">
                            <h3>Knowledge Check Quiz</h3>
                            <div class="quiz-question">
                                <h4>Question 1: What is the new 6th core function in NIST CSF 2.0?</h4>
                                <div class="quiz-options">
                                    <div class="quiz-option">A) Identify</div>
                                    <div class="quiz-option">B) Govern</div>
                                    <div class="quiz-option">C) Protect</div>
                                    <div class="quiz-option">D) Secure</div>
                                </div>
                            </div>
                            <div class="quiz-question">
                                <h4>Question 2: Which area received enhanced focus in version 2.0?</h4>
                                <div class="quiz-options">
                                    <div class="quiz-option">A) Network Security</div>
                                    <div class="quiz-option">B) Supply Chain Risk Management</div>
                                    <div class="quiz-option">C) Physical Security</div>
                                    <div class="quiz-option">D) User Training</div>
                                </div>
                            </div>
                            <div class="quiz-question">
                                <h4>Question 3: NIST CSF 2.0 aligns better with which frameworks?</h4>
                                <div class="quiz-options">
                                    <div class="quiz-option">A) ISO 27001 and CIS Controls</div>
                                    <div class="quiz-option">B) COBIT only</div>
                                    <div class="quiz-option">C) PCI-DSS only</div>
                                    <div class="quiz-option">D) HIPAA only</div>
                                </div>
                            </div>
                        </div>
                    `;
                } else {
                    content = `
                        <div class="results-card">
                            <h3>Key Points Breakdown</h3>
                            <p><strong>00:00 - Introduction</strong><br>Overview of NIST CSF evolution and why 2.0 matters</p>
                            <p><strong>05:30 - New Govern Function</strong><br>Deep dive into governance requirements and implementation</p>
                            <p><strong>15:45 - Supply Chain Security</strong><br>Enhanced controls for third-party risk management</p>
                            <p><strong>25:20 - Framework Alignment</strong><br>How NIST CSF 2.0 maps to ISO 27001 and CIS Controls</p>
                            <p><strong>32:10 - Implementation Strategy</strong><br>Step-by-step approach with real-world examples</p>
                            <p><strong>40:00 - Common Pitfalls</strong><br>Mistakes to avoid and lessons learned from early adopters</p>
                        </div>
                    `;
                }

                resultsDiv.innerHTML = content;
                resultsDiv.classList.remove('hidden');
                btn.innerHTML = '<span>Analyze Video</span>';
                btn.classList.remove('loading');
            }, 2000);
        }

        // File Upload Setup
        function setupFileUpload() {
            const uploadArea = document.getElementById('file-upload-area');
            const fileInput = document.getElementById('file-input');
            const analyzeBtn = document.getElementById('analyze-doc-btn');

            uploadArea.addEventListener('click', () => fileInput.click());

            fileInput.addEventListener('change', (e) => {
                const file = e.target.files[0];
                if (file) {
                    handleFileUpload(file);
                }
            });

            // Drag and drop
            uploadArea.addEventListener('dragover', (e) => {
                e.preventDefault();
                uploadArea.classList.add('drag-over');
            });

            uploadArea.addEventListener('dragleave', () => {
                uploadArea.classList.remove('drag-over');
            });

            uploadArea.addEventListener('drop', (e) => {
                e.preventDefault();
                uploadArea.classList.remove('drag-over');
                const file = e.dataTransfer.files[0];
                if (file) {
                    handleFileUpload(file);
                }
            });
        }

        function handleFileUpload(file) {
            appState.uploadedFile = file;
            const fileInfoDiv = document.getElementById('file-info');
            const analyzeBtn = document.getElementById('analyze-doc-btn');
            
            fileInfoDiv.innerHTML = `
                <div class="file-info">
                    <span style="font-size: 24px;">ðŸ“„</span>
                    <div style="flex: 1;">
                        <div style="font-weight: 600; margin-bottom: 4px;">${file.name}</div>
                        <div style="font-size: 12px; color: rgba(255, 255, 255, 0.6);">${(file.size / 1024).toFixed(2)} KB</div>
                    </div>
                    <span style="color: var(--color-teal-accent);">âœ“</span>
                </div>
            `;
            fileInfoDiv.classList.remove('hidden');
            analyzeBtn.disabled = false;
        }

        function cleanSummaryText(text) {
            if (!text) return '';
            let cleaned = text.replace(/\[\d+\](\s*\[\d+\])+/g, '');
            cleaned = cleaned.replace(/\[\d+\]/g, '');
            cleaned = cleaned.replace(/[ \t]{2,}/g, ' ');
            cleaned = cleaned.replace(/[ \t]+\n/g, '\n').trim();
            return cleaned;
        }

        function sanitizeArtifactValue(value) {
            if (!value) return '';
            return value.replace(/[),.;]+$/g, '');
        }

        function extractArtifacts(primaryText, secondaryText) {
            const combined = [primaryText, secondaryText].filter(Boolean).join('\n');
            const cveRegex = /CVE-\d{4}-\d{4,7}/g;
            const ipRegex = /\b(?:(?:25[0-5]|2[0-4]\d|[01]?\d?\d)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d?\d)\b/g;
            const urlRegex = /https?:\/\/[^\s"'<>]+/g;
            const emailRegex = /\b[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,}\b/gi;
            const md5Regex = /\b[a-f0-9]{32}\b/gi;
            const sha1Regex = /\b[a-f0-9]{40}\b/gi;
            const sha256Regex = /\b[a-f0-9]{64}\b/gi;
            const domainRegex = /\b(?:[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?\.)+[a-z]{2,}\b/gi;

            const cves = new Set((combined.match(cveRegex) || []).map(value => value.toUpperCase()));
            const ips = new Set((combined.match(ipRegex) || []).map(value => value));
            const urls = new Set((combined.match(urlRegex) || []).map(value => sanitizeArtifactValue(value)));
            const emails = new Set((combined.match(emailRegex) || []).map(value => value.toLowerCase()));
            const md5 = new Set((combined.match(md5Regex) || []).map(value => value.toLowerCase()));
            const sha1 = new Set((combined.match(sha1Regex) || []).map(value => value.toLowerCase()));
            const sha256 = new Set((combined.match(sha256Regex) || []).map(value => value.toLowerCase()));

            const emailDomains = new Set(Array.from(emails).map(email => email.split('@')[1]).filter(Boolean));
            const urlDomains = new Set(Array.from(urls).map(url => {
                try {
                    return new URL(url).hostname.toLowerCase();
                } catch (error) {
                    return '';
                }
            }).filter(Boolean));

            const domains = new Set(
                (combined.match(domainRegex) || [])
                    .map(value => value.toLowerCase())
                    .filter(value => value && !emailDomains.has(value) && !urlDomains.has(value))
            );

            return {
                cves: Array.from(cves),
                ips: Array.from(ips),
                urls: Array.from(urls),
                emails: Array.from(emails),
                hashes: {
                    md5: Array.from(md5),
                    sha1: Array.from(sha1),
                    sha256: Array.from(sha256)
                },
                domains: Array.from(domains)
            };
        }

        function countArtifacts(artifacts) {
            if (!artifacts) return 0;
            return artifacts.cves.length +
                artifacts.ips.length +
                artifacts.urls.length +
                artifacts.emails.length +
                artifacts.domains.length +
                artifacts.hashes.md5.length +
                artifacts.hashes.sha1.length +
                artifacts.hashes.sha256.length;
        }

        function renderArtifactGroup(label, items, type, options = {}) {
            if (!items.length) return '';
            const chips = items.map(value => `
                <button class="artifact-chip" type="button" data-artifact-type="${type}" data-artifact-value="${escapeHtml(value)}" ${options.hashType ? `data-hash-type="${options.hashType}"` : ''}>
                    ${escapeHtml(value)} <span>Â· ${label}</span>
                </button>
            `).join('');
            return `
                <div>
                    <div class="artifact-group-title">${label} (${items.length})</div>
                    <div class="artifact-chips">${chips}</div>
                </div>
            `;
        }

        function renderArtifactsHtml(artifacts) {
            const total = countArtifacts(artifacts);
            if (!total) {
                return `<div class="artifact-empty">No artifacts detected.</div>`;
            }
            return `
                <div class="artifact-toolbar">
                    <div style="font-size: 12px; color: rgba(255,255,255,0.7);">${total} artifacts detected</div>
                    <button class="btn btn-secondary" type="button" data-artifact-action="copy-all">ðŸ“‹ Copy All Artifacts</button>
                </div>
                <div class="artifact-groups">
                    ${renderArtifactGroup('CVEs', artifacts.cves, 'cve')}
                    ${renderArtifactGroup('IPv4s', artifacts.ips, 'ip')}
                    ${renderArtifactGroup('URLs', artifacts.urls, 'url')}
                    ${renderArtifactGroup('Emails', artifacts.emails, 'email')}
                    ${renderArtifactGroup('Domains', artifacts.domains, 'domain')}
                    ${renderArtifactGroup('MD5', artifacts.hashes.md5, 'hash', { hashType: 'md5' })}
                    ${renderArtifactGroup('SHA1', artifacts.hashes.sha1, 'hash', { hashType: 'sha1' })}
                    ${renderArtifactGroup('SHA256', artifacts.hashes.sha256, 'hash', { hashType: 'sha256' })}
                </div>
            `;
        }

        function formatArtifactsForClipboard(artifacts) {
            if (!artifacts) return '';
            const lines = [];
            if (artifacts.cves.length) lines.push(`CVEs: ${artifacts.cves.join(', ')}`);
            if (artifacts.ips.length) lines.push(`IPs: ${artifacts.ips.join(', ')}`);
            if (artifacts.urls.length) lines.push(`URLs: ${artifacts.urls.join(', ')}`);
            if (artifacts.emails.length) lines.push(`Emails: ${artifacts.emails.join(', ')}`);
            if (artifacts.domains.length) lines.push(`Domains: ${artifacts.domains.join(', ')}`);
            if (artifacts.hashes.md5.length) lines.push(`MD5: ${artifacts.hashes.md5.join(', ')}`);
            if (artifacts.hashes.sha1.length) lines.push(`SHA1: ${artifacts.hashes.sha1.join(', ')}`);
            if (artifacts.hashes.sha256.length) lines.push(`SHA256: ${artifacts.hashes.sha256.join(', ')}`);
            return lines.join('\n');
        }

        function setupDocumentAnalyzerEnhancements() {
            document.addEventListener('click', event => {
                const accordionToggle = event.target.closest('[data-accordion-toggle]');
                if (accordionToggle && accordionToggle.closest('#document-results')) {
                    const targetId = accordionToggle.dataset.accordionToggle;
                    const target = targetId ? document.getElementById(targetId) : null;
                    if (target) {
                        const isExpanded = accordionToggle.getAttribute('aria-expanded') === 'true';
                        accordionToggle.setAttribute('aria-expanded', String(!isExpanded));
                        target.classList.toggle('is-collapsed', isExpanded);
                    }
                    return;
                }

                const actionBtn = event.target.closest('[data-artifact-action]');
                if (actionBtn && actionBtn.closest('#document-results')) {
                    if (actionBtn.dataset.artifactAction === 'copy-all') {
                        copyAllArtifactsToClipboard();
                    }
                    return;
                }

                const chip = event.target.closest('[data-artifact-type]');
                if (chip && chip.closest('#document-results')) {
                    routeArtifactToTool(chip.dataset.artifactType, chip.dataset.artifactValue);
                }
            });
        }

        function activateMainTab(tabName) {
            const button = document.querySelector(`.tab-btn[data-tab="${tabName}"]`);
            if (button) {
                button.click();
            }
        }

        function routeArtifactToTool(type, value) {
            if (!value) return;
            activateMainTab('tools');
            const toolMap = {
                cve: 'cve-input',
                ip: 'ip-input',
                url: 'url-input',
                hash: 'hash-input',
                email: 'email-input',
                domain: 'threatminer-input'
            };
            const inputId = toolMap[type];
            const input = inputId ? document.getElementById(inputId) : null;
            if (input) {
                input.value = value;
                input.focus();
                input.scrollIntoView({ behavior: 'smooth', block: 'center' });
            }
        }

        function copyAllArtifactsToClipboard() {
            const artifacts = appState.lastResults.document?.artifacts;
            if (!artifacts || !countArtifacts(artifacts)) {
                showToast('No artifacts to copy');
                return;
            }
            const text = formatArtifactsForClipboard(artifacts);
            navigator.clipboard.writeText(text).then(() => {
                showToast('Artifacts copied');
            }).catch(() => {
                showToast('Unable to copy artifacts');
            });
        }

        // Analyze Document with Perplexity API
        async function analyzeDocument() {
            const action = document.getElementById('document-action').value;
            const resultsDiv = document.getElementById('document-results');
            const exportBtns = document.getElementById('document-export-buttons');
            const btn = event.target;

            if (!appState.uploadedFile) {
                alert('Please upload a document first');
                return;
            }

            btn.innerHTML = '<span class="spinner"></span> Analyzing with AI...';
            btn.classList.add('loading');
            resultsDiv.classList.add('hidden');
            exportBtns.classList.add('hidden');

            try {
                // Read file content
                const fileContent = await readFileContent(appState.uploadedFile);
                appState.documentText = fileContent;
                
                const actionPrompt = {
                    'summarize': 'Provide an executive summary of this document',
                    'quiz': 'Generate a knowledge check quiz with 5 questions based on this document',
                    'qa': 'Analyze this document and be ready to answer questions about it'
                }[action];

                const query = `${actionPrompt}: ${fileContent.substring(0, 3000)}`; // Limit content size
                
                const result = await callPerplexityAPI(query);
                
                const timestamp = new Date().toLocaleString();
                let content = '';
                
                if (action === 'summarize') {
                    const cleanedResult = cleanSummaryText(result);
                    const artifacts = extractArtifacts(cleanedResult, fileContent);
                    appState.lastResults.document = {
                        title: appState.uploadedFile.name,
                        content: cleanedResult,
                        rawContent: result,
                        cleanedContent: cleanedResult,
                        action: action,
                        timestamp: timestamp,
                        artifacts: artifacts
                    };
                    content = `
                        <div class="results-card" id="document-result-content" data-clipboard-anchor="document-summary">
                            <div class="doc-accordion">
                                <button class="doc-accordion-toggle" type="button" data-accordion-toggle="document-summary-body" aria-expanded="true">
                                    <span>Document Summary</span>
                                    <span>â–¾</span>
                                </button>
                                <div class="doc-accordion-body" id="document-summary-body">
                                    <p><strong>Document:</strong> ${appState.uploadedFile.name}</p>
                                    <p><strong>Generated:</strong> ${timestamp}</p>
                                    <hr style="border: 0; border-top: 1px solid rgba(255,255,255,0.2); margin: 16px 0;">
                                    <div style="line-height: 1.8; white-space: pre-wrap;">${cleanedResult}</div>
                                </div>
                            </div>
                            <div class="doc-accordion">
                                <button class="doc-accordion-toggle" type="button" data-accordion-toggle="document-artifacts-body" aria-expanded="true">
                                    <span>Detected Artifacts</span>
                                    <span>â–¾</span>
                                </button>
                                <div class="doc-accordion-body" id="document-artifacts-body">
                                    ${renderArtifactsHtml(artifacts)}
                                </div>
                            </div>
                        </div>
                    `;
                } else if (action === 'quiz') {
                    appState.lastResults.document = {
                        title: appState.uploadedFile.name,
                        content: result,
                        action: action,
                        timestamp: timestamp
                    };
                    content = `
                        <div class="results-card" id="document-result-content">
                            <h3>Document Knowledge Quiz</h3>
                            <p><strong>Document:</strong> ${appState.uploadedFile.name}</p>
                            <p><strong>Generated:</strong> ${timestamp}</p>
                            <hr style="border: 0; border-top: 1px solid rgba(255,255,255,0.2); margin: 16px 0;">
                            <div style="line-height: 1.8; white-space: pre-wrap;">${result}</div>
                        </div>
                    `;
                } else {
                    appState.lastResults.document = {
                        title: appState.uploadedFile.name,
                        content: result,
                        action: action,
                        timestamp: timestamp
                    };
                    content = `
                        <div class="results-card" id="document-result-content">
                            <h3>Q&amp;A Mode - Ask Questions</h3>
                            <p><strong>Document:</strong> ${appState.uploadedFile.name}</p>
                            <p><strong>Analysis:</strong></p>
                            <div style="line-height: 1.8; white-space: pre-wrap; margin-bottom: 20px;">${result}</div>
                            <hr style="border: 0; border-top: 1px solid rgba(255,255,255,0.2); margin: 16px 0;">
                            <div class="form-group">
                                <input type="text" class="form-input" id="qa-question" placeholder="e.g., What are the key risk factors mentioned?">
                            </div>
                            <button class="btn btn-primary" onclick="askQuestion()">
                                <span>Get Answer</span>
                            </button>
                            <div id="qa-answer" class="hidden" style="margin-top: 20px; padding: 16px; background: rgba(34,211,238,0.1); border-left: 3px solid var(--color-teal-accent); border-radius: 8px;">
                            </div>
                        </div>
                    `;
                }

                resultsDiv.innerHTML = content;
                resultsDiv.classList.remove('hidden');
                if (action !== 'qa') {
                    exportBtns.classList.remove('hidden');
                }
            } catch (error) {
                resultsDiv.innerHTML = `
                    <div class="results-card" style="border-left-color: #ff0040;">
                        <h3 style="color: #ff0040;">âš ï¸ Error</h3>
                        <p>${error.message}</p>
                        <p style="font-size: 13px; color: rgba(255,255,255,0.6);">Please check the server configuration and try again.</p>
                    </div>
                `;
                resultsDiv.classList.remove('hidden');
            } finally {
                btn.innerHTML = '<span>Analyze Document</span>';
                btn.classList.remove('loading');
            }
        }

        // Read file content
        function readFileContent(file) {
            return new Promise((resolve, reject) => {
                const reader = new FileReader();
                reader.onload = (e) => resolve(e.target.result);
                reader.onerror = (e) => reject(new Error('Failed to read file'));
                reader.readAsText(file);
            });
        }

        // Legacy document analyzer
        function analyzeDocumentLegacy() {
            const action = document.getElementById('document-action').value;
            const resultsDiv = document.getElementById('document-results');
            const btn = event.target;

            if (!appState.uploadedFile) {
                alert('Please upload a document first');
                return;
            }

            btn.innerHTML = '<span class="spinner"></span> Analyzing...';
            btn.classList.add('loading');

            setTimeout(() => {
                let content = '';
                
                if (action === 'summarize') {
                    content = `
                        <div class="results-card">
                            <h3>Document Summary</h3>
                            <p><strong>Document:</strong> ${appState.uploadedFile.name}</p>
                            <p><strong>Executive Summary:</strong></p>
                            <p>This document outlines a comprehensive risk assessment framework for cloud infrastructure implementations. It covers key areas including data classification, access control mechanisms, encryption standards, and compliance requirements.</p>
                            <p><strong>Key Topics Covered:</strong></p>
                            <p>â€¢ Risk identification and classification methodology<br>
                            â€¢ Control implementation strategies<br>
                            â€¢ Compliance mapping (NIST, ISO, SOC 2)<br>
                            â€¢ Continuous monitoring approach<br>
                            â€¢ Incident response procedures</p>
                            <p><strong>Recommendations:</strong> The document recommends a phased approach to implementation, starting with high-risk areas and expanding coverage over 12-18 months.</p>
                        </div>
                    `;
                } else if (action === 'quiz') {
                    content = `
                        <div class="results-card">
                            <h3>Document Knowledge Quiz</h3>
                            <div class="quiz-question">
                                <h4>Question 1: What is the primary focus of this document?</h4>
                                <div class="quiz-options">
                                    <div class="quiz-option">A) Network Architecture</div>
                                    <div class="quiz-option">B) Cloud Risk Assessment Framework</div>
                                    <div class="quiz-option">C) Employee Training</div>
                                    <div class="quiz-option">D) Budget Planning</div>
                                </div>
                            </div>
                            <div class="quiz-question">
                                <h4>Question 2: Which frameworks are mentioned for compliance mapping?</h4>
                                <div class="quiz-options">
                                    <div class="quiz-option">A) NIST, ISO, and SOC 2</div>
                                    <div class="quiz-option">B) Only GDPR</div>
                                    <div class="quiz-option">C) Only PCI-DSS</div>
                                    <div class="quiz-option">D) None specified</div>
                                </div>
                            </div>
                        </div>
                    `;
                } else {
                    content = `
                        <div class="results-card">
                            <h3>Q&amp;A Mode - Ask Questions</h3>
                            <p style="margin-bottom: 20px;">Ask specific questions about the document content:</p>
                            <div class="form-group">
                                <input type="text" class="form-input" id="qa-question" placeholder="e.g., What are the key risk factors mentioned?">
                            </div>
                            <button class="btn btn-primary" onclick="askQuestion()">
                                <span>Get Answer</span>
                            </button>
                            <div id="qa-answer" class="hidden" style="margin-top: 20px; padding: 16px; background: rgba(34,211,238,0.1); border-left: 3px solid var(--color-teal-accent); border-radius: 8px;">
                            </div>
                        </div>
                    `;
                }

                resultsDiv.innerHTML = content;
                resultsDiv.classList.remove('hidden');
                btn.innerHTML = '<span>Analyze Document</span>';
                btn.classList.remove('loading');
            }, 2000);
        }

        async function askQuestion() {
            const question = document.getElementById('qa-question').value;
            const answerDiv = document.getElementById('qa-answer');
            const btn = event.target;
            
            if (!question.trim()) {
                alert('Please enter a question');
                return;
            }

            btn.innerHTML = '<span class="spinner"></span> Getting answer...';
            btn.classList.add('loading');

            try {
                const fileContent = await readFileContent(appState.uploadedFile);
                const query = `Based on this document content: ${fileContent.substring(0, 2000)}\n\nQuestion: ${question}\n\nProvide a detailed answer based only on the document content.`;
                
                const result = await callPerplexityAPI(query);
                
                answerDiv.innerHTML = `
                    <p><strong>Q:</strong> ${question}</p>
                    <p style="margin-top: 12px;"><strong>A:</strong> ${result}</p>
                `;
                answerDiv.classList.remove('hidden');
            } catch (error) {
                answerDiv.innerHTML = `
                    <p style="color: #ff0040;"><strong>Error:</strong> ${error.message}</p>
                `;
                answerDiv.classList.remove('hidden');
            } finally {
                btn.innerHTML = '<span>Get Answer</span>';
                btn.classList.remove('loading');
            }
        }

        // Learning Hub Sub-tab Switcher - INSTANT SWITCHING, NO DELAY
        function activateLearningSubTab(tabName) {
            // INSTANT SWITCH: Remove active from all content sections
            const allContent = document.querySelectorAll('.learning-subtab');
            allContent.forEach(content => content.classList.remove('active'));
            
            // INSTANT SWITCH: Show selected content immediately
            const contentMap = {
                'news': 'learning-news-content',
                'research': 'learning-research-content',
                'youtube': 'learning-youtube-content',
                'document': 'learning-docs-content',
                'library': 'learning-library-content',
                'databank': 'learning-databank-content'
            };
            
            const targetId = contentMap[tabName];
            if (targetId) {
                const targetContent = document.getElementById(targetId);
                if (targetContent) {
                    targetContent.classList.add('active');
                }
                
                // Initialize Data Bank if needed
                if (tabName === 'databank') {
                    switchDataBankSection(dataBankState.activeSection || 'frameworks');
                }
            }

            // Update button states - remove active from all
            const allButtons = document.querySelectorAll('.learning-subtab-btn');
            allButtons.forEach(btn => btn.classList.remove('active'));
            
            // Add active to clicked button
            const buttonMap = {
                'news': 'learning-news-btn',
                'research': 'learning-research-btn',
                'youtube': 'learning-youtube-btn',
                'document': 'learning-docs-btn',
                'library': 'learning-library-btn',
                'databank': 'learning-databank-btn'
            };
            
            const targetBtn = buttonMap[tabName];
            if (targetBtn) {
                const btn = document.getElementById(targetBtn);
                if (btn) {
                    btn.classList.add('active');
                }
            }
        }

        // Data Bank: Section Switcher & Rendering
        const dataBankData = {
            frameworks: [
                {
                    id: "nist-csf-2-0",
                    type: "framework",
                    name: "NIST Cybersecurity Framework 2.0",
                    version: "2.0",
                    functions: 6,
                    categories: 23,
                    subcategories: 108,
                    link: "https://www.nist.gov/cyberframework",
                    description: "Flexible, voluntary framework for managing cybersecurity risks",
                    best_for: "All organizations, especially critical infrastructure",
                    functions_list: ["Govern", "Identify", "Protect", "Detect", "Respond", "Recover"],
                    what_it_is: "A risk-based framework that helps organizations manage, reduce, and communicate cybersecurity risk.",
                    who_its_for: "Executives, CISOs, risk owners, and teams building an enterprise-wide security program.",
                    structure_summary: "Organized into 6 Functions, 23 Categories, and 108 Subcategories with Profiles and Tiers.",
                    checklist: [
                        "Define the organizational scope and critical services",
                        "Complete a baseline risk assessment",
                        "Map current controls to CSF Categories",
                        "Establish a target profile aligned to business goals",
                        "Prioritize gaps based on risk tolerance",
                        "Assign owners and timelines for remediation",
                        "Document metrics and desired outcomes",
                        "Align policies to CSF governance expectations",
                        "Validate third-party dependencies",
                        "Schedule quarterly program reviews"
                    ],
                    evidence_examples: [
                        "CSF profile mapping worksheet",
                        "Risk register with prioritized actions",
                        "Program roadmap and ownership matrix",
                        "Executive steering committee minutes"
                    ],
                    official_links: [
                        { label: "NIST CSF Portal", url: "https://www.nist.gov/cyberframework" },
                        { label: "CSF 2.0 Implementation Resources", url: "https://www.nist.gov/cyberframework/framework-implementation" }
                    ]
                },
                {
                    id: "nist-800-53-r5",
                    type: "framework",
                    name: "NIST SP 800-53 Revision 5",
                    version: "5",
                    controls: 1077,
                    families: 20,
                    link: "https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final",
                    description: "Comprehensive security controls for federal agencies",
                    best_for: "Federal agencies and government contractors",
                    what_it_is: "A catalog of security and privacy controls to protect federal information systems.",
                    who_its_for: "Federal programs, regulated industries, and organizations aligning to FedRAMP or CMMC.",
                    structure_summary: "20 control families and 1000+ controls with baselines for low, moderate, and high systems.",
                    checklist: [
                        "Select applicable baselines (Low/Moderate/High)",
                        "Tailor controls based on system risk",
                        "Define control implementation statements",
                        "Identify inherited vs. system-specific controls",
                        "Validate control ownership and evidence sources",
                        "Create SSP with implementation details",
                        "Execute assessment procedures",
                        "Track POA&M items with due dates",
                        "Review continuous monitoring cadence"
                    ],
                    evidence_examples: [
                        "System Security Plan (SSP)",
                        "POA&M tracker",
                        "Assessment report and control test results",
                        "Continuous monitoring dashboard"
                    ],
                    official_links: [
                        { label: "NIST SP 800-53 Rev 5", url: "https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final" }
                    ]
                },
                {
                    id: "iso-27001-2022",
                    type: "framework",
                    name: "ISO 27001:2022",
                    version: "2022",
                    controls: 93,
                    domains: 4,
                    link: "https://www.iso.org/standard/27001",
                    description: "International standard for information security management",
                    best_for: "Organizations seeking global certification",
                    what_it_is: "A certifiable ISMS standard focused on governance, risk management, and continual improvement.",
                    who_its_for: "Organizations pursuing ISO certification or aligning to international compliance requirements.",
                    structure_summary: "Annex A includes 93 controls across 4 themes: Organizational, People, Physical, and Technological.",
                    checklist: [
                        "Define ISMS scope and boundaries",
                        "Perform ISMS risk assessment",
                        "Draft Statement of Applicability",
                        "Implement Annex A controls",
                        "Train stakeholders and assign roles",
                        "Document ISMS policies and procedures",
                        "Run internal audit cycle",
                        "Complete management review",
                        "Prepare for external certification audit"
                    ],
                    evidence_examples: [
                        "Statement of Applicability (SoA)",
                        "ISMS risk assessment reports",
                        "Internal audit results",
                        "Management review minutes"
                    ],
                    official_links: [
                        { label: "ISO 27001 Standard", url: "https://www.iso.org/standard/27001" }
                    ]
                },
                {
                    id: "cis-controls-v8",
                    type: "framework",
                    name: "CIS Controls v8",
                    version: "8",
                    controls: 18,
                    safeguards: 153,
                    link: "https://www.cisecurity.org/controls",
                    description: "Prescriptive, actionable best practices",
                    best_for: "SMBs and organizations with limited resources",
                    what_it_is: "A prioritized set of defensive actions organized into 18 controls and 153 safeguards.",
                    who_its_for: "Security teams that need a practical, stepwise implementation roadmap.",
                    structure_summary: "18 Controls grouped into Implementation Groups (IG1â€“IG3) with 153 safeguards.",
                    checklist: [
                        "Inventory hardware and software assets",
                        "Secure configuration baselines",
                        "Establish identity and access management",
                        "Prioritize IG1 safeguards",
                        "Harden endpoints and servers",
                        "Implement centralized logging",
                        "Secure backups and recovery plans",
                        "Test incident response playbooks"
                    ],
                    evidence_examples: [
                        "Asset inventory records",
                        "Configuration baseline documentation",
                        "Endpoint protection dashboards",
                        "Backup verification logs"
                    ],
                    official_links: [
                        { label: "CIS Controls Overview", url: "https://www.cisecurity.org/controls" }
                    ]
                }
            ],
            controlFamilies: [
                {
                    id: "ac-access-control",
                    type: "control",
                    code: "AC",
                    name: "Access Control",
                    description: "Controls for limiting access to systems and data",
                    key_controls: ["Least Privilege", "Multi-Factor Authentication", "Access Reviews"],
                    purpose: "Ensure only authorized users and systems can access sensitive resources.",
                    key_controls_detail: [
                        { name: "Least Privilege", description: "Grant only the minimum access needed for job functions." },
                        { name: "Multi-Factor Authentication", description: "Require multiple verification factors for privileged access." },
                        { name: "Access Reviews", description: "Periodically validate that access remains appropriate." }
                    ],
                    implementation_examples: [
                        "Role-based access control with approval workflows",
                        "Just-in-time admin access for sensitive systems",
                        "Quarterly access certification campaigns"
                    ],
                    evidence: [
                        "Access review logs and attestation reports",
                        "MFA enforcement configuration screenshots",
                        "Role matrix and provisioning tickets"
                    ],
                    audit_questions: [
                        "How are privileged accounts approved and reviewed?",
                        "What evidence shows MFA is enforced for sensitive systems?",
                        "How often are access rights revalidated?"
                    ]
                },
                {
                    id: "at-awareness-training",
                    type: "control",
                    code: "AT",
                    name: "Awareness and Training",
                    description: "Security awareness and training programs",
                    key_controls: ["Security Training", "Phishing Awareness", "Role-Based Training"],
                    purpose: "Build organizational security literacy and reduce user-driven risk.",
                    key_controls_detail: [
                        { name: "Security Training", description: "Baseline training for all employees and contractors." },
                        { name: "Phishing Awareness", description: "Ongoing phishing simulations and response coaching." },
                        { name: "Role-Based Training", description: "Targeted content for privileged or high-risk roles." }
                    ],
                    implementation_examples: [
                        "Quarterly phishing simulations with coaching",
                        "Annual security training for all staff",
                        "Secure coding sessions for engineering teams"
                    ],
                    evidence: [
                        "Training completion reports",
                        "Phishing simulation metrics",
                        "Role-based curriculum documents"
                    ],
                    audit_questions: [
                        "How do you measure training effectiveness?",
                        "Which roles receive additional training?",
                        "What happens when a user fails a phishing test?"
                    ]
                },
                {
                    id: "au-audit-accountability",
                    type: "control",
                    code: "AU",
                    name: "Audit and Accountability",
                    description: "Audit logging and monitoring capabilities",
                    key_controls: ["Audit Logging", "Log Retention", "Log Analysis"],
                    purpose: "Provide traceability of events and detect suspicious behavior.",
                    key_controls_detail: [
                        { name: "Audit Logging", description: "Enable logging for authentication, admin actions, and critical events." },
                        { name: "Log Retention", description: "Retain logs in accordance with legal and policy requirements." },
                        { name: "Log Analysis", description: "Review logs regularly or via automated detection." }
                    ],
                    implementation_examples: [
                        "Central SIEM with log normalization",
                        "Alerting for anomalous logins",
                        "Immutable storage for sensitive logs"
                    ],
                    evidence: [
                        "Log retention policy",
                        "SIEM alert reports",
                        "Sample audit logs with timestamps"
                    ],
                    audit_questions: [
                        "What events are logged for privileged activity?",
                        "How long are logs retained?",
                        "How are alerts reviewed and closed?"
                    ]
                },
                {
                    id: "ca-security-assessment",
                    type: "control",
                    code: "CA",
                    name: "Security Assessment and Authorization",
                    description: "Security assessments and system authorization",
                    key_controls: ["Security Assessment", "Continuous Monitoring", "Plan of Action"],
                    purpose: "Validate system security posture and authorize operation.",
                    key_controls_detail: [
                        { name: "Security Assessment", description: "Independent assessments of control effectiveness." },
                        { name: "Continuous Monitoring", description: "Ongoing evaluation of security posture." },
                        { name: "Plan of Action", description: "Track remediation activities and risk acceptance." }
                    ],
                    implementation_examples: [
                        "Annual control assessments",
                        "Continuous monitoring dashboards",
                        "POA&M management workflows"
                    ],
                    evidence: [
                        "Assessment reports",
                        "POA&M logs",
                        "Monitoring metrics"
                    ],
                    audit_questions: [
                        "How are assessments scheduled and tracked?",
                        "What remediation evidence is maintained?",
                        "How is authorization to operate documented?"
                    ]
                },
                {
                    id: "cm-configuration-management",
                    type: "control",
                    code: "CM",
                    name: "Configuration Management",
                    description: "Management of system configurations",
                    key_controls: ["Baseline Configuration", "Change Management", "Inventory"],
                    purpose: "Maintain secure baselines and control system changes.",
                    key_controls_detail: [
                        { name: "Baseline Configuration", description: "Define secure configurations for systems and services." },
                        { name: "Change Management", description: "Control and document configuration changes." },
                        { name: "Inventory", description: "Maintain accurate configuration inventories." }
                    ],
                    implementation_examples: [
                        "CIS benchmark baselines",
                        "Change approval boards",
                        "Automated configuration drift alerts"
                    ],
                    evidence: [
                        "Baseline configuration documents",
                        "Change tickets and approvals",
                        "Configuration inventory exports"
                    ],
                    audit_questions: [
                        "How are configuration changes approved?",
                        "What evidence shows baselines are enforced?",
                        "How is drift detected and corrected?"
                    ]
                },
                {
                    id: "cp-contingency-planning",
                    type: "control",
                    code: "CP",
                    name: "Contingency Planning",
                    description: "Plans for business continuity and disaster recovery",
                    key_controls: ["Backup", "Recovery Planning", "Incident Response"],
                    purpose: "Ensure operational resilience during disruptions.",
                    key_controls_detail: [
                        { name: "Backup", description: "Maintain backups for critical systems and data." },
                        { name: "Recovery Planning", description: "Define recovery procedures and RTO/RPO targets." },
                        { name: "Incident Response", description: "Coordinate recovery with incident response teams." }
                    ],
                    implementation_examples: [
                        "Quarterly disaster recovery tests",
                        "Immutable backup storage",
                        "Runbooks for critical services"
                    ],
                    evidence: [
                        "Backup logs and restore tests",
                        "Business impact analysis",
                        "DR test reports"
                    ],
                    audit_questions: [
                        "How often are backups tested?",
                        "What are the RTO/RPO targets?",
                        "How is recovery communicated to stakeholders?"
                    ]
                },
                {
                    id: "ia-identification-authentication",
                    type: "control",
                    code: "IA",
                    name: "Identification and Authentication",
                    description: "User identification and authentication mechanisms",
                    key_controls: ["User Authentication", "Credential Management", "MFA"],
                    purpose: "Verify identity and prevent unauthorized access.",
                    key_controls_detail: [
                        { name: "User Authentication", description: "Ensure users are uniquely identified." },
                        { name: "Credential Management", description: "Protect secrets, passwords, and keys." },
                        { name: "MFA", description: "Add additional factors for critical access." }
                    ],
                    implementation_examples: [
                        "SSO with conditional access",
                        "Privileged account password vault",
                        "MFA for VPN and admin consoles"
                    ],
                    evidence: [
                        "Authentication logs",
                        "Password policy documentation",
                        "MFA enrollment reports"
                    ],
                    audit_questions: [
                        "How are passwords and secrets protected?",
                        "Is MFA enforced for all privileged access?",
                        "How are identity anomalies detected?"
                    ]
                },
                {
                    id: "ir-incident-response",
                    type: "control",
                    code: "IR",
                    name: "Incident Response",
                    description: "Procedures for detecting and responding to incidents",
                    key_controls: ["Incident Handling", "Incident Analysis", "Evidence Handling"],
                    purpose: "Respond quickly and effectively to security incidents.",
                    key_controls_detail: [
                        { name: "Incident Handling", description: "Define roles and response procedures." },
                        { name: "Incident Analysis", description: "Analyze root causes and impact." },
                        { name: "Evidence Handling", description: "Preserve evidence for investigations." }
                    ],
                    implementation_examples: [
                        "24/7 incident triage rotations",
                        "Forensic evidence collection playbooks",
                        "Post-incident reviews"
                    ],
                    evidence: [
                        "Incident response plan",
                        "Incident reports",
                        "Evidence chain-of-custody records"
                    ],
                    audit_questions: [
                        "How are incidents classified and escalated?",
                        "What evidence shows response readiness?",
                        "How are lessons learned captured?"
                    ]
                },
                {
                    id: "ma-maintenance",
                    type: "control",
                    code: "MA",
                    name: "Maintenance",
                    description: "Maintenance of systems and security tools",
                    key_controls: ["Maintenance Procedures", "Tools Update", "Maintenance Tracking"],
                    purpose: "Ensure systems are maintained securely and reliably.",
                    key_controls_detail: [
                        { name: "Maintenance Procedures", description: "Standardize maintenance activities and approvals." },
                        { name: "Tools Update", description: "Keep maintenance tools patched and secure." },
                        { name: "Maintenance Tracking", description: "Track and audit maintenance actions." }
                    ],
                    implementation_examples: [
                        "Scheduled patch windows",
                        "Tool access restricted to authorized staff",
                        "Maintenance ticketing workflows"
                    ],
                    evidence: [
                        "Maintenance schedules",
                        "Patch logs",
                        "Maintenance approval records"
                    ],
                    audit_questions: [
                        "Who approves maintenance activities?",
                        "How is tool access controlled?",
                        "Where are maintenance logs stored?"
                    ]
                },
                {
                    id: "mp-media-protection",
                    type: "control",
                    code: "MP",
                    name: "Media Protection",
                    description: "Protection of physical and digital media",
                    key_controls: ["Media Sanitization", "Media Transport", "Media Storage"],
                    purpose: "Protect sensitive data stored on physical or digital media.",
                    key_controls_detail: [
                        { name: "Media Sanitization", description: "Securely erase or destroy sensitive media." },
                        { name: "Media Transport", description: "Control transport of removable media." },
                        { name: "Media Storage", description: "Secure storage for sensitive media." }
                    ],
                    implementation_examples: [
                        "Certified destruction for retired disks",
                        "Encrypted removable media policies",
                        "Locked storage cabinets"
                    ],
                    evidence: [
                        "Media disposal certificates",
                        "Media transport logs",
                        "Storage access records"
                    ],
                    audit_questions: [
                        "How is sensitive media destroyed?",
                        "Who is authorized to transport media?",
                        "Where is media stored and monitored?"
                    ]
                },
                {
                    id: "pe-physical-environmental",
                    type: "control",
                    code: "PE",
                    name: "Physical and Environmental Protection",
                    description: "Physical security of facilities and equipment",
                    key_controls: ["Access Control", "Environmental Controls", "Surveillance"],
                    purpose: "Protect facilities and critical systems from physical threats.",
                    key_controls_detail: [
                        { name: "Access Control", description: "Restrict facility access to authorized personnel." },
                        { name: "Environmental Controls", description: "Maintain power, cooling, and fire suppression." },
                        { name: "Surveillance", description: "Monitor facilities and entry points." }
                    ],
                    implementation_examples: [
                        "Badge-controlled data center access",
                        "Environmental sensor monitoring",
                        "24/7 CCTV coverage"
                    ],
                    evidence: [
                        "Access logs and badge reports",
                        "Environmental monitoring reports",
                        "Surveillance audit logs"
                    ],
                    audit_questions: [
                        "How is physical access authorized and tracked?",
                        "What environmental monitoring is in place?",
                        "How is surveillance footage retained?"
                    ]
                },
                {
                    id: "pl-planning",
                    type: "control",
                    code: "PL",
                    name: "Planning",
                    description: "Information security planning",
                    key_controls: ["Security Planning", "Policy Development", "Strategic Planning"],
                    purpose: "Establish and maintain security plans and policies.",
                    key_controls_detail: [
                        { name: "Security Planning", description: "Document and maintain security plans." },
                        { name: "Policy Development", description: "Create policies aligned to risk appetite." },
                        { name: "Strategic Planning", description: "Align security objectives with business strategy." }
                    ],
                    implementation_examples: [
                        "Annual security strategy refresh",
                        "Policy governance committee",
                        "Risk-based planning workshops"
                    ],
                    evidence: [
                        "Security plan documentation",
                        "Policy approval records",
                        "Strategic roadmap artifacts"
                    ],
                    audit_questions: [
                        "How are security plans reviewed?",
                        "Who approves security policies?",
                        "How is planning aligned to business goals?"
                    ]
                },
                {
                    id: "pm-program-management",
                    type: "control",
                    code: "PM",
                    name: "Program Management",
                    description: "Cybersecurity program management",
                    key_controls: ["Program Plan", "Risk Strategy", "Enterprise Architecture"],
                    purpose: "Coordinate security initiatives across the enterprise.",
                    key_controls_detail: [
                        { name: "Program Plan", description: "Define program goals, scope, and governance." },
                        { name: "Risk Strategy", description: "Define risk tolerances and management approach." },
                        { name: "Enterprise Architecture", description: "Align controls with architecture standards." }
                    ],
                    implementation_examples: [
                        "Security governance charters",
                        "Enterprise risk strategy documents",
                        "Architecture review boards"
                    ],
                    evidence: [
                        "Program plans and KPI dashboards",
                        "Risk strategy documentation",
                        "Architecture review minutes"
                    ],
                    audit_questions: [
                        "What governance model is used?",
                        "How is risk strategy communicated?",
                        "How are security initiatives prioritized?"
                    ]
                },
                {
                    id: "ps-personnel-security",
                    type: "control",
                    code: "PS",
                    name: "Personnel Security",
                    description: "Personnel security controls and management",
                    key_controls: ["Personnel Screening", "Termination", "Contractor Management"],
                    purpose: "Manage personnel risks throughout the employment lifecycle.",
                    key_controls_detail: [
                        { name: "Personnel Screening", description: "Conduct background checks as required." },
                        { name: "Termination", description: "Revoke access promptly on departure." },
                        { name: "Contractor Management", description: "Ensure third-party personnel meet security requirements." }
                    ],
                    implementation_examples: [
                        "Background check workflow integration",
                        "Exit checklist with access removal",
                        "Contractor onboarding controls"
                    ],
                    evidence: [
                        "Screening records",
                        "Termination tickets",
                        "Contractor agreements"
                    ],
                    audit_questions: [
                        "How is access removed upon termination?",
                        "What screening is performed?",
                        "How are contractors monitored?"
                    ]
                },
                {
                    id: "ra-risk-assessment",
                    type: "control",
                    code: "RA",
                    name: "Risk Assessment",
                    description: "Risk assessment and management",
                    key_controls: ["Risk Assessment", "Vulnerability Scanning", "Risk Review"],
                    purpose: "Identify and prioritize risks to support informed decisions.",
                    key_controls_detail: [
                        { name: "Risk Assessment", description: "Identify threats, vulnerabilities, and impacts." },
                        { name: "Vulnerability Scanning", description: "Scan systems on a defined cadence." },
                        { name: "Risk Review", description: "Review risks with stakeholders and owners." }
                    ],
                    implementation_examples: [
                        "Quarterly enterprise risk reviews",
                        "Weekly vulnerability scans",
                        "Risk scoring and prioritization"
                    ],
                    evidence: [
                        "Risk assessment reports",
                        "Vulnerability scan outputs",
                        "Risk review meeting notes"
                    ],
                    audit_questions: [
                        "How often are risk assessments performed?",
                        "How are risks prioritized?",
                        "Who approves risk acceptance?"
                    ]
                },
                {
                    id: "sa-system-services-acquisition",
                    type: "control",
                    code: "SA",
                    name: "System and Services Acquisition",
                    description: "Acquisition and management of systems and services",
                    key_controls: ["Requirements Definition", "Security Testing", "Supply Chain"],
                    purpose: "Ensure security requirements are built into acquisition and procurement.",
                    key_controls_detail: [
                        { name: "Requirements Definition", description: "Define security requirements for new systems." },
                        { name: "Security Testing", description: "Validate security before production release." },
                        { name: "Supply Chain", description: "Manage vendor and supply chain risk." }
                    ],
                    implementation_examples: [
                        "Security requirements in procurement templates",
                        "Pre-production security testing",
                        "Vendor risk assessments"
                    ],
                    evidence: [
                        "Procurement checklists",
                        "Security test results",
                        "Vendor assessment reports"
                    ],
                    audit_questions: [
                        "How are security requirements communicated to vendors?",
                        "What testing is required before launch?",
                        "How is supply chain risk evaluated?"
                    ]
                },
                {
                    id: "sc-system-communications-protection",
                    type: "control",
                    code: "SC",
                    name: "System and Communications Protection",
                    description: "Protection of system boundaries and communications",
                    key_controls: ["Boundary Protection", "Encryption", "DoS Protection"],
                    purpose: "Protect data in transit and maintain secure boundaries.",
                    key_controls_detail: [
                        { name: "Boundary Protection", description: "Manage network segmentation and perimeter controls." },
                        { name: "Encryption", description: "Encrypt data in transit and at rest." },
                        { name: "DoS Protection", description: "Mitigate denial-of-service threats." }
                    ],
                    implementation_examples: [
                        "Network segmentation with zero trust policies",
                        "TLS enforcement and key rotation",
                        "DDoS mitigation services"
                    ],
                    evidence: [
                        "Network architecture diagrams",
                        "Encryption policies",
                        "DDoS mitigation reports"
                    ],
                    audit_questions: [
                        "How are network boundaries protected?",
                        "What encryption standards are used?",
                        "How are DoS attacks monitored?"
                    ]
                },
                {
                    id: "si-system-information-integrity",
                    type: "control",
                    code: "SI",
                    name: "System and Information Integrity",
                    description: "System and information integrity protection",
                    key_controls: ["Malware Protection", "Software Integrity", "Monitoring"],
                    purpose: "Protect systems from malicious activity and ensure integrity.",
                    key_controls_detail: [
                        { name: "Malware Protection", description: "Deploy anti-malware and endpoint security controls." },
                        { name: "Software Integrity", description: "Validate software integrity and updates." },
                        { name: "Monitoring", description: "Continuously monitor for anomalies." }
                    ],
                    implementation_examples: [
                        "Endpoint detection and response tooling",
                        "Code signing for software releases",
                        "Continuous monitoring alerts"
                    ],
                    evidence: [
                        "Endpoint protection reports",
                        "Software integrity verification logs",
                        "Monitoring alerts and responses"
                    ],
                    audit_questions: [
                        "How is malware detected and remediated?",
                        "How are software updates validated?",
                        "How is continuous monitoring handled?"
                    ]
                }
            ],
            glossary: [
                {
                    id: "access-control",
                    type: "term",
                    term: "Access Control",
                    definition: "Policies and mechanisms that restrict system access to authorized users.",
                    expanded_definition: "Access control governs who can access systems, data, and facilities, ensuring least privilege and proper authentication.",
                    examples: ["Role-based access control (RBAC)", "Just-in-time administrative access"],
                    related: ["Least Privilege", "Multi-Factor Authentication", "Zero Trust"]
                },
                {
                    id: "attack-surface",
                    type: "term",
                    term: "Attack Surface",
                    definition: "All possible entry points where a system can be attacked",
                    expanded_definition: "The attack surface includes all hardware, software, APIs, and user interactions that could be exploited.",
                    examples: ["Public-facing APIs", "Unpatched servers", "Exposed cloud storage"],
                    related: ["Threat", "Vulnerability", "Risk"]
                },
                {
                    id: "baseline",
                    type: "term",
                    term: "Baseline",
                    definition: "A documented, approved configuration serving as a reference point",
                    expanded_definition: "Baselines establish secure configurations that act as a benchmark for auditing and drift detection.",
                    examples: ["CIS benchmark baseline", "Gold image for servers"],
                    related: ["Configuration Management", "Change Management"]
                },
                {
                    id: "cvss",
                    type: "term",
                    term: "CVSS",
                    definition: "Common Vulnerability Scoring System - metric for assessing vulnerability severity",
                    expanded_definition: "CVSS provides a standardized way to rate vulnerabilities on a 0.0â€“10.0 severity scale.",
                    examples: ["CVSS 9.8 critical rating", "Base score used for prioritization"],
                    related: ["Vulnerability", "Risk"]
                },
                {
                    id: "data-classification",
                    type: "term",
                    term: "Data Classification",
                    definition: "Process of organizing data by sensitivity and criticality",
                    expanded_definition: "Classifying data helps determine security controls based on confidentiality, integrity, and availability needs.",
                    examples: ["Public / Internal / Confidential tiers", "PII classification labels"],
                    related: ["Risk", "Governance"]
                },
                {
                    id: "defense-in-depth",
                    type: "term",
                    term: "Defense in Depth",
                    definition: "Multiple layers of security controls to reduce risk",
                    expanded_definition: "Layered security ensures that if one control fails, others mitigate the threat.",
                    examples: ["Firewall + MFA + EDR", "Network segmentation plus monitoring"],
                    related: ["Zero Trust", "Mitigation"]
                },
                {
                    id: "due-diligence",
                    type: "term",
                    term: "Due Diligence",
                    definition: "Investigation into compliance and security practices",
                    expanded_definition: "Due diligence validates security and compliance posture before approving vendors or initiatives.",
                    examples: ["Vendor security questionnaires", "M&A security assessments"],
                    related: ["Risk Assessment", "Governance"]
                },
                {
                    id: "exploit",
                    type: "term",
                    term: "Exploit",
                    definition: "Code or technique used to take advantage of a vulnerability",
                    expanded_definition: "Exploits leverage weaknesses to gain unauthorized access or disrupt systems.",
                    examples: ["Remote code execution exploits", "Privilege escalation exploits"],
                    related: ["Vulnerability", "Threat"]
                },
                {
                    id: "grc",
                    type: "term",
                    term: "GRC",
                    definition: "Governance, Risk, and Compliance management",
                    expanded_definition: "GRC aligns policy, risk management, and compliance obligations into a unified program.",
                    examples: ["Policy management workflows", "Risk register updates"],
                    related: ["Governance", "Compliance", "Risk"]
                },
                {
                    id: "isms",
                    type: "term",
                    term: "ISMS",
                    definition: "Information Security Management System",
                    expanded_definition: "An ISMS is the structured framework of policies and controls that manage information security risk.",
                    examples: ["ISO 27001-aligned ISMS", "Security policy library"],
                    related: ["ISO 27001", "Governance"]
                },
                {
                    id: "zero-trust",
                    type: "term",
                    term: "Zero Trust",
                    definition: "Security model requiring verification for every access request",
                    expanded_definition: "Zero Trust assumes no implicit trust and requires continuous verification.",
                    examples: ["Continuous authentication", "Micro-segmentation"],
                    related: ["Access Control", "Least Privilege"]
                },
                {
                    id: "vulnerability",
                    type: "term",
                    term: "Vulnerability",
                    definition: "Weakness in a system that can be exploited",
                    expanded_definition: "Vulnerabilities can stem from misconfigurations, software flaws, or process gaps.",
                    examples: ["Outdated software", "Open S3 buckets"],
                    related: ["Exploit", "Threat"]
                },
                {
                    id: "threat",
                    type: "term",
                    term: "Threat",
                    definition: "Potential danger that could exploit a vulnerability",
                    expanded_definition: "Threats include adversaries, malware, or environmental factors that impact security.",
                    examples: ["Ransomware campaign", "Insider threat"],
                    related: ["Risk", "Attack Surface"]
                },
                {
                    id: "risk",
                    type: "term",
                    term: "Risk",
                    definition: "Probability of a threat exploiting a vulnerability with impact",
                    expanded_definition: "Risk combines likelihood and impact to prioritize security actions.",
                    examples: ["High likelihood phishing risk", "Critical impact downtime risk"],
                    related: ["Threat", "Mitigation"]
                },
                {
                    id: "mitigation",
                    type: "term",
                    term: "Mitigation",
                    definition: "Actions taken to reduce risk impact or probability",
                    expanded_definition: "Mitigations include preventive, detective, and corrective controls.",
                    examples: ["Patching critical vulnerabilities", "Adding monitoring controls"],
                    related: ["Risk", "Control"]
                },
                {
                    id: "incident",
                    type: "term",
                    term: "Incident",
                    definition: "Security event that compromises information or systems",
                    expanded_definition: "Incidents require structured response to contain, eradicate, and recover.",
                    examples: ["Data breach", "Account takeover"],
                    related: ["Incident Response", "Threat"]
                }
            ],
            riskMatrices: [
                {
                    title: "Risk Matrix (Probability vs Impact)",
                    description: "Assess risk by mapping likelihood and impact levels. Standard grid: Low, Medium, High, Critical.",
                    table: [
                        [" ", "Low", "Medium", "High", "Critical"],
                        ["Low", "Low", "Low", "Medium", "High"],
                        ["Medium", "Low", "Medium", "High", "Critical"],
                        ["High", "Medium", "High", "Critical", "Critical"]
                    ]
                },
                {
                    title: "CVSS Scoring Scale",
                    description: "CVSS (Common Vulnerability Scoring System) rates vulnerabilities from 0.0â€“10.0. Severity: Low (0â€“3.9), Medium (4â€“6.9), High (7â€“8.9), Critical (9â€“10).",
                    scale: [
                        { range: "0â€“3.9", label: "Low", color: "#5dde8c" },
                        { range: "4â€“6.9", label: "Medium", color: "#ffd700" },
                        { range: "7â€“8.9", label: "High", color: "#ff6b00" },
                        { range: "9â€“10", label: "Critical", color: "#ff0040" }
                    ]
                },
                {
                    title: "Risk Rating Methodology",
                    description: "Risk = Likelihood x Impact. Matrix scores help prioritize security controls."
                }
            ],
            guides: [
                {
                    id: "nist-csf-implementation",
                    type: "guide",
                    title: "NIST CSF Implementation Steps",
                    summary: "A phased plan to align governance, risk, and controls to CSF outcomes.",
                    steps: [
                        {
                            step: "Conduct a cybersecurity risk assessment",
                            deliverables: ["Risk register", "Asset inventory"],
                            evidence: ["Assessment report", "Risk scoring worksheet"]
                        },
                        {
                            step: "Map existing controls to NIST CSF categories",
                            deliverables: ["Control mapping matrix"],
                            evidence: ["Crosswalk documentation", "System inventory list"]
                        },
                        {
                            step: "Identify gaps and prioritize actions",
                            deliverables: ["Gap analysis", "Priority backlog"],
                            evidence: ["Risk acceptance logs"]
                        },
                        {
                            step: "Develop an implementation plan",
                            deliverables: ["Implementation roadmap", "Budget estimates"],
                            evidence: ["Project plan approvals"]
                        },
                        {
                            step: "Engage stakeholders across organization",
                            deliverables: ["Stakeholder communication plan"],
                            evidence: ["Meeting minutes", "Training rosters"]
                        },
                        {
                            step: "Monitor effectiveness and adjust as needed",
                            deliverables: ["Metrics dashboard"],
                            evidence: ["Quarterly review reports"]
                        }
                    ]
                },
                {
                    id: "iso-27001-certification",
                    type: "guide",
                    title: "ISO 27001 Certification Path",
                    summary: "Step-by-step path to build and certify an ISMS.",
                    steps: [
                        {
                            step: "Establish ISMS team & scope",
                            deliverables: ["ISMS charter", "Scope statement"],
                            evidence: ["Governance approvals"]
                        },
                        {
                            step: "Perform gap analysis",
                            deliverables: ["Gap analysis report"],
                            evidence: ["Assessment worksheets"]
                        },
                        {
                            step: "Define policies & procedures",
                            deliverables: ["ISMS policy library"],
                            evidence: ["Policy approval records"]
                        },
                        {
                            step: "Implement controls per Annex A",
                            deliverables: ["Control implementation plan"],
                            evidence: ["Control evidence packages"]
                        },
                        {
                            step: "Conduct internal audit & management review",
                            deliverables: ["Internal audit report"],
                            evidence: ["Management review minutes"]
                        },
                        {
                            step: "Undergo formal certification audit",
                            deliverables: ["Certification audit plan"],
                            evidence: ["Audit findings and corrective actions"]
                        }
                    ]
                },
                {
                    id: "cis-controls-roadmap",
                    type: "guide",
                    title: "CIS Controls Implementation Roadmap",
                    summary: "Prioritized rollout of CIS safeguards by implementation group.",
                    steps: [
                        {
                            step: "Identify critical assets",
                            deliverables: ["Asset inventory"],
                            evidence: ["Asset discovery reports"]
                        },
                        {
                            step: "Apply basic controls (CIS 1â€“6)",
                            deliverables: ["IG1 safeguard checklist"],
                            evidence: ["Configuration baselines"]
                        },
                        {
                            step: "Expand to foundational & organizational controls",
                            deliverables: ["IG2/IG3 rollout plan"],
                            evidence: ["Security control testing results"]
                        },
                        {
                            step: "Continuously monitor & improve",
                            deliverables: ["Metrics dashboard"],
                            evidence: ["Control effectiveness reports"]
                        }
                    ]
                },
                {
                    id: "risk-assessment-methodology",
                    type: "guide",
                    title: "Risk Assessment Methodology",
                    summary: "Structured method to assess likelihood, impact, and treatment options.",
                    steps: [
                        {
                            step: "Asset inventory",
                            deliverables: ["Asset register"],
                            evidence: ["CMDB exports"]
                        },
                        {
                            step: "Threat identification",
                            deliverables: ["Threat catalog"],
                            evidence: ["Threat modeling notes"]
                        },
                        {
                            step: "Vulnerability assessment",
                            deliverables: ["Vulnerability report"],
                            evidence: ["Scanner outputs"]
                        },
                        {
                            step: "Evaluate likelihood & impact",
                            deliverables: ["Risk scoring matrix"],
                            evidence: ["Risk scoring worksheets"]
                        },
                        {
                            step: "Prioritize & mitigate risks",
                            deliverables: ["Risk treatment plan"],
                            evidence: ["Mitigation tracking logs"]
                        },
                        {
                            step: "Document and review periodically",
                            deliverables: ["Risk review cadence"],
                            evidence: ["Review meeting notes"]
                        }
                    ]
                }
            ]
        };

        const dataBankFavoritesKey = 'databank_favs_v1';
        const dataBankRecentKey = 'databank_recent_v1';
        const dataBankTypeMeta = {
            framework: { icon: "ðŸ›¡ï¸", label: "Framework" },
            control: { icon: "ðŸ”—", label: "Control Family" },
            term: { icon: "ðŸ“–", label: "Term" },
            guide: { icon: "ðŸ“", label: "Guide" }
        };

        const dataBankState = {
            activeSection: 'frameworks',
            search: '',
            favorites: new Set(loadDataBankFavorites()),
            recent: loadDataBankRecent()
        };

        const riskMatrixStorageKey = 'risk_matrix_v1';
        const riskRegisterStorageKey = 'risk_register_v1';
        const implementationChecklistsKey = 'implementation_checklists_v1';
        const riskRatingOptions = ['Low', 'Medium', 'High', 'Critical'];
        const riskRatingMeta = {
            Low: { color: '#22c55e', rank: 1 },
            Medium: { color: '#ffd700', rank: 2 },
            High: { color: '#ff6b00', rank: 3 },
            Critical: { color: '#ff0040', rank: 4 }
        };

        const riskRegisterUiState = {
            status: 'all',
            rating: 'Low',
            category: 'all',
            sort: 'rating',
            unmappedOnly: false,
            inProgressOnly: false
        };

        const postureUiState = {
            category: 'all'
        };

        const postureFiltersKey = 'posture_filters_v1';
        let postureFiltersState = loadPostureFilters();

        const riskRegisterModalState = {
            mappedControls: [],
            autoSuggestions: []
        };

        const controlStatusOptions = ['Planned', 'In Progress', 'Implemented'];
        const evidenceFrequencyOptions = ['Monthly', 'Quarterly', 'Annually', 'Ad hoc'];

        const controlKeywordMappings = [
            { keywords: ['phishing', 'awareness', 'training', 'social engineering'], families: ['AT'] },
            { keywords: ['mfa', 'authentication', 'identity', 'sso', 'access', 'privilege'], families: ['IA', 'AC'] },
            { keywords: ['logging', 'monitoring', 'siem', 'audit'], families: ['AU'] },
            { keywords: ['ransomware', 'incident', 'containment', 'forensic'], families: ['IR', 'CP'] },
            { keywords: ['backup', 'recovery', 'bcp', 'dr'], families: ['CP'] },
            { keywords: ['vendor', 'third party', 'supplier', 'outsourced'], families: ['SA', 'RA'] },
            { keywords: ['patch', 'patching', 'vulnerability', 'cve'], families: ['SI', 'CM', 'RA'] },
            { keywords: ['encryption', 'key management', 'crypto'], families: ['SC', 'AC'] },
            { keywords: ['cloud', 'misconfig', 'configuration'], families: ['CM', 'AC', 'AU'] }
        ];

        const controlEvidenceTemplates = {
            AC: ['Access reviews', 'IAM policy document', 'MFA settings screenshots', 'Role matrix', 'Privileged access approvals'],
            AU: ['Log retention policy', 'SIEM alert samples', 'Audit log samples', 'Monitoring dashboard screenshots'],
            IR: ['Incident response plan', 'Tabletop exercise results', 'Ticket samples', 'Post-incident report'],
            CP: ['Backup policy', 'Restore test evidence', 'BCP/DR runbooks', 'RTO/RPO metrics'],
            AT: ['Training completion reports', 'Phishing simulation results', 'Role-based training roster'],
            IA: ['Authentication logs', 'Password policy', 'MFA enrollment report'],
            CM: ['Baseline configuration docs', 'Change tickets', 'Configuration inventory'],
            SI: ['Vulnerability scan results', 'Patch tracking logs', 'Malware protection configuration'],
            RA: ['Risk assessment report', 'Vendor risk reviews', 'Threat modeling notes'],
            SA: ['Vendor security questionnaires', 'Contract security clauses', 'Third-party assessments'],
            SC: ['Encryption standards', 'Key management procedures', 'TLS configuration evidence']
        };

        let riskMatrixState = loadRiskMatrixConfig();
        let riskRegisterState = loadRiskRegister();
        let implementationChecklistsState = loadImplementationChecklists();

        function getDefaultRiskLabels(size, type) {
            if (size === 3) {
                return ['Low', 'Medium', 'High'];
            }
            if (type === 'impact') {
                return ['Very Low', 'Low', 'Medium', 'High', 'Very High'];
            }
            return ['Rare', 'Unlikely', 'Possible', 'Likely', 'Almost Certain'];
        }

        function getDefaultRiskRatings(size) {
            const ratings = [];
            for (let row = 1; row <= size; row += 1) {
                const rowRatings = [];
                for (let col = 1; col <= size; col += 1) {
                    const score = (row + col) / (size * 2);
                    let label = 'Low';
                    if (score > 0.8) {
                        label = 'Critical';
                    } else if (score > 0.6) {
                        label = 'High';
                    } else if (score > 0.4) {
                        label = 'Medium';
                    }
                    rowRatings.push(label);
                }
                ratings.push(rowRatings);
            }
            return ratings;
        }

        function getDefaultRiskMatrixConfig(size = 3) {
            return {
                size,
                likelihoodLabels: getDefaultRiskLabels(size, 'likelihood'),
                impactLabels: getDefaultRiskLabels(size, 'impact'),
                ratings: getDefaultRiskRatings(size)
            };
        }

        function normalizeRiskMatrixConfig(config) {
            const size = config?.size === 5 ? 5 : 3;
            const defaults = getDefaultRiskMatrixConfig(size);
            const likelihoodLabels = Array.isArray(config?.likelihoodLabels) ? config.likelihoodLabels.slice(0, size) : [];
            const impactLabels = Array.isArray(config?.impactLabels) ? config.impactLabels.slice(0, size) : [];
            while (likelihoodLabels.length < size) {
                likelihoodLabels.push(defaults.likelihoodLabels[likelihoodLabels.length]);
            }
            while (impactLabels.length < size) {
                impactLabels.push(defaults.impactLabels[impactLabels.length]);
            }
            const ratings = Array.isArray(config?.ratings) ? config.ratings : [];
            const normalizedRatings = Array.from({ length: size }, (_, rowIndex) => {
                const row = Array.isArray(ratings[rowIndex]) ? ratings[rowIndex] : [];
                return Array.from({ length: size }, (_, colIndex) => {
                    const value = row[colIndex];
                    return riskRatingOptions.includes(value) ? value : defaults.ratings[rowIndex][colIndex];
                });
            });
            return {
                size,
                likelihoodLabels,
                impactLabels,
                ratings: normalizedRatings
            };
        }

        function loadRiskMatrixConfig() {
            try {
                const raw = localStorage.getItem(riskMatrixStorageKey);
                if (!raw) {
                    const defaults = getDefaultRiskMatrixConfig(3);
                    localStorage.setItem(riskMatrixStorageKey, JSON.stringify(defaults));
                    return defaults;
                }
                const parsed = JSON.parse(raw);
                const normalized = normalizeRiskMatrixConfig(parsed);
                localStorage.setItem(riskMatrixStorageKey, JSON.stringify(normalized));
                return normalized;
            } catch (error) {
                const defaults = getDefaultRiskMatrixConfig(3);
                localStorage.setItem(riskMatrixStorageKey, JSON.stringify(defaults));
                return defaults;
            }
        }

        function saveRiskMatrixConfig() {
            localStorage.setItem(riskMatrixStorageKey, JSON.stringify(riskMatrixState));
        }

        function getEvidenceFrequencyThresholdDays(frequency) {
            switch (frequency) {
                case 'Monthly':
                    return 30;
                case 'Quarterly':
                    return 90;
                case 'Annually':
                    return 365;
                case 'Ad hoc':
                default:
                    return 365;
            }
        }

        function getEvidenceStatus(item) {
            if (!item?.lastCollectedDate) return 'Missing';
            const lastDate = new Date(item.lastCollectedDate);
            if (Number.isNaN(lastDate.getTime())) return 'Missing';
            const diffDays = (Date.now() - lastDate.getTime()) / (1000 * 60 * 60 * 24);
            const threshold = getEvidenceFrequencyThresholdDays(item.frequency);
            return diffDays > threshold ? 'Stale' : 'OK';
        }

        function normalizeEvidenceItem(item) {
            const normalized = {
                id: item?.id || `evidence-${Date.now()}-${Math.random().toString(16).slice(2)}`,
                name: item?.name || '',
                description: item?.description || '',
                frequency: evidenceFrequencyOptions.includes(item?.frequency) ? item.frequency : 'Quarterly',
                owner: item?.owner || '',
                lastCollectedDate: item?.lastCollectedDate || '',
                status: item?.status || 'Missing',
                linkOrNote: item?.linkOrNote || ''
            };
            normalized.status = getEvidenceStatus(normalized);
            return normalized;
        }

        function buildDefaultEvidenceItemsForControl(entry) {
            const familyCode = entry?.type === 'family' ? entry.id : entry?.id?.split('-')[0];
            const templates = familyCode ? controlEvidenceTemplates[familyCode] : null;
            if (!templates?.length) return [];
            return templates.slice(0, 6).map(name => normalizeEvidenceItem({ name, frequency: 'Quarterly' }));
        }

        function normalizeMappedControl(entry) {
            if (!entry || typeof entry !== 'object') {
                return {
                    type: 'family',
                    id: '',
                    title: '',
                    rationale: '',
                    status: 'Planned',
                    owner: '',
                    dueDate: '',
                    evidenceItems: []
                };
            }
            return {
                type: entry.type === 'control' ? 'control' : 'family',
                id: entry.id || '',
                title: entry.title || '',
                rationale: entry.rationale || '',
                status: controlStatusOptions.includes(entry.status) ? entry.status : 'Planned',
                owner: entry.owner || '',
                dueDate: entry.dueDate || '',
                evidenceItems: Array.isArray(entry.evidenceItems)
                    ? entry.evidenceItems.map(normalizeEvidenceItem)
                    : []
            };
        }

        function normalizeRiskRegisterItem(item) {
            if (!item || typeof item !== 'object') return null;
            const mappedControls = Array.isArray(item.mappedControls)
                ? item.mappedControls.map(normalizeMappedControl).filter(entry => entry.id || entry.title)
                : [];
            return {
                ...item,
                mappedControls,
                treatmentPlanNotes: item.treatmentPlanNotes || ''
            };
        }

        function loadRiskRegister() {
            try {
                const raw = localStorage.getItem(riskRegisterStorageKey);
                if (!raw) {
                    const defaults = { version: 1, items: [], updatedAt: null };
                    localStorage.setItem(riskRegisterStorageKey, JSON.stringify(defaults));
                    return defaults;
                }
                const parsed = JSON.parse(raw);
                if (!parsed || typeof parsed !== 'object') {
                    const defaults = { version: 1, items: [], updatedAt: null };
                    localStorage.setItem(riskRegisterStorageKey, JSON.stringify(defaults));
                    return defaults;
                }
                const normalizedItems = Array.isArray(parsed.items)
                    ? parsed.items.map(normalizeRiskRegisterItem).filter(Boolean)
                    : [];
                const normalized = {
                    version: 1,
                    items: normalizedItems,
                    updatedAt: parsed.updatedAt || null
                };
                localStorage.setItem(riskRegisterStorageKey, JSON.stringify(normalized));
                return normalized;
            } catch (error) {
                const defaults = { version: 1, items: [], updatedAt: null };
                localStorage.setItem(riskRegisterStorageKey, JSON.stringify(defaults));
                return defaults;
            }
        }

        function loadPostureFilters() {
            try {
                const raw = localStorage.getItem(postureFiltersKey);
                if (!raw) return { timeRange: '7d' };
                const parsed = JSON.parse(raw);
                const allowed = ['24h', '7d', '30d'];
                return {
                    timeRange: allowed.includes(parsed?.timeRange) ? parsed.timeRange : '7d'
                };
            } catch (error) {
                return { timeRange: '7d' };
            }
        }

        function savePostureFilters() {
            localStorage.setItem(postureFiltersKey, JSON.stringify(postureFiltersState));
        }

        function initializeRiskMatrixAndRegister() {
            riskMatrixState = loadRiskMatrixConfig();
            riskRegisterState = loadRiskRegister();
        }

        function saveRiskRegister() {
            riskRegisterState.updatedAt = new Date().toISOString();
            localStorage.setItem(riskRegisterStorageKey, JSON.stringify(riskRegisterState));
        }

        function loadImplementationChecklists() {
            try {
                const raw = localStorage.getItem(implementationChecklistsKey);
                if (!raw) return [];
                const parsed = JSON.parse(raw);
                return Array.isArray(parsed) ? parsed : [];
            } catch (error) {
                return [];
            }
        }

        function saveImplementationChecklists() {
            localStorage.setItem(implementationChecklistsKey, JSON.stringify(implementationChecklistsState));
        }

        function getRiskRatingMeta(label) {
            return riskRatingMeta[label] || riskRatingMeta.Low;
        }

        function getRiskCellRating(likelihood, impact) {
            const rowIndex = Math.max(0, Math.min(riskMatrixState.size - 1, Number(likelihood) - 1));
            const colIndex = Math.max(0, Math.min(riskMatrixState.size - 1, Number(impact) - 1));
            return riskMatrixState.ratings[rowIndex][colIndex] || 'Low';
        }

        function getRiskRatingBadge(label) {
            const meta = getRiskRatingMeta(label);
            return `<span class="risk-rating-badge" style="background:${meta.color};">${escapeHtml(label)}</span>`;
        }

        function getRiskRatingRank(label) {
            return getRiskRatingMeta(label).rank;
        }

        function updateRiskRegisterRating(item) {
            const label = getRiskCellRating(item.likelihood, item.impact);
            if (item.ratingLabel !== label) {
                item.ratingLabel = label;
                saveRiskRegister();
            }
            return label;
        }

        function renderRiskMatrixBuilder() {
            const size = riskMatrixState.size;
            const sizeOptions = [3, 5].map(option => `
                <button class="risk-toggle-btn ${size === option ? 'active' : ''}" type="button" data-risk-size="${option}">
                    ${option}x${option}
                </button>
            `).join('');
            const likelihoodInputs = riskMatrixState.likelihoodLabels.map((label, index) => `
                <input type="text" value="${escapeHtml(label)}" data-risk-label="likelihood" data-index="${index}">
            `).join('');
            const impactInputs = riskMatrixState.impactLabels.map((label, index) => `
                <input type="text" value="${escapeHtml(label)}" data-risk-label="impact" data-index="${index}">
            `).join('');
            const headerRow = `
                <tr>
                    <th>Likelihood \\ Impact</th>
                    ${riskMatrixState.impactLabels.map(label => `<th>${escapeHtml(label)}</th>`).join('')}
                </tr>
            `;
            const bodyRows = riskMatrixState.ratings.map((row, rowIndex) => `
                <tr>
                    <th>${escapeHtml(riskMatrixState.likelihoodLabels[rowIndex])}</th>
                    ${row.map((cell, colIndex) => {
                        const meta = getRiskRatingMeta(cell);
                        return `
                            <td style="background:${meta.color};" data-risk-cell="${rowIndex}-${colIndex}">
                                <div class="risk-cell-label">${escapeHtml(cell)}</div>
                                <select class="risk-cell-select" data-risk-cell-select data-row="${rowIndex}" data-col="${colIndex}">
                                    ${riskRatingOptions.map(option => `
                                        <option value="${option}" ${option === cell ? 'selected' : ''}>${option}</option>
                                    `).join('')}
                                </select>
                            </td>
                        `;
                    }).join('')}
                </tr>
            `).join('');
            return `
                <div class="premium-card risk-builder-card" id="risk-matrix-builder">
                    <div class="risk-builder-header">
                        <div>
                            <h3 style="color:#ffb020; margin-bottom:4px;">Risk Matrix Builder</h3>
                            <div style="font-size:13px; color: rgba(255,255,255,0.7);">Customize likelihood, impact, and rating tiers for offline scoring.</div>
                        </div>
                        <span class="risk-interactive-badge">Interactive (Saved locally)</span>
                        <div class="risk-builder-toggle">${sizeOptions}</div>
                    </div>
                    <div class="risk-builder-labels">
                        <div class="risk-label-group">
                            <h4>Likelihood labels (rows)</h4>
                            <div class="risk-label-inputs">${likelihoodInputs}</div>
                        </div>
                        <div class="risk-label-group">
                            <h4>Impact labels (columns)</h4>
                            <div class="risk-label-inputs">${impactInputs}</div>
                        </div>
                    </div>
                    <div style="overflow-x:auto;">
                        <table class="risk-matrix-grid">
                            <thead>${headerRow}</thead>
                            <tbody>${bodyRows}</tbody>
                        </table>
                    </div>
                </div>
            `;
        }

        function renderRiskRegisterSection() {
            const filterOptions = riskRatingOptions.map(option => `
                <option value="${option}" ${riskRegisterUiState.rating === option ? 'selected' : ''}>${option}+</option>
            `).join('');
            const categoryOptions = ['all', 'Security', 'Compliance', 'Vendor', 'Cloud', 'AppSec', 'Other']
                .map(option => `<option value="${option}" ${riskRegisterUiState.category === option ? 'selected' : ''}>${option === 'all' ? 'All Categories' : option}</option>`)
                .join('');
            const statusOptions = ['all', 'Open', 'In Progress', 'Closed']
                .map(option => `<option value="${option}" ${riskRegisterUiState.status === option ? 'selected' : ''}>${option === 'all' ? 'All Statuses' : option}</option>`)
                .join('');
            const sortOptions = [
                { value: 'rating', label: 'Rating' },
                { value: 'due', label: 'Due Date' },
                { value: 'updated', label: 'Last Updated' }
            ].map(option => `<option value="${option.value}" ${riskRegisterUiState.sort === option.value ? 'selected' : ''}>${option.label}</option>`).join('');
            const rows = getFilteredRiskRegisterItems().map(item => {
                const ratingLabel = updateRiskRegisterRating(item);
                const dueLabel = item.dueDate ? new Date(item.dueDate).toLocaleDateString() : 'â€”';
                const updatedLabel = item.updatedAt ? new Date(item.updatedAt).toLocaleDateString() : 'â€”';
                const mappedCount = item.mappedControls?.length || 0;
                return `
                    <tr data-risk-row="true" data-risk-id="${escapeHtml(item.id)}" data-clipboard-anchor="risk:${escapeHtml(item.id)}">
                        <td>${getRiskRatingBadge(ratingLabel)}</td>
                        <td><strong>${escapeHtml(item.title)}</strong></td>
                        <td>${escapeHtml(item.category || 'â€”')}</td>
                        <td>${escapeHtml(item.owner || 'â€”')}</td>
                        <td>${escapeHtml(item.status || 'Open')}</td>
                        <td>${dueLabel}</td>
                        <td>${updatedLabel}</td>
                        <td><span class="risk-controls-count">${mappedCount}</span></td>
                        <td>
                            <div class="risk-row-actions">
                                <button class="library-action-btn" type="button" data-risk-action="plan" data-risk-id="${escapeHtml(item.id)}">Treatment Plan</button>
                                <button class="library-action-btn" type="button" data-risk-action="clipboard" data-risk-id="${escapeHtml(item.id)}">Pin</button>
                                <button class="library-action-btn" type="button" data-risk-action="case" data-risk-id="${escapeHtml(item.id)}">Case</button>
                                <button class="library-action-btn" type="button" data-risk-action="library" data-risk-id="${escapeHtml(item.id)}">Save</button>
                            </div>
                        </td>
                    </tr>
                `;
            }).join('');
            return `
                <div class="premium-card" id="risk-register">
                    <div class="risk-register-header">
                        <div>
                            <h3 style="color:#22d3ee; margin-bottom:4px;">Risk Register</h3>
                            <div style="font-size:13px; color: rgba(255,255,255,0.7);">Track risks with auto-scored ratings, owners, and treatments.</div>
                        </div>
                        <div class="risk-register-actions">
                            <button class="btn btn-primary" type="button" data-risk-add="true">Add Risk</button>
                            <button class="library-action-btn" type="button" data-risk-export="csv">Export CSV</button>
                            <button class="library-action-btn" type="button" data-risk-export="pdf">Export PDF</button>
                            <button class="library-action-btn" type="button" data-risk-export="controls">Export Controls Mapping CSV</button>
                        </div>
                    </div>
                    <div class="risk-register-filters">
                        <select class="form-input" data-risk-filter="status">${statusOptions}</select>
                        <select class="form-input" data-risk-filter="rating">${filterOptions}</select>
                        <select class="form-input" data-risk-filter="category">${categoryOptions}</select>
                        <select class="form-input" data-risk-sort="true">${sortOptions}</select>
                        <label style="display:flex; align-items:center; gap:8px; font-size:12px; color: rgba(255,255,255,0.7);">
                            <input type="checkbox" data-risk-filter="unmapped" ${riskRegisterUiState.unmappedOnly ? 'checked' : ''}>
                            Unmapped risks only
                        </label>
                        <label style="display:flex; align-items:center; gap:8px; font-size:12px; color: rgba(255,255,255,0.7);">
                            <input type="checkbox" data-risk-filter="inprogress" ${riskRegisterUiState.inProgressOnly ? 'checked' : ''}>
                            Has controls In Progress
                        </label>
                    </div>
                    <div style="overflow-x:auto;">
                        <table class="data-table risk-register-table">
                            <thead>
                                <tr>
                                    <th>Rating</th>
                                    <th>Title</th>
                                    <th>Category</th>
                                    <th>Owner</th>
                                    <th>Status</th>
                                    <th>Due</th>
                                    <th>Updated</th>
                                    <th>Controls</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${rows || `<tr><td colspan="9" style="text-align:center; color: rgba(255,255,255,0.6);">No risks yet. Add your first entry.</td></tr>`}
                            </tbody>
                        </table>
                    </div>
                </div>
            `;
        }

        function getFilteredRiskRegisterItems() {
            const minRating = getRiskRatingRank(riskRegisterUiState.rating);
            const filtered = riskRegisterState.items.filter(item => {
                if (riskRegisterUiState.status !== 'all' && item.status !== riskRegisterUiState.status) return false;
                if (riskRegisterUiState.category !== 'all' && item.category !== riskRegisterUiState.category) return false;
                if (riskRegisterUiState.unmappedOnly && (item.mappedControls || []).length > 0) return false;
                if (riskRegisterUiState.inProgressOnly && !(item.mappedControls || []).some(ctrl => ctrl.status === 'In Progress')) return false;
                const ratingLabel = getRiskCellRating(item.likelihood, item.impact);
                return getRiskRatingRank(ratingLabel) >= minRating;
            });
            if (riskRegisterUiState.sort === 'rating') {
                filtered.sort((a, b) => {
                    const ratingA = getRiskRatingRank(getRiskCellRating(a.likelihood, a.impact));
                    const ratingB = getRiskRatingRank(getRiskCellRating(b.likelihood, b.impact));
                    return ratingB - ratingA;
                });
            } else if (riskRegisterUiState.sort === 'due') {
                filtered.sort((a, b) => new Date(a.dueDate || 0) - new Date(b.dueDate || 0));
            } else if (riskRegisterUiState.sort === 'updated') {
                filtered.sort((a, b) => new Date(b.updatedAt || 0) - new Date(a.updatedAt || 0));
            }
            return filtered;
        }

        function getPostureFilteredRisks() {
            if (postureUiState.category === 'all') return riskRegisterState.items;
            return riskRegisterState.items.filter(item => item.category === postureUiState.category);
        }

        function getUpcomingDueCounts(items, dateField) {
            const now = new Date();
            const in7 = new Date(now);
            in7.setDate(in7.getDate() + 7);
            const in30 = new Date(now);
            in30.setDate(in30.getDate() + 30);
            const counts = { next7: 0, next30: 0 };
            items.forEach(item => {
                const dateValue = item?.[dateField];
                if (!dateValue) return;
                const dueDate = new Date(dateValue);
                if (Number.isNaN(dueDate.getTime())) return;
                if (dueDate >= now && dueDate <= in7) counts.next7 += 1;
                if (dueDate >= now && dueDate <= in30) counts.next30 += 1;
            });
            return counts;
        }

        function isWithinNextDays(dateValue, days) {
            if (!dateValue) return false;
            const dueDate = new Date(dateValue);
            if (Number.isNaN(dueDate.getTime())) return false;
            const now = new Date();
            const cutoff = new Date(now);
            cutoff.setDate(cutoff.getDate() + days);
            return dueDate >= now && dueDate <= cutoff;
        }

        // Posture KPIs are computed here for the Data Bank Posture view and exports.
        function computePostureKpis() {
            initializeRiskMatrixAndRegister();
            const filteredRisks = getPostureFilteredRisks();
            const openRisks = filteredRisks.filter(item => item.status !== 'Closed');
            const mappedControls = openRisks.flatMap(item => item.mappedControls || []);
            const controlCounts = mappedControls.reduce((acc, control) => {
                const status = control.status || 'Planned';
                acc[status] = (acc[status] || 0) + 1;
                return acc;
            }, { 'Implemented': 0, 'In Progress': 0, 'Planned': 0 });
            const evidenceConfigured = mappedControls.some(control => (control.evidenceItems || []).length > 0);
            const evidenceCounts = evidenceConfigured
                ? mappedControls.reduce((acc, control) => {
                    const items = control.evidenceItems || [];
                    if (!items.length) {
                        acc.Missing += 1;
                        return acc;
                    }
                    items.forEach(item => {
                        const status = getEvidenceStatus(item);
                        acc[status] += 1;
                    });
                    return acc;
                }, { OK: 0, Stale: 0, Missing: 0 })
                : null;
            const ratingCounts = openRisks.reduce((acc, item) => {
                const rating = getRiskCellRating(item.likelihood, item.impact);
                if (['Critical', 'High', 'Medium'].includes(rating)) {
                    acc[rating] += 1;
                }
                return acc;
            }, { Critical: 0, High: 0, Medium: 0 });
            const riskDue = getUpcomingDueCounts(openRisks, 'dueDate');
            const controlDue = getUpcomingDueCounts(mappedControls, 'dueDate');
            return {
                filteredRisks,
                openRisks,
                mappedControls,
                controlCounts,
                evidenceCounts,
                evidenceConfigured,
                ratingCounts,
                riskDue,
                controlDue
            };
        }

        function renderPostureBar(label, value, total) {
            const percent = total ? Math.round((value / total) * 100) : 0;
            return `
                <div class="posture-bar">
                    <div class="posture-bar-label">
                        <span>${escapeHtml(label)}</span>
                        <span>${value} (${percent}%)</span>
                    </div>
                    <div class="posture-bar-track">
                        <div class="posture-bar-fill" style="width:${percent}%;"></div>
                    </div>
                </div>
            `;
        }

        function renderPostureSection() {
            const categoryOptions = ['all', 'Security', 'Compliance', 'Vendor', 'Cloud', 'Other']
                .map(option => `<option value="${option}" ${postureUiState.category === option ? 'selected' : ''}>${option === 'all' ? 'All Categories' : option}</option>`)
                .join('');
            const postureData = computePostureKpis();
            const {
                openRisks,
                mappedControls,
                controlCounts,
                evidenceCounts,
                evidenceConfigured,
                ratingCounts,
                riskDue,
                controlDue
            } = postureData;
            const totalControls = mappedControls.length || 1;
            const totalEvidence = evidenceCounts
                ? Math.max(1, evidenceCounts.OK + evidenceCounts.Stale + evidenceCounts.Missing)
                : 1;
            const evidenceCards = evidenceConfigured
                ? `
                        <div class="posture-kpi-card">
                            <div class="posture-kpi-label">Evidence OK</div>
                            <div class="posture-kpi-value">${evidenceCounts.OK}</div>
                        </div>
                        <div class="posture-kpi-card">
                            <div class="posture-kpi-label">Evidence Stale</div>
                            <div class="posture-kpi-value">${evidenceCounts.Stale}</div>
                        </div>
                        <div class="posture-kpi-card">
                            <div class="posture-kpi-label">Evidence Missing</div>
                            <div class="posture-kpi-value">${evidenceCounts.Missing}</div>
                        </div>
                    `
                : `
                        <div class="posture-kpi-card" style="grid-column: span 3;">
                            <div class="posture-kpi-label">Evidence Freshness</div>
                            <div class="posture-kpi-value">Evidence not configured</div>
                            <div style="font-size: 11px; color: rgba(255,255,255,0.6);">Add evidence items to mapped controls to track OK / Stale / Missing.</div>
                        </div>
                    `;
            const evidenceBars = evidenceConfigured
                ? `
                        ${renderPostureBar('Evidence OK', evidenceCounts.OK, totalEvidence)}
                        ${renderPostureBar('Evidence Stale', evidenceCounts.Stale, totalEvidence)}
                    `
                : `<div class="posture-empty" style="margin-top: 6px;">Evidence not configured.</div>`;
            const emptyStateCard = riskRegisterState.items.length === 0
                ? `
                    <div class="premium-card" style="border-left: 4px solid #22d3ee;">
                        <h3 style="margin-bottom: 8px; font-size: 18px;">No risks yet</h3>
                        <p style="font-size: 13px; color: rgba(255,255,255,0.7); margin-bottom: 12px;">
                            Add one in Risk Matrices â†’ Risk Register to populate Posture.
                        </p>
                        <button class="btn btn-secondary" type="button" data-posture-go-risk="true">Go to Risk Register</button>
                    </div>
                `
                : '';

            return `
                ${emptyStateCard}
                <div class="premium-card">
                    <div class="posture-toolbar">
                        <div>
                            <h3 style="color:#22d3ee; margin-bottom:4px;">Posture View</h3>
                            <div style="font-size:13px; color: rgba(255,255,255,0.7);">Snapshot of control implementation, evidence freshness, and open risk exposure.</div>
                        </div>
                        <div style="display:flex; gap:10px; flex-wrap: wrap;">
                            <select class="form-input" data-posture-filter="category">${categoryOptions}</select>
                            <button class="library-action-btn" type="button" data-posture-export="true">Export Report (PDF/JSON fallback)</button>
                        </div>
                    </div>
                    <div class="posture-kpi-grid">
                        <div class="posture-kpi-card">
                            <div class="posture-kpi-label">Controls Implemented</div>
                            <div class="posture-kpi-value">${controlCounts['Implemented'] || 0}</div>
                        </div>
                        <div class="posture-kpi-card">
                            <div class="posture-kpi-label">Controls In Progress</div>
                            <div class="posture-kpi-value">${controlCounts['In Progress'] || 0}</div>
                        </div>
                        <div class="posture-kpi-card">
                            <div class="posture-kpi-label">Controls Planned</div>
                            <div class="posture-kpi-value">${controlCounts['Planned'] || 0}</div>
                        </div>
                        ${evidenceCards}
                        <div class="posture-kpi-card">
                            <div class="posture-kpi-label">Open Risks (Critical)</div>
                            <div class="posture-kpi-value">${ratingCounts.Critical}</div>
                        </div>
                        <div class="posture-kpi-card">
                            <div class="posture-kpi-label">Open Risks (High)</div>
                            <div class="posture-kpi-value">${ratingCounts.High}</div>
                        </div>
                        <div class="posture-kpi-card">
                            <div class="posture-kpi-label">Open Risks (Medium)</div>
                            <div class="posture-kpi-value">${ratingCounts.Medium}</div>
                        </div>
                    </div>
                    <div class="posture-bars">
                        ${renderPostureBar('Controls Implemented', controlCounts['Implemented'] || 0, totalControls)}
                        ${renderPostureBar('Controls In Progress', controlCounts['In Progress'] || 0, totalControls)}
                        ${evidenceBars}
                    </div>
                    <div class="posture-due-grid">
                        <div class="posture-due-card">
                            <div style="font-size:12px; color: rgba(255,255,255,0.6);">Controls due in next 7 days</div>
                            <div class="posture-due-value">${controlDue.next7}</div>
                            <div style="font-size:11px; color: rgba(255,255,255,0.5);">Next 30 days: ${controlDue.next30}</div>
                        </div>
                        <div class="posture-due-card">
                            <div style="font-size:12px; color: rgba(255,255,255,0.6);">Risks due in next 7 days</div>
                            <div class="posture-due-value">${riskDue.next7}</div>
                            <div style="font-size:11px; color: rgba(255,255,255,0.5);">Next 30 days: ${riskDue.next30}</div>
                        </div>
                    </div>
                </div>
            `;
        }

        function getPostureTimeRangeWindow(range) {
            const now = new Date();
            const start = new Date(now);
            if (range === '24h') {
                start.setHours(start.getHours() - 24);
            } else if (range === '30d') {
                start.setDate(start.getDate() - 30);
            } else {
                start.setDate(start.getDate() - 7);
            }
            return {
                start,
                end: now
            };
        }

        function formatPostureRangeLabel(range) {
            if (range === '24h') return 'Last 24 hours';
            if (range === '30d') return 'Last 30 days';
            return 'Last 7 days';
        }

        function isWithinPostureRange(dateValue, range) {
            if (!dateValue) return false;
            const date = new Date(dateValue);
            if (Number.isNaN(date.getTime())) return false;
            const window = getPostureTimeRangeWindow(range);
            return date >= window.start && date <= window.end;
        }

        function getPostureFixFirstItems() {
            const source = (fixFirstSourceCache && fixFirstSourceCache.length) ? fixFirstSourceCache : nvdCVEsCache;
            const items = buildFixFirstItems(source || []).map(item => ({
                ...item,
                score: getFixFirstScore(item, 'combined'),
                recencyBoost: getRecencyBoost(item.publishedDate)
            }));
            return items.sort((a, b) => {
                if (b.score !== a.score) return b.score - a.score;
                if (b.recencyBoost !== a.recencyBoost) return b.recencyBoost - a.recencyBoost;
                if ((b.epssPercent || 0) !== (a.epssPercent || 0)) return (b.epssPercent || 0) - (a.epssPercent || 0);
                return (b.cvss || 0) - (a.cvss || 0);
            });
        }

        function getPostureRiskSnapshot() {
            const openRisks = (riskRegisterState.items || []).filter(item => item.status !== 'Closed');
            const mappedControls = openRisks.flatMap(item => item.mappedControls || []);
            const controlCounts = mappedControls.reduce((acc, control) => {
                const status = control.status || 'Planned';
                acc[status] = (acc[status] || 0) + 1;
                return acc;
            }, { 'Implemented': 0, 'In Progress': 0, 'Planned': 0 });
            const evidenceConfigured = mappedControls.some(control => (control.evidenceItems || []).length > 0);
            const evidenceCounts = evidenceConfigured
                ? mappedControls.reduce((acc, control) => {
                    const items = control.evidenceItems || [];
                    if (!items.length) {
                        acc.Missing += 1;
                        return acc;
                    }
                    items.forEach(item => {
                        const status = getEvidenceStatus(item);
                        acc[status] += 1;
                    });
                    return acc;
                }, { OK: 0, Stale: 0, Missing: 0 })
                : null;
            const ratingCounts = openRisks.reduce((acc, item) => {
                const rating = getRiskCellRating(item.likelihood, item.impact);
                if (['Critical', 'High', 'Medium'].includes(rating)) {
                    acc[rating] += 1;
                }
                return acc;
            }, { Critical: 0, High: 0, Medium: 0 });
            const riskDue = getUpcomingDueCounts(openRisks, 'dueDate');
            const controlDue = getUpcomingDueCounts(mappedControls, 'dueDate');
            return {
                openRisks,
                mappedControls,
                controlCounts,
                evidenceCounts,
                evidenceConfigured,
                ratingCounts,
                riskDue,
                controlDue
            };
        }

        function renderPostureDashboard() {
            const container = document.getElementById('posture-dashboard');
            if (!container) return;
            const range = postureFiltersState.timeRange || '7d';
            const rangeLabel = document.getElementById('posture-range-label');
            if (rangeLabel) {
                const window = getPostureTimeRangeWindow(range);
                rangeLabel.textContent = `${formatPostureRangeLabel(range)} Â· ${window.start.toLocaleDateString()} â†’ ${window.end.toLocaleDateString()}`;
            }
            const snapshot = getPostureRiskSnapshot();
            const fixFirstItems = getPostureFixFirstItems();
            const fixFirstTop = fixFirstItems.slice(0, 10);
            const kevCount = fixFirstItems.filter(item => item.isKEV).length;
            const epss10Count = fixFirstItems.filter(item => (item.epssPercent || 0) >= 10).length;
            const dueSoonWindow = 14;
            const dueCutoff = new Date();
            dueCutoff.setDate(dueCutoff.getDate() + dueSoonWindow);
            const dueSoonItems = snapshot.openRisks.flatMap(risk => {
                const dueItems = [];
                if (risk.dueDate) {
                    const due = new Date(risk.dueDate);
                    if (!Number.isNaN(due.getTime()) && due <= dueCutoff && due >= new Date()) {
                        dueItems.push({
                            type: 'risk',
                            id: risk.id,
                            title: risk.title,
                            dueDate: risk.dueDate,
                            rating: getRiskCellRating(risk.likelihood, risk.impact)
                        });
                    }
                }
                (risk.mappedControls || []).forEach(control => {
                    if (!control.dueDate) return;
                    const due = new Date(control.dueDate);
                    if (!Number.isNaN(due.getTime()) && due <= dueCutoff && due >= new Date()) {
                        dueItems.push({
                            type: 'control',
                            id: `${risk.id}:${control.id}`,
                            riskId: risk.id,
                            title: control.title || control.id,
                            dueDate: control.dueDate,
                            status: control.status || 'Planned'
                        });
                    }
                });
                return dueItems;
            }).sort((a, b) => new Date(a.dueDate) - new Date(b.dueDate)).slice(0, 10);

            const riskSorted = [...snapshot.openRisks].sort((a, b) => {
                const ratingA = getRiskRatingRank(getRiskCellRating(a.likelihood, a.impact));
                const ratingB = getRiskRatingRank(getRiskCellRating(b.likelihood, b.impact));
                if (ratingB !== ratingA) return ratingB - ratingA;
                return new Date(b.updatedAt || 0) - new Date(a.updatedAt || 0);
            }).slice(0, 5);

            const evidenceCardValue = snapshot.evidenceConfigured
                ? `${snapshot.evidenceCounts.OK} / ${snapshot.evidenceCounts.Stale} / ${snapshot.evidenceCounts.Missing}`
                : 'Not configured yet';

            const evidenceCardSub = snapshot.evidenceConfigured
                ? 'OK / Stale / Missing'
                : 'Add evidence items to mapped controls';

            const dueSoonTotal7 = snapshot.riskDue.next7 + snapshot.controlDue.next7;
            const dueSoonTotal30 = snapshot.riskDue.next30 + snapshot.controlDue.next30;

            const riskDistributionTotal = snapshot.ratingCounts.Critical + snapshot.ratingCounts.High + snapshot.ratingCounts.Medium || 1;
            const controlDistributionTotal = (snapshot.controlCounts['Implemented'] || 0) + (snapshot.controlCounts['In Progress'] || 0) + (snapshot.controlCounts['Planned'] || 0) || 1;

            container.innerHTML = `
                <div class="posture-kpi-grid">
                    <div class="posture-kpi-card">
                        <div class="posture-kpi-label">Open Risks (Critical / High / Medium)</div>
                        <div class="posture-kpi-value">${snapshot.ratingCounts.Critical} / ${snapshot.ratingCounts.High} / ${snapshot.ratingCounts.Medium}</div>
                    </div>
                    <div class="posture-kpi-card">
                        <div class="posture-kpi-label">Controls Status (Implemented / In Progress / Planned)</div>
                        <div class="posture-kpi-value">${snapshot.controlCounts['Implemented'] || 0} / ${snapshot.controlCounts['In Progress'] || 0} / ${snapshot.controlCounts['Planned'] || 0}</div>
                    </div>
                    <div class="posture-kpi-card">
                        <div class="posture-kpi-label">Evidence Freshness</div>
                        <div class="posture-kpi-value">${evidenceCardValue}</div>
                        <div style="font-size: 11px; color: rgba(255,255,255,0.6);">${evidenceCardSub}</div>
                    </div>
                    <div class="posture-kpi-card">
                        <div class="posture-kpi-label">Fix-First (KEV / EPSS â‰¥ 10%)</div>
                        <div class="posture-kpi-value">${kevCount} / ${epss10Count}</div>
                    </div>
                    <div class="posture-kpi-card">
                        <div class="posture-kpi-label">Upcoming Due Dates</div>
                        <div class="posture-kpi-value">${dueSoonTotal7}</div>
                        <div style="font-size: 11px; color: rgba(255,255,255,0.6);">Next 30 days: ${dueSoonTotal30}</div>
                    </div>
                </div>
                <div class="posture-dashboard-grid">
                    <div style="display: grid; gap: 16px;">
                        <div class="posture-card">
                            <div class="posture-card-title">
                                <span>Risk Distribution</span>
                            </div>
                            <div class="posture-bars">
                                ${renderPostureBar('Critical', snapshot.ratingCounts.Critical, riskDistributionTotal)}
                                ${renderPostureBar('High', snapshot.ratingCounts.High, riskDistributionTotal)}
                                ${renderPostureBar('Medium', snapshot.ratingCounts.Medium, riskDistributionTotal)}
                            </div>
                        </div>
                        <div class="posture-card">
                            <div class="posture-card-title">
                                <span>Control Implementation</span>
                            </div>
                            <div class="posture-bars">
                                ${renderPostureBar('Implemented', snapshot.controlCounts['Implemented'] || 0, controlDistributionTotal)}
                                ${renderPostureBar('In Progress', snapshot.controlCounts['In Progress'] || 0, controlDistributionTotal)}
                                ${renderPostureBar('Planned', snapshot.controlCounts['Planned'] || 0, controlDistributionTotal)}
                            </div>
                        </div>
                        <div class="posture-card">
                            <div class="posture-card-title">
                                <span>Fix First (Top 10)</span>
                                <button class="library-action-btn" type="button" data-posture-view="fix-first">View all</button>
                            </div>
                            <div class="posture-list">
                                ${fixFirstTop.length ? fixFirstTop.map(item => {
                                    const epssLabel = item.epssPercent != null ? `${item.epssPercent.toFixed(1)}%` : '--';
                                    const cvssLabel = item.cvss ? item.cvss.toFixed(1) : '--';
                                    const anchorId = `cve:${item.cveId}`;
                                    return `
                                        <div class="posture-list-item">
                                            <div class="posture-list-content">
                                                <div style="font-weight: 600;">${escapeHtml(item.cveId)}</div>
                                                <div style="font-size: 12px; color: rgba(255,255,255,0.7);">${escapeHtml(item.title)}</div>
                                                <div class="posture-list-meta">
                                                    ${item.isKEV ? '<span class="posture-pill" style="border-color: rgba(255,68,68,0.6); color: #ff4444;">KEV</span>' : ''}
                                                    <span class="posture-pill">EPSS ${epssLabel}</span>
                                                    <span class="posture-pill">CVSS ${cvssLabel}</span>
                                                </div>
                                            </div>
                                            <div class="posture-list-actions">
                                                ${getPinButtonMarkup({
                                                    id: anchorId,
                                                    anchor: anchorId,
                                                    type: 'cve',
                                                    title: item.cveId,
                                                    subtitle: item.vendorProduct,
                                                    url: `https://nvd.nist.gov/vuln/detail/${item.cveId}`,
                                                    severity: null,
                                                    meta: {
                                                        cveId: item.cveId,
                                                        title: item.title,
                                                        cvss: item.cvss,
                                                        epss: item.epssPercent != null ? `${item.epssPercent.toFixed(1)}%` : 'Unknown',
                                                        isKEV: item.isKEV ? 'Yes' : 'No'
                                                    }
                                                }, { compact: true })}
                                                <button class="library-action-btn" type="button" data-posture-open="cve" data-posture-id="${escapeHtml(anchorId)}">Open</button>
                                                <button class="library-action-btn" type="button" data-posture-case="cve" data-posture-id="${escapeHtml(item.cveId)}">Case</button>
                                            </div>
                                        </div>
                                    `;
                                }).join('') : `<div class="posture-empty">No Fix-First items yet. Load Threat Intel to populate.</div>`}
                            </div>
                        </div>
                        <div class="posture-card">
                            <div class="posture-card-title">
                                <span>Highest Risks</span>
                                <button class="library-action-btn" type="button" data-posture-view="risks">View all</button>
                            </div>
                            <div class="posture-list">
                                ${riskSorted.length ? riskSorted.map(item => {
                                    const rating = getRiskCellRating(item.likelihood, item.impact);
                                    return `
                                        <div class="posture-list-item">
                                            <div class="posture-list-content">
                                                <div style="font-weight: 600;">${escapeHtml(item.title)}</div>
                                                <div style="font-size: 12px; color: rgba(255,255,255,0.7);">${escapeHtml(item.category || 'Uncategorized')} â€¢ ${escapeHtml(item.owner || 'Unassigned')}</div>
                                                <div class="posture-list-meta">
                                                    <span class="posture-pill">${escapeHtml(rating)}</span>
                                                    ${item.dueDate ? `<span class="posture-pill">Due ${escapeHtml(item.dueDate)}</span>` : ''}
                                                </div>
                                            </div>
                                            <div class="posture-list-actions">
                                                ${getPinButtonMarkup(buildRiskClipboardPayload(item), { compact: true })}
                                                <button class="library-action-btn" type="button" data-posture-open="risk" data-posture-id="${escapeHtml(item.id)}">Open</button>
                                                <button class="library-action-btn" type="button" data-posture-case="risk" data-posture-id="${escapeHtml(item.id)}">Case</button>
                                            </div>
                                        </div>
                                    `;
                                }).join('') : `<div class="posture-empty">No open risks yet.</div>`}
                            </div>
                        </div>
                    </div>
                    <div style="display: grid; gap: 16px;">
                        <div class="posture-card">
                            <div class="posture-card-title">
                                <span>Due Soon (Next 14 Days)</span>
                                <button class="library-action-btn" type="button" data-posture-view="due">View all</button>
                            </div>
                            <div class="posture-list">
                                ${dueSoonItems.length ? dueSoonItems.map(item => {
                                    const badge = item.type === 'risk' ? `Risk â€¢ ${escapeHtml(item.rating || '')}` : `Control â€¢ ${escapeHtml(item.status || '')}`;
                                    const riskItem = item.type === 'risk' ? getRiskRegisterItemById(item.id) : null;
                                    const payload = item.type === 'risk' && riskItem
                                        ? buildRiskClipboardPayload(riskItem)
                                        : item.type === 'control'
                                            ? {
                                                id: `control:${item.riskId}:${item.title}`,
                                                anchor: `risk:${item.riskId}`,
                                                type: 'control',
                                                title: `Control: ${item.title}`,
                                                subtitle: `Due ${item.dueDate}`,
                                                url: '',
                                                severity: null,
                                                meta: { status: item.status || 'Planned' }
                                            }
                                            : null;
                                    return `
                                        <div class="posture-list-item">
                                            <div class="posture-list-content">
                                                <div style="font-weight: 600;">${escapeHtml(item.title)}</div>
                                                <div style="font-size: 12px; color: rgba(255,255,255,0.7);">${badge}</div>
                                                <div class="posture-list-meta">
                                                    <span class="posture-pill">Due ${escapeHtml(item.dueDate)}</span>
                                                </div>
                                            </div>
                                            <div class="posture-list-actions">
                                                ${payload ? getPinButtonMarkup(payload, { compact: true }) : ''}
                                                <button class="library-action-btn" type="button" data-posture-open="${escapeHtml(item.type)}" data-posture-id="${escapeHtml(item.type === 'risk' ? item.id : item.riskId)}">Open</button>
                                                <button class="library-action-btn" type="button" data-posture-case="${escapeHtml(item.type)}" data-posture-id="${escapeHtml(item.type === 'risk' ? item.id : item.riskId)}" data-posture-title="${escapeHtml(item.title)}">Case</button>
                                            </div>
                                        </div>
                                    `;
                                }).join('') : `<div class="posture-empty">No upcoming due dates.</div>`}
                            </div>
                        </div>
                        <div class="posture-card">
                            <div class="posture-card-title">
                                <span>Due Date Outlook</span>
                            </div>
                            <div class="posture-due-grid">
                                <div class="posture-due-card">
                                    <div style="font-size:12px; color: rgba(255,255,255,0.6);">Controls due in next 7 days</div>
                                    <div class="posture-due-value">${snapshot.controlDue.next7}</div>
                                    <div style="font-size:11px; color: rgba(255,255,255,0.5);">Next 30 days: ${snapshot.controlDue.next30}</div>
                                </div>
                                <div class="posture-due-card">
                                    <div style="font-size:12px; color: rgba(255,255,255,0.6);">Risks due in next 7 days</div>
                                    <div class="posture-due-value">${snapshot.riskDue.next7}</div>
                                    <div style="font-size:11px; color: rgba(255,255,255,0.5);">Next 30 days: ${snapshot.riskDue.next30}</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            updatePinButtons();
        }

        function openRiskRegisterFromPosture() {
            activateMainTab('learning');
            setTimeout(() => {
                activateLearningSubTab('databank');
                switchDataBankSection('risk');
                setTimeout(() => {
                    const register = document.getElementById('risk-register');
                    if (register) {
                        register.scrollIntoView({ behavior: 'smooth', block: 'start' });
                    }
                }, 150);
            }, 120);
        }

        function addCveToCase(cveId) {
            if (!cveId) return;
            const data = loadCaseBuilder();
            const entry = {
                id: `case-item:${Date.now()}`,
                title: `CVE: ${cveId}`,
                description: 'Added from Posture Fix-First list.',
                type: 'CVE',
                createdAt: new Date().toISOString()
            };
            if (data.cases.length) {
                if (!Array.isArray(data.cases[0].items)) {
                    data.cases[0].items = [];
                }
                data.cases[0].items.unshift(entry);
            } else {
                data.cases.unshift({
                    id: `case:${Date.now()}`,
                    title: `Case: ${cveId}`,
                    description: entry.description,
                    items: [entry],
                    createdAt: new Date().toISOString()
                });
            }
            saveCaseBuilder(data);
            showToast('Added CVE to case');
        }

        function addControlToCase(riskId, title) {
            const data = loadCaseBuilder();
            const entry = {
                id: `case-item:${Date.now()}`,
                title: `Control: ${title}`,
                description: `From risk ${riskId}`,
                type: 'Control',
                createdAt: new Date().toISOString()
            };
            if (data.cases.length) {
                if (!Array.isArray(data.cases[0].items)) {
                    data.cases[0].items = [];
                }
                data.cases[0].items.unshift(entry);
            } else {
                data.cases.unshift({
                    id: `case:${Date.now()}`,
                    title: `Case: ${title}`,
                    description: entry.description,
                    items: [entry],
                    createdAt: new Date().toISOString()
                });
            }
            saveCaseBuilder(data);
            showToast('Added control to case');
        }

        function setupPostureDashboard() {
            const rangeSelect = document.getElementById('posture-time-range');
            if (rangeSelect) {
                rangeSelect.value = postureFiltersState.timeRange || '7d';
                rangeSelect.addEventListener('change', () => {
                    postureFiltersState.timeRange = rangeSelect.value;
                    savePostureFilters();
                    renderPostureDashboard();
                });
            }
            const briefingBtn = document.getElementById('posture-briefing-btn');
            if (briefingBtn) {
                briefingBtn.addEventListener('click', generateBriefingPack);
            }

            document.addEventListener('click', event => {
                const openBtn = event.target.closest('[data-posture-open]');
                if (openBtn) {
                    const type = openBtn.dataset.postureOpen;
                    const id = openBtn.dataset.postureId;
                    if (type === 'cve') {
                        activateMainTab('threats');
                        setTimeout(() => scrollToClipboardAnchor(id), 200);
                        return;
                    }
                    if (type === 'risk') {
                        const item = getRiskRegisterItemById(id);
                        if (item) {
                            openRiskTreatmentModal(item);
                        } else {
                            openRiskRegisterFromPosture();
                        }
                        return;
                    }
                    if (type === 'control') {
                        const item = getRiskRegisterItemById(id);
                        if (item) {
                            openRiskTreatmentModal(item);
                        } else {
                            openRiskRegisterFromPosture();
                        }
                    }
                }

                const viewBtn = event.target.closest('[data-posture-view]');
                if (viewBtn) {
                    const view = viewBtn.dataset.postureView;
                    if (view === 'fix-first') {
                        activateMainTab('threats');
                        return;
                    }
                    openRiskRegisterFromPosture();
                    return;
                }

                const caseBtn = event.target.closest('[data-posture-case]');
                if (caseBtn) {
                    const type = caseBtn.dataset.postureCase;
                    const id = caseBtn.dataset.postureId;
                    if (type === 'cve') {
                        addCveToCase(id);
                        return;
                    }
                    if (type === 'risk') {
                        const item = getRiskRegisterItemById(id);
                        if (item) addRiskToCase(item);
                        return;
                    }
                    if (type === 'control') {
                        addControlToCase(id, caseBtn.dataset.postureTitle || 'Control');
                    }
                }
            });
        }

        function buildBriefingPackData() {
            const range = postureFiltersState.timeRange || '7d';
            const window = getPostureTimeRangeWindow(range);
            const snapshot = getPostureRiskSnapshot();
            const fixFirstTop = getPostureFixFirstItems().slice(0, 10);
            const topRisks = [...snapshot.openRisks].sort((a, b) => {
                const ratingA = getRiskRatingRank(getRiskCellRating(a.likelihood, a.impact));
                const ratingB = getRiskRatingRank(getRiskCellRating(b.likelihood, b.impact));
                return ratingB - ratingA;
            }).slice(0, 5);
            const breaches = (allBreachesData || []).filter(item => isWithinPostureRange(item.date, range));
            const incidents = (newsState.items || []).filter(item => {
                const hasTag = (item.tags || []).some(tag => ['incident', 'breach', 'ransomware'].includes(tag.toLowerCase()));
                return hasTag && isWithinPostureRange(item.dateISO, range);
            });
            const actions = [];
            const highRisks = snapshot.openRisks.filter(item => ['High', 'Critical'].includes(getRiskCellRating(item.likelihood, item.impact))).slice(0, 3);
            if (highRisks.length) {
                actions.push(`Mitigate top risks: ${highRisks.map(item => item.title).join(', ')}`);
            }
            if (snapshot.riskDue.next7 || snapshot.controlDue.next7) {
                actions.push(`Complete ${snapshot.riskDue.next7} risk items and ${snapshot.controlDue.next7} controls due in the next 7 days.`);
            }
            if (!actions.length) {
                actions.push('Maintain monitoring cadence; no critical deadlines detected this week.');
            }

            return {
                title: 'Briefing Pack',
                generatedAt: new Date().toISOString(),
                range: {
                    label: formatPostureRangeLabel(range),
                    start: window.start.toISOString(),
                    end: window.end.toISOString()
                },
                executiveSummary: `Open risks remain the primary exposure area with ${snapshot.ratingCounts.Critical} critical and ${snapshot.ratingCounts.High} high risks. Fix-first queue highlights ${fixFirstTop.length} priority vulnerabilities, including ${fixFirstTop.filter(item => item.isKEV).length} KEV items.`,
                topPriorities: fixFirstTop.map(item => ({
                    cve: item.cveId,
                    kev: item.isKEV,
                    epss: item.epssPercent,
                    cvss: item.cvss
                })),
                breaches: breaches.map(item => ({
                    name: item.name,
                    date: item.date,
                    severity: item.severity,
                    source: item.sourceName,
                    url: item.url
                })),
                incidents: incidents.map(item => ({
                    title: item.title,
                    date: item.dateISO,
                    source: item.sourceName,
                    url: item.url
                })),
                risks: topRisks.map(item => ({
                    title: item.title,
                    rating: getRiskCellRating(item.likelihood, item.impact),
                    owner: item.owner,
                    due: item.dueDate,
                    treatment: item.treatment
                })),
                controlSummary: snapshot.controlCounts,
                actionsThisWeek: actions,
                sources: {
                    cves: fixFirstTop.map(item => `https://nvd.nist.gov/vuln/detail/${item.cveId}`),
                    breaches: breaches.map(item => item.url).filter(Boolean),
                    incidents: incidents.map(item => item.url).filter(Boolean)
                }
            };
        }

        function generateBriefingPack() {
            const data = buildBriefingPackData();
            if (!window.jspdf?.jsPDF) {
                const blob = new Blob([JSON.stringify({ version: 1, ...data }, null, 2)], { type: 'application/json' });
                const url = URL.createObjectURL(blob);
                const link = document.createElement('a');
                link.href = url;
                link.download = 'briefing_pack_v1.json';
                link.click();
                URL.revokeObjectURL(url);
                showToast('Briefing pack generated');
                return;
            }
            const { jsPDF } = window.jspdf;
            const pdf = new jsPDF('p', 'pt', 'a4');
            const margin = 40;
            const width = pdf.internal.pageSize.getWidth() - margin * 2;
            let y = 50;
            const addSection = (title, lines) => {
                pdf.setFontSize(12);
                if (y > 760) {
                    pdf.addPage();
                    y = 40;
                }
                pdf.text(title, margin, y);
                y += 14;
                pdf.setFontSize(10);
                lines.forEach(line => {
                    const wrapped = pdf.splitTextToSize(line, width);
                    wrapped.forEach(textLine => {
                        if (y > 760) {
                            pdf.addPage();
                            y = 40;
                        }
                        pdf.text(textLine, margin, y);
                        y += 12;
                    });
                });
                y += 8;
            };

            pdf.setFontSize(18);
            pdf.text('Executive Briefing Pack', margin, y);
            y += 18;
            pdf.setFontSize(10);
            pdf.text(`${data.range.label} Â· ${new Date(data.range.start).toLocaleDateString()} â†’ ${new Date(data.range.end).toLocaleDateString()}`, margin, y);
            y += 18;

            addSection('1. Executive Summary', [data.executiveSummary]);
            addSection('2. Top Priorities (Fix-First Top 10)', data.topPriorities.length
                ? data.topPriorities.map(item => `${item.cve} â€¢ KEV: ${item.kev ? 'Yes' : 'No'} â€¢ EPSS: ${item.epss != null ? item.epss.toFixed(1) + '%' : 'N/A'} â€¢ CVSS: ${item.cvss || 'N/A'}`)
                : ['No fix-first items available.']);

            const breachLines = data.breaches.length
                ? data.breaches.map(item => `${item.name} (${item.date}) â€¢ ${item.severity || 'Unknown'}${item.url ? ` â€¢ ${item.url}` : ''}`)
                : ['No verified breaches in the selected range.'];
            const incidentLines = data.incidents.length
                ? data.incidents.map(item => `${item.title} (${formatNewsDate(item.date)}) â€¢ ${item.source}${item.url ? ` â€¢ ${item.url}` : ''}`)
                : ['No incident feed items in the selected range.'];
            addSection(`3. Breaches & Incidents (${data.range.label})`, [...breachLines, ...incidentLines]);

            const riskLines = data.risks.length
                ? data.risks.map(item => `${item.title} â€¢ ${item.rating} â€¢ Owner: ${item.owner || 'Unassigned'} â€¢ Due: ${item.due || 'N/A'} â€¢ Treatment: ${item.treatment || 'Mitigate'}`)
                : ['No open risks logged.'];
            addSection('4. Risk & Control Posture', [
                ...riskLines,
                `Control Status â†’ Implemented: ${data.controlSummary['Implemented'] || 0}, In Progress: ${data.controlSummary['In Progress'] || 0}, Planned: ${data.controlSummary['Planned'] || 0}`
            ]);

            addSection('5. Actions This Week', data.actionsThisWeek);

            const sourceLines = [
                ...data.sources.cves.map(link => `CVE: ${link}`),
                ...data.sources.breaches.map(link => `Breach: ${link}`),
                ...data.sources.incidents.map(link => `Incident: ${link}`)
            ];
            addSection('6. Sources / Links', sourceLines.length ? sourceLines : ['No external links available.']);

            pdf.save(`briefing-pack-${Date.now()}.pdf`);
            showToast('Briefing pack generated');
        }

        function getRiskRegisterItemById(id) {
            return riskRegisterState.items.find(item => item.id === id);
        }

        function getControlFamilyByCode(code) {
            return dataBankData.controlFamilies.find(fam => fam.code === code);
        }

        function getControlCatalog() {
            const catalog = [];
            dataBankData.controlFamilies.forEach(family => {
                catalog.push({
                    type: 'family',
                    id: family.code,
                    title: family.name,
                    familyId: family.id
                });
                const details = family.key_controls_detail || family.key_controls || [];
                details.forEach((detail, index) => {
                    const name = typeof detail === 'string' ? detail : detail.name;
                    if (!name) return;
                    catalog.push({
                        type: 'control',
                        id: `${family.code}-${index + 1}`,
                        title: name,
                        familyCode: family.code,
                        familyId: family.id
                    });
                });
            });
            return catalog;
        }

        function setRiskRegisterModalState(item) {
            riskRegisterModalState.mappedControls = (item?.mappedControls || []).map(normalizeMappedControl);
            riskRegisterModalState.autoSuggestions = [];
            renderMappedControlsList();
            renderControlAutoSuggestions([]);
            updateControlSearchSuggestions('');
        }

        function renderMappedControlsList() {
            const list = document.getElementById('risk-control-list');
            if (!list) return;
            if (!riskRegisterModalState.mappedControls.length) {
                list.innerHTML = `<div style="font-size:12px; color: rgba(255,255,255,0.6);">No controls mapped yet. Add a family or specific control.</div>`;
                return;
            }
            list.innerHTML = riskRegisterModalState.mappedControls.map((entry, index) => {
                const familyCode = entry.type === 'family' ? entry.id : entry.id.split('-')[0];
                const family = getControlFamilyByCode(familyCode);
                const label = entry.type === 'family' ? `${entry.id} â€” ${entry.title}` : `${entry.id} â€” ${entry.title}`;
                return `
                    <div class="mapped-control-row" data-mapped-index="${index}">
                        <div class="mapped-control-header">
                            <div class="mapped-control-meta">
                                <span class="mapped-control-badge">${escapeHtml(entry.id || familyCode || 'CTRL')}</span>
                                <div>
                                    <div style="font-weight:600;">${escapeHtml(label)}</div>
                                    <div class="mapped-control-type">${escapeHtml(entry.type === 'family' ? 'Control Family' : 'Specific Control')}${family?.name ? ` Â· ${escapeHtml(family.name)}` : ''}</div>
                                </div>
                            </div>
                            <button class="mapped-control-remove" type="button" data-mapped-remove="${index}">Remove</button>
                        </div>
                        <div class="mapped-control-fields">
                            <div class="form-group">
                                <label>Status</label>
                                <select class="form-input" data-mapped-field="status" data-mapped-index="${index}">
                                    ${controlStatusOptions.map(option => `
                                        <option value="${option}" ${option === entry.status ? 'selected' : ''}>${option}</option>
                                    `).join('')}
                                </select>
                            </div>
                            <div class="form-group">
                                <label>Owner</label>
                                <input class="form-input" type="text" data-mapped-field="owner" data-mapped-index="${index}" value="${escapeHtml(entry.owner || '')}">
                            </div>
                            <div class="form-group">
                                <label>Due date</label>
                                <input class="form-input" type="date" data-mapped-field="dueDate" data-mapped-index="${index}" value="${escapeHtml(entry.dueDate || '')}">
                            </div>
                            <div class="form-group" style="grid-column: 1 / -1;">
                                <label>Rationale (optional)</label>
                                <textarea class="form-input" rows="2" data-mapped-field="rationale" data-mapped-index="${index}">${escapeHtml(entry.rationale || '')}</textarea>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        function updateControlSearchSuggestions(query) {
            const container = document.getElementById('risk-control-suggestions');
            if (!container) return;
            const trimmed = query.trim().toLowerCase();
            const catalog = getControlCatalog();
            const matches = trimmed
                ? catalog.filter(item => {
                    const haystack = `${item.id} ${item.title} ${item.familyCode || ''}`.toLowerCase();
                    return haystack.includes(trimmed);
                })
                : catalog.slice(0, 6);
            if (!matches.length) {
                container.innerHTML = `<div style="font-size:12px; color: rgba(255,255,255,0.6);">No matching controls found.</div>`;
                return;
            }
            container.innerHTML = matches.slice(0, 8).map(item => `
                <div class="risk-control-suggestion">
                    <div>
                        <div style="font-weight:600;">${escapeHtml(item.id)} â€” ${escapeHtml(item.title)}</div>
                        <div style="font-size:11px; color: rgba(255,255,255,0.6);">${escapeHtml(item.type === 'family' ? 'Control Family' : `Control (${item.familyCode})`)}</div>
                    </div>
                    <button class="library-action-btn" type="button" data-control-add="${escapeHtml(item.id)}" data-control-type="${escapeHtml(item.type)}" data-control-title="${escapeHtml(item.title)}">Add</button>
                </div>
            `).join('');
        }

        function renderControlAutoSuggestions(list) {
            const container = document.getElementById('risk-control-auto');
            if (!container) return;
            if (!list.length) {
                container.innerHTML = '';
                return;
            }
            container.innerHTML = `
                <div style="font-size:12px; color: rgba(255,255,255,0.6);">Auto-suggested families</div>
                ${list.map(item => `
                    <div class="risk-control-suggestion">
                        <div>
                            <div style="font-weight:600;">${escapeHtml(item.id)} â€” ${escapeHtml(item.title)}</div>
                            <div style="font-size:11px; color: rgba(255,255,255,0.6);">Control Family Â· score ${item.score}</div>
                        </div>
                        <button class="library-action-btn" type="button" data-control-add="${escapeHtml(item.id)}" data-control-type="family" data-control-title="${escapeHtml(item.title)}">Add</button>
                    </div>
                `).join('')}
            `;
        }

        function addMappedControlEntry(entry) {
            if (!entry?.id) return;
            const exists = riskRegisterModalState.mappedControls.some(ctrl => ctrl.id === entry.id && ctrl.type === entry.type);
            if (exists) {
                showToast('Control already mapped');
                return;
            }
            const baseEntry = {
                type: entry.type || 'family',
                id: entry.id,
                title: entry.title || entry.id,
                rationale: '',
                status: 'Planned',
                owner: '',
                dueDate: ''
            };
            riskRegisterModalState.mappedControls.push({
                ...baseEntry,
                evidenceItems: buildDefaultEvidenceItemsForControl(baseEntry)
            });
            renderMappedControlsList();
        }

        function clearMappedControls() {
            riskRegisterModalState.mappedControls = [];
            renderMappedControlsList();
        }

        function getAutoSuggestedFamilies(item) {
            const text = [item?.title, item?.description, item?.category].filter(Boolean).join(' ').toLowerCase();
            const scores = {};
            controlKeywordMappings.forEach(mapping => {
                if (mapping.keywords.some(keyword => text.includes(keyword))) {
                    mapping.families.forEach(code => {
                        scores[code] = (scores[code] || 0) + 1;
                    });
                }
            });
            const ranked = Object.entries(scores)
                .map(([code, score]) => {
                    const family = getControlFamilyByCode(code);
                    return family ? { id: family.code, title: family.name, score } : null;
                })
                .filter(Boolean)
                .sort((a, b) => b.score - a.score)
                .slice(0, 5);
            return ranked;
        }

        function openRiskRegisterModal(item = null) {
            const modal = document.getElementById('risk-register-modal');
            if (!modal) return;
            const isEdit = Boolean(item);
            const maxScore = riskMatrixState.size;
            document.getElementById('risk-id').value = item?.id || '';
            document.getElementById('risk-title').value = item?.title || '';
            document.getElementById('risk-description').value = item?.description || '';
            document.getElementById('risk-category').value = item?.category || 'Security';
            populateRiskScoreOptions();
            document.getElementById('risk-likelihood').value = String(Math.min(item?.likelihood || 1, maxScore));
            document.getElementById('risk-impact').value = String(Math.min(item?.impact || 1, maxScore));
            document.getElementById('risk-treatment').value = item?.treatment || 'Mitigate';
            document.getElementById('risk-owner').value = item?.owner || '';
            document.getElementById('risk-due').value = item?.dueDate || '';
            document.getElementById('risk-status').value = item?.status || 'Open';
            document.getElementById('risk-notes').value = item?.notes || '';
            document.getElementById('risk-treatment-notes').value = item?.treatmentPlanNotes || '';
            const controlSearch = document.getElementById('risk-control-search');
            if (controlSearch) controlSearch.value = '';
            setRiskRegisterModalState(item);
            updateRiskRatingPreview();
            const deleteBtn = document.getElementById('risk-delete-btn');
            if (deleteBtn) {
                deleteBtn.style.display = isEdit ? 'inline-flex' : 'none';
            }
            modal.classList.add('active');
            modal.setAttribute('aria-hidden', 'false');
            document.body.style.overflow = 'hidden';
        }

        function closeRiskRegisterModal() {
            const modal = document.getElementById('risk-register-modal');
            if (!modal) return;
            modal.classList.remove('active');
            modal.setAttribute('aria-hidden', 'true');
            document.body.style.overflow = '';
        }

        function populateRiskScoreOptions() {
            const likelihoodSelect = document.getElementById('risk-likelihood');
            const impactSelect = document.getElementById('risk-impact');
            if (!likelihoodSelect || !impactSelect) return;
            const options = Array.from({ length: riskMatrixState.size }, (_, index) => {
                const value = index + 1;
                return `<option value="${value}">${value}</option>`;
            }).join('');
            likelihoodSelect.innerHTML = options;
            impactSelect.innerHTML = options;
        }

        function updateRiskRatingPreview() {
            const likelihood = document.getElementById('risk-likelihood')?.value || 1;
            const impact = document.getElementById('risk-impact')?.value || 1;
            const label = getRiskCellRating(likelihood, impact);
            const preview = document.getElementById('risk-rating-preview');
            if (preview) {
                preview.innerHTML = `${getRiskRatingBadge(label)} <span>Auto-scored from matrix</span>`;
            }
        }

        function saveRiskFromForm() {
            const idField = document.getElementById('risk-id');
            const title = document.getElementById('risk-title').value.trim();
            if (!title) {
                showToast('Title is required');
                return;
            }
            const likelihood = Number(document.getElementById('risk-likelihood').value);
            const impact = Number(document.getElementById('risk-impact').value);
            const ratingLabel = getRiskCellRating(likelihood, impact);
            const now = new Date().toISOString();
            const payload = {
                id: idField.value || `risk-${Date.now()}`,
                title,
                description: document.getElementById('risk-description').value.trim(),
                category: document.getElementById('risk-category').value,
                likelihood,
                impact,
                ratingLabel,
                treatment: document.getElementById('risk-treatment').value,
                owner: document.getElementById('risk-owner').value.trim(),
                dueDate: document.getElementById('risk-due').value,
                status: document.getElementById('risk-status').value,
                notes: document.getElementById('risk-notes').value.trim(),
                mappedControls: riskRegisterModalState.mappedControls.map(normalizeMappedControl),
                treatmentPlanNotes: document.getElementById('risk-treatment-notes').value.trim()
            };
            const existingIndex = riskRegisterState.items.findIndex(item => item.id === payload.id);
            if (existingIndex >= 0) {
                const existing = riskRegisterState.items[existingIndex];
                riskRegisterState.items[existingIndex] = {
                    ...existing,
                    ...payload,
                    updatedAt: now
                };
            } else {
                riskRegisterState.items.unshift({
                    ...payload,
                    createdAt: now,
                    updatedAt: now
                });
            }
            saveRiskRegister();
            closeRiskRegisterModal();
            renderDataBankSection('risk', dataBankState.search);
            renderPostureDashboard();
            showToast('Risk saved');
        }

        function deleteRisk(id) {
            riskRegisterState.items = riskRegisterState.items.filter(item => item.id !== id);
            saveRiskRegister();
            closeRiskRegisterModal();
            renderDataBankSection('risk', dataBankState.search);
            renderPostureDashboard();
            showToast('Risk removed');
        }

        function exportRiskRegisterCsv() {
            if (!riskRegisterState.items.length) {
                showToast('No risks to export');
                return;
            }
            const headers = ['Title', 'Description', 'Category', 'Likelihood', 'Impact', 'Rating', 'Treatment', 'Owner', 'Due Date', 'Status', 'Notes', 'Created At', 'Updated At'];
            const rows = riskRegisterState.items.map(item => [
                item.title,
                item.description,
                item.category,
                item.likelihood,
                item.impact,
                getRiskCellRating(item.likelihood, item.impact),
                item.treatment,
                item.owner,
                item.dueDate,
                item.status,
                item.notes,
                item.createdAt,
                item.updatedAt
            ]);
            const csv = [headers, ...rows]
                .map(row => row.map(value => `"${String(value || '').replace(/"/g, '""')}"`).join(','))
                .join('\n');
            const blob = new Blob([csv], { type: 'text/csv' });
            const url = URL.createObjectURL(blob);
            const link = document.createElement('a');
            link.href = url;
            link.download = `risk-register-${Date.now()}.csv`;
            link.click();
            URL.revokeObjectURL(url);
            showToast('Risk register exported');
        }

        function exportRiskRegisterPdf() {
            if (!riskRegisterState.items.length) {
                showToast('No risks to export');
                return;
            }
            if (!window.jspdf?.jsPDF) {
                const payload = {
                    title: 'Risk Register',
                    generatedAt: new Date().toISOString(),
                    items: riskRegisterState.items
                };
                const blob = new Blob([JSON.stringify(payload, null, 2)], { type: 'application/json' });
                const url = URL.createObjectURL(blob);
                const link = document.createElement('a');
                link.href = url;
                link.download = `risk-register-${Date.now()}.json`;
                link.click();
                URL.revokeObjectURL(url);
                showToast('PDF unavailable, exported JSON instead');
                return;
            }
            const { jsPDF } = window.jspdf;
            const pdf = new jsPDF('p', 'pt', 'a4');
            const margin = 40;
            let y = 50;
            pdf.setFontSize(18);
            pdf.text('Risk Register', margin, y);
            y += 20;
            pdf.setFontSize(10);
            pdf.text(`Generated: ${new Date().toLocaleString()}`, margin, y);
            y += 20;
            const sorted = [...riskRegisterState.items].sort((a, b) => {
                const ratingA = getRiskRatingRank(getRiskCellRating(a.likelihood, a.impact));
                const ratingB = getRiskRatingRank(getRiskCellRating(b.likelihood, b.impact));
                return ratingB - ratingA;
            });
            const topRisks = sorted.slice(0, 10);
            pdf.setFontSize(12);
            pdf.text('Top Risks (by rating)', margin, y);
            y += 16;
            pdf.setFontSize(10);
            topRisks.forEach(item => {
                const rating = getRiskCellRating(item.likelihood, item.impact);
                const line = `${rating} â€¢ ${item.title} (${item.category || 'Uncategorized'})`;
                if (y > 760) {
                    pdf.addPage();
                    y = 40;
                }
                pdf.text(line, margin, y);
                y += 14;
            });
            pdf.save(`risk-register-${Date.now()}.pdf`);
            showToast('Risk register PDF exported');
        }

        function exportRiskControlsMappingCsv() {
            const rows = [];
            riskRegisterState.items.forEach(item => {
                const mapped = item.mappedControls || [];
                mapped.forEach(control => {
                    rows.push([
                        item.id,
                        item.title,
                        getRiskCellRating(item.likelihood, item.impact),
                        control.id,
                        control.title,
                        control.status,
                        control.owner,
                        control.dueDate
                    ]);
                });
            });
            if (!rows.length) {
                showToast('No control mappings to export');
                return;
            }
            const headers = ['riskId', 'riskTitle', 'rating', 'mappedControlId', 'mappedControlTitle', 'status', 'owner', 'dueDate'];
            const csv = [headers, ...rows]
                .map(row => row.map(value => `"${String(value || '').replace(/"/g, '""')}"`).join(','))
                .join('\n');
            const blob = new Blob([csv], { type: 'text/csv' });
            const url = URL.createObjectURL(blob);
            const link = document.createElement('a');
            link.href = url;
            link.download = `risk-control-mapping-${Date.now()}.csv`;
            link.click();
            URL.revokeObjectURL(url);
            showToast('Controls mapping CSV exported');
        }

        function getMappedFamilyCodes(item) {
            const codes = new Set();
            (item.mappedControls || []).forEach(control => {
                const code = control.type === 'family' ? control.id : control.id.split('-')[0];
                if (code) codes.add(code);
            });
            return [...codes];
        }

        function getEvidenceChecklistForRisk(item) {
            const families = getMappedFamilyCodes(item);
            return families.map(code => {
                const template = controlEvidenceTemplates[code];
                if (template?.length) {
                    return { code, items: template.slice(0, 6) };
                }
                const family = getControlFamilyByCode(code);
                const evidence = family?.evidence || [];
                return { code, items: evidence.length ? evidence.slice(0, 6) : ['Evidence pending'] };
            });
        }

        function getEvidenceStatusCountsForControl(control) {
            const items = control?.evidenceItems || [];
            if (!items.length) {
                return { Missing: 1, Stale: 0, OK: 0 };
            }
            return items.reduce((acc, item) => {
                const status = getEvidenceStatus(item);
                acc[status] = (acc[status] || 0) + 1;
                return acc;
            }, { Missing: 0, Stale: 0, OK: 0 });
        }

        function renderEvidenceItems(control, controlIndex, riskId) {
            const items = (control.evidenceItems || []).map(normalizeEvidenceItem);
            control.evidenceItems = items;
            const statusCounts = getEvidenceStatusCountsForControl({ evidenceItems: items });
            const statusSummary = `${statusCounts.OK} OK Â· ${statusCounts.Stale} Stale Â· ${statusCounts.Missing} Missing`;
            const evidenceList = items.length ? items.map((evidence, evidenceIndex) => {
                const status = getEvidenceStatus(evidence);
                return `
                    <div class="evidence-item" data-evidence-item="true" data-control-index="${controlIndex}" data-evidence-index="${evidenceIndex}">
                        <div class="evidence-item-header">
                            <input class="form-input" type="text" placeholder="Evidence name" value="${escapeHtml(evidence.name)}"
                                data-evidence-field="name" data-control-index="${controlIndex}" data-evidence-index="${evidenceIndex}" data-risk-id="${escapeHtml(riskId)}">
                            <span class="evidence-status-badge evidence-status-${status.toLowerCase()}">${status}</span>
                        </div>
                        <textarea class="form-input" rows="2" placeholder="Description"
                            data-evidence-field="description" data-control-index="${controlIndex}" data-evidence-index="${evidenceIndex}" data-risk-id="${escapeHtml(riskId)}">${escapeHtml(evidence.description || '')}</textarea>
                        <div class="evidence-item-grid">
                            <div class="form-group">
                                <label class="form-label">Frequency</label>
                                <select class="form-input" data-evidence-field="frequency" data-control-index="${controlIndex}" data-evidence-index="${evidenceIndex}" data-risk-id="${escapeHtml(riskId)}">
                                    ${evidenceFrequencyOptions.map(option => `<option value="${option}" ${option === evidence.frequency ? 'selected' : ''}>${option}</option>`).join('')}
                                </select>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Owner</label>
                                <input class="form-input" type="text" value="${escapeHtml(evidence.owner || '')}"
                                    data-evidence-field="owner" data-control-index="${controlIndex}" data-evidence-index="${evidenceIndex}" data-risk-id="${escapeHtml(riskId)}">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Last collected</label>
                                <input class="form-input" type="date" value="${escapeHtml(evidence.lastCollectedDate || '')}"
                                    data-evidence-field="lastCollectedDate" data-control-index="${controlIndex}" data-evidence-index="${evidenceIndex}" data-risk-id="${escapeHtml(riskId)}">
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Link / Notes</label>
                            <input class="form-input" type="text" value="${escapeHtml(evidence.linkOrNote || '')}"
                                data-evidence-field="linkOrNote" data-control-index="${controlIndex}" data-evidence-index="${evidenceIndex}" data-risk-id="${escapeHtml(riskId)}">
                        </div>
                        <div class="evidence-item-actions">
                            <button class="library-action-btn" type="button" data-evidence-mark="true" data-control-index="${controlIndex}" data-evidence-index="${evidenceIndex}" data-risk-id="${escapeHtml(riskId)}">Mark collected today</button>
                            <button class="library-action-btn evidence-remove-btn" type="button" data-evidence-remove="true" data-control-index="${controlIndex}" data-evidence-index="${evidenceIndex}" data-risk-id="${escapeHtml(riskId)}">Remove</button>
                        </div>
                    </div>
                `;
            }).join('') : `
                <div style="font-size:12px; color: rgba(255,255,255,0.6);">No evidence items yet. Add your first proof point.</div>
            `;
            return `
                <details class="evidence-accordion">
                    <summary>
                        Evidence Tracker
                        <span class="evidence-summary-pill">${statusSummary}</span>
                    </summary>
                    <div class="evidence-items">
                        ${evidenceList}
                    </div>
                    <div style="display:flex; gap:8px; margin-top:10px; flex-wrap: wrap;">
                        <button class="library-action-btn" type="button" data-evidence-add="true" data-control-index="${controlIndex}" data-risk-id="${escapeHtml(riskId)}">Add evidence item</button>
                        <button class="library-action-btn" type="button" data-evidence-copy="true" data-control-index="${controlIndex}" data-risk-id="${escapeHtml(riskId)}">Copy evidence checklist</button>
                    </div>
                </details>
            `;
        }

        function renderRiskTreatmentPlan(item) {
            const ratingLabel = getRiskCellRating(item.likelihood, item.impact);
            const mappedControls = item.mappedControls || [];
            const evidenceGroups = getEvidenceChecklistForRisk(item);
            return `
                <div class="risk-treatment-summary">
                    <div style="display:flex; justify-content: space-between; gap: 12px; flex-wrap: wrap;">
                        <div>
                            <div style="font-weight:600; font-size:16px;">${escapeHtml(item.title)}</div>
                            <div style="font-size:12px; color: rgba(255,255,255,0.65);">${escapeHtml(item.category || 'Uncategorized')}</div>
                        </div>
                        <div>${getRiskRatingBadge(ratingLabel)}</div>
                    </div>
                    <div style="display:grid; gap:6px; font-size:13px; color: rgba(255,255,255,0.7);">
                        <div><strong>Treatment:</strong> ${escapeHtml(item.treatment || 'Mitigate')}</div>
                        <div><strong>Owner:</strong> ${escapeHtml(item.owner || 'Unassigned')}</div>
                        <div><strong>Due:</strong> ${item.dueDate ? new Date(item.dueDate).toLocaleDateString() : 'â€”'}</div>
                        <div><strong>Status:</strong> ${escapeHtml(item.status || 'Open')}</div>
                    </div>
                </div>
                <div class="risk-treatment-controls">
                    <div style="font-weight:600; color:#ffb020;">Mapped Controls</div>
                    ${mappedControls.length ? mappedControls.map((control, index) => `
                        <div class="risk-control-block">
                            <div class="risk-control-suggestion" style="margin:0;">
                                <div>
                                    <div style="font-weight:600;">${escapeHtml(control.id)} â€” ${escapeHtml(control.title)}</div>
                                    <div style="font-size:11px; color: rgba(255,255,255,0.6);">${escapeHtml(control.status || 'Planned')} Â· ${escapeHtml(control.owner || 'Unassigned')} Â· ${control.dueDate ? new Date(control.dueDate).toLocaleDateString() : 'No due date'}</div>
                                    ${control.rationale ? `<div style="font-size:11px; color: rgba(255,255,255,0.6); margin-top:4px;">${escapeHtml(control.rationale)}</div>` : ''}
                                </div>
                            </div>
                            ${renderEvidenceItems(control, index, item.id)}
                        </div>
                    `).join('') : `<div style="font-size:12px; color: rgba(255,255,255,0.6);">No controls mapped yet.</div>`}
                </div>
                <div class="risk-treatment-evidence">
                    <div style="font-weight:600; color:#22d3ee;">Evidence Checklist</div>
                    ${evidenceGroups.length ? evidenceGroups.map(group => `
                        <div>
                            <div style="font-size:12px; color: rgba(255,255,255,0.65); margin-bottom:6px;">${escapeHtml(group.code)} Evidence</div>
                            <div class="checklist-items">
                                ${group.items.map(itemText => `
                                    <label class="checklist-item">
                                        <input type="checkbox" disabled>
                                        <span>${escapeHtml(itemText)}</span>
                                    </label>
                                `).join('')}
                            </div>
                        </div>
                    `).join('') : `<div style="font-size:12px; color: rgba(255,255,255,0.6);">Map controls to generate evidence checklists.</div>`}
                </div>
                <div class="risk-treatment-notes">
                    <label style="font-size:12px; color: rgba(255,255,255,0.65);">Notes</label>
                    <textarea class="form-input" data-treatment-notes="${escapeHtml(item.id)}">${escapeHtml(item.treatmentPlanNotes || '')}</textarea>
                </div>
                <div class="risk-treatment-actions">
                    <button class="library-action-btn" type="button" data-risk-plan-action="clipboard" data-risk-id="${escapeHtml(item.id)}">Pin plan to Clipboard</button>
                    <button class="library-action-btn" type="button" data-risk-plan-action="case" data-risk-id="${escapeHtml(item.id)}">Add plan to Case</button>
                    <button class="library-action-btn" type="button" data-risk-plan-action="library" data-risk-id="${escapeHtml(item.id)}">Save plan to Library</button>
                    <button class="library-action-btn" type="button" data-risk-plan-action="export" data-risk-id="${escapeHtml(item.id)}">Export Treatment Plan</button>
                    <button class="library-action-btn" type="button" data-risk-plan-action="evidence-export" data-risk-id="${escapeHtml(item.id)}">Export Evidence Pack</button>
                </div>
            `;
        }

        function openRiskTreatmentModal(item) {
            const modal = document.getElementById('risk-treatment-modal');
            const body = document.getElementById('risk-treatment-modal-body');
            if (!modal || !body || !item) return;
            body.innerHTML = renderRiskTreatmentPlan(item);
            modal.dataset.riskId = item.id;
            modal.classList.add('active');
            modal.setAttribute('aria-hidden', 'false');
            document.body.style.overflow = 'hidden';
        }

        function closeRiskTreatmentModal() {
            const modal = document.getElementById('risk-treatment-modal');
            if (!modal) return;
            modal.classList.remove('active');
            modal.setAttribute('aria-hidden', 'true');
            document.body.style.overflow = '';
        }

        function buildTreatmentPlanPayload(item) {
            const rating = getRiskCellRating(item.likelihood, item.impact);
            const controls = (item.mappedControls || []).map(control => `${control.id} (${control.status || 'Planned'})`).join(', ');
            return {
                id: `risk-plan:${item.id}`,
                anchor: `risk-plan:${item.id}`,
                type: 'risk-plan',
                title: `Treatment Plan: ${item.title}`,
                subtitle: `${rating} â€¢ ${item.treatment || 'Mitigate'}`,
                url: '',
                severity: rating.toUpperCase(),
                meta: {
                    owner: item.owner || 'Unassigned',
                    dueDate: item.dueDate || '',
                    controls: controls || 'No controls mapped'
                }
            };
        }

        function saveRiskTreatmentNotes(id, value) {
            const item = getRiskRegisterItemById(id);
            if (!item) return;
            item.treatmentPlanNotes = value.trim();
            saveRiskRegister();
        }

        function refreshRiskTreatmentModal(id) {
            const item = getRiskRegisterItemById(id);
            if (!item) return;
            openRiskTreatmentModal(item);
        }

        function updateEvidenceField(riskId, controlIndex, evidenceIndex, field, value) {
            const item = getRiskRegisterItemById(riskId);
            if (!item) return null;
            const control = item.mappedControls?.[controlIndex];
            if (!control) return null;
            if (!Array.isArray(control.evidenceItems)) {
                control.evidenceItems = [];
            }
            const evidence = control.evidenceItems[evidenceIndex];
            if (!evidence) return null;
            evidence[field] = value;
            evidence.status = getEvidenceStatus(evidence);
            saveRiskRegister();
            return evidence;
        }

        function handleEvidenceFieldUpdate(target) {
            const riskId = target.dataset.riskId;
            const controlIndex = Number(target.dataset.controlIndex);
            const evidenceIndex = Number(target.dataset.evidenceIndex);
            const field = target.dataset.evidenceField;
            if (!riskId || Number.isNaN(controlIndex) || Number.isNaN(evidenceIndex) || !field) return;
            const updated = updateEvidenceField(riskId, controlIndex, evidenceIndex, field, target.value);
            const parent = target.closest('[data-evidence-item]');
            if (parent && updated) {
                const badge = parent.querySelector('.evidence-status-badge');
                if (badge) {
                    badge.textContent = updated.status;
                    badge.className = `evidence-status-badge evidence-status-${updated.status.toLowerCase()}`;
                }
            }
        }

        function addEvidenceItemToControl(riskId, controlIndex) {
            const item = getRiskRegisterItemById(riskId);
            if (!item) return;
            const control = item.mappedControls?.[controlIndex];
            if (!control) return;
            if (!Array.isArray(control.evidenceItems)) {
                control.evidenceItems = [];
            }
            control.evidenceItems.push(normalizeEvidenceItem({}));
            saveRiskRegister();
            refreshRiskTreatmentModal(riskId);
        }

        function removeEvidenceItemFromControl(riskId, controlIndex, evidenceIndex) {
            const item = getRiskRegisterItemById(riskId);
            if (!item) return;
            const control = item.mappedControls?.[controlIndex];
            if (!control?.evidenceItems?.length) return;
            control.evidenceItems.splice(evidenceIndex, 1);
            saveRiskRegister();
            refreshRiskTreatmentModal(riskId);
        }

        function copyEvidenceChecklist(control) {
            const items = control?.evidenceItems || [];
            if (!items.length) {
                showToast('No evidence items to copy');
                return;
            }
            const text = items.map(item => `â€¢ ${item.name || 'Untitled'}${item.description ? ` â€” ${item.description}` : ''}`).join('\n');
            navigator.clipboard.writeText(text).then(() => {
                showToast('Evidence checklist copied');
            }).catch(() => {
                showToast('Unable to copy evidence checklist');
            });
        }

        function exportRiskTreatmentPlan(item) {
            if (!item) return;
            if (!window.jspdf?.jsPDF) {
                const payload = {
                    title: 'Risk Treatment Plan',
                    generatedAt: new Date().toISOString(),
                    risk: item
                };
                const blob = new Blob([JSON.stringify(payload, null, 2)], { type: 'application/json' });
                const url = URL.createObjectURL(blob);
                const link = document.createElement('a');
                link.href = url;
                link.download = `risk-treatment-plan-${Date.now()}.json`;
                link.click();
                URL.revokeObjectURL(url);
                showToast('PDF unavailable, exported JSON instead');
                return;
            }
            const { jsPDF } = window.jspdf;
            const pdf = new jsPDF('p', 'pt', 'a4');
            let y = 50;
            pdf.setFontSize(16);
            pdf.text('Risk Treatment Plan', 40, y);
            y += 18;
            pdf.setFontSize(10);
            pdf.text(`Generated: ${new Date().toLocaleString()}`, 40, y);
            y += 18;
            pdf.setFontSize(12);
            pdf.text(`Risk: ${item.title}`, 40, y);
            y += 16;
            const rating = getRiskCellRating(item.likelihood, item.impact);
            pdf.setFontSize(10);
            pdf.text(`Rating: ${rating}`, 40, y);
            y += 14;
            pdf.text(`Treatment: ${item.treatment || 'Mitigate'}`, 40, y);
            y += 14;
            pdf.text(`Owner: ${item.owner || 'Unassigned'} | Due: ${item.dueDate || 'â€”'}`, 40, y);
            y += 18;
            pdf.setFontSize(11);
            pdf.text('Mapped Controls:', 40, y);
            y += 14;
            (item.mappedControls || []).forEach(control => {
                if (y > 760) {
                    pdf.addPage();
                    y = 40;
                }
                const line = `${control.id} - ${control.title} (${control.status || 'Planned'})`;
                pdf.text(line, 40, y);
                y += 12;
            });
            y += 6;
            pdf.setFontSize(11);
            pdf.text('Evidence Checklist:', 40, y);
            y += 14;
            getEvidenceChecklistForRisk(item).forEach(group => {
                if (y > 760) {
                    pdf.addPage();
                    y = 40;
                }
                pdf.text(`${group.code}:`, 40, y);
                y += 12;
                group.items.forEach(evidence => {
                    if (y > 760) {
                        pdf.addPage();
                        y = 40;
                    }
                    pdf.text(`- ${evidence}`, 50, y);
                    y += 12;
                });
            });
            pdf.save(`risk-treatment-plan-${Date.now()}.pdf`);
            showToast('Treatment plan exported');
        }

        function exportEvidencePack(item) {
            if (!item) return;
            const rows = [];
            (item.mappedControls || []).forEach(control => {
                const evidenceItems = control.evidenceItems?.length ? control.evidenceItems : [normalizeEvidenceItem({})];
                evidenceItems.forEach(evidence => {
                    const status = getEvidenceStatus(evidence);
                    rows.push([
                        item.id,
                        item.title,
                        control.id,
                        control.title,
                        evidence.name,
                        evidence.description,
                        evidence.frequency,
                        evidence.owner,
                        evidence.lastCollectedDate,
                        status,
                        evidence.linkOrNote
                    ]);
                });
            });
            if (!rows.length) {
                showToast('No evidence items to export');
                return;
            }
            const headers = ['riskId', 'riskTitle', 'controlId', 'controlTitle', 'evidenceName', 'description', 'frequency', 'owner', 'lastCollectedDate', 'status', 'linkOrNote'];
            const csv = [headers, ...rows]
                .map(row => row.map(value => `"${String(value || '').replace(/"/g, '""')}"`).join(','))
                .join('\n');
            const blob = new Blob([csv], { type: 'text/csv' });
            const url = URL.createObjectURL(blob);
            const link = document.createElement('a');
            link.href = url;
            link.download = `evidence-pack-${item.id}-${Date.now()}.csv`;
            link.click();
            URL.revokeObjectURL(url);

            if (!window.jspdf?.jsPDF) {
                const payload = {
                    title: 'Evidence Pack',
                    generatedAt: new Date().toISOString(),
                    risk: item
                };
                const jsonBlob = new Blob([JSON.stringify(payload, null, 2)], { type: 'application/json' });
                const jsonUrl = URL.createObjectURL(jsonBlob);
                const jsonLink = document.createElement('a');
                jsonLink.href = jsonUrl;
                jsonLink.download = `evidence-pack-${item.id}-${Date.now()}.json`;
                jsonLink.click();
                URL.revokeObjectURL(jsonUrl);
                showToast('Evidence CSV exported (PDF unavailable)');
                return;
            }
            const { jsPDF } = window.jspdf;
            const pdf = new jsPDF('p', 'pt', 'a4');
            let y = 50;
            pdf.setFontSize(16);
            pdf.text(`Evidence Pack - ${item.title}`, 40, y);
            y += 18;
            pdf.setFontSize(10);
            pdf.text(`Generated: ${new Date().toLocaleString()}`, 40, y);
            y += 18;
            (item.mappedControls || []).forEach(control => {
                if (y > 760) {
                    pdf.addPage();
                    y = 40;
                }
                pdf.setFontSize(12);
                pdf.text(`${control.id} - ${control.title}`, 40, y);
                y += 14;
                pdf.setFontSize(10);
                (control.evidenceItems || []).forEach(evidence => {
                    if (y > 760) {
                        pdf.addPage();
                        y = 40;
                    }
                    const status = getEvidenceStatus(evidence);
                    const line = `â€¢ ${evidence.name || 'Untitled'} (${status}, ${evidence.frequency || 'Quarterly'})`;
                    pdf.text(line, 50, y);
                    y += 12;
                    if (evidence.description) {
                        pdf.text(`  ${evidence.description}`, 60, y);
                        y += 12;
                    }
                });
                y += 6;
            });
            pdf.save(`evidence-pack-${item.id}-${Date.now()}.pdf`);
            showToast('Evidence pack exported');
        }

        function buildMonthlyGrcReportData() {
            const postureData = computePostureKpis();
            const {
                openRisks,
                mappedControls,
                controlCounts,
                evidenceCounts,
                evidenceConfigured,
                ratingCounts,
                riskDue,
                controlDue
            } = postureData;
            const topRisks = [...openRisks]
                .sort((a, b) => {
                    const ratingA = getRiskRatingRank(getRiskCellRating(a.likelihood, a.impact));
                    const ratingB = getRiskRatingRank(getRiskCellRating(b.likelihood, b.impact));
                    if (ratingB !== ratingA) return ratingB - ratingA;
                    return new Date(b.updatedAt || 0) - new Date(a.updatedAt || 0);
                })
                .slice(0, 5)
                .map(risk => ({
                    title: risk.title,
                    rating: getRiskCellRating(risk.likelihood, risk.impact),
                    owner: risk.owner || 'Unassigned',
                    dueDate: risk.dueDate || 'N/A',
                    treatment: risk.treatment || 'N/A'
                }));
            const risksDueSoon = openRisks
                .filter(risk => isWithinNextDays(risk.dueDate, 30))
                .sort((a, b) => new Date(a.dueDate) - new Date(b.dueDate))
                .map(risk => ({
                    title: risk.title,
                    rating: getRiskCellRating(risk.likelihood, risk.impact),
                    owner: risk.owner || 'Unassigned',
                    dueDate: risk.dueDate || 'N/A',
                    treatment: risk.treatment || 'N/A'
                }));
            const controlsDueSoon = openRisks.flatMap(risk => (risk.mappedControls || [])
                .filter(control => isWithinNextDays(control.dueDate, 30))
                .map(control => ({
                    title: control.title || control.id || 'Control',
                    status: control.status || 'Planned',
                    owner: control.owner || risk.owner || 'Unassigned',
                    dueDate: control.dueDate || 'N/A',
                    riskTitle: risk.title
                })))
                .sort((a, b) => new Date(a.dueDate) - new Date(b.dueDate));

            return {
                title: 'Monthly GRC Posture Report',
                generatedAt: new Date().toISOString(),
                category: postureUiState.category,
                kpis: {
                    risks: ratingCounts,
                    controls: controlCounts,
                    evidence: evidenceConfigured ? evidenceCounts : 'Evidence not configured',
                    dueSoon: {
                        risksNext7: riskDue.next7,
                        risksNext30: riskDue.next30,
                        controlsNext7: controlDue.next7,
                        controlsNext30: controlDue.next30
                    }
                },
                topRisks,
                risksDueSoon,
                controlsDueSoon
            };
        }

        function exportMonthlyGrcReport() {
            const payload = buildMonthlyGrcReportData();
            const fallbackToJson = () => {
                const blob = new Blob([JSON.stringify(payload, null, 2)], { type: 'application/json' });
                const url = URL.createObjectURL(blob);
                const link = document.createElement('a');
                link.href = url;
                link.download = `monthly-grc-posture-report-${Date.now()}.json`;
                link.click();
                URL.revokeObjectURL(url);
                showToast('PDF unavailable, exported JSON instead');
            };

            if (!window.jspdf?.jsPDF) {
                fallbackToJson();
                return;
            }

            try {
                const { jsPDF } = window.jspdf;
                const pdf = new jsPDF('p', 'pt', 'a4');
                const pageHeight = pdf.internal.pageSize.getHeight();
                const pageWidth = pdf.internal.pageSize.getWidth();
                const margin = 40;
                let y = 50;
                const ensureSpace = () => {
                    if (y > pageHeight - 50) {
                        pdf.addPage();
                        y = 40;
                    }
                };
                const addLine = (text, indent = 0) => {
                    ensureSpace();
                    pdf.text(text, margin + indent, y);
                    y += 14;
                };
                const addParagraph = (text, indent = 0) => {
                    const lines = pdf.splitTextToSize(text, pageWidth - margin * 2 - indent);
                    lines.forEach(line => addLine(line, indent));
                };

                pdf.setFontSize(16);
                addLine(payload.title);
                pdf.setFontSize(10);
                addLine(`Generated: ${new Date(payload.generatedAt).toLocaleString()}`);
                addLine(`Category: ${postureUiState.category === 'all' ? 'All' : postureUiState.category}`);
                y += 6;

                pdf.setFontSize(12);
                addLine('KPI Summary');
                pdf.setFontSize(10);
                addLine(`Open Risks - Critical: ${payload.kpis.risks.Critical}, High: ${payload.kpis.risks.High}, Medium: ${payload.kpis.risks.Medium}`);
                addLine(`Controls - Implemented: ${payload.kpis.controls['Implemented'] || 0}, In Progress: ${payload.kpis.controls['In Progress'] || 0}, Planned: ${payload.kpis.controls['Planned'] || 0}`);
                if (typeof payload.kpis.evidence === 'string') {
                    addLine(`Evidence: ${payload.kpis.evidence}`);
                } else {
                    addLine(`Evidence - OK: ${payload.kpis.evidence.OK}, Stale: ${payload.kpis.evidence.Stale}, Missing: ${payload.kpis.evidence.Missing}`);
                }
                addLine(`Due Soon - Risks: ${payload.kpis.dueSoon.risksNext7} (7d), ${payload.kpis.dueSoon.risksNext30} (30d)`);
                addLine(`Due Soon - Controls: ${payload.kpis.dueSoon.controlsNext7} (7d), ${payload.kpis.dueSoon.controlsNext30} (30d)`);
                y += 6;

                pdf.setFontSize(12);
                addLine('Top 5 Open Risks');
                pdf.setFontSize(10);
                if (!payload.topRisks.length) {
                    addLine('No open risks to display.');
                } else {
                    payload.topRisks.forEach(risk => {
                        addParagraph(`â€¢ ${risk.title} (${risk.rating}) â€” Owner: ${risk.owner} | Due: ${risk.dueDate} | Treatment: ${risk.treatment}`);
                    });
                }
                y += 6;

                pdf.setFontSize(12);
                addLine('Controls Due Soon (Next 30 Days)');
                pdf.setFontSize(10);
                if (!payload.controlsDueSoon.length) {
                    addLine('No controls due in the next 30 days.');
                } else {
                    payload.controlsDueSoon.slice(0, 10).forEach(control => {
                        addParagraph(`â€¢ ${control.title} (${control.status}) â€” Due: ${control.dueDate} | Owner: ${control.owner} | Risk: ${control.riskTitle}`);
                    });
                }
                y += 6;

                pdf.setFontSize(12);
                addLine('Risks Due Soon (Next 30 Days)');
                pdf.setFontSize(10);
                if (!payload.risksDueSoon.length) {
                    addLine('No risks due in the next 30 days.');
                } else {
                    payload.risksDueSoon.slice(0, 10).forEach(risk => {
                        addParagraph(`â€¢ ${risk.title} (${risk.rating}) â€” Owner: ${risk.owner} | Due: ${risk.dueDate} | Treatment: ${risk.treatment}`);
                    });
                }

                pdf.save(`monthly-grc-posture-report-${Date.now()}.pdf`);
                showToast('Monthly GRC posture report exported');
            } catch (error) {
                fallbackToJson();
            }
        }

        function buildRiskClipboardPayload(item) {
            const rating = getRiskCellRating(item.likelihood, item.impact);
            return {
                id: `risk:${item.id}`,
                anchor: `risk:${item.id}`,
                type: 'risk',
                title: `Risk: ${item.title}`,
                subtitle: `${rating} â€¢ ${item.category || 'Uncategorized'}`,
                url: '',
                severity: rating.toUpperCase(),
                meta: {
                    owner: item.owner || 'Unassigned',
                    status: item.status || 'Open'
                }
            };
        }

        function addRiskToLibrary(item) {
            addLibraryItem({
                id: `risk:${item.id}`,
                type: 'risk',
                title: item.title,
                summary: item.description || `Rating: ${getRiskCellRating(item.likelihood, item.impact)}`,
                source: 'Risk Register',
                date: item.updatedAt ? new Date(item.updatedAt).toLocaleDateString() : new Date().toLocaleDateString(),
                url: '',
                tags: ['risk', item.category || 'General', getRiskCellRating(item.likelihood, item.impact)]
            });
        }

        function addRiskToCase(item) {
            const data = loadCaseBuilder();
            const caseItem = {
                id: `case-item:${Date.now()}`,
                title: item.title,
                description: item.description || `Rating: ${getRiskCellRating(item.likelihood, item.impact)}`,
                type: 'Risk',
                createdAt: new Date().toISOString()
            };
            if (data.cases.length) {
                if (!Array.isArray(data.cases[0].items)) {
                    data.cases[0].items = [];
                }
                data.cases[0].items.unshift(caseItem);
                saveCaseBuilder(data);
                showToast('Added to current case');
                return;
            }
            const entry = {
                id: `case:${Date.now()}`,
                title: `Case: ${caseItem.title}`,
                description: caseItem.description,
                items: [caseItem],
                createdAt: new Date().toISOString()
            };
            data.cases.unshift(entry);
            saveCaseBuilder(data);
            showToast('Case created');
        }

        function renderChecklistSummarySection() {
            if (!implementationChecklistsState.length) {
                return `
                    <div class="premium-card">
                        <h3 style="color:#22d3ee; margin-bottom:6px;">My Checklists</h3>
                        <p style="color: rgba(255,255,255,0.65); font-size: 13px;">No saved checklists yet. Convert a guide to get started.</p>
                    </div>
                `;
            }
            const cards = implementationChecklistsState.map(checklist => {
                const completed = checklist.items?.filter(item => item.done).length || 0;
                const total = checklist.items?.length || 0;
                return `
                    <div class="checklist-card" data-checklist-id="${escapeHtml(checklist.id)}">
                        <div>
                            <div style="font-weight:600;">${escapeHtml(checklist.title)}</div>
                            <div style="font-size:12px; color: rgba(255,255,255,0.6);">${completed}/${total} complete</div>
                        </div>
                        <div class="checklist-actions">
                            <button class="library-action-btn" type="button" data-checklist-open="${escapeHtml(checklist.id)}">Open</button>
                            <button class="library-action-btn" type="button" data-checklist-delete="${escapeHtml(checklist.id)}">Delete</button>
                        </div>
                    </div>
                `;
            }).join('');
            return `
                <div class="premium-card">
                    <h3 style="color:#22d3ee; margin-bottom:6px;">My Checklists</h3>
                    <div class="checklist-summary">${cards}</div>
                </div>
            `;
        }

        function createChecklistFromGuide(guide) {
            if (!guide) return;
            const checklist = {
                id: `checklist-${Date.now()}`,
                title: guide.title,
                items: (guide.steps || []).map(step => ({
                    text: step.step,
                    done: false
                })),
                createdAt: new Date().toISOString()
            };
            implementationChecklistsState.unshift(checklist);
            saveImplementationChecklists();
            renderDataBankSection('guides', dataBankState.search);
            openChecklistModal(checklist.id);
            showToast('Checklist created');
        }

        function getChecklistById(id) {
            return implementationChecklistsState.find(checklist => checklist.id === id);
        }

        function openChecklistModal(id) {
            const checklist = getChecklistById(id);
            const modal = document.getElementById('checklist-modal');
            const body = document.getElementById('checklist-modal-body');
            const title = document.getElementById('checklist-modal-title');
            if (!checklist || !modal || !body || !title) return;
            title.textContent = checklist.title;
            const completed = checklist.items.filter(item => item.done).length;
            const total = checklist.items.length;
            body.innerHTML = `
                <div>
                    <div style="display:flex; justify-content: space-between; align-items: center; gap: 12px; flex-wrap: wrap;">
                        <div style="color: rgba(255,255,255,0.7); font-size: 13px;">${completed}/${total} complete</div>
                        <div class="checklist-actions">
                            <button class="library-action-btn" type="button" data-checklist-pin="${escapeHtml(checklist.id)}">Pin checklist</button>
                            <button class="library-action-btn" type="button" data-checklist-library="${escapeHtml(checklist.id)}">Save to Library</button>
                            <button class="library-action-btn" type="button" data-checklist-export="${escapeHtml(checklist.id)}">Export</button>
                        </div>
                    </div>
                    <div class="checklist-items">
                        ${checklist.items.map((item, index) => `
                            <label class="checklist-item ${item.done ? 'done' : ''}">
                                <input type="checkbox" data-checklist-item="${escapeHtml(checklist.id)}" data-index="${index}" ${item.done ? 'checked' : ''}>
                                <span>${escapeHtml(item.text)}</span>
                            </label>
                        `).join('')}
                    </div>
                </div>
            `;
            modal.classList.add('active');
            modal.setAttribute('aria-hidden', 'false');
            document.body.style.overflow = 'hidden';
        }

        function closeChecklistModal() {
            const modal = document.getElementById('checklist-modal');
            if (!modal) return;
            modal.classList.remove('active');
            modal.setAttribute('aria-hidden', 'true');
            document.body.style.overflow = '';
        }

        function updateChecklistItem(checklistId, index, done) {
            const checklist = getChecklistById(checklistId);
            if (!checklist || !checklist.items[index]) return;
            checklist.items[index].done = done;
            saveImplementationChecklists();
            openChecklistModal(checklistId);
            renderDataBankSection('guides', dataBankState.search);
        }

        function deleteChecklist(id) {
            implementationChecklistsState = implementationChecklistsState.filter(checklist => checklist.id !== id);
            saveImplementationChecklists();
            renderDataBankSection('guides', dataBankState.search);
            closeChecklistModal();
            showToast('Checklist removed');
        }

        function pinChecklistToClipboard(checklist) {
            if (!checklist) return;
            const completed = checklist.items.filter(item => item.done).length;
            const payload = {
                id: `checklist:${checklist.id}`,
                anchor: `checklist:${checklist.id}`,
                type: 'checklist',
                title: checklist.title,
                subtitle: 'Implementation Checklist',
                url: '',
                severity: null,
                meta: {
                    progress: `${completed}/${checklist.items.length}`
                }
            };
            upsertClipboardItem(payload);
            renderClipboard();
            updatePinButtons();
            showToast('Checklist pinned');
        }

        function saveChecklistToLibrary(checklist) {
            if (!checklist) return;
            const completed = checklist.items.filter(item => item.done).length;
            addLibraryItem({
                id: `checklist:${checklist.id}`,
                type: 'checklist',
                title: checklist.title,
                summary: `${completed}/${checklist.items.length} tasks complete`,
                source: 'Implementation Guides',
                date: new Date(checklist.createdAt).toLocaleDateString(),
                url: '',
                tags: ['checklist', 'implementation']
            });
        }

        function exportChecklist(checklist) {
            if (!checklist) return;
            if (window.jspdf?.jsPDF) {
                const { jsPDF } = window.jspdf;
                const pdf = new jsPDF('p', 'pt', 'a4');
                let y = 50;
                pdf.setFontSize(16);
                pdf.text(checklist.title, 40, y);
                y += 20;
                pdf.setFontSize(10);
                pdf.text(`Generated: ${new Date().toLocaleString()}`, 40, y);
                y += 20;
                pdf.setFontSize(11);
                checklist.items.forEach(item => {
                    const text = `${item.done ? 'â˜‘' : 'â˜'} ${item.text}`;
                    if (y > 760) {
                        pdf.addPage();
                        y = 40;
                    }
                    pdf.text(text, 40, y);
                    y += 14;
                });
                pdf.save(`checklist-${Date.now()}.pdf`);
                showToast('Checklist exported');
                return;
            }
            const blob = new Blob([JSON.stringify(checklist, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const link = document.createElement('a');
            link.href = url;
            link.download = `checklist-${Date.now()}.json`;
            link.click();
            URL.revokeObjectURL(url);
            showToast('Checklist exported');
        }

        function loadDataBankFavorites() {
            try {
                const raw = localStorage.getItem(dataBankFavoritesKey);
                const parsed = JSON.parse(raw || '[]');
                return Array.isArray(parsed) ? parsed : [];
            } catch (error) {
                return [];
            }
        }

        function saveDataBankFavorites() {
            localStorage.setItem(dataBankFavoritesKey, JSON.stringify([...dataBankState.favorites]));
        }

        function loadDataBankRecent() {
            try {
                const raw = localStorage.getItem(dataBankRecentKey);
                const parsed = JSON.parse(raw || '[]');
                return Array.isArray(parsed) ? parsed : [];
            } catch (error) {
                return [];
            }
        }

        function saveDataBankRecent() {
            localStorage.setItem(dataBankRecentKey, JSON.stringify(dataBankState.recent));
        }

        function getDataBankAllItems() {
            return [
                ...dataBankData.frameworks,
                ...dataBankData.controlFamilies,
                ...dataBankData.glossary,
                ...dataBankData.guides
            ];
        }

        function getDataBankItemById(id) {
            return getDataBankAllItems().find(item => item.id === id);
        }

        function getDataBankSectionForType(type) {
            if (type === 'framework') return 'frameworks';
            if (type === 'control') return 'controls';
            if (type === 'term') return 'glossary';
            if (type === 'guide') return 'guides';
            return 'frameworks';
        }

        function getDataBankSearchText(item) {
            if (!item) return '';
            if (item.type === 'framework') {
                return [
                    item.name,
                    item.description,
                    item.best_for,
                    ...(item.functions_list || []),
                    item.structure_summary
                ].join(' ');
            }
            if (item.type === 'control') {
                return [
                    item.code,
                    item.name,
                    item.description,
                    item.purpose,
                    ...(item.key_controls || []),
                    ...(item.key_controls_detail || []).map(ctrl => ctrl.name)
                ].join(' ');
            }
            if (item.type === 'term') {
                return [
                    item.term,
                    item.definition,
                    item.expanded_definition,
                    ...(item.related || [])
                ].join(' ');
            }
            if (item.type === 'guide') {
                return [
                    item.title,
                    item.summary,
                    ...(item.steps || []).map(step => step.step)
                ].join(' ');
            }
            return '';
        }

        function getDataBankSnippet(item) {
            if (!item) return '';
            if (item.type === 'framework') return item.description || item.what_it_is || '';
            if (item.type === 'control') return item.description || item.purpose || '';
            if (item.type === 'term') return item.definition || '';
            if (item.type === 'guide') {
                const firstStep = item.steps?.[0]?.step;
                return firstStep ? `Step 1: ${firstStep}` : (item.summary || '');
            }
            return '';
        }

        function toggleDataBankFavorite(id) {
            if (!id) return;
            if (dataBankState.favorites.has(id)) {
                dataBankState.favorites.delete(id);
            } else {
                dataBankState.favorites.add(id);
            }
            saveDataBankFavorites();
            renderDataBankMiniRows();
            updateDataBankFavoriteButtons();
        }

        function updateDataBankRecent(id) {
            if (!id) return;
            dataBankState.recent = dataBankState.recent.filter(entry => entry !== id);
            dataBankState.recent.unshift(id);
            dataBankState.recent = dataBankState.recent.slice(0, 10);
            saveDataBankRecent();
            renderDataBankMiniRows();
        }

        function renderDataBankMiniRows() {
            const favoritesContainer = document.getElementById('databank-favorites');
            const favoritesEmpty = document.getElementById('databank-favorites-empty');
            const recentContainer = document.getElementById('databank-recent');
            const recentEmpty = document.getElementById('databank-recent-empty');

            if (!favoritesContainer || !recentContainer || !favoritesEmpty || !recentEmpty) return;

            const favoriteItems = [...dataBankState.favorites]
                .map(id => getDataBankItemById(id))
                .filter(Boolean);
            const recentItems = dataBankState.recent
                .map(id => getDataBankItemById(id))
                .filter(Boolean);

            favoritesContainer.innerHTML = favoriteItems.map(item => `
                <button class="databank-mini-chip" type="button" data-databank-chip="${escapeHtml(item.id)}">
                    <span>${dataBankTypeMeta[item.type]?.icon || 'ðŸ“Œ'}</span>
                    <span>${escapeHtml(item.name || item.term || item.title)}</span>
                    <span class="databank-chip-type">${escapeHtml(dataBankTypeMeta[item.type]?.label || 'Item')}</span>
                </button>
            `).join('');
            favoritesEmpty.style.display = favoriteItems.length ? 'none' : 'block';

            recentContainer.innerHTML = recentItems.map(item => `
                <button class="databank-mini-chip" type="button" data-databank-chip="${escapeHtml(item.id)}">
                    <span>${dataBankTypeMeta[item.type]?.icon || 'ðŸ“Œ'}</span>
                    <span>${escapeHtml(item.name || item.term || item.title)}</span>
                    <span class="databank-chip-type">${escapeHtml(dataBankTypeMeta[item.type]?.label || 'Item')}</span>
                </button>
            `).join('');
            recentEmpty.style.display = recentItems.length ? 'none' : 'block';
        }

        function updateDataBankFavoriteButtons() {
            document.querySelectorAll('[data-databank-fav]').forEach(btn => {
                const id = btn.dataset.databankFav;
                if (!id) return;
                const isFav = dataBankState.favorites.has(id);
                btn.classList.toggle('is-active', isFav);
                btn.setAttribute('aria-pressed', String(isFav));
                btn.textContent = isFav ? 'â˜…' : 'â˜†';
            });
        }

        function updateDataBankSearchResults(query) {
            const resultsContainer = document.getElementById('databank-search-results');
            if (!resultsContainer) return;
            const trimmed = query.trim().toLowerCase();
            if (!trimmed) {
                resultsContainer.classList.remove('active');
                resultsContainer.innerHTML = '';
                return;
            }

            const results = getDataBankAllItems().filter(item => {
                const haystack = getDataBankSearchText(item).toLowerCase();
                return haystack.includes(trimmed);
            });

            if (!results.length) {
                resultsContainer.innerHTML = `
                    <div class="databank-search-result">
                        <div class="databank-result-icon">ðŸ”Ž</div>
                        <div>
                            <div class="databank-result-title">No matches</div>
                            <div class="databank-result-snippet">Try a different term or filter.</div>
                        </div>
                    </div>
                `;
                resultsContainer.classList.add('active');
                return;
            }

            resultsContainer.innerHTML = results.map(item => `
                <div class="databank-search-result" data-databank-result="${escapeHtml(item.id)}">
                    <div class="databank-result-icon">${dataBankTypeMeta[item.type]?.icon || 'ðŸ“Œ'}</div>
                    <div>
                        <div class="databank-result-type">${escapeHtml(dataBankTypeMeta[item.type]?.label || 'Item')}</div>
                        <div class="databank-result-title">${escapeHtml(item.name || item.term || item.title)}</div>
                        <div class="databank-result-snippet">${escapeHtml(getDataBankSnippet(item))}</div>
                    </div>
                </div>
            `).join('');
            resultsContainer.classList.add('active');
        }

        function switchDataBankSection(section) {
            dataBankState.activeSection = section;
            const dbBtns = document.querySelectorAll('[data-databank]');
            dbBtns.forEach(btn => btn.classList.remove('active'));
            const activeBtn = document.querySelector(`[data-databank="${section}"]`);
            if (activeBtn) {
                activeBtn.classList.add('active');
            }
            if (section === 'risk' || section === 'posture') {
                initializeRiskMatrixAndRegister();
            }
            renderDataBankSection(section, dataBankState.search);
        }

        function filterDataBank() {
            const searchInput = document.getElementById('databank-search');
            if (!searchInput) return;
            const query = searchInput.value.trim().toLowerCase();
            dataBankState.search = query;
            renderDataBankSection(dataBankState.activeSection, query);
            updateDataBankSearchResults(query);
        }

        function renderDataBankSection(section, searchTerm) {
            const contentDiv = document.getElementById('databank-content');
            if (!contentDiv) return;
            let html = "";
            const query = (searchTerm || '').trim().toLowerCase();

            if (section === 'frameworks') {
                const frameworks = dataBankData.frameworks.filter(item => {
                    if (!query) return true;
                    return getDataBankSearchText(item).toLowerCase().includes(query);
                });
                html += `<div class='news-grid'>`;
                frameworks.forEach(framework => {
                    html += `
                        <div class='news-card' style='border-left: 5px solid #22d3ee;' data-databank-item data-databank-id='${escapeHtml(framework.id)}' data-clipboard-anchor='databank-${escapeHtml(framework.id)}'>
                            <div class="databank-card-header">
                                <span class='news-badge badge-blue'>${escapeHtml(framework.name)}</span>
                                <button class="databank-fav-btn" type="button" data-databank-fav="${escapeHtml(framework.id)}" aria-label="Toggle favorite">â˜†</button>
                            </div>
                            <h3>${escapeHtml(framework.name)} <span style='font-size:13px; color: #00ff88;'>v.${escapeHtml(framework.version)}</span></h3>
                            <p>${escapeHtml(framework.description)}</p>
                            <div style='font-size:13px; color: #ff4444;'>${escapeHtml(framework.best_for)}</div>
                            <div class='news-meta'>
                                <span style='color:#00ff88;'>${framework.functions || framework.families || framework.domains} ${framework.functions ? 'Functions' : framework.families ? 'Families' : 'Domains'}</span>
                                <span style='color:#ff0040;'>${framework.controls || framework.safeguards || framework.subcategories} controls</span>
                            </div>
                            ${framework.functions_list ? `<div style='margin-top:12px; font-size:13px;'>Core Functions: <span style='color:#ff4444;'>${framework.functions_list.map(item => escapeHtml(item)).join(', ')}</span></div>` : ''}
                            ${framework.link ? `<a class='news-link' href='${escapeHtml(framework.link)}' target='_blank' rel='noopener'>View official standard â†’</a>` : ''}
                        </div>`;
                });
                html += `</div>`;
                if (!frameworks.length) {
                    html = `<div class='premium-card'><p>No matches in Frameworks & Standards.</p></div>`;
                }
            } else if (section === 'controls') {
                const families = dataBankData.controlFamilies.filter(item => {
                    if (!query) return true;
                    return getDataBankSearchText(item).toLowerCase().includes(query);
                });
                html += `<div class='malware-grid'>`;
                families.forEach(fam => {
                    html += `
                        <div class='malware-card' style='border-left: 5px solid #9b59b6;' data-databank-item data-databank-id='${escapeHtml(fam.id)}' data-clipboard-anchor='databank-${escapeHtml(fam.id)}'>
                            <div class="databank-card-header">
                                <div style='font-weight:600; font-size:17px; margin-bottom:4px; color:#9b59b6;'>${escapeHtml(fam.code)} â€“ ${escapeHtml(fam.name)}</div>
                                <button class="databank-fav-btn" type="button" data-databank-fav="${escapeHtml(fam.id)}" aria-label="Toggle favorite">â˜†</button>
                            </div>
                            <div style='font-size:14px; margin-bottom:8px;'>${escapeHtml(fam.description)}</div>
                            <div style='font-size:13px;'><span style='color:#ff6b35;'>Key Controls:</span> ${fam.key_controls.map(kc => `<span style='padding:2px 6px; background:rgba(34,211,238,0.1); border-radius:5px; margin-right:6px;'>${escapeHtml(kc)}</span>`).join('')}</div>
                        </div>`;
                });
                html += `</div>`;
                if (!families.length) {
                    html = `<div class='premium-card'><p>No matches in Control Families.</p></div>`;
                }
            } else if (section === 'glossary') {
                const terms = dataBankData.glossary.filter(item => {
                    if (!query) return true;
                    return getDataBankSearchText(item).toLowerCase().includes(query);
                });
                html += `<div class='breach-table'><table class='data-table'><thead><tr><th>Term</th><th>Definition</th><th style="width:70px;">Favorite</th></tr></thead><tbody>`;
                terms.forEach(gloss => {
                    html += `
                        <tr data-databank-item data-databank-id='${escapeHtml(gloss.id)}' data-clipboard-anchor='databank-${escapeHtml(gloss.id)}'>
                            <td><strong style='color: #22d3ee;'>${escapeHtml(gloss.term)}</strong></td>
                            <td>${escapeHtml(gloss.definition)}</td>
                            <td><button class="databank-fav-btn" type="button" data-databank-fav="${escapeHtml(gloss.id)}" aria-label="Toggle favorite">â˜†</button></td>
                        </tr>
                    `;
                });
                html += `</tbody></table></div>`;
                if (!terms.length) {
                    html = `<div class='premium-card'><p>No matches in Glossary.</p></div>`;
                }
            } else if (section === 'risk') {
                html += renderRiskMatrixBuilder();
                html += renderRiskRegisterSection();
                dataBankData.riskMatrices.forEach(matrix => {
                    if (query && !((matrix.title && matrix.title.toLowerCase().includes(query)) || (matrix.description && matrix.description.toLowerCase().includes(query)))) return;
                    html += `<div class='premium-card' style='box-shadow:0 0 10px #ffd700; margin-bottom:18px;'>`;
                    html += `<h3 style='color:#ff6b00; margin-bottom:10px;'>${escapeHtml(matrix.title)}</h3><p style='margin-bottom:12px;'>${escapeHtml(matrix.description || '')}</p>`;
                    if (matrix.table) {
                        html += `<table class='data-table'><tbody>`;
                        matrix.table.forEach(row => {
                            html += `<tr>${row.map((cell,i) => `<td style='${i===0?"font-weight:600;color:#ff6b35;":"font-weight:500;color:#ff0040;"}'>${escapeHtml(cell)}</td>`).join('')}</tr>`;
                        });
                        html += `</tbody></table>`;
                    }
                    if (matrix.scale) {
                        html += `<div style='display:flex; gap:12px; margin:10px 0;'>`;
                        matrix.scale.forEach(s => {
                            html += `<span style='padding:6px 16px; background:${escapeHtml(s.color)}; color:#0f1419; border-radius:6px; font-weight:600;'>${escapeHtml(s.label)} (${escapeHtml(s.range)})</span>`;
                        });
                        html += `</div>`;
                    }
                    html += `</div>`;
                });
                if (!dataBankData.riskMatrices.some(matrix => {
                    if (!query) return true;
                    return (matrix.title && matrix.title.toLowerCase().includes(query)) || (matrix.description && matrix.description.toLowerCase().includes(query));
                })) {
                    html += `<div class='premium-card'><p>No matches in Risk Matrices.</p></div>`;
                }
            } else if (section === 'posture') {
                html += renderPostureSection();
            } else if (section === 'guides') {
                const guides = dataBankData.guides.filter(item => {
                    if (!query) return true;
                    return getDataBankSearchText(item).toLowerCase().includes(query);
                });
                html += renderChecklistSummarySection();
                html += `<div class='timeline'>`;
                guides.forEach(guide => {
                    html += `
                        <div class='timeline-item' data-databank-item data-databank-id='${escapeHtml(guide.id)}' data-clipboard-anchor='databank-${escapeHtml(guide.id)}'>
                            <div class='timeline-dot' style='background:#22d3ee;'></div>
                            <div class='timeline-content'>
                                <div class='databank-guide-header'>
                                    <div>
                                        <div class='timeline-header'><strong style='color:#22d3ee;'>${escapeHtml(guide.title)}</strong></div>
                                        <div class='timeline-meta'>${escapeHtml(guide.summary || 'Implementation steps and evidence guidance.')}</div>
                                    </div>
                                    <div class="databank-guide-actions">
                                        <button class="databank-fav-btn" type="button" data-databank-fav="${escapeHtml(guide.id)}" aria-label="Toggle favorite">â˜†</button>
                                        <button class="databank-detail-btn" type="button" data-checklist-create="${escapeHtml(guide.id)}">Convert to Checklist</button>
                                        <button class="databank-guide-toggle" type="button" data-guide-toggle="${escapeHtml(guide.id)}">Toggle steps</button>
                                        <button class="databank-detail-btn" type="button" data-databank-open="${escapeHtml(guide.id)}">Details</button>
                                    </div>
                                </div>
                                <div class='databank-guide-body' data-guide-body="${escapeHtml(guide.id)}">
                                    ${(guide.steps || []).map((step, index) => `
                                        <div class="databank-guide-step">
                                            <strong>Step ${index + 1}:</strong> ${escapeHtml(step.step)}
                                            <div style="margin-top:6px; font-size:12px; color: rgba(255,255,255,0.65);">
                                                <div><span style="color:#22d3ee;">Deliverables:</span> ${(step.deliverables || []).map(item => escapeHtml(item)).join(', ') || 'TBD'}</div>
                                                <div><span style="color:#ffb020;">Evidence:</span> ${(step.evidence || []).map(item => escapeHtml(item)).join(', ') || 'TBD'}</div>
                                            </div>
                                        </div>
                                    `).join('')}
                                </div>
                            </div>
                        </div>
                    `;
                });
                html += `</div>`;
                if (!guides.length) {
                    html += `<div class='premium-card'><p>No matches in Implementation Guides.</p></div>`;
                }
            } else {
                html = `<div class='premium-card'><p>No data available for this section.</p></div>`;
            }
            contentDiv.innerHTML = html;
            updateDataBankFavoriteButtons();
            updatePinButtons();
        }

        function highlightDataBankItem(id) {
            if (!id) return;
            const safeId = (window.CSS && CSS.escape) ? CSS.escape(id) : id;
            const selector = `[data-databank-id="${safeId}"]`;
            const target = document.querySelector(selector);
            if (!target) return;
            target.classList.add('databank-highlight');
            setTimeout(() => {
                target.classList.remove('databank-highlight');
            }, 1200);
        }

        function scrollToDataBankItem(id) {
            if (!id) return;
            const safeId = (window.CSS && CSS.escape) ? CSS.escape(id) : id;
            const selector = `[data-databank-id="${safeId}"]`;
            const target = document.querySelector(selector);
            if (!target) return;
            target.scrollIntoView({ behavior: 'smooth', block: 'center' });
            highlightDataBankItem(id);
        }

        function buildDataBankActionButtons(item) {
            if (!item) return '';
            return `
                <div class="databank-detail-actions">
                    <button class="library-action-btn" type="button" data-databank-action="library" data-databank-id="${escapeHtml(item.id)}">Save to Library</button>
                    <button class="library-action-btn" type="button" data-databank-action="clipboard" data-databank-id="${escapeHtml(item.id)}">Pin to Clipboard</button>
                    <button class="library-action-btn" type="button" data-databank-action="case" data-databank-id="${escapeHtml(item.id)}">Add to Case</button>
                </div>
            `;
        }

        function renderDataBankModalContent(item) {
            if (!item) return '<p>No detail information available.</p>';
            if (item.type === 'framework') {
                return `
                    <div class="databank-detail-grid">
                        <div class="databank-detail-section">
                            <h4>What it is</h4>
                            <p style="color: rgba(255,255,255,0.75); font-size: 13px;">${escapeHtml(item.what_it_is)}</p>
                            <h4 style="margin-top:12px;">Who itâ€™s for</h4>
                            <p style="color: rgba(255,255,255,0.75); font-size: 13px;">${escapeHtml(item.who_its_for)}</p>
                        </div>
                        <div class="databank-detail-section">
                            <h4>Structure summary</h4>
                            <p style="color: rgba(255,255,255,0.75); font-size: 13px;">${escapeHtml(item.structure_summary)}</p>
                        </div>
                        <div class="databank-detail-section">
                            <h4>Getting started checklist</h4>
                            <ul>${(item.checklist || []).map(entry => `<li>${escapeHtml(entry)}</li>`).join('')}</ul>
                        </div>
                        <div class="databank-detail-section">
                            <h4>Evidence examples (audit-ready)</h4>
                            <ul>${(item.evidence_examples || []).map(entry => `<li>${escapeHtml(entry)}</li>`).join('')}</ul>
                        </div>
                        <div class="databank-detail-section">
                            <h4>Official links</h4>
                            <ul>${(item.official_links || []).map(link => `<li><a class="news-link" href="${escapeHtml(link.url)}" target="_blank" rel="noopener">${escapeHtml(link.label)} â†’</a></li>`).join('')}</ul>
                        </div>
                        ${buildDataBankActionButtons(item)}
                    </div>
                `;
            }
            if (item.type === 'control') {
                return `
                    <div class="databank-detail-grid">
                        <div class="databank-detail-section">
                            <h4>Family purpose</h4>
                            <p style="color: rgba(255,255,255,0.75); font-size: 13px;">${escapeHtml(item.purpose)}</p>
                        </div>
                        <div class="databank-detail-section">
                            <h4>Key controls</h4>
                            <ul>${(item.key_controls_detail || []).map(ctrl => `<li><strong>${escapeHtml(ctrl.name)}:</strong> ${escapeHtml(ctrl.description)}</li>`).join('')}</ul>
                        </div>
                        <div class="databank-detail-section">
                            <h4>Implementation examples</h4>
                            <ul>${(item.implementation_examples || []).map(entry => `<li>${escapeHtml(entry)}</li>`).join('')}</ul>
                        </div>
                        <div class="databank-detail-section">
                            <h4>Evidence to collect</h4>
                            <ul>${(item.evidence || []).map(entry => `<li>${escapeHtml(entry)}</li>`).join('')}</ul>
                        </div>
                        <div class="databank-detail-section">
                            <h4>Audit questions</h4>
                            <ul>${(item.audit_questions || []).map(entry => `<li>${escapeHtml(entry)}</li>`).join('')}</ul>
                        </div>
                        ${buildDataBankActionButtons(item)}
                    </div>
                `;
            }
            if (item.type === 'term') {
                return `
                    <div class="databank-detail-grid">
                        <div class="databank-detail-section">
                            <h4>Expanded definition</h4>
                            <p style="color: rgba(255,255,255,0.75); font-size: 13px;">${escapeHtml(item.expanded_definition)}</p>
                        </div>
                        <div class="databank-detail-section">
                            <h4>Examples</h4>
                            <ul>${(item.examples || []).map(entry => `<li>${escapeHtml(entry)}</li>`).join('')}</ul>
                        </div>
                        <div class="databank-detail-section">
                            <h4>Related terms</h4>
                            <ul>${(item.related || []).map(entry => `<li>${escapeHtml(entry)}</li>`).join('')}</ul>
                        </div>
                        ${buildDataBankActionButtons(item)}
                    </div>
                `;
            }
            if (item.type === 'guide') {
                return `
                    <div class="databank-detail-grid">
                        <div class="databank-detail-section">
                            <h4>Overview</h4>
                            <p style="color: rgba(255,255,255,0.75); font-size: 13px;">${escapeHtml(item.summary)}</p>
                        </div>
                        <div class="databank-detail-section">
                            <h4>Steps + deliverables + evidence</h4>
                            <ul>
                                ${(item.steps || []).map((step, index) => `
                                    <li>
                                        <strong>Step ${index + 1}:</strong> ${escapeHtml(step.step)}<br>
                                        <span style="color:#22d3ee;">Deliverables:</span> ${(step.deliverables || []).map(entry => escapeHtml(entry)).join(', ') || 'TBD'}<br>
                                        <span style="color:#ffb020;">Evidence:</span> ${(step.evidence || []).map(entry => escapeHtml(entry)).join(', ') || 'TBD'}
                                    </li>
                                `).join('')}
                            </ul>
                        </div>
                        ${buildDataBankActionButtons(item)}
                    </div>
                `;
            }
            return '<p>No detail information available.</p>';
        }

        function openDataBankModal(item) {
            if (!item) return;
            const modal = document.getElementById('databank-detail-modal');
            const title = document.getElementById('databank-detail-modal-title');
            const body = document.getElementById('databank-detail-modal-body');
            if (!modal || !body || !title) return;
            title.textContent = item.name || item.term || item.title || 'Data Bank Details';
            body.innerHTML = renderDataBankModalContent(item);
            modal.classList.add('active');
            modal.setAttribute('aria-hidden', 'false');
            document.body.style.overflow = 'hidden';
            updateDataBankRecent(item.id);
        }

        function closeDataBankModal() {
            const modal = document.getElementById('databank-detail-modal');
            if (!modal) return;
            modal.classList.remove('active');
            modal.setAttribute('aria-hidden', 'true');
            document.body.style.overflow = '';
        }

        function buildDataBankLibraryPayload(item) {
            const title = item.name || item.term || item.title || 'Data Bank Item';
            const summary = getDataBankSnippet(item);
            return {
                id: `databank:${item.id}`,
                type: 'knowledge',
                title: title,
                summary: summary,
                source: 'Data Bank',
                date: new Date().toLocaleDateString(),
                url: item.link || '',
                tags: ['databank', dataBankTypeMeta[item.type]?.label || item.type]
            };
        }

        function addDataBankToClipboard(item) {
            if (!item) return;
            const payload = {
                id: `databank:${item.id}`,
                anchor: `databank-${item.id}`,
                type: 'knowledge',
                title: item.name || item.term || item.title || 'Data Bank Item',
                subtitle: dataBankTypeMeta[item.type]?.label || 'Knowledge',
                url: item.link || '',
                meta: {
                    source: 'Data Bank',
                    category: dataBankTypeMeta[item.type]?.label || item.type
                }
            };
            upsertClipboardItem(payload);
            renderClipboard();
            updatePinButtons();
            showToast('Pinned to clipboard');
        }

        function addDataBankToCase(item) {
            if (!item) return;
            const data = loadCaseBuilder();
            const caseItem = {
                id: `case-item:${Date.now()}`,
                title: item.name || item.term || item.title || 'Data Bank Item',
                description: getDataBankSnippet(item),
                type: dataBankTypeMeta[item.type]?.label || item.type,
                createdAt: new Date().toISOString()
            };
            if (data.cases.length) {
                if (!Array.isArray(data.cases[0].items)) {
                    data.cases[0].items = [];
                }
                data.cases[0].items.unshift(caseItem);
                saveCaseBuilder(data);
                showToast('Added to current case');
                return;
            }
            const entry = {
                id: `case:${Date.now()}`,
                title: `Case: ${caseItem.title}`,
                description: caseItem.description,
                items: [caseItem],
                createdAt: new Date().toISOString()
            };
            data.cases.unshift(entry);
            saveCaseBuilder(data);
            showToast('Case created');
        }

        function handleDataBankAction(action, id) {
            const item = getDataBankItemById(id);
            if (!item) return;
            if (action === 'library') {
                addLibraryItem(buildDataBankLibraryPayload(item));
                return;
            }
            if (action === 'clipboard') {
                addDataBankToClipboard(item);
                return;
            }
            if (action === 'case') {
                addDataBankToCase(item);
            }
        }

        function setupDataBank() {
            const searchInput = document.getElementById('databank-search');
            if (searchInput) {
                searchInput.addEventListener('input', filterDataBank);
                searchInput.addEventListener('focus', () => {
                    updateDataBankSearchResults(searchInput.value);
                });
            }
            renderDataBankMiniRows();

            document.addEventListener('click', event => {
                const resultItem = event.target.closest('[data-databank-result]');
                if (resultItem) {
                    const id = resultItem.dataset.databankResult;
                    const item = getDataBankItemById(id);
                    if (!item) return;
                    const targetSection = getDataBankSectionForType(item.type);
                    switchDataBankSection(targetSection);
                    setTimeout(() => {
                        scrollToDataBankItem(id);
                    }, 120);
                    const resultsContainer = document.getElementById('databank-search-results');
                    if (resultsContainer) {
                        resultsContainer.classList.remove('active');
                    }
                    return;
                }

                const riskSizeBtn = event.target.closest('[data-risk-size]');
                if (riskSizeBtn) {
                    const size = Number(riskSizeBtn.dataset.riskSize);
                    if (size === riskMatrixState.size) return;
                    riskMatrixState = getDefaultRiskMatrixConfig(size);
                    saveRiskMatrixConfig();
                    renderDataBankSection('risk', dataBankState.search);
                    return;
                }

                const riskAddBtn = event.target.closest('[data-risk-add]');
                if (riskAddBtn) {
                    openRiskRegisterModal();
                    return;
                }

                const riskExportBtn = event.target.closest('[data-risk-export]');
                if (riskExportBtn) {
                    const type = riskExportBtn.dataset.riskExport;
                    if (type === 'csv') exportRiskRegisterCsv();
                    if (type === 'pdf') exportRiskRegisterPdf();
                    if (type === 'controls') exportRiskControlsMappingCsv();
                    return;
                }

                const postureExportBtn = event.target.closest('[data-posture-export]');
                if (postureExportBtn) {
                    exportMonthlyGrcReport();
                    return;
                }

                const postureRiskBtn = event.target.closest('[data-posture-go-risk]');
                if (postureRiskBtn) {
                    openRiskRegisterFromPosture();
                    return;
                }

                const riskActionBtn = event.target.closest('[data-risk-action]');
                if (riskActionBtn) {
                    const id = riskActionBtn.dataset.riskId;
                    const action = riskActionBtn.dataset.riskAction;
                    const item = getRiskRegisterItemById(id);
                    if (!item) return;
                    if (action === 'plan') {
                        openRiskTreatmentModal(item);
                    } else if (action === 'clipboard') {
                        upsertClipboardItem(buildRiskClipboardPayload(item));
                        renderClipboard();
                        updatePinButtons();
                        showToast('Pinned to clipboard');
                    } else if (action === 'case') {
                        addRiskToCase(item);
                    } else if (action === 'library') {
                        addRiskToLibrary(item);
                    }
                    return;
                }

                const evidenceAddBtn = event.target.closest('[data-evidence-add]');
                if (evidenceAddBtn) {
                    addEvidenceItemToControl(evidenceAddBtn.dataset.riskId, Number(evidenceAddBtn.dataset.controlIndex));
                    return;
                }

                const evidenceRemoveBtn = event.target.closest('[data-evidence-remove]');
                if (evidenceRemoveBtn) {
                    removeEvidenceItemFromControl(
                        evidenceRemoveBtn.dataset.riskId,
                        Number(evidenceRemoveBtn.dataset.controlIndex),
                        Number(evidenceRemoveBtn.dataset.evidenceIndex)
                    );
                    return;
                }

                const evidenceMarkBtn = event.target.closest('[data-evidence-mark]');
                if (evidenceMarkBtn) {
                    const today = new Date().toISOString().split('T')[0];
                    const updated = updateEvidenceField(
                        evidenceMarkBtn.dataset.riskId,
                        Number(evidenceMarkBtn.dataset.controlIndex),
                        Number(evidenceMarkBtn.dataset.evidenceIndex),
                        'lastCollectedDate',
                        today
                    );
                    const parent = evidenceMarkBtn.closest('[data-evidence-item]');
                    if (parent) {
                        const dateInput = parent.querySelector('[data-evidence-field="lastCollectedDate"]');
                        if (dateInput) dateInput.value = today;
                        const badge = parent.querySelector('.evidence-status-badge');
                        if (badge && updated) {
                            badge.textContent = updated.status;
                            badge.className = `evidence-status-badge evidence-status-${updated.status.toLowerCase()}`;
                        }
                    }
                    showToast('Evidence marked collected');
                    return;
                }

                const evidenceCopyBtn = event.target.closest('[data-evidence-copy]');
                if (evidenceCopyBtn) {
                    const item = getRiskRegisterItemById(evidenceCopyBtn.dataset.riskId);
                    const control = item?.mappedControls?.[Number(evidenceCopyBtn.dataset.controlIndex)];
                    if (control) {
                        copyEvidenceChecklist(control);
                    }
                    return;
                }

                const controlAddBtn = event.target.closest('[data-control-add]');
                if (controlAddBtn) {
                    addMappedControlEntry({
                        id: controlAddBtn.dataset.controlAdd,
                        type: controlAddBtn.dataset.controlType,
                        title: controlAddBtn.dataset.controlTitle
                    });
                    return;
                }

                const mappedRemoveBtn = event.target.closest('[data-mapped-remove]');
                if (mappedRemoveBtn) {
                    const index = Number(mappedRemoveBtn.dataset.mappedRemove);
                    if (!Number.isNaN(index)) {
                        riskRegisterModalState.mappedControls.splice(index, 1);
                        renderMappedControlsList();
                    }
                    return;
                }

                const controlSuggestBtn = event.target.closest('[data-risk-control-suggest]');
                if (controlSuggestBtn) {
                    const currentId = document.getElementById('risk-id')?.value;
                    const item = currentId ? getRiskRegisterItemById(currentId) : {
                        title: document.getElementById('risk-title')?.value,
                        description: document.getElementById('risk-description')?.value,
                        category: document.getElementById('risk-category')?.value
                    };
                    const suggestions = getAutoSuggestedFamilies(item);
                    riskRegisterModalState.autoSuggestions = suggestions;
                    renderControlAutoSuggestions(suggestions);
                    return;
                }

                const controlClearBtn = event.target.closest('[data-risk-control-clear]');
                if (controlClearBtn) {
                    clearMappedControls();
                    return;
                }

                const riskRow = event.target.closest('[data-risk-row]');
                if (riskRow && !event.target.closest('button') && !event.target.closest('a')) {
                    const id = riskRow.dataset.riskId;
                    const item = getRiskRegisterItemById(id);
                    if (item) {
                        openRiskRegisterModal(item);
                    }
                    return;
                }

                const checklistCreateBtn = event.target.closest('[data-checklist-create]');
                if (checklistCreateBtn) {
                    const guide = getDataBankItemById(checklistCreateBtn.dataset.checklistCreate);
                    createChecklistFromGuide(guide);
                    return;
                }

                const checklistOpenBtn = event.target.closest('[data-checklist-open]');
                if (checklistOpenBtn) {
                    openChecklistModal(checklistOpenBtn.dataset.checklistOpen);
                    return;
                }

                const checklistDeleteBtn = event.target.closest('[data-checklist-delete]');
                if (checklistDeleteBtn) {
                    deleteChecklist(checklistDeleteBtn.dataset.checklistDelete);
                    return;
                }

                const checklistPinBtn = event.target.closest('[data-checklist-pin]');
                if (checklistPinBtn) {
                    const checklist = getChecklistById(checklistPinBtn.dataset.checklistPin);
                    pinChecklistToClipboard(checklist);
                    return;
                }

                const checklistLibraryBtn = event.target.closest('[data-checklist-library]');
                if (checklistLibraryBtn) {
                    const checklist = getChecklistById(checklistLibraryBtn.dataset.checklistLibrary);
                    saveChecklistToLibrary(checklist);
                    return;
                }

                const checklistExportBtn = event.target.closest('[data-checklist-export]');
                if (checklistExportBtn) {
                    const checklist = getChecklistById(checklistExportBtn.dataset.checklistExport);
                    exportChecklist(checklist);
                    return;
                }

                const favBtn = event.target.closest('[data-databank-fav]');
                if (favBtn) {
                    event.preventDefault();
                    event.stopPropagation();
                    toggleDataBankFavorite(favBtn.dataset.databankFav);
                    return;
                }

                const actionBtn = event.target.closest('[data-databank-action]');
                if (actionBtn) {
                    handleDataBankAction(actionBtn.dataset.databankAction, actionBtn.dataset.databankId);
                    return;
                }

                const chipBtn = event.target.closest('[data-databank-chip]');
                if (chipBtn) {
                    const item = getDataBankItemById(chipBtn.dataset.databankChip);
                    if (item) {
                        openDataBankModal(item);
                    }
                    return;
                }

                const toggleBtn = event.target.closest('[data-guide-toggle]');
                if (toggleBtn) {
                    const id = toggleBtn.dataset.guideToggle;
                    const safeId = (window.CSS && CSS.escape) ? CSS.escape(id) : id;
                    const body = document.querySelector(`[data-guide-body="${safeId}"]`);
                    if (body) {
                        body.classList.toggle('active');
                    }
                    return;
                }

                const openBtn = event.target.closest('[data-databank-open]');
                if (openBtn) {
                    const item = getDataBankItemById(openBtn.dataset.databankOpen);
                    openDataBankModal(item);
                    return;
                }

                const card = event.target.closest('[data-databank-item]');
                if (card && !event.target.closest('a') && !event.target.closest('button')) {
                    const item = getDataBankItemById(card.dataset.databankId);
                    openDataBankModal(item);
                    return;
                }

                const modal = document.getElementById('databank-detail-modal');
                if (modal && modal.classList.contains('active')) {
                    if (event.target.closest('#databank-detail-modal .modal-close') || event.target === modal) {
                        closeDataBankModal();
                        return;
                    }
                }

                const riskModal = document.getElementById('risk-register-modal');
                if (riskModal && riskModal.classList.contains('active')) {
                    if (event.target.closest('#risk-register-modal .modal-close') || event.target === riskModal) {
                        closeRiskRegisterModal();
                        return;
                    }
                }

                const checklistModal = document.getElementById('checklist-modal');
                if (checklistModal && checklistModal.classList.contains('active')) {
                    if (event.target.closest('#checklist-modal .modal-close') || event.target === checklistModal) {
                        closeChecklistModal();
                        return;
                    }
                }

                const riskTreatmentModal = document.getElementById('risk-treatment-modal');
                if (riskTreatmentModal && riskTreatmentModal.classList.contains('active')) {
                    if (event.target.closest('#risk-treatment-modal .modal-close') || event.target === riskTreatmentModal) {
                        closeRiskTreatmentModal();
                        return;
                    }
                }

                const riskPlanAction = event.target.closest('[data-risk-plan-action]');
                if (riskPlanAction) {
                    const id = riskPlanAction.dataset.riskId;
                    const item = getRiskRegisterItemById(id);
                    if (!item) return;
                    const action = riskPlanAction.dataset.riskPlanAction;
                    if (action === 'clipboard') {
                        upsertClipboardItem(buildTreatmentPlanPayload(item));
                        renderClipboard();
                        updatePinButtons();
                        showToast('Treatment plan pinned');
                    } else if (action === 'case') {
                        addRiskToCase({
                            ...item,
                            title: `Treatment Plan: ${item.title}`,
                            description: item.treatmentPlanNotes || item.description || ''
                        });
                    } else if (action === 'library') {
                        addLibraryItem({
                            id: `risk-plan:${item.id}`,
                            type: 'risk-plan',
                            title: `Treatment Plan: ${item.title}`,
                            summary: item.treatmentPlanNotes || item.description || '',
                            source: 'Risk Register',
                            date: new Date().toLocaleDateString(),
                            url: '',
                            tags: ['risk', 'treatment', getRiskCellRating(item.likelihood, item.impact)]
                        });
                    } else if (action === 'export') {
                        exportRiskTreatmentPlan(item);
                    } else if (action === 'evidence-export') {
                        exportEvidencePack(item);
                    }
                    return;
                }

                if (!event.target.closest('.databank-search-wrapper')) {
                    const resultsContainer = document.getElementById('databank-search-results');
                    if (resultsContainer) {
                        resultsContainer.classList.remove('active');
                    }
                }
            });

            document.addEventListener('change', event => {
                if (event.target.matches('[data-risk-cell-select]')) {
                    const row = Number(event.target.dataset.row);
                    const col = Number(event.target.dataset.col);
                    const value = event.target.value;
                    if (!riskRatingOptions.includes(value)) return;
                    riskMatrixState.ratings[row][col] = value;
                    saveRiskMatrixConfig();
                    const cell = event.target.closest('td');
                    if (cell) {
                        const meta = getRiskRatingMeta(value);
                        cell.style.background = meta.color;
                        const label = cell.querySelector('.risk-cell-label');
                        if (label) label.textContent = value;
                    }
                    renderDataBankSection('risk', dataBankState.search);
                    return;
                }

                if (event.target.matches('[data-risk-filter]')) {
                    const type = event.target.dataset.riskFilter;
                    if (type === 'status') riskRegisterUiState.status = event.target.value;
                    if (type === 'rating') riskRegisterUiState.rating = event.target.value;
                    if (type === 'category') riskRegisterUiState.category = event.target.value;
                    if (type === 'unmapped') riskRegisterUiState.unmappedOnly = event.target.checked;
                    if (type === 'inprogress') riskRegisterUiState.inProgressOnly = event.target.checked;
                    renderDataBankSection('risk', dataBankState.search);
                    return;
                }

                if (event.target.matches('[data-risk-sort]')) {
                    riskRegisterUiState.sort = event.target.value;
                    renderDataBankSection('risk', dataBankState.search);
                    return;
                }

                if (event.target.matches('[data-posture-filter]')) {
                    postureUiState.category = event.target.value;
                    renderDataBankSection('posture', dataBankState.search);
                    return;
                }

                if (event.target.id === 'risk-likelihood' || event.target.id === 'risk-impact') {
                    updateRiskRatingPreview();
                    return;
                }

                if (event.target.matches('[data-mapped-field]')) {
                    const index = Number(event.target.dataset.mappedIndex);
                    const field = event.target.dataset.mappedField;
                    const entry = riskRegisterModalState.mappedControls[index];
                    if (!entry || !field) return;
                    entry[field] = event.target.value;
                    return;
                }

                if (event.target.matches('[data-evidence-field]')) {
                    handleEvidenceFieldUpdate(event.target);
                    return;
                }

                if (event.target.matches('[data-checklist-item]')) {
                    const checklistId = event.target.dataset.checklistItem;
                    const index = Number(event.target.dataset.index);
                    updateChecklistItem(checklistId, index, event.target.checked);
                }
            });

            document.addEventListener('input', event => {
                if (event.target.matches('[data-risk-label]')) {
                    const type = event.target.dataset.riskLabel;
                    const index = Number(event.target.dataset.index);
                    const value = event.target.value;
                    if (type === 'likelihood') {
                        riskMatrixState.likelihoodLabels[index] = value;
                    } else if (type === 'impact') {
                        riskMatrixState.impactLabels[index] = value;
                    }
                    saveRiskMatrixConfig();
                    const table = document.querySelector('#risk-matrix-builder .risk-matrix-grid');
                    if (table) {
                        if (type === 'likelihood') {
                            const rowHeader = table.querySelector(`tbody tr:nth-child(${index + 1}) th`);
                            if (rowHeader) rowHeader.textContent = value || '';
                        } else if (type === 'impact') {
                            const headerCell = table.querySelector(`thead th:nth-child(${index + 2})`);
                            if (headerCell) headerCell.textContent = value || '';
                        }
                    }
                }

                if (event.target.id === 'risk-control-search') {
                    updateControlSearchSuggestions(event.target.value);
                    return;
                }

                if (event.target.matches('[data-mapped-field]')) {
                    const index = Number(event.target.dataset.mappedIndex);
                    const field = event.target.dataset.mappedField;
                    const entry = riskRegisterModalState.mappedControls[index];
                    if (!entry || !field) return;
                    entry[field] = event.target.value;
                    return;
                }

                if (event.target.matches('[data-evidence-field]')) {
                    handleEvidenceFieldUpdate(event.target);
                    return;
                }

                if (event.target.matches('[data-treatment-notes]')) {
                    saveRiskTreatmentNotes(event.target.dataset.treatmentNotes, event.target.value);
                }
            });

            const riskForm = document.getElementById('risk-register-form');
            if (riskForm) {
                riskForm.addEventListener('submit', event => {
                    event.preventDefault();
                    saveRiskFromForm();
                });
            }

            const riskDeleteBtn = document.getElementById('risk-delete-btn');
            if (riskDeleteBtn) {
                riskDeleteBtn.addEventListener('click', () => {
                    const id = document.getElementById('risk-id').value;
                    if (id) {
                        deleteRisk(id);
                    }
                });
            }

            document.addEventListener('keydown', event => {
                if (event.key === 'Escape') {
                    closeDataBankModal();
                    closeRiskRegisterModal();
                    closeRiskTreatmentModal();
                    closeChecklistModal();
                }
            });
        }

        // Fix: Learning Hub Tab - Subtab/section init
        function setupLearningHubTabs() {
            // Attach listeners to all 6 subtab buttons immediately
            document.getElementById('learning-news-btn').addEventListener('click', function(){activateLearningSubTab('news');});
            document.getElementById('learning-research-btn').addEventListener('click', function(){activateLearningSubTab('research');});
            document.getElementById('learning-youtube-btn').addEventListener('click', function(){activateLearningSubTab('youtube');});
            document.getElementById('learning-docs-btn').addEventListener('click', function(){activateLearningSubTab('document');});
            document.getElementById('learning-library-btn').addEventListener('click', function(){activateLearningSubTab('library');});
            document.getElementById('learning-databank-btn').addEventListener('click', function(){activateLearningSubTab('databank');});
            
            // On load, show news tab
            activateLearningSubTab('news');
        }



        // END Learning Hub & Data Bank logic

        // PDF Download Function
        async function downloadAsPDF(type) {
            const btn = event.target;
            btn.innerHTML = '<span class="spinner"></span> Generating PDF...';
            btn.classList.add('loading');

            try {
                const contentMap = {
                    'research': 'research-result-content',
                    'youtube': 'youtube-result-content',
                    'document': 'document-result-content'
                };

                const elementId = contentMap[type];
                const element = document.getElementById(elementId);
                
                if (!element) {
                    throw new Error('Content not found');
                }

                const canvas = await html2canvas(element, {
                    scale: 2,
                    backgroundColor: '#1a4d5c',
                    logging: false
                });

                const imgData = canvas.toDataURL('image/png');
                const { jsPDF } = window.jspdf;
                const pdf = new jsPDF('p', 'pt', 'a4');
                
                const imgWidth = 595;
                const imgHeight = (canvas.height * imgWidth) / canvas.width;
                
                pdf.addImage(imgData, 'PNG', 0, 0, imgWidth, imgHeight);
                
                const filename = `${type}-result-${Date.now()}.pdf`;
                pdf.save(filename);

                alert('âœ“ PDF downloaded successfully!');
            } catch (error) {
                alert('Error generating PDF: ' + error.message);
            } finally {
                btn.innerHTML = 'ðŸ“„ Download as PDF';
                btn.classList.remove('loading');
            }
        }

        // Word Download Function
        async function downloadAsWord(type) {
            const btn = event.target;
            btn.innerHTML = '<span class="spinner"></span> Generating Word...';
            btn.classList.add('loading');

            try {
                const result = appState.lastResults[type];
                if (!result) {
                    throw new Error('No content to export');
                }

                const { Document, Packer, Paragraph, TextRun, HeadingLevel } = docx;

                const doc = new Document({
                    sections: [{
                        properties: {},
                        children: [
                            new Paragraph({
                                text: result.title || 'Research Result',
                                heading: HeadingLevel.HEADING_1
                            }),
                            new Paragraph({
                                text: `Generated: ${result.timestamp}`,
                                spacing: { after: 200 }
                            }),
                            new Paragraph({
                                text: result.content,
                                spacing: { after: 200 }
                            }),
                            new Paragraph({
                                text: '---',
                                spacing: { before: 200, after: 200 }
                            }),
                            new Paragraph({
                                text: 'Generated by CyberSec Command',
                                italics: true
                            })
                        ]
                    }]
                });

                const blob = await Packer.toBlob(doc);
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `${type}-result-${Date.now()}.docx`;
                a.click();
                URL.revokeObjectURL(url);

                alert('âœ“ Word document downloaded successfully!');
            } catch (error) {
                alert('Error generating Word document: ' + error.message);
            } finally {
                btn.innerHTML = 'ðŸ“ Download as Word';
                btn.classList.remove('loading');
            }
        }

        // Copy to Clipboard Function
        function copyToClipboard(type) {
            const result = appState.lastResults[type];
            if (!result) {
                alert('No content to copy');
                return;
            }

            const text = `${result.title}\n\nGenerated: ${result.timestamp}\n\n${result.content}`;
            
            navigator.clipboard.writeText(text).then(() => {
                alert('âœ“ Content copied to clipboard!');
            }).catch(() => {
                alert('Failed to copy to clipboard');
            });
        }

        const caseBuilderStorageKey = 'case_builder_v1';
        const caseBuilderVersion = 1;

        function loadCaseBuilder() {
            try {
                const raw = localStorage.getItem(caseBuilderStorageKey);
                if (!raw) return { version: caseBuilderVersion, cases: [] };
                const parsed = JSON.parse(raw);
                if (!parsed || parsed.version !== caseBuilderVersion || !Array.isArray(parsed.cases)) {
                    return { version: caseBuilderVersion, cases: [] };
                }
                return parsed;
            } catch (error) {
                return { version: caseBuilderVersion, cases: [] };
            }
        }

        function saveCaseBuilder(data) {
            try {
                localStorage.setItem(caseBuilderStorageKey, JSON.stringify(data));
            } catch (error) {
                showToast('Case storage unavailable');
            }
        }

        function getDocumentActionLabel(action) {
            const labels = {
                summarize: 'Summarize - Executive Summary',
                quiz: 'Quiz - Knowledge Check',
                qa: 'Q&A - Ask Questions'
            };
            return labels[action] || action;
        }

        function pinDocumentSummary(options = {}) {
            const result = appState.lastResults.document;
            if (!result || result.action !== 'summarize') {
                showToast('Generate a document summary first');
                return null;
            }
            const id = result.clipboardId || `doc:${result.title}:${result.timestamp}`;
            const payload = {
                id: id,
                anchor: 'document-summary',
                type: 'doc',
                title: result.title,
                subtitle: getDocumentActionLabel(result.action),
                notes: result.cleanedContent || result.content,
                meta: {
                    generatedAt: result.timestamp,
                    artifacts: result.artifacts
                }
            };
            upsertClipboardItem(payload);
            renderClipboard();
            updatePinButtons();
            result.clipboardId = id;
            if (!options.silent) {
                showToast('Pinned to Clipboard');
            }
            return id;
        }

        function createDocumentCase() {
            const result = appState.lastResults.document;
            if (!result || result.action !== 'summarize') {
                showToast('Generate a document summary first');
                return;
            }
            const clipboardId = result.clipboardId || pinDocumentSummary({ silent: true });
            const data = loadCaseBuilder();
            const description = (result.cleanedContent || result.content || '').slice(0, 200);
            const entry = {
                id: `case:${Date.now()}`,
                title: `Document Analysis: ${result.title}`,
                description: description,
                artifacts: result.artifacts || {},
                clipboardId: clipboardId,
                createdAt: new Date().toISOString()
            };
            data.cases.unshift(entry);
            saveCaseBuilder(data);
            showToast('Case created');
        }

        // === Saved Library ===
        const libraryStorageKey = 'library_v1';
        const libraryTypeLabels = {
            news: 'News',
            breach: 'Breach',
            incident: 'Incident',
            cve: 'CVE',
            kev: 'KEV',
            actor: 'Threat Actor',
            technique: 'Technique',
            risk: 'Risk Register',
            checklist: 'Checklist',
            advisory: 'Vendor Advisory',
            osv: 'OSV Advisory',
            status: 'Status Update'
        };
        const libraryState = {
            items: [],
            filteredItems: [],
            activeTag: 'all',
            search: '',
            sort: 'saved',
            selectedIds: new Set()
        };

        function getLibrarySaveMarkup(item, options = {}) {
            if (!item || !item.id) return '';
            const encoded = encodeURIComponent(JSON.stringify(item));
            const label = options.label || 'Save';
            return `
                <button class="library-save-btn" type="button" data-library-save="true" data-library="${escapeHtml(encoded)}">
                    ${label}
                </button>
            `;
        }

        function loadLibrary() {
            try {
                const raw = localStorage.getItem(libraryStorageKey);
                if (!raw) return [];
                const parsed = JSON.parse(raw);
                return Array.isArray(parsed) ? parsed : [];
            } catch (error) {
                return [];
            }
        }

        function persistLibrary() {
            localStorage.setItem(libraryStorageKey, JSON.stringify(libraryState.items));
        }

        function normalizeLibraryTags(tags) {
            return (tags || [])
                .map(tag => String(tag).trim())
                .filter(Boolean);
        }

        function addLibraryItem(rawItem) {
            if (!rawItem || !rawItem.id) return;
            const normalizedTags = normalizeLibraryTags(rawItem.tags || []);
            const existingIndex = libraryState.items.findIndex(item => item.id === rawItem.id);
            if (existingIndex >= 0) {
                const existing = libraryState.items[existingIndex];
                libraryState.items[existingIndex] = {
                    ...existing,
                    ...rawItem,
                    tags: normalizedTags.length ? normalizedTags : existing.tags || [],
                    savedAt: existing.savedAt || rawItem.savedAt
                };
                persistLibrary();
                renderLibrary();
                showToast('Already saved in Library');
                return;
            }

            const item = {
                ...rawItem,
                tags: normalizedTags,
                savedAt: rawItem.savedAt || new Date().toISOString()
            };
            libraryState.items = [item, ...libraryState.items];
            persistLibrary();
            renderLibrary();
            showToast('Saved to Library');
        }

        function removeLibraryItem(id) {
            libraryState.items = libraryState.items.filter(item => item.id !== id);
            libraryState.selectedIds.delete(id);
            persistLibrary();
            renderLibrary();
            showToast('Removed from Library');
        }

        function updateLibraryTags(id, tags) {
            const index = libraryState.items.findIndex(item => item.id === id);
            if (index < 0) return;
            libraryState.items[index] = {
                ...libraryState.items[index],
                tags: normalizeLibraryTags(tags)
            };
            persistLibrary();
            renderLibrary();
            showToast('Tags updated');
        }

        function getLibraryTypeLabel(type) {
            return libraryTypeLabels[type] || 'Item';
        }

        function matchesLibrarySearch(item, query) {
            if (!query) return true;
            const haystack = [
                item.title,
                item.summary,
                ...(item.tags || [])
            ].join(' ').toLowerCase();
            return haystack.includes(query);
        }

        function sortLibraryItems(items) {
            const sorted = [...items];
            if (libraryState.sort === 'date') {
                sorted.sort((a, b) => new Date(b.date || b.savedAt || 0) - new Date(a.date || a.savedAt || 0));
            } else if (libraryState.sort === 'type') {
                sorted.sort((a, b) => {
                    const typeCompare = (a.type || '').localeCompare(b.type || '');
                    return typeCompare !== 0 ? typeCompare : (a.title || '').localeCompare(b.title || '');
                });
            } else {
                sorted.sort((a, b) => new Date(b.savedAt || 0) - new Date(a.savedAt || 0));
            }
            return sorted;
        }

        function renderLibraryTagFilters() {
            const container = document.getElementById('library-tag-filters');
            if (!container) return;
            const tagCounts = {};
            libraryState.items.forEach(item => {
                (item.tags || []).forEach(tag => {
                    tagCounts[tag] = (tagCounts[tag] || 0) + 1;
                });
            });
            const tags = Object.keys(tagCounts).sort((a, b) => a.localeCompare(b));
            const chips = [
                `<button class="library-chip ${libraryState.activeTag === 'all' ? 'active' : ''}" data-library-tag="all">All (${libraryState.items.length})</button>`,
                ...tags.map(tag => `
                    <button class="library-chip ${libraryState.activeTag === tag ? 'active' : ''}" data-library-tag="${escapeHtml(tag)}">
                        ${escapeHtml(tag)} (${tagCounts[tag]})
                    </button>
                `)
            ];
            container.innerHTML = chips.join('');
        }

        function renderLibrary() {
            const container = document.getElementById('library-items');
            const emptyState = document.getElementById('library-empty');
            if (!container || !emptyState) return;
            renderLibraryTagFilters();

            const query = libraryState.search.trim().toLowerCase();
            const filtered = libraryState.items.filter(item => {
                if (libraryState.activeTag !== 'all' && !(item.tags || []).includes(libraryState.activeTag)) {
                    return false;
                }
                return matchesLibrarySearch(item, query);
            });

            const sorted = sortLibraryItems(filtered);
            libraryState.filteredItems = sorted;

            if (!sorted.length) {
                container.innerHTML = '';
                emptyState.style.display = 'block';
                return;
            }
            emptyState.style.display = 'none';

            container.innerHTML = sorted.map(item => `
                <div class="library-item" data-library-id="${escapeHtml(item.id)}">
                    <label class="library-select">
                        <input type="checkbox" data-library-select="${escapeHtml(item.id)}" ${libraryState.selectedIds.has(item.id) ? 'checked' : ''}>
                    </label>
                    <div>
                        <div class="library-item-title">${escapeHtml(item.title)}</div>
                        <div class="library-item-meta">${getLibraryTypeLabel(item.type)} â€¢ ${escapeHtml(item.source || 'Source')} â€¢ ${escapeHtml(item.date || 'Date N/A')}</div>
                        <div class="library-item-summary">${escapeHtml(item.summary || 'No summary available.')}</div>
                        <div class="library-item-actions">
                            ${item.url ? `<a class="library-action-btn" href="${escapeHtml(item.url)}" target="_blank" rel="noopener">Open link</a>` : ''}
                            <button class="library-action-btn" type="button" data-library-edit-tags="${escapeHtml(item.id)}">Edit tags</button>
                            <button class="library-action-btn" type="button" data-library-remove="${escapeHtml(item.id)}">Remove</button>
                        </div>
                        <div class="library-tags">
                            ${(item.tags && item.tags.length)
                                ? item.tags.map(tag => `<span class="library-tag">${escapeHtml(tag)}</span>`).join('')
                                : '<span class="library-tag">No tags</span>'}
                        </div>
                    </div>
                </div>
            `).join('');
        }

        function exportLibraryBrief() {
            const selectedInView = libraryState.filteredItems.filter(item => libraryState.selectedIds.has(item.id));
            const exportItems = selectedInView.length ? selectedInView : libraryState.filteredItems;
            if (!exportItems.length) {
                showToast('No saved items to export');
                return;
            }
            const payload = {
                title: 'Weekly Brief',
                generatedAt: new Date().toISOString(),
                items: exportItems.map(item => ({
                    title: item.title,
                    date: item.date || item.savedAt,
                    category: getLibraryTypeLabel(item.type),
                    link: item.url || ''
                }))
            };
            const blob = new Blob([JSON.stringify(payload, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const link = document.createElement('a');
            link.href = url;
            link.download = `weekly-brief-${Date.now()}.json`;
            link.click();
            URL.revokeObjectURL(url);
            showToast('Weekly brief exported');
        }

        function setupLibrary() {
            libraryState.items = loadLibrary();
            renderLibrary();

            const searchInput = document.getElementById('library-search');
            if (searchInput) {
                searchInput.addEventListener('input', () => {
                    libraryState.search = searchInput.value;
                    renderLibrary();
                });
            }

            const sortSelect = document.getElementById('library-sort');
            if (sortSelect) {
                sortSelect.value = libraryState.sort;
                sortSelect.addEventListener('change', () => {
                    libraryState.sort = sortSelect.value;
                    renderLibrary();
                });
            }

            const exportBtn = document.getElementById('library-export');
            if (exportBtn) {
                exportBtn.addEventListener('click', exportLibraryBrief);
            }

            document.addEventListener('click', event => {
                const saveBtn = event.target.closest('[data-library-save]');
                if (saveBtn) {
                    const payloadRaw = saveBtn.dataset.library;
                    try {
                        const payload = JSON.parse(decodeURIComponent(payloadRaw));
                        addLibraryItem(payload);
                    } catch (error) {
                        showToast('Unable to save item');
                    }
                    return;
                }

                const tagBtn = event.target.closest('[data-library-tag]');
                if (tagBtn) {
                    const tag = tagBtn.dataset.libraryTag;
                    libraryState.activeTag = tag || 'all';
                    renderLibrary();
                    return;
                }

                const editBtn = event.target.closest('[data-library-edit-tags]');
                if (editBtn) {
                    const id = editBtn.dataset.libraryEditTags;
                    const current = libraryState.items.find(item => item.id === id);
                    const value = prompt('Edit tags (comma-separated)', (current?.tags || []).join(', '));
                    if (value !== null) {
                        updateLibraryTags(id, value.split(','));
                    }
                    return;
                }

                const removeBtn = event.target.closest('[data-library-remove]');
                if (removeBtn) {
                    removeLibraryItem(removeBtn.dataset.libraryRemove);
                }
            });

            document.addEventListener('change', event => {
                if (event.target.matches('[data-library-select]')) {
                    const id = event.target.dataset.librarySelect;
                    if (event.target.checked) {
                        libraryState.selectedIds.add(id);
                    } else {
                        libraryState.selectedIds.delete(id);
                    }
                }
            });
        }

        // === Investigation Clipboard ===
        const clipboardStorageKey = 'clipboard_v1';
        const clipboardUiStorageKey = 'clipboard_ui_v1';
        const clipboardVersion = 1;
        const clipboardStatusValues = ['Open', 'Investigating', 'Closed'];
        const clipboardGroupDefaults = {
            Open: true,
            Investigating: true,
            Closed: false
        };
        const clipboardTypeLabels = {
            cve: 'CVE',
            kev: 'KEV',
            breach: 'Breach',
            incident: 'Incident',
            actor: 'Threat Actor',
            technique: 'Technique',
            tool: 'Tool Result',
            doc: 'Document',
            risk: 'Risk',
            checklist: 'Checklist',
            advisory: 'Vendor Advisory',
            osv: 'OSV Advisory',
            status: 'Status Update'
        };
        let clipboardState = loadClipboard();
        let clipboardUiState = loadClipboardUiState();
        let clipboardGroupState = { ...clipboardGroupDefaults };
        let clipboardInitialized = false;
        let clipboardAutoCollapsed = false;
        let clipboardManualOverride = false;

        function getPinButtonMarkup(item, options = {}) {
            if (!item || !item.id) return '';
            const encoded = encodeURIComponent(JSON.stringify(item));
            const compactClass = options.compact ? 'pin-btn--compact' : '';
            const label = options.label || 'Pin';
            return `
                <button class="pin-btn ${compactClass}" type="button" data-clipboard-id="${escapeHtml(item.id)}" data-clipboard="${encoded}" aria-label="Pin to investigation clipboard">
                    <span class="pin-icon">ðŸ“Œ</span>
                    <span class="pin-label">${label}</span>
                </button>
            `;
        }

        function loadClipboardUiState() {
            try {
                const raw = localStorage.getItem(clipboardUiStorageKey);
                if (!raw) return { collapsed: false };
                const parsed = JSON.parse(raw);
                return {
                    collapsed: Boolean(parsed?.collapsed)
                };
            } catch (error) {
                return { collapsed: false };
            }
        }

        function saveClipboardUiState() {
            try {
                localStorage.setItem(clipboardUiStorageKey, JSON.stringify({
                    collapsed: Boolean(clipboardUiState.collapsed)
                }));
            } catch (error) {
                showToast('Clipboard UI preferences unavailable');
            }
        }

        function applyClipboardUiState() {
            const panel = document.getElementById('clipboard-panel');
            const appShell = document.getElementById('app-shell');
            const collapsed = Boolean(clipboardUiState.collapsed || clipboardAutoCollapsed);
            if (panel) {
                panel.classList.toggle('is-collapsed', collapsed);
            }
            if (appShell) {
                appShell.classList.toggle('has-clipboard', !collapsed);
            }
            document.body.classList.toggle('clipboard-collapsed', collapsed);
            document.body.classList.toggle('clipboard-open', !collapsed);
            const toggleBtn = document.getElementById('clipboard-collapse-toggle');
            if (toggleBtn) {
                toggleBtn.textContent = collapsed ? 'Expand' : 'Collapse';
                toggleBtn.setAttribute('aria-expanded', String(!collapsed));
            }
        }

        function setClipboardCollapsed(nextValue) {
            clipboardUiState.collapsed = Boolean(nextValue);
            clipboardManualOverride = true;
            clipboardAutoCollapsed = false;
            saveClipboardUiState();
            applyClipboardUiState();
        }

        function updateClipboardAutoCollapse() {
            const isNarrow = window.innerWidth < 1250;
            if (!isNarrow) {
                clipboardAutoCollapsed = false;
                clipboardManualOverride = false;
                applyClipboardUiState();
                return;
            }
            if (clipboardManualOverride) {
                clipboardAutoCollapsed = false;
                applyClipboardUiState();
                return;
            }
            clipboardAutoCollapsed = !clipboardUiState.collapsed;
            applyClipboardUiState();
        }

        function loadClipboard() {
            try {
                const raw = localStorage.getItem(clipboardStorageKey);
                if (!raw) return { version: clipboardVersion, items: [] };
                const parsed = JSON.parse(raw);
                if (!parsed || parsed.version !== clipboardVersion || !Array.isArray(parsed.items)) {
                    return { version: clipboardVersion, items: [] };
                }
                const sanitized = parsed.items.map(normalizeClipboardItem).filter(Boolean);
                return { version: clipboardVersion, items: sanitized };
            } catch (error) {
                return { version: clipboardVersion, items: [] };
            }
        }

        function normalizeClipboardItem(item) {
            if (!item || typeof item.id !== 'string') return null;
            const type = typeof item.type === 'string' && item.type.trim() ? item.type : 'item';
            const anchor = typeof item.anchor === 'string' && item.anchor.trim() ? item.anchor : item.id;
            return {
                id: item.id,
                anchor: anchor,
                type: type,
                title: String(item.title || 'Untitled'),
                subtitle: String(item.subtitle || ''),
                url: String(item.url || ''),
                severity: item.severity || null,
                meta: typeof item.meta === 'object' && item.meta ? item.meta : {},
                status: clipboardStatusValues.includes(item.status) ? item.status : 'Open',
                notes: String(item.notes || ''),
                pinnedAt: item.pinnedAt || new Date().toISOString()
            };
        }

        function saveClipboard(data) {
            try {
                clipboardState = data;
                localStorage.setItem(clipboardStorageKey, JSON.stringify(clipboardState));
            } catch (error) {
                showToast('Clipboard storage unavailable');
            }
        }

        function upsertClipboardItem(payload) {
            const normalized = normalizeClipboardItem(payload);
            if (!normalized) return false;
            const existing = clipboardState.items.find(item => item.id === normalized.id);
            if (existing) {
                existing.anchor = normalized.anchor;
                existing.title = normalized.title;
                existing.subtitle = normalized.subtitle;
                existing.url = normalized.url;
                existing.severity = normalized.severity;
                existing.meta = normalized.meta;
                existing.type = normalized.type;
                saveClipboard(clipboardState);
                return false;
            }
            normalized.status = 'Open';
            normalized.notes = '';
            normalized.pinnedAt = new Date().toISOString();
            clipboardState.items.unshift(normalized);
            saveClipboard(clipboardState);
            return true;
        }

        function removeClipboardItem(id) {
            clipboardState.items = clipboardState.items.filter(item => item.id !== id);
            saveClipboard(clipboardState);
        }

        function updateClipboardStatus(id, status) {
            const item = clipboardState.items.find(entry => entry.id === id);
            if (item && clipboardStatusValues.includes(status)) {
                item.status = status;
                saveClipboard(clipboardState);
            }
        }

        function updateClipboardNotes(id, notes) {
            const item = clipboardState.items.find(entry => entry.id === id);
            if (item) {
                item.notes = notes;
                saveClipboard(clipboardState);
            }
        }

        function clearClosedItems() {
            const before = clipboardState.items.length;
            clipboardState.items = clipboardState.items.filter(item => item.status !== 'Closed');
            if (clipboardState.items.length !== before) {
                saveClipboard(clipboardState);
                renderClipboard();
                updatePinButtons();
                showToast('Closed items cleared');
            } else {
                showToast('No closed items to clear');
            }
        }

        function formatMetaChips(item) {
            const chips = [];
            if (item.severity) {
                chips.push(`<span class="clipboard-chip severity">${escapeHtml(item.severity)}</span>`);
            }
            chips.push(`<span class="clipboard-chip">${escapeHtml(clipboardTypeLabels[item.type] || item.type)}</span>`);
            const entries = Object.entries(item.meta || {}).filter(([, value]) => {
                const valueType = typeof value;
                return value != null && value !== '' && (valueType === 'string' || valueType === 'number' || valueType === 'boolean');
            });
            entries.slice(0, 3).forEach(([key, value]) => {
                const label = `${key}: ${value}`;
                chips.push(`<span class="clipboard-chip">${escapeHtml(label)}</span>`);
            });
            return chips.join('');
        }

        function renderClipboardItems(items) {
            if (!items.length) {
                return `<div class="clipboard-empty">No pinned items yet. Pin CVEs and vulnerabilities to build your investigation.</div>`;
            }
            const groups = clipboardStatusValues.map(status => ({
                status,
                items: items.filter(item => item.status === status)
            }));
            return groups.map(group => {
                const isExpanded = clipboardGroupState[group.status] !== false;
                const count = group.items.length;
                const itemsMarkup = count
                    ? group.items.map(item => `
                        <div class="clipboard-item" data-clipboard-id="${item.id}">
                            <div class="clipboard-item-header">
                                <div class="clipboard-item-title">
                                    <div style="font-weight: 600;">
                                        ${item.url ? `<a href="${escapeHtml(item.url)}" target="_blank" rel="noopener">${escapeHtml(item.title)}</a>` : escapeHtml(item.title)}
                                    </div>
                                    ${item.subtitle ? `<div class="clipboard-item-subtitle">${escapeHtml(item.subtitle)}</div>` : ''}
                                </div>
                                <div class="clipboard-item-actions">
                                    <button class="clipboard-goto" type="button" data-clipboard-go="${escapeHtml(item.anchor || item.id)}">Go to</button>
                                    <button class="clipboard-remove" type="button" aria-label="Remove pinned item">Ã—</button>
                                </div>
                            </div>
                            <div class="clipboard-meta">
                                ${formatMetaChips(item)}
                            </div>
                            <div class="clipboard-controls">
                                <label style="font-size: 11px; color: rgba(255,255,255,0.6);">Status</label>
                                <select class="clipboard-status" data-clipboard-status>
                                    ${clipboardStatusValues.map(status => `
                                        <option value="${status}" ${item.status === status ? 'selected' : ''}>${status}</option>
                                    `).join('')}
                                </select>
                            </div>
                            <div class="clipboard-notes active">
                                <textarea class="clipboard-notes-input" placeholder="Add investigation notes..." data-clipboard-notes>${escapeHtml(item.notes)}</textarea>
                            </div>
                        </div>
                    `).join('')
                    : `<div class="clipboard-empty">No ${group.status.toLowerCase()} items.</div>`;
                return `
                    <div class="clipboard-group ${isExpanded ? '' : 'is-collapsed'}" data-clipboard-group="${group.status}">
                        <div class="clipboard-group-header">
                            <button class="clipboard-group-toggle" type="button" data-clipboard-group-toggle="${group.status}">
                                <span>${group.status}</span>
                                <span class="clipboard-group-count">${count}</span>
                                <span class="clipboard-group-chevron">â–¾</span>
                            </button>
                        </div>
                        <div class="clipboard-group-body">
                            ${itemsMarkup}
                        </div>
                    </div>
                `;
            }).join('');
        }

        function renderClipboard() {
            const panelBody = document.getElementById('clipboard-panel-body');
            const modalBody = document.getElementById('clipboard-modal-body');
            const count = clipboardState.items.length;
            const countLabel = `${count} items`;
            const countEl = document.getElementById('clipboard-count');
            const fabCount = document.getElementById('clipboard-fab-count');
            const modalCount = document.getElementById('clipboard-modal-count');
            const collapsedCount = document.getElementById('clipboard-collapsed-count');
            if (countEl) countEl.textContent = countLabel;
            if (fabCount) fabCount.textContent = String(count);
            if (modalCount) modalCount.textContent = countLabel;
            if (collapsedCount) collapsedCount.textContent = String(count);

            const html = renderClipboardItems(clipboardState.items);
            if (panelBody) panelBody.innerHTML = html;
            if (modalBody) modalBody.innerHTML = html;
        }

        function updatePinButtons() {
            const pinnedIds = new Set(clipboardState.items.map(item => item.id));
            document.querySelectorAll('.pin-btn').forEach(btn => {
                const id = btn.dataset.clipboardId;
                const label = btn.querySelector('.pin-label');
                if (!id) return;
                const isPinned = pinnedIds.has(id);
                btn.classList.toggle('is-pinned', isPinned);
                if (label) {
                    label.textContent = isPinned ? 'Pinned' : 'Pin';
                }
            });
            document.querySelectorAll('[data-clipboard-anchor]').forEach(card => {
                const anchor = card.dataset.clipboardAnchor;
                if (!anchor) return;
                card.classList.toggle('is-pinned', pinnedIds.has(anchor));
            });
        }

        function showToast(message) {
            const container = document.getElementById('toast-container');
            if (!container) return;
            const toast = document.createElement('div');
            toast.className = 'toast';
            toast.textContent = message;
            container.appendChild(toast);
            setTimeout(() => {
                toast.remove();
            }, 2000);
        }

        function scrollToClipboardAnchor(anchor) {
            if (!anchor) return;
            const safeAnchor = (window.CSS && CSS.escape) ? CSS.escape(anchor) : anchor;
            const target = document.querySelector(`[data-clipboard-anchor="${safeAnchor}"]`);
            if (!target) {
                showToast('Pinned item is not visible on this view');
                return;
            }
            target.scrollIntoView({ behavior: 'smooth', block: 'center' });
            target.classList.add('clipboard-highlight');
            setTimeout(() => {
                target.classList.remove('clipboard-highlight');
            }, 1200);
        }

        function handlePinClick(event) {
            const button = event.target.closest('.pin-btn');
            if (!button) return;
            event.preventDefault();
            event.stopPropagation();
            const payloadRaw = button.dataset.clipboard;
            let payload;
            try {
                payload = JSON.parse(decodeURIComponent(payloadRaw));
            } catch (error) {
                showToast('Unable to pin item');
                return;
            }

            const existing = clipboardState.items.find(item => item.id === payload.id);
            if (existing) {
                removeClipboardItem(payload.id);
                renderClipboard();
                updatePinButtons();
                showToast('Removed from clipboard');
                return;
            }

            upsertClipboardItem(payload);
            renderClipboard();
            updatePinButtons();
            showToast('Pinned to clipboard');
        }

        function exportClipboardJson() {
            if (!clipboardState.items.length) {
                showToast('No pinned items to export');
                return;
            }
            const blob = new Blob([JSON.stringify(clipboardState, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const link = document.createElement('a');
            link.href = url;
            link.download = `investigation-clipboard-${Date.now()}.json`;
            link.click();
            URL.revokeObjectURL(url);
            showToast('Clipboard exported');
        }

        function openClipboardModal() {
            const modal = document.getElementById('clipboard-modal');
            if (!modal) return;
            modal.classList.add('active');
            modal.setAttribute('aria-hidden', 'false');
            document.body.style.overflow = 'hidden';
        }

        function closeClipboardModal() {
            const modal = document.getElementById('clipboard-modal');
            if (!modal) return;
            modal.classList.remove('active');
            modal.setAttribute('aria-hidden', 'true');
            document.body.style.overflow = '';
        }

        function setupClipboardInteractions() {
            if (clipboardInitialized) return;
            clipboardInitialized = true;

            document.addEventListener('click', event => {
                if (event.target.closest('.pin-btn')) {
                    handlePinClick(event);
                    return;
                }
                const cardPin = event.target.closest('.card-pin-indicator');
                if (cardPin) {
                    const id = cardPin.dataset.clipboardId;
                    if (id) {
                        removeClipboardItem(id);
                        renderClipboard();
                        updatePinButtons();
                        showToast('Removed from clipboard');
                    }
                    return;
                }
                const groupToggle = event.target.closest('[data-clipboard-group-toggle]');
                if (groupToggle) {
                    const group = groupToggle.getAttribute('data-clipboard-group-toggle');
                    if (group) {
                        clipboardGroupState[group] = !clipboardGroupState[group];
                        renderClipboard();
                    }
                    return;
                }
                const goToBtn = event.target.closest('[data-clipboard-go]');
                if (goToBtn) {
                    const anchor = goToBtn.getAttribute('data-clipboard-go');
                    const modal = document.getElementById('clipboard-modal');
                    if (modal?.classList.contains('active')) {
                        closeClipboardModal();
                        setTimeout(() => scrollToClipboardAnchor(anchor), 80);
                    } else {
                        scrollToClipboardAnchor(anchor);
                    }
                    return;
                }
                const actionBtn = event.target.closest('[data-clipboard-action]');
                if (actionBtn) {
                    const action = actionBtn.getAttribute('data-clipboard-action');
                    if (action === 'export') exportClipboardJson();
                    if (action === 'clear-closed') clearClosedItems();
                    return;
                }
                const removeBtn = event.target.closest('.clipboard-remove');
                if (removeBtn) {
                    const item = removeBtn.closest('.clipboard-item');
                    if (item?.dataset.clipboardId) {
                        removeClipboardItem(item.dataset.clipboardId);
                        renderClipboard();
                        updatePinButtons();
                        showToast('Removed from clipboard');
                    }
                    return;
                }
            });

            document.addEventListener('change', event => {
                if (event.target.matches('[data-clipboard-status]')) {
                    const item = event.target.closest('.clipboard-item');
                    if (item?.dataset.clipboardId) {
                        updateClipboardStatus(item.dataset.clipboardId, event.target.value);
                        renderClipboard();
                        updatePinButtons();
                    }
                }
            });

            document.addEventListener('input', event => {
                if (event.target.matches('[data-clipboard-notes]')) {
                    const item = event.target.closest('.clipboard-item');
                    if (item?.dataset.clipboardId) {
                        updateClipboardNotes(item.dataset.clipboardId, event.target.value);
                    }
                }
            });

            const fab = document.getElementById('clipboard-fab');
            const modal = document.getElementById('clipboard-modal');
            const navBtn = document.getElementById('clipboard-nav-btn');
            const collapseToggle = document.getElementById('clipboard-collapse-toggle');
            const collapsedPill = document.getElementById('clipboard-collapsed-pill');
            if (fab && modal) {
                fab.addEventListener('click', openClipboardModal);
            }
            if (navBtn) {
                navBtn.addEventListener('click', openClipboardModal);
            }
            if (collapseToggle) {
                collapseToggle.addEventListener('click', () => {
                    setClipboardCollapsed(!clipboardUiState.collapsed);
                });
            }
            if (collapsedPill) {
                collapsedPill.addEventListener('click', () => {
                    setClipboardCollapsed(false);
                });
            }
            if (modal) {
                const closeBtn = modal.querySelector('.modal-close');
                if (closeBtn) {
                    closeBtn.addEventListener('click', closeClipboardModal);
                }
                modal.addEventListener('click', event => {
                    if (event.target === modal) {
                        closeClipboardModal();
                    }
                });
                document.addEventListener('keydown', event => {
                    if (event.key === 'Escape' && modal.classList.contains('active')) {
                        closeClipboardModal();
                    }
                });
            }
        }

        // Initialize on load
        document.addEventListener('DOMContentLoaded', () => {
            initApp();
            loadSavedAPIKey();
            applyClipboardUiState();
            updateClipboardAutoCollapse();
            renderClipboard();
            updatePinButtons();
            setupClipboardInteractions();
            setupFixFirstQueue();
            window.addEventListener('resize', updateClipboardAutoCollapse);
        });
    </script>

</body></html>
